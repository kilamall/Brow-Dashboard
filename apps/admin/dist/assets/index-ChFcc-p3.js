function hV(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function dV(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var k1={exports:{}},Xp={},x1={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wh=Symbol.for("react.element"),fV=Symbol.for("react.portal"),pV=Symbol.for("react.fragment"),mV=Symbol.for("react.strict_mode"),gV=Symbol.for("react.profiler"),yV=Symbol.for("react.provider"),_V=Symbol.for("react.context"),vV=Symbol.for("react.forward_ref"),wV=Symbol.for("react.suspense"),EV=Symbol.for("react.memo"),TV=Symbol.for("react.lazy"),GT=Symbol.iterator;function IV(t){return t===null||typeof t!="object"?null:(t=GT&&t[GT]||t["@@iterator"],typeof t=="function"?t:null)}var N1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D1=Object.assign,V1={};function Nl(t,e,n){this.props=t,this.context=e,this.refs=V1,this.updater=n||N1}Nl.prototype.isReactComponent={};Nl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Nl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function O1(){}O1.prototype=Nl.prototype;function cw(t,e,n){this.props=t,this.context=e,this.refs=V1,this.updater=n||N1}var hw=cw.prototype=new O1;hw.constructor=cw;D1(hw,Nl.prototype);hw.isPureReactComponent=!0;var QT=Array.isArray,M1=Object.prototype.hasOwnProperty,dw={current:null},L1={key:!0,ref:!0,__self:!0,__source:!0};function $1(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)M1.call(e,r)&&!L1.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Wh,type:t,key:s,ref:o,props:i,_owner:dw.current}}function AV(t,e){return{$$typeof:Wh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function fw(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wh}function SV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var YT=/\/+/g;function Gg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?SV(""+t.key):e.toString(36)}function nf(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Wh:case fV:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Gg(o,0):r,QT(i)?(n="",t!=null&&(n=t.replace(YT,"$&/")+"/"),nf(i,e,n,"",function(h){return h})):i!=null&&(fw(i)&&(i=AV(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(YT,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",QT(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+Gg(s,l);o+=nf(s,e,n,u,i)}else if(u=IV(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+Gg(s,l++),o+=nf(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ad(t,e,n){if(t==null)return t;var r=[],i=0;return nf(t,r,"","",function(s){return e.call(n,s,i++)}),r}function PV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ln={current:null},rf={transition:null},RV={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:rf,ReactCurrentOwner:dw};function F1(){throw Error("act(...) is not supported in production builds of React.")}ge.Children={map:Ad,forEach:function(t,e,n){Ad(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ad(t,function(){e++}),e},toArray:function(t){return Ad(t,function(e){return e})||[]},only:function(t){if(!fw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ge.Component=Nl;ge.Fragment=pV;ge.Profiler=gV;ge.PureComponent=cw;ge.StrictMode=mV;ge.Suspense=wV;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RV;ge.act=F1;ge.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=D1({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=dw.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)M1.call(e,u)&&!L1.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:Wh,type:t.type,key:i,ref:s,props:r,_owner:o}};ge.createContext=function(t){return t={$$typeof:_V,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:yV,_context:t},t.Consumer=t};ge.createElement=$1;ge.createFactory=function(t){var e=$1.bind(null,t);return e.type=t,e};ge.createRef=function(){return{current:null}};ge.forwardRef=function(t){return{$$typeof:vV,render:t}};ge.isValidElement=fw;ge.lazy=function(t){return{$$typeof:TV,_payload:{_status:-1,_result:t},_init:PV}};ge.memo=function(t,e){return{$$typeof:EV,type:t,compare:e===void 0?null:e}};ge.startTransition=function(t){var e=rf.transition;rf.transition={};try{t()}finally{rf.transition=e}};ge.unstable_act=F1;ge.useCallback=function(t,e){return ln.current.useCallback(t,e)};ge.useContext=function(t){return ln.current.useContext(t)};ge.useDebugValue=function(){};ge.useDeferredValue=function(t){return ln.current.useDeferredValue(t)};ge.useEffect=function(t,e){return ln.current.useEffect(t,e)};ge.useId=function(){return ln.current.useId()};ge.useImperativeHandle=function(t,e,n){return ln.current.useImperativeHandle(t,e,n)};ge.useInsertionEffect=function(t,e){return ln.current.useInsertionEffect(t,e)};ge.useLayoutEffect=function(t,e){return ln.current.useLayoutEffect(t,e)};ge.useMemo=function(t,e){return ln.current.useMemo(t,e)};ge.useReducer=function(t,e,n){return ln.current.useReducer(t,e,n)};ge.useRef=function(t){return ln.current.useRef(t)};ge.useState=function(t){return ln.current.useState(t)};ge.useSyncExternalStore=function(t,e,n){return ln.current.useSyncExternalStore(t,e,n)};ge.useTransition=function(){return ln.current.useTransition()};ge.version="18.3.1";x1.exports=ge;var D=x1.exports;const le=dV(D),n_=hV({__proto__:null,default:le},[D]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CV=D,bV=Symbol.for("react.element"),kV=Symbol.for("react.fragment"),xV=Object.prototype.hasOwnProperty,NV=CV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,DV={key:!0,ref:!0,__self:!0,__source:!0};function j1(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)xV.call(e,r)&&!DV.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:bV,type:t,key:s,ref:o,props:i,_owner:NV.current}}Xp.Fragment=kV;Xp.jsx=j1;Xp.jsxs=j1;k1.exports=Xp;var T=k1.exports,r_={},U1={exports:{}},Fn={},B1={exports:{}},z1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,G){var B=U.length;U.push(G);e:for(;0<B;){var Z=B-1>>>1,oe=U[Z];if(0<i(oe,G))U[Z]=G,U[B]=oe,B=Z;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var G=U[0],B=U.pop();if(B!==G){U[0]=B;e:for(var Z=0,oe=U.length,H=oe>>>1;Z<H;){var He=2*(Z+1)-1,Ie=U[He],it=He+1,nt=U[it];if(0>i(Ie,B))it<oe&&0>i(nt,Ie)?(U[Z]=nt,U[it]=B,Z=it):(U[Z]=Ie,U[He]=B,Z=He);else if(it<oe&&0>i(nt,B))U[Z]=nt,U[it]=B,Z=it;else break e}}return G}function i(U,G){var B=U.sortIndex-G.sortIndex;return B!==0?B:U.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],h=[],f=1,p=null,g=3,I=!1,A=!1,C=!1,N=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(U){for(var G=n(h);G!==null;){if(G.callback===null)r(h);else if(G.startTime<=U)r(h),G.sortIndex=G.expirationTime,e(u,G);else break;G=n(h)}}function O(U){if(C=!1,x(U),!A)if(n(u)!==null)A=!0,jt(M);else{var G=n(h);G!==null&&Ue(O,G.startTime-U)}}function M(U,G){A=!1,C&&(C=!1,P(y),y=-1),I=!0;var B=g;try{for(x(G),p=n(u);p!==null&&(!(p.expirationTime>G)||U&&!S());){var Z=p.callback;if(typeof Z=="function"){p.callback=null,g=p.priorityLevel;var oe=Z(p.expirationTime<=G);G=t.unstable_now(),typeof oe=="function"?p.callback=oe:p===n(u)&&r(u),x(G)}else r(u);p=n(u)}if(p!==null)var H=!0;else{var He=n(h);He!==null&&Ue(O,He.startTime-G),H=!1}return H}finally{p=null,g=B,I=!1}}var $=!1,v=null,y=-1,_=5,E=-1;function S(){return!(t.unstable_now()-E<_)}function b(){if(v!==null){var U=t.unstable_now();E=U;var G=!0;try{G=v(!0,U)}finally{G?w():($=!1,v=null)}}else $=!1}var w;if(typeof R=="function")w=function(){R(b)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,Oe=Te.port2;Te.port1.onmessage=b,w=function(){Oe.postMessage(null)}}else w=function(){N(b,0)};function jt(U){v=U,$||($=!0,w())}function Ue(U,G){y=N(function(){U(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){A||I||(A=!0,jt(M))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(U){switch(g){case 1:case 2:case 3:var G=3;break;default:G=g}var B=g;g=G;try{return U()}finally{g=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,G){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var B=g;g=U;try{return G()}finally{g=B}},t.unstable_scheduleCallback=function(U,G,B){var Z=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?Z+B:Z):B=Z,U){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=B+oe,U={id:f++,callback:G,priorityLevel:U,startTime:B,expirationTime:oe,sortIndex:-1},B>Z?(U.sortIndex=B,e(h,U),n(u)===null&&U===n(h)&&(C?(P(y),y=-1):C=!0,Ue(O,B-Z))):(U.sortIndex=oe,e(u,U),A||I||(A=!0,jt(M))),U},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(U){var G=g;return function(){var B=g;g=G;try{return U.apply(this,arguments)}finally{g=B}}}})(z1);B1.exports=z1;var VV=B1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OV=D,$n=VV;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var q1=new Set,rh={};function la(t,e){cl(t,e),cl(t+"Capture",e)}function cl(t,e){for(rh[t]=e,t=0;t<e.length;t++)q1.add(e[t])}var ki=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),i_=Object.prototype.hasOwnProperty,MV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,XT={},JT={};function LV(t){return i_.call(JT,t)?!0:i_.call(XT,t)?!1:MV.test(t)?JT[t]=!0:(XT[t]=!0,!1)}function $V(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function FV(t,e,n,r){if(e===null||typeof e>"u"||$V(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ft[t]=new un(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ft[e]=new un(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ft[t]=new un(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ft[t]=new un(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ft[t]=new un(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ft[t]=new un(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ft[t]=new un(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ft[t]=new un(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ft[t]=new un(t,5,!1,t.toLowerCase(),null,!1,!1)});var pw=/[\-:]([a-z])/g;function mw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(pw,mw);Ft[e]=new un(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(pw,mw);Ft[e]=new un(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(pw,mw);Ft[e]=new un(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ft[t]=new un(t,1,!1,t.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ft[t]=new un(t,1,!1,t.toLowerCase(),null,!0,!0)});function gw(t,e,n,r){var i=Ft.hasOwnProperty(e)?Ft[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(FV(e,n,i,r)&&(n=null),r||i===null?LV(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Hi=OV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sd=Symbol.for("react.element"),Da=Symbol.for("react.portal"),Va=Symbol.for("react.fragment"),yw=Symbol.for("react.strict_mode"),s_=Symbol.for("react.profiler"),W1=Symbol.for("react.provider"),H1=Symbol.for("react.context"),_w=Symbol.for("react.forward_ref"),o_=Symbol.for("react.suspense"),a_=Symbol.for("react.suspense_list"),vw=Symbol.for("react.memo"),ns=Symbol.for("react.lazy"),K1=Symbol.for("react.offscreen"),ZT=Symbol.iterator;function Xu(t){return t===null||typeof t!="object"?null:(t=ZT&&t[ZT]||t["@@iterator"],typeof t=="function"?t:null)}var Ze=Object.assign,Qg;function cc(t){if(Qg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Qg=e&&e[1]||""}return`
`+Qg+t}var Yg=!1;function Xg(t,e){if(!t||Yg)return"";Yg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var u=`
`+i[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Yg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?cc(t):""}function jV(t){switch(t.tag){case 5:return cc(t.type);case 16:return cc("Lazy");case 13:return cc("Suspense");case 19:return cc("SuspenseList");case 0:case 2:case 15:return t=Xg(t.type,!1),t;case 11:return t=Xg(t.type.render,!1),t;case 1:return t=Xg(t.type,!0),t;default:return""}}function l_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Va:return"Fragment";case Da:return"Portal";case s_:return"Profiler";case yw:return"StrictMode";case o_:return"Suspense";case a_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case H1:return(t.displayName||"Context")+".Consumer";case W1:return(t._context.displayName||"Context")+".Provider";case _w:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case vw:return e=t.displayName||null,e!==null?e:l_(t.type)||"Memo";case ns:e=t._payload,t=t._init;try{return l_(t(e))}catch{}}return null}function UV(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return l_(e);case 8:return e===yw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ns(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function G1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function BV(t){var e=G1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Pd(t){t._valueTracker||(t._valueTracker=BV(t))}function Q1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=G1(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ff(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function u_(t,e){var n=e.checked;return Ze({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function e0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ns(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Y1(t,e){e=e.checked,e!=null&&gw(t,"checked",e,!1)}function c_(t,e){Y1(t,e);var n=Ns(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?h_(t,e.type,n):e.hasOwnProperty("defaultValue")&&h_(t,e.type,Ns(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function t0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function h_(t,e,n){(e!=="number"||Ff(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var hc=Array.isArray;function Qa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ns(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function d_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ze({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function n0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(hc(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ns(n)}}function X1(t,e){var n=Ns(e.value),r=Ns(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function r0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function J1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function f_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?J1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Rd,Z1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Rd=Rd||document.createElement("div"),Rd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Rd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ih(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var kc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zV=["Webkit","ms","Moz","O"];Object.keys(kc).forEach(function(t){zV.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),kc[e]=kc[t]})});function eP(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||kc.hasOwnProperty(t)&&kc[t]?(""+e).trim():e+"px"}function tP(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=eP(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var qV=Ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function p_(t,e){if(e){if(qV[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function m_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var g_=null;function ww(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var y_=null,Ya=null,Xa=null;function i0(t){if(t=Gh(t)){if(typeof y_!="function")throw Error(W(280));var e=t.stateNode;e&&(e=nm(e),y_(t.stateNode,t.type,e))}}function nP(t){Ya?Xa?Xa.push(t):Xa=[t]:Ya=t}function rP(){if(Ya){var t=Ya,e=Xa;if(Xa=Ya=null,i0(t),e)for(t=0;t<e.length;t++)i0(e[t])}}function iP(t,e){return t(e)}function sP(){}var Jg=!1;function oP(t,e,n){if(Jg)return t(e,n);Jg=!0;try{return iP(t,e,n)}finally{Jg=!1,(Ya!==null||Xa!==null)&&(sP(),rP())}}function sh(t,e){var n=t.stateNode;if(n===null)return null;var r=nm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var __=!1;if(ki)try{var Ju={};Object.defineProperty(Ju,"passive",{get:function(){__=!0}}),window.addEventListener("test",Ju,Ju),window.removeEventListener("test",Ju,Ju)}catch{__=!1}function WV(t,e,n,r,i,s,o,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(f){this.onError(f)}}var xc=!1,jf=null,Uf=!1,v_=null,HV={onError:function(t){xc=!0,jf=t}};function KV(t,e,n,r,i,s,o,l,u){xc=!1,jf=null,WV.apply(HV,arguments)}function GV(t,e,n,r,i,s,o,l,u){if(KV.apply(this,arguments),xc){if(xc){var h=jf;xc=!1,jf=null}else throw Error(W(198));Uf||(Uf=!0,v_=h)}}function ua(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function aP(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function s0(t){if(ua(t)!==t)throw Error(W(188))}function QV(t){var e=t.alternate;if(!e){if(e=ua(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return s0(i),t;if(s===r)return s0(i),e;s=s.sibling}throw Error(W(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function lP(t){return t=QV(t),t!==null?uP(t):null}function uP(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=uP(t);if(e!==null)return e;t=t.sibling}return null}var cP=$n.unstable_scheduleCallback,o0=$n.unstable_cancelCallback,YV=$n.unstable_shouldYield,XV=$n.unstable_requestPaint,at=$n.unstable_now,JV=$n.unstable_getCurrentPriorityLevel,Ew=$n.unstable_ImmediatePriority,hP=$n.unstable_UserBlockingPriority,Bf=$n.unstable_NormalPriority,ZV=$n.unstable_LowPriority,dP=$n.unstable_IdlePriority,Jp=null,Vr=null;function e2(t){if(Vr&&typeof Vr.onCommitFiberRoot=="function")try{Vr.onCommitFiberRoot(Jp,t,void 0,(t.current.flags&128)===128)}catch{}}var Er=Math.clz32?Math.clz32:r2,t2=Math.log,n2=Math.LN2;function r2(t){return t>>>=0,t===0?32:31-(t2(t)/n2|0)|0}var Cd=64,bd=4194304;function dc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function zf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=dc(l):(s&=o,s!==0&&(r=dc(s)))}else o=n&~i,o!==0?r=dc(o):s!==0&&(r=dc(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Er(e),i=1<<n,r|=t[n],e&=~i;return r}function i2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function s2(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Er(s),l=1<<o,u=i[o];u===-1?(!(l&n)||l&r)&&(i[o]=i2(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function w_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fP(){var t=Cd;return Cd<<=1,!(Cd&4194240)&&(Cd=64),t}function Zg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Hh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Er(e),t[e]=n}function o2(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Er(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Tw(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Er(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Le=0;function pP(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var mP,Iw,gP,yP,_P,E_=!1,kd=[],ys=null,_s=null,vs=null,oh=new Map,ah=new Map,is=[],a2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function a0(t,e){switch(t){case"focusin":case"focusout":ys=null;break;case"dragenter":case"dragleave":_s=null;break;case"mouseover":case"mouseout":vs=null;break;case"pointerover":case"pointerout":oh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ah.delete(e.pointerId)}}function Zu(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Gh(e),e!==null&&Iw(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function l2(t,e,n,r,i){switch(e){case"focusin":return ys=Zu(ys,t,e,n,r,i),!0;case"dragenter":return _s=Zu(_s,t,e,n,r,i),!0;case"mouseover":return vs=Zu(vs,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return oh.set(s,Zu(oh.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ah.set(s,Zu(ah.get(s)||null,t,e,n,r,i)),!0}return!1}function vP(t){var e=bo(t.target);if(e!==null){var n=ua(e);if(n!==null){if(e=n.tag,e===13){if(e=aP(n),e!==null){t.blockedOn=e,_P(t.priority,function(){gP(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function sf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=T_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);g_=r,n.target.dispatchEvent(r),g_=null}else return e=Gh(n),e!==null&&Iw(e),t.blockedOn=n,!1;e.shift()}return!0}function l0(t,e,n){sf(t)&&n.delete(e)}function u2(){E_=!1,ys!==null&&sf(ys)&&(ys=null),_s!==null&&sf(_s)&&(_s=null),vs!==null&&sf(vs)&&(vs=null),oh.forEach(l0),ah.forEach(l0)}function ec(t,e){t.blockedOn===e&&(t.blockedOn=null,E_||(E_=!0,$n.unstable_scheduleCallback($n.unstable_NormalPriority,u2)))}function lh(t){function e(i){return ec(i,t)}if(0<kd.length){ec(kd[0],t);for(var n=1;n<kd.length;n++){var r=kd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ys!==null&&ec(ys,t),_s!==null&&ec(_s,t),vs!==null&&ec(vs,t),oh.forEach(e),ah.forEach(e),n=0;n<is.length;n++)r=is[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<is.length&&(n=is[0],n.blockedOn===null);)vP(n),n.blockedOn===null&&is.shift()}var Ja=Hi.ReactCurrentBatchConfig,qf=!0;function c2(t,e,n,r){var i=Le,s=Ja.transition;Ja.transition=null;try{Le=1,Aw(t,e,n,r)}finally{Le=i,Ja.transition=s}}function h2(t,e,n,r){var i=Le,s=Ja.transition;Ja.transition=null;try{Le=4,Aw(t,e,n,r)}finally{Le=i,Ja.transition=s}}function Aw(t,e,n,r){if(qf){var i=T_(t,e,n,r);if(i===null)uy(t,e,r,Wf,n),a0(t,r);else if(l2(i,t,e,n,r))r.stopPropagation();else if(a0(t,r),e&4&&-1<a2.indexOf(t)){for(;i!==null;){var s=Gh(i);if(s!==null&&mP(s),s=T_(t,e,n,r),s===null&&uy(t,e,r,Wf,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else uy(t,e,r,null,n)}}var Wf=null;function T_(t,e,n,r){if(Wf=null,t=ww(r),t=bo(t),t!==null)if(e=ua(t),e===null)t=null;else if(n=e.tag,n===13){if(t=aP(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Wf=t,null}function wP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(JV()){case Ew:return 1;case hP:return 4;case Bf:case ZV:return 16;case dP:return 536870912;default:return 16}default:return 16}}var hs=null,Sw=null,of=null;function EP(){if(of)return of;var t,e=Sw,n=e.length,r,i="value"in hs?hs.value:hs.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return of=i.slice(t,1<r?1-r:void 0)}function af(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function xd(){return!0}function u0(){return!1}function jn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?xd:u0,this.isPropagationStopped=u0,this}return Ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=xd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=xd)},persist:function(){},isPersistent:xd}),e}var Dl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pw=jn(Dl),Kh=Ze({},Dl,{view:0,detail:0}),d2=jn(Kh),ey,ty,tc,Zp=Ze({},Kh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==tc&&(tc&&t.type==="mousemove"?(ey=t.screenX-tc.screenX,ty=t.screenY-tc.screenY):ty=ey=0,tc=t),ey)},movementY:function(t){return"movementY"in t?t.movementY:ty}}),c0=jn(Zp),f2=Ze({},Zp,{dataTransfer:0}),p2=jn(f2),m2=Ze({},Kh,{relatedTarget:0}),ny=jn(m2),g2=Ze({},Dl,{animationName:0,elapsedTime:0,pseudoElement:0}),y2=jn(g2),_2=Ze({},Dl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),v2=jn(_2),w2=Ze({},Dl,{data:0}),h0=jn(w2),E2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},T2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},I2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function A2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=I2[t])?!!e[t]:!1}function Rw(){return A2}var S2=Ze({},Kh,{key:function(t){if(t.key){var e=E2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=af(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?T2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rw,charCode:function(t){return t.type==="keypress"?af(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?af(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),P2=jn(S2),R2=Ze({},Zp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),d0=jn(R2),C2=Ze({},Kh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rw}),b2=jn(C2),k2=Ze({},Dl,{propertyName:0,elapsedTime:0,pseudoElement:0}),x2=jn(k2),N2=Ze({},Zp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),D2=jn(N2),V2=[9,13,27,32],Cw=ki&&"CompositionEvent"in window,Nc=null;ki&&"documentMode"in document&&(Nc=document.documentMode);var O2=ki&&"TextEvent"in window&&!Nc,TP=ki&&(!Cw||Nc&&8<Nc&&11>=Nc),f0=" ",p0=!1;function IP(t,e){switch(t){case"keyup":return V2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function AP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Oa=!1;function M2(t,e){switch(t){case"compositionend":return AP(e);case"keypress":return e.which!==32?null:(p0=!0,f0);case"textInput":return t=e.data,t===f0&&p0?null:t;default:return null}}function L2(t,e){if(Oa)return t==="compositionend"||!Cw&&IP(t,e)?(t=EP(),of=Sw=hs=null,Oa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return TP&&e.locale!=="ko"?null:e.data;default:return null}}var $2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function m0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!$2[t.type]:e==="textarea"}function SP(t,e,n,r){nP(r),e=Hf(e,"onChange"),0<e.length&&(n=new Pw("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Dc=null,uh=null;function F2(t){MP(t,0)}function em(t){var e=$a(t);if(Q1(e))return t}function j2(t,e){if(t==="change")return e}var PP=!1;if(ki){var ry;if(ki){var iy="oninput"in document;if(!iy){var g0=document.createElement("div");g0.setAttribute("oninput","return;"),iy=typeof g0.oninput=="function"}ry=iy}else ry=!1;PP=ry&&(!document.documentMode||9<document.documentMode)}function y0(){Dc&&(Dc.detachEvent("onpropertychange",RP),uh=Dc=null)}function RP(t){if(t.propertyName==="value"&&em(uh)){var e=[];SP(e,uh,t,ww(t)),oP(F2,e)}}function U2(t,e,n){t==="focusin"?(y0(),Dc=e,uh=n,Dc.attachEvent("onpropertychange",RP)):t==="focusout"&&y0()}function B2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return em(uh)}function z2(t,e){if(t==="click")return em(e)}function q2(t,e){if(t==="input"||t==="change")return em(e)}function W2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ar=typeof Object.is=="function"?Object.is:W2;function ch(t,e){if(Ar(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!i_.call(e,i)||!Ar(t[i],e[i]))return!1}return!0}function _0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function v0(t,e){var n=_0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_0(n)}}function CP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?CP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function bP(){for(var t=window,e=Ff();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ff(t.document)}return e}function bw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function H2(t){var e=bP(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&CP(n.ownerDocument.documentElement,n)){if(r!==null&&bw(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=v0(n,s);var o=v0(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var K2=ki&&"documentMode"in document&&11>=document.documentMode,Ma=null,I_=null,Vc=null,A_=!1;function w0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;A_||Ma==null||Ma!==Ff(r)||(r=Ma,"selectionStart"in r&&bw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vc&&ch(Vc,r)||(Vc=r,r=Hf(I_,"onSelect"),0<r.length&&(e=new Pw("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ma)))}function Nd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var La={animationend:Nd("Animation","AnimationEnd"),animationiteration:Nd("Animation","AnimationIteration"),animationstart:Nd("Animation","AnimationStart"),transitionend:Nd("Transition","TransitionEnd")},sy={},kP={};ki&&(kP=document.createElement("div").style,"AnimationEvent"in window||(delete La.animationend.animation,delete La.animationiteration.animation,delete La.animationstart.animation),"TransitionEvent"in window||delete La.transitionend.transition);function tm(t){if(sy[t])return sy[t];if(!La[t])return t;var e=La[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in kP)return sy[t]=e[n];return t}var xP=tm("animationend"),NP=tm("animationiteration"),DP=tm("animationstart"),VP=tm("transitionend"),OP=new Map,E0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ws(t,e){OP.set(t,e),la(e,[t])}for(var oy=0;oy<E0.length;oy++){var ay=E0[oy],G2=ay.toLowerCase(),Q2=ay[0].toUpperCase()+ay.slice(1);Ws(G2,"on"+Q2)}Ws(xP,"onAnimationEnd");Ws(NP,"onAnimationIteration");Ws(DP,"onAnimationStart");Ws("dblclick","onDoubleClick");Ws("focusin","onFocus");Ws("focusout","onBlur");Ws(VP,"onTransitionEnd");cl("onMouseEnter",["mouseout","mouseover"]);cl("onMouseLeave",["mouseout","mouseover"]);cl("onPointerEnter",["pointerout","pointerover"]);cl("onPointerLeave",["pointerout","pointerover"]);la("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));la("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));la("onBeforeInput",["compositionend","keypress","textInput","paste"]);la("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));la("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));la("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y2=new Set("cancel close invalid load scroll toggle".split(" ").concat(fc));function T0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,GV(r,e,void 0,t),t.currentTarget=null}function MP(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==s&&i.isPropagationStopped())break e;T0(i,l,h),s=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,h=l.currentTarget,l=l.listener,u!==s&&i.isPropagationStopped())break e;T0(i,l,h),s=u}}}if(Uf)throw t=v_,Uf=!1,v_=null,t}function ze(t,e){var n=e[b_];n===void 0&&(n=e[b_]=new Set);var r=t+"__bubble";n.has(r)||(LP(e,t,2,!1),n.add(r))}function ly(t,e,n){var r=0;e&&(r|=4),LP(n,t,r,e)}var Dd="_reactListening"+Math.random().toString(36).slice(2);function hh(t){if(!t[Dd]){t[Dd]=!0,q1.forEach(function(n){n!=="selectionchange"&&(Y2.has(n)||ly(n,!1,t),ly(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Dd]||(e[Dd]=!0,ly("selectionchange",!1,e))}}function LP(t,e,n,r){switch(wP(e)){case 1:var i=c2;break;case 4:i=h2;break;default:i=Aw}n=i.bind(null,e,n,t),i=void 0,!__||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function uy(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;l!==null;){if(o=bo(l),o===null)return;if(u=o.tag,u===5||u===6){r=s=o;continue e}l=l.parentNode}}r=r.return}oP(function(){var h=s,f=ww(n),p=[];e:{var g=OP.get(t);if(g!==void 0){var I=Pw,A=t;switch(t){case"keypress":if(af(n)===0)break e;case"keydown":case"keyup":I=P2;break;case"focusin":A="focus",I=ny;break;case"focusout":A="blur",I=ny;break;case"beforeblur":case"afterblur":I=ny;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=c0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=p2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=b2;break;case xP:case NP:case DP:I=y2;break;case VP:I=x2;break;case"scroll":I=d2;break;case"wheel":I=D2;break;case"copy":case"cut":case"paste":I=v2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=d0}var C=(e&4)!==0,N=!C&&t==="scroll",P=C?g!==null?g+"Capture":null:g;C=[];for(var R=h,x;R!==null;){x=R;var O=x.stateNode;if(x.tag===5&&O!==null&&(x=O,P!==null&&(O=sh(R,P),O!=null&&C.push(dh(R,O,x)))),N)break;R=R.return}0<C.length&&(g=new I(g,A,null,n,f),p.push({event:g,listeners:C}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",g&&n!==g_&&(A=n.relatedTarget||n.fromElement)&&(bo(A)||A[xi]))break e;if((I||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,I?(A=n.relatedTarget||n.toElement,I=h,A=A?bo(A):null,A!==null&&(N=ua(A),A!==N||A.tag!==5&&A.tag!==6)&&(A=null)):(I=null,A=h),I!==A)){if(C=c0,O="onMouseLeave",P="onMouseEnter",R="mouse",(t==="pointerout"||t==="pointerover")&&(C=d0,O="onPointerLeave",P="onPointerEnter",R="pointer"),N=I==null?g:$a(I),x=A==null?g:$a(A),g=new C(O,R+"leave",I,n,f),g.target=N,g.relatedTarget=x,O=null,bo(f)===h&&(C=new C(P,R+"enter",A,n,f),C.target=x,C.relatedTarget=N,O=C),N=O,I&&A)t:{for(C=I,P=A,R=0,x=C;x;x=wa(x))R++;for(x=0,O=P;O;O=wa(O))x++;for(;0<R-x;)C=wa(C),R--;for(;0<x-R;)P=wa(P),x--;for(;R--;){if(C===P||P!==null&&C===P.alternate)break t;C=wa(C),P=wa(P)}C=null}else C=null;I!==null&&I0(p,g,I,C,!1),A!==null&&N!==null&&I0(p,N,A,C,!0)}}e:{if(g=h?$a(h):window,I=g.nodeName&&g.nodeName.toLowerCase(),I==="select"||I==="input"&&g.type==="file")var M=j2;else if(m0(g))if(PP)M=q2;else{M=B2;var $=U2}else(I=g.nodeName)&&I.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(M=z2);if(M&&(M=M(t,h))){SP(p,M,n,f);break e}$&&$(t,g,h),t==="focusout"&&($=g._wrapperState)&&$.controlled&&g.type==="number"&&h_(g,"number",g.value)}switch($=h?$a(h):window,t){case"focusin":(m0($)||$.contentEditable==="true")&&(Ma=$,I_=h,Vc=null);break;case"focusout":Vc=I_=Ma=null;break;case"mousedown":A_=!0;break;case"contextmenu":case"mouseup":case"dragend":A_=!1,w0(p,n,f);break;case"selectionchange":if(K2)break;case"keydown":case"keyup":w0(p,n,f)}var v;if(Cw)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Oa?IP(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(TP&&n.locale!=="ko"&&(Oa||y!=="onCompositionStart"?y==="onCompositionEnd"&&Oa&&(v=EP()):(hs=f,Sw="value"in hs?hs.value:hs.textContent,Oa=!0)),$=Hf(h,y),0<$.length&&(y=new h0(y,t,null,n,f),p.push({event:y,listeners:$}),v?y.data=v:(v=AP(n),v!==null&&(y.data=v)))),(v=O2?M2(t,n):L2(t,n))&&(h=Hf(h,"onBeforeInput"),0<h.length&&(f=new h0("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:h}),f.data=v))}MP(p,e)})}function dh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hf(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=sh(t,n),s!=null&&r.unshift(dh(t,s,i)),s=sh(t,e),s!=null&&r.push(dh(t,s,i))),t=t.return}return r}function wa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function I0(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,i?(u=sh(n,s),u!=null&&o.unshift(dh(n,u,l))):i||(u=sh(n,s),u!=null&&o.push(dh(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var X2=/\r\n?/g,J2=/\u0000|\uFFFD/g;function A0(t){return(typeof t=="string"?t:""+t).replace(X2,`
`).replace(J2,"")}function Vd(t,e,n){if(e=A0(e),A0(t)!==e&&n)throw Error(W(425))}function Kf(){}var S_=null,P_=null;function R_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var C_=typeof setTimeout=="function"?setTimeout:void 0,Z2=typeof clearTimeout=="function"?clearTimeout:void 0,S0=typeof Promise=="function"?Promise:void 0,eO=typeof queueMicrotask=="function"?queueMicrotask:typeof S0<"u"?function(t){return S0.resolve(null).then(t).catch(tO)}:C_;function tO(t){setTimeout(function(){throw t})}function cy(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),lh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);lh(e)}function ws(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function P0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Vl=Math.random().toString(36).slice(2),Nr="__reactFiber$"+Vl,fh="__reactProps$"+Vl,xi="__reactContainer$"+Vl,b_="__reactEvents$"+Vl,nO="__reactListeners$"+Vl,rO="__reactHandles$"+Vl;function bo(t){var e=t[Nr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[xi]||n[Nr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=P0(t);t!==null;){if(n=t[Nr])return n;t=P0(t)}return e}t=n,n=t.parentNode}return null}function Gh(t){return t=t[Nr]||t[xi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $a(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function nm(t){return t[fh]||null}var k_=[],Fa=-1;function Hs(t){return{current:t}}function We(t){0>Fa||(t.current=k_[Fa],k_[Fa]=null,Fa--)}function Be(t,e){Fa++,k_[Fa]=t.current,t.current=e}var Ds={},Yt=Hs(Ds),_n=Hs(!1),Wo=Ds;function hl(t,e){var n=t.type.contextTypes;if(!n)return Ds;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function vn(t){return t=t.childContextTypes,t!=null}function Gf(){We(_n),We(Yt)}function R0(t,e,n){if(Yt.current!==Ds)throw Error(W(168));Be(Yt,e),Be(_n,n)}function $P(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(W(108,UV(t)||"Unknown",i));return Ze({},n,r)}function Qf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ds,Wo=Yt.current,Be(Yt,t),Be(_n,_n.current),!0}function C0(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=$P(t,e,Wo),r.__reactInternalMemoizedMergedChildContext=t,We(_n),We(Yt),Be(Yt,t)):We(_n),Be(_n,n)}var pi=null,rm=!1,hy=!1;function FP(t){pi===null?pi=[t]:pi.push(t)}function iO(t){rm=!0,FP(t)}function Ks(){if(!hy&&pi!==null){hy=!0;var t=0,e=Le;try{var n=pi;for(Le=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}pi=null,rm=!1}catch(i){throw pi!==null&&(pi=pi.slice(t+1)),cP(Ew,Ks),i}finally{Le=e,hy=!1}}return null}var ja=[],Ua=0,Yf=null,Xf=0,Bn=[],zn=0,Ho=null,gi=1,yi="";function Eo(t,e){ja[Ua++]=Xf,ja[Ua++]=Yf,Yf=t,Xf=e}function jP(t,e,n){Bn[zn++]=gi,Bn[zn++]=yi,Bn[zn++]=Ho,Ho=t;var r=gi;t=yi;var i=32-Er(r)-1;r&=~(1<<i),n+=1;var s=32-Er(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,gi=1<<32-Er(e)+i|n<<i|r,yi=s+t}else gi=1<<s|n<<i|r,yi=t}function kw(t){t.return!==null&&(Eo(t,1),jP(t,1,0))}function xw(t){for(;t===Yf;)Yf=ja[--Ua],ja[Ua]=null,Xf=ja[--Ua],ja[Ua]=null;for(;t===Ho;)Ho=Bn[--zn],Bn[zn]=null,yi=Bn[--zn],Bn[zn]=null,gi=Bn[--zn],Bn[zn]=null}var On=null,Vn=null,Ke=!1,yr=null;function UP(t,e){var n=Hn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function b0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,On=t,Vn=ws(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,On=t,Vn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ho!==null?{id:gi,overflow:yi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Hn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,On=t,Vn=null,!0):!1;default:return!1}}function x_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function N_(t){if(Ke){var e=Vn;if(e){var n=e;if(!b0(t,e)){if(x_(t))throw Error(W(418));e=ws(n.nextSibling);var r=On;e&&b0(t,e)?UP(r,n):(t.flags=t.flags&-4097|2,Ke=!1,On=t)}}else{if(x_(t))throw Error(W(418));t.flags=t.flags&-4097|2,Ke=!1,On=t}}}function k0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;On=t}function Od(t){if(t!==On)return!1;if(!Ke)return k0(t),Ke=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!R_(t.type,t.memoizedProps)),e&&(e=Vn)){if(x_(t))throw BP(),Error(W(418));for(;e;)UP(t,e),e=ws(e.nextSibling)}if(k0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Vn=ws(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Vn=null}}else Vn=On?ws(t.stateNode.nextSibling):null;return!0}function BP(){for(var t=Vn;t;)t=ws(t.nextSibling)}function dl(){Vn=On=null,Ke=!1}function Nw(t){yr===null?yr=[t]:yr.push(t)}var sO=Hi.ReactCurrentBatchConfig;function nc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function Md(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function x0(t){var e=t._init;return e(t._payload)}function zP(t){function e(P,R){if(t){var x=P.deletions;x===null?(P.deletions=[R],P.flags|=16):x.push(R)}}function n(P,R){if(!t)return null;for(;R!==null;)e(P,R),R=R.sibling;return null}function r(P,R){for(P=new Map;R!==null;)R.key!==null?P.set(R.key,R):P.set(R.index,R),R=R.sibling;return P}function i(P,R){return P=As(P,R),P.index=0,P.sibling=null,P}function s(P,R,x){return P.index=x,t?(x=P.alternate,x!==null?(x=x.index,x<R?(P.flags|=2,R):x):(P.flags|=2,R)):(P.flags|=1048576,R)}function o(P){return t&&P.alternate===null&&(P.flags|=2),P}function l(P,R,x,O){return R===null||R.tag!==6?(R=_y(x,P.mode,O),R.return=P,R):(R=i(R,x),R.return=P,R)}function u(P,R,x,O){var M=x.type;return M===Va?f(P,R,x.props.children,O,x.key):R!==null&&(R.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===ns&&x0(M)===R.type)?(O=i(R,x.props),O.ref=nc(P,R,x),O.return=P,O):(O=pf(x.type,x.key,x.props,null,P.mode,O),O.ref=nc(P,R,x),O.return=P,O)}function h(P,R,x,O){return R===null||R.tag!==4||R.stateNode.containerInfo!==x.containerInfo||R.stateNode.implementation!==x.implementation?(R=vy(x,P.mode,O),R.return=P,R):(R=i(R,x.children||[]),R.return=P,R)}function f(P,R,x,O,M){return R===null||R.tag!==7?(R=jo(x,P.mode,O,M),R.return=P,R):(R=i(R,x),R.return=P,R)}function p(P,R,x){if(typeof R=="string"&&R!==""||typeof R=="number")return R=_y(""+R,P.mode,x),R.return=P,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Sd:return x=pf(R.type,R.key,R.props,null,P.mode,x),x.ref=nc(P,null,R),x.return=P,x;case Da:return R=vy(R,P.mode,x),R.return=P,R;case ns:var O=R._init;return p(P,O(R._payload),x)}if(hc(R)||Xu(R))return R=jo(R,P.mode,x,null),R.return=P,R;Md(P,R)}return null}function g(P,R,x,O){var M=R!==null?R.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return M!==null?null:l(P,R,""+x,O);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Sd:return x.key===M?u(P,R,x,O):null;case Da:return x.key===M?h(P,R,x,O):null;case ns:return M=x._init,g(P,R,M(x._payload),O)}if(hc(x)||Xu(x))return M!==null?null:f(P,R,x,O,null);Md(P,x)}return null}function I(P,R,x,O,M){if(typeof O=="string"&&O!==""||typeof O=="number")return P=P.get(x)||null,l(R,P,""+O,M);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Sd:return P=P.get(O.key===null?x:O.key)||null,u(R,P,O,M);case Da:return P=P.get(O.key===null?x:O.key)||null,h(R,P,O,M);case ns:var $=O._init;return I(P,R,x,$(O._payload),M)}if(hc(O)||Xu(O))return P=P.get(x)||null,f(R,P,O,M,null);Md(R,O)}return null}function A(P,R,x,O){for(var M=null,$=null,v=R,y=R=0,_=null;v!==null&&y<x.length;y++){v.index>y?(_=v,v=null):_=v.sibling;var E=g(P,v,x[y],O);if(E===null){v===null&&(v=_);break}t&&v&&E.alternate===null&&e(P,v),R=s(E,R,y),$===null?M=E:$.sibling=E,$=E,v=_}if(y===x.length)return n(P,v),Ke&&Eo(P,y),M;if(v===null){for(;y<x.length;y++)v=p(P,x[y],O),v!==null&&(R=s(v,R,y),$===null?M=v:$.sibling=v,$=v);return Ke&&Eo(P,y),M}for(v=r(P,v);y<x.length;y++)_=I(v,P,y,x[y],O),_!==null&&(t&&_.alternate!==null&&v.delete(_.key===null?y:_.key),R=s(_,R,y),$===null?M=_:$.sibling=_,$=_);return t&&v.forEach(function(S){return e(P,S)}),Ke&&Eo(P,y),M}function C(P,R,x,O){var M=Xu(x);if(typeof M!="function")throw Error(W(150));if(x=M.call(x),x==null)throw Error(W(151));for(var $=M=null,v=R,y=R=0,_=null,E=x.next();v!==null&&!E.done;y++,E=x.next()){v.index>y?(_=v,v=null):_=v.sibling;var S=g(P,v,E.value,O);if(S===null){v===null&&(v=_);break}t&&v&&S.alternate===null&&e(P,v),R=s(S,R,y),$===null?M=S:$.sibling=S,$=S,v=_}if(E.done)return n(P,v),Ke&&Eo(P,y),M;if(v===null){for(;!E.done;y++,E=x.next())E=p(P,E.value,O),E!==null&&(R=s(E,R,y),$===null?M=E:$.sibling=E,$=E);return Ke&&Eo(P,y),M}for(v=r(P,v);!E.done;y++,E=x.next())E=I(v,P,y,E.value,O),E!==null&&(t&&E.alternate!==null&&v.delete(E.key===null?y:E.key),R=s(E,R,y),$===null?M=E:$.sibling=E,$=E);return t&&v.forEach(function(b){return e(P,b)}),Ke&&Eo(P,y),M}function N(P,R,x,O){if(typeof x=="object"&&x!==null&&x.type===Va&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Sd:e:{for(var M=x.key,$=R;$!==null;){if($.key===M){if(M=x.type,M===Va){if($.tag===7){n(P,$.sibling),R=i($,x.props.children),R.return=P,P=R;break e}}else if($.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===ns&&x0(M)===$.type){n(P,$.sibling),R=i($,x.props),R.ref=nc(P,$,x),R.return=P,P=R;break e}n(P,$);break}else e(P,$);$=$.sibling}x.type===Va?(R=jo(x.props.children,P.mode,O,x.key),R.return=P,P=R):(O=pf(x.type,x.key,x.props,null,P.mode,O),O.ref=nc(P,R,x),O.return=P,P=O)}return o(P);case Da:e:{for($=x.key;R!==null;){if(R.key===$)if(R.tag===4&&R.stateNode.containerInfo===x.containerInfo&&R.stateNode.implementation===x.implementation){n(P,R.sibling),R=i(R,x.children||[]),R.return=P,P=R;break e}else{n(P,R);break}else e(P,R);R=R.sibling}R=vy(x,P.mode,O),R.return=P,P=R}return o(P);case ns:return $=x._init,N(P,R,$(x._payload),O)}if(hc(x))return A(P,R,x,O);if(Xu(x))return C(P,R,x,O);Md(P,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,R!==null&&R.tag===6?(n(P,R.sibling),R=i(R,x),R.return=P,P=R):(n(P,R),R=_y(x,P.mode,O),R.return=P,P=R),o(P)):n(P,R)}return N}var fl=zP(!0),qP=zP(!1),Jf=Hs(null),Zf=null,Ba=null,Dw=null;function Vw(){Dw=Ba=Zf=null}function Ow(t){var e=Jf.current;We(Jf),t._currentValue=e}function D_(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Za(t,e){Zf=t,Dw=Ba=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yn=!0),t.firstContext=null)}function Qn(t){var e=t._currentValue;if(Dw!==t)if(t={context:t,memoizedValue:e,next:null},Ba===null){if(Zf===null)throw Error(W(308));Ba=t,Zf.dependencies={lanes:0,firstContext:t}}else Ba=Ba.next=t;return e}var ko=null;function Mw(t){ko===null?ko=[t]:ko.push(t)}function WP(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Mw(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ni(t,r)}function Ni(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var rs=!1;function Lw(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HP(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ii(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Es(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,xe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ni(t,n)}return i=r.interleaved,i===null?(e.next=e,Mw(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ni(t,n)}function lf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tw(t,n)}}function N0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ep(t,e,n,r){var i=t.updateQueue;rs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,h=u.next;u.next=null,o===null?s=h:o.next=h,o=u;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=h:l.next=h,f.lastBaseUpdate=u))}if(s!==null){var p=i.baseState;o=0,f=h=u=null,l=s;do{var g=l.lane,I=l.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:I,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var A=t,C=l;switch(g=e,I=n,C.tag){case 1:if(A=C.payload,typeof A=="function"){p=A.call(I,p,g);break e}p=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=C.payload,g=typeof A=="function"?A.call(I,p,g):A,g==null)break e;p=Ze({},p,g);break e;case 2:rs=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[l]:g.push(l))}else I={eventTime:I,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(h=f=I,u=p):f=f.next=I,o|=g;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;g=l,l=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(u=p),i.baseState=u,i.firstBaseUpdate=h,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Go|=o,t.lanes=o,t.memoizedState=p}}function D0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(W(191,i));i.call(r)}}}var Qh={},Or=Hs(Qh),ph=Hs(Qh),mh=Hs(Qh);function xo(t){if(t===Qh)throw Error(W(174));return t}function $w(t,e){switch(Be(mh,e),Be(ph,t),Be(Or,Qh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:f_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=f_(e,t)}We(Or),Be(Or,e)}function pl(){We(Or),We(ph),We(mh)}function KP(t){xo(mh.current);var e=xo(Or.current),n=f_(e,t.type);e!==n&&(Be(ph,t),Be(Or,n))}function Fw(t){ph.current===t&&(We(Or),We(ph))}var Ye=Hs(0);function tp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dy=[];function jw(){for(var t=0;t<dy.length;t++)dy[t]._workInProgressVersionPrimary=null;dy.length=0}var uf=Hi.ReactCurrentDispatcher,fy=Hi.ReactCurrentBatchConfig,Ko=0,Xe=null,_t=null,It=null,np=!1,Oc=!1,gh=0,oO=0;function Ut(){throw Error(W(321))}function Uw(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ar(t[n],e[n]))return!1;return!0}function Bw(t,e,n,r,i,s){if(Ko=s,Xe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,uf.current=t===null||t.memoizedState===null?cO:hO,t=n(r,i),Oc){s=0;do{if(Oc=!1,gh=0,25<=s)throw Error(W(301));s+=1,It=_t=null,e.updateQueue=null,uf.current=dO,t=n(r,i)}while(Oc)}if(uf.current=rp,e=_t!==null&&_t.next!==null,Ko=0,It=_t=Xe=null,np=!1,e)throw Error(W(300));return t}function zw(){var t=gh!==0;return gh=0,t}function xr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?Xe.memoizedState=It=t:It=It.next=t,It}function Yn(){if(_t===null){var t=Xe.alternate;t=t!==null?t.memoizedState:null}else t=_t.next;var e=It===null?Xe.memoizedState:It.next;if(e!==null)It=e,_t=t;else{if(t===null)throw Error(W(310));_t=t,t={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},It===null?Xe.memoizedState=It=t:It=It.next=t}return It}function yh(t,e){return typeof e=="function"?e(t):e}function py(t){var e=Yn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=_t,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,u=null,h=s;do{var f=h.lane;if((Ko&f)===f)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var p={lane:f,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=p,o=r):u=u.next=p,Xe.lanes|=f,Go|=f}h=h.next}while(h!==null&&h!==s);u===null?o=r:u.next=l,Ar(r,e.memoizedState)||(yn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Xe.lanes|=s,Go|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function my(t){var e=Yn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ar(s,e.memoizedState)||(yn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function GP(){}function QP(t,e){var n=Xe,r=Yn(),i=e(),s=!Ar(r.memoizedState,i);if(s&&(r.memoizedState=i,yn=!0),r=r.queue,qw(JP.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||It!==null&&It.memoizedState.tag&1){if(n.flags|=2048,_h(9,XP.bind(null,n,r,i,e),void 0,null),Pt===null)throw Error(W(349));Ko&30||YP(n,e,i)}return i}function YP(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Xe.updateQueue,e===null?(e={lastEffect:null,stores:null},Xe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function XP(t,e,n,r){e.value=n,e.getSnapshot=r,ZP(e)&&eR(t)}function JP(t,e,n){return n(function(){ZP(e)&&eR(t)})}function ZP(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ar(t,n)}catch{return!0}}function eR(t){var e=Ni(t,1);e!==null&&Tr(e,t,1,-1)}function V0(t){var e=xr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yh,lastRenderedState:t},e.queue=t,t=t.dispatch=uO.bind(null,Xe,t),[e.memoizedState,t]}function _h(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Xe.updateQueue,e===null?(e={lastEffect:null,stores:null},Xe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function tR(){return Yn().memoizedState}function cf(t,e,n,r){var i=xr();Xe.flags|=t,i.memoizedState=_h(1|e,n,void 0,r===void 0?null:r)}function im(t,e,n,r){var i=Yn();r=r===void 0?null:r;var s=void 0;if(_t!==null){var o=_t.memoizedState;if(s=o.destroy,r!==null&&Uw(r,o.deps)){i.memoizedState=_h(e,n,s,r);return}}Xe.flags|=t,i.memoizedState=_h(1|e,n,s,r)}function O0(t,e){return cf(8390656,8,t,e)}function qw(t,e){return im(2048,8,t,e)}function nR(t,e){return im(4,2,t,e)}function rR(t,e){return im(4,4,t,e)}function iR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sR(t,e,n){return n=n!=null?n.concat([t]):null,im(4,4,iR.bind(null,e,t),n)}function Ww(){}function oR(t,e){var n=Yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uw(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function aR(t,e){var n=Yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uw(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function lR(t,e,n){return Ko&21?(Ar(n,e)||(n=fP(),Xe.lanes|=n,Go|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yn=!0),t.memoizedState=n)}function aO(t,e){var n=Le;Le=n!==0&&4>n?n:4,t(!0);var r=fy.transition;fy.transition={};try{t(!1),e()}finally{Le=n,fy.transition=r}}function uR(){return Yn().memoizedState}function lO(t,e,n){var r=Is(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},cR(t))hR(e,n);else if(n=WP(t,e,n,r),n!==null){var i=on();Tr(n,t,r,i),dR(n,e,r)}}function uO(t,e,n){var r=Is(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(cR(t))hR(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,Ar(l,o)){var u=e.interleaved;u===null?(i.next=i,Mw(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=WP(t,e,i,r),n!==null&&(i=on(),Tr(n,t,r,i),dR(n,e,r))}}function cR(t){var e=t.alternate;return t===Xe||e!==null&&e===Xe}function hR(t,e){Oc=np=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function dR(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tw(t,n)}}var rp={readContext:Qn,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},cO={readContext:Qn,useCallback:function(t,e){return xr().memoizedState=[t,e===void 0?null:e],t},useContext:Qn,useEffect:O0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,cf(4194308,4,iR.bind(null,e,t),n)},useLayoutEffect:function(t,e){return cf(4194308,4,t,e)},useInsertionEffect:function(t,e){return cf(4,2,t,e)},useMemo:function(t,e){var n=xr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=xr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=lO.bind(null,Xe,t),[r.memoizedState,t]},useRef:function(t){var e=xr();return t={current:t},e.memoizedState=t},useState:V0,useDebugValue:Ww,useDeferredValue:function(t){return xr().memoizedState=t},useTransition:function(){var t=V0(!1),e=t[0];return t=aO.bind(null,t[1]),xr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Xe,i=xr();if(Ke){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),Pt===null)throw Error(W(349));Ko&30||YP(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,O0(JP.bind(null,r,s,t),[t]),r.flags|=2048,_h(9,XP.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=xr(),e=Pt.identifierPrefix;if(Ke){var n=yi,r=gi;n=(r&~(1<<32-Er(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=gh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=oO++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},hO={readContext:Qn,useCallback:oR,useContext:Qn,useEffect:qw,useImperativeHandle:sR,useInsertionEffect:nR,useLayoutEffect:rR,useMemo:aR,useReducer:py,useRef:tR,useState:function(){return py(yh)},useDebugValue:Ww,useDeferredValue:function(t){var e=Yn();return lR(e,_t.memoizedState,t)},useTransition:function(){var t=py(yh)[0],e=Yn().memoizedState;return[t,e]},useMutableSource:GP,useSyncExternalStore:QP,useId:uR,unstable_isNewReconciler:!1},dO={readContext:Qn,useCallback:oR,useContext:Qn,useEffect:qw,useImperativeHandle:sR,useInsertionEffect:nR,useLayoutEffect:rR,useMemo:aR,useReducer:my,useRef:tR,useState:function(){return my(yh)},useDebugValue:Ww,useDeferredValue:function(t){var e=Yn();return _t===null?e.memoizedState=t:lR(e,_t.memoizedState,t)},useTransition:function(){var t=my(yh)[0],e=Yn().memoizedState;return[t,e]},useMutableSource:GP,useSyncExternalStore:QP,useId:uR,unstable_isNewReconciler:!1};function mr(t,e){if(t&&t.defaultProps){e=Ze({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function V_(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ze({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var sm={isMounted:function(t){return(t=t._reactInternals)?ua(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=on(),i=Is(t),s=Ii(r,i);s.payload=e,n!=null&&(s.callback=n),e=Es(t,s,i),e!==null&&(Tr(e,t,i,r),lf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=on(),i=Is(t),s=Ii(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Es(t,s,i),e!==null&&(Tr(e,t,i,r),lf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=on(),r=Is(t),i=Ii(n,r);i.tag=2,e!=null&&(i.callback=e),e=Es(t,i,r),e!==null&&(Tr(e,t,r,n),lf(e,t,r))}};function M0(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!ch(n,r)||!ch(i,s):!0}function fR(t,e,n){var r=!1,i=Ds,s=e.contextType;return typeof s=="object"&&s!==null?s=Qn(s):(i=vn(e)?Wo:Yt.current,r=e.contextTypes,s=(r=r!=null)?hl(t,i):Ds),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=sm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function L0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&sm.enqueueReplaceState(e,e.state,null)}function O_(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Lw(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Qn(s):(s=vn(e)?Wo:Yt.current,i.context=hl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(V_(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&sm.enqueueReplaceState(i,i.state,null),ep(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ml(t,e){try{var n="",r=e;do n+=jV(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function gy(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function M_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var fO=typeof WeakMap=="function"?WeakMap:Map;function pR(t,e,n){n=Ii(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){sp||(sp=!0,H_=r),M_(t,e)},n}function mR(t,e,n){n=Ii(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){M_(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){M_(t,e),typeof r!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function $0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new fO;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=RO.bind(null,t,e,n),e.then(t,t))}function F0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function j0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ii(-1,1),e.tag=2,Es(n,e,1))),n.lanes|=1),t)}var pO=Hi.ReactCurrentOwner,yn=!1;function rn(t,e,n,r){e.child=t===null?qP(e,null,n,r):fl(e,t.child,n,r)}function U0(t,e,n,r,i){n=n.render;var s=e.ref;return Za(e,i),r=Bw(t,e,n,r,s,i),n=zw(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Di(t,e,i)):(Ke&&n&&kw(e),e.flags|=1,rn(t,e,r,i),e.child)}function B0(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Zw(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,gR(t,e,s,r,i)):(t=pf(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ch,n(o,r)&&t.ref===e.ref)return Di(t,e,i)}return e.flags|=1,t=As(s,r),t.ref=e.ref,t.return=e,e.child=t}function gR(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(ch(s,r)&&t.ref===e.ref)if(yn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(yn=!0);else return e.lanes=t.lanes,Di(t,e,i)}return L_(t,e,n,r,i)}function yR(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(qa,xn),xn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Be(qa,xn),xn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Be(qa,xn),xn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Be(qa,xn),xn|=r;return rn(t,e,i,n),e.child}function _R(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function L_(t,e,n,r,i){var s=vn(n)?Wo:Yt.current;return s=hl(e,s),Za(e,i),n=Bw(t,e,n,r,s,i),r=zw(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Di(t,e,i)):(Ke&&r&&kw(e),e.flags|=1,rn(t,e,n,i),e.child)}function z0(t,e,n,r,i){if(vn(n)){var s=!0;Qf(e)}else s=!1;if(Za(e,i),e.stateNode===null)hf(t,e),fR(e,n,r),O_(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=Qn(h):(h=vn(n)?Wo:Yt.current,h=hl(e,h));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==h)&&L0(e,o,r,h),rs=!1;var g=e.memoizedState;o.state=g,ep(e,r,o,i),u=e.memoizedState,l!==r||g!==u||_n.current||rs?(typeof f=="function"&&(V_(e,n,f,r),u=e.memoizedState),(l=rs||M0(e,n,l,r,g,u,h))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=h,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,HP(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:mr(e.type,l),o.props=h,p=e.pendingProps,g=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Qn(u):(u=vn(n)?Wo:Yt.current,u=hl(e,u));var I=n.getDerivedStateFromProps;(f=typeof I=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||g!==u)&&L0(e,o,r,u),rs=!1,g=e.memoizedState,o.state=g,ep(e,r,o,i);var A=e.memoizedState;l!==p||g!==A||_n.current||rs?(typeof I=="function"&&(V_(e,n,I,r),A=e.memoizedState),(h=rs||M0(e,n,h,r,g,A,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=u,r=h):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return $_(t,e,n,r,s,i)}function $_(t,e,n,r,i,s){_R(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&C0(e,n,!1),Di(t,e,s);r=e.stateNode,pO.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=fl(e,t.child,null,s),e.child=fl(e,null,l,s)):rn(t,e,l,s),e.memoizedState=r.state,i&&C0(e,n,!0),e.child}function vR(t){var e=t.stateNode;e.pendingContext?R0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&R0(t,e.context,!1),$w(t,e.containerInfo)}function q0(t,e,n,r,i){return dl(),Nw(i),e.flags|=256,rn(t,e,n,r),e.child}var F_={dehydrated:null,treeContext:null,retryLane:0};function j_(t){return{baseLanes:t,cachePool:null,transitions:null}}function wR(t,e,n){var r=e.pendingProps,i=Ye.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Be(Ye,i&1),t===null)return N_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=lm(o,r,0,null),t=jo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=j_(n),e.memoizedState=F_,t):Hw(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return mO(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=As(i,u),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=As(l,s):(s=jo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?j_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=F_,r}return s=t.child,t=s.sibling,r=As(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Hw(t,e){return e=lm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ld(t,e,n,r){return r!==null&&Nw(r),fl(e,t.child,null,n),t=Hw(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mO(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=gy(Error(W(422))),Ld(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=lm({mode:"visible",children:r.children},i,0,null),s=jo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&fl(e,t.child,null,o),e.child.memoizedState=j_(o),e.memoizedState=F_,s);if(!(e.mode&1))return Ld(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(W(419)),r=gy(s,r,void 0),Ld(t,e,o,r)}if(l=(o&t.childLanes)!==0,yn||l){if(r=Pt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ni(t,i),Tr(r,t,i,-1))}return Jw(),r=gy(Error(W(421))),Ld(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=CO.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Vn=ws(i.nextSibling),On=e,Ke=!0,yr=null,t!==null&&(Bn[zn++]=gi,Bn[zn++]=yi,Bn[zn++]=Ho,gi=t.id,yi=t.overflow,Ho=e),e=Hw(e,r.children),e.flags|=4096,e)}function W0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),D_(t.return,e,n)}function yy(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ER(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(rn(t,e,r.children,n),r=Ye.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&W0(t,n,e);else if(t.tag===19)W0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Be(Ye,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&tp(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),yy(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&tp(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}yy(e,!0,n,null,s);break;case"together":yy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function hf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Di(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Go|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=As(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=As(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function gO(t,e,n){switch(e.tag){case 3:vR(e),dl();break;case 5:KP(e);break;case 1:vn(e.type)&&Qf(e);break;case 4:$w(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Be(Jf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Be(Ye,Ye.current&1),e.flags|=128,null):n&e.child.childLanes?wR(t,e,n):(Be(Ye,Ye.current&1),t=Di(t,e,n),t!==null?t.sibling:null);Be(Ye,Ye.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ER(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Be(Ye,Ye.current),r)break;return null;case 22:case 23:return e.lanes=0,yR(t,e,n)}return Di(t,e,n)}var TR,U_,IR,AR;TR=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};U_=function(){};IR=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,xo(Or.current);var s=null;switch(n){case"input":i=u_(t,i),r=u_(t,r),s=[];break;case"select":i=Ze({},i,{value:void 0}),r=Ze({},r,{value:void 0}),s=[];break;case"textarea":i=d_(t,i),r=d_(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Kf)}p_(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var l=i[h];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(rh.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var u=r[h];if(l=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(rh.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&ze("scroll",t),s||l===u||(s=[])):(s=s||[]).push(h,u))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};AR=function(t,e,n,r){n!==r&&(e.flags|=4)};function rc(t,e){if(!Ke)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function yO(t,e,n){var r=e.pendingProps;switch(xw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(e),null;case 1:return vn(e.type)&&Gf(),Bt(e),null;case 3:return r=e.stateNode,pl(),We(_n),We(Yt),jw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Od(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yr!==null&&(Q_(yr),yr=null))),U_(t,e),Bt(e),null;case 5:Fw(e);var i=xo(mh.current);if(n=e.type,t!==null&&e.stateNode!=null)IR(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return Bt(e),null}if(t=xo(Or.current),Od(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Nr]=e,r[fh]=s,t=(e.mode&1)!==0,n){case"dialog":ze("cancel",r),ze("close",r);break;case"iframe":case"object":case"embed":ze("load",r);break;case"video":case"audio":for(i=0;i<fc.length;i++)ze(fc[i],r);break;case"source":ze("error",r);break;case"img":case"image":case"link":ze("error",r),ze("load",r);break;case"details":ze("toggle",r);break;case"input":e0(r,s),ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ze("invalid",r);break;case"textarea":n0(r,s),ze("invalid",r)}p_(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Vd(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Vd(r.textContent,l,t),i=["children",""+l]):rh.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ze("scroll",r)}switch(n){case"input":Pd(r),t0(r,s,!0);break;case"textarea":Pd(r),r0(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Kf)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=J1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Nr]=e,t[fh]=r,TR(t,e,!1,!1),e.stateNode=t;e:{switch(o=m_(n,r),n){case"dialog":ze("cancel",t),ze("close",t),i=r;break;case"iframe":case"object":case"embed":ze("load",t),i=r;break;case"video":case"audio":for(i=0;i<fc.length;i++)ze(fc[i],t);i=r;break;case"source":ze("error",t),i=r;break;case"img":case"image":case"link":ze("error",t),ze("load",t),i=r;break;case"details":ze("toggle",t),i=r;break;case"input":e0(t,r),i=u_(t,r),ze("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ze({},r,{value:void 0}),ze("invalid",t);break;case"textarea":n0(t,r),i=d_(t,r),ze("invalid",t);break;default:i=r}p_(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?tP(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Z1(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ih(t,u):typeof u=="number"&&ih(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(rh.hasOwnProperty(s)?u!=null&&s==="onScroll"&&ze("scroll",t):u!=null&&gw(t,s,u,o))}switch(n){case"input":Pd(t),t0(t,r,!1);break;case"textarea":Pd(t),r0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ns(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Qa(t,!!r.multiple,s,!1):r.defaultValue!=null&&Qa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Kf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bt(e),null;case 6:if(t&&e.stateNode!=null)AR(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=xo(mh.current),xo(Or.current),Od(e)){if(r=e.stateNode,n=e.memoizedProps,r[Nr]=e,(s=r.nodeValue!==n)&&(t=On,t!==null))switch(t.tag){case 3:Vd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Vd(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Nr]=e,e.stateNode=r}return Bt(e),null;case 13:if(We(Ye),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ke&&Vn!==null&&e.mode&1&&!(e.flags&128))BP(),dl(),e.flags|=98560,s=!1;else if(s=Od(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(W(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(W(317));s[Nr]=e}else dl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bt(e),s=!1}else yr!==null&&(Q_(yr),yr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ye.current&1?wt===0&&(wt=3):Jw())),e.updateQueue!==null&&(e.flags|=4),Bt(e),null);case 4:return pl(),U_(t,e),t===null&&hh(e.stateNode.containerInfo),Bt(e),null;case 10:return Ow(e.type._context),Bt(e),null;case 17:return vn(e.type)&&Gf(),Bt(e),null;case 19:if(We(Ye),s=e.memoizedState,s===null)return Bt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)rc(s,!1);else{if(wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=tp(t),o!==null){for(e.flags|=128,rc(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Be(Ye,Ye.current&1|2),e.child}t=t.sibling}s.tail!==null&&at()>gl&&(e.flags|=128,r=!0,rc(s,!1),e.lanes=4194304)}else{if(!r)if(t=tp(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),rc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ke)return Bt(e),null}else 2*at()-s.renderingStartTime>gl&&n!==1073741824&&(e.flags|=128,r=!0,rc(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=at(),e.sibling=null,n=Ye.current,Be(Ye,r?n&1|2:n&1),e):(Bt(e),null);case 22:case 23:return Xw(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?xn&1073741824&&(Bt(e),e.subtreeFlags&6&&(e.flags|=8192)):Bt(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function _O(t,e){switch(xw(e),e.tag){case 1:return vn(e.type)&&Gf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pl(),We(_n),We(Yt),jw(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Fw(e),null;case 13:if(We(Ye),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));dl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return We(Ye),null;case 4:return pl(),null;case 10:return Ow(e.type._context),null;case 22:case 23:return Xw(),null;case 24:return null;default:return null}}var $d=!1,Ht=!1,vO=typeof WeakSet=="function"?WeakSet:Set,Y=null;function za(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){rt(t,e,r)}else n.current=null}function B_(t,e,n){try{n()}catch(r){rt(t,e,r)}}var H0=!1;function wO(t,e){if(S_=qf,t=bP(),bw(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,h=0,f=0,p=t,g=null;t:for(;;){for(var I;p!==n||i!==0&&p.nodeType!==3||(l=o+i),p!==s||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(I=p.firstChild)!==null;)g=p,p=I;for(;;){if(p===t)break t;if(g===n&&++h===i&&(l=o),g===s&&++f===r&&(u=o),(I=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=I}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(P_={focusedElem:t,selectionRange:n},qf=!1,Y=e;Y!==null;)if(e=Y,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Y=t;else for(;Y!==null;){e=Y;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var C=A.memoizedProps,N=A.memoizedState,P=e.stateNode,R=P.getSnapshotBeforeUpdate(e.elementType===e.type?C:mr(e.type,C),N);P.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(O){rt(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}return A=H0,H0=!1,A}function Mc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&B_(e,n,s)}i=i.next}while(i!==r)}}function om(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function z_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function SR(t){var e=t.alternate;e!==null&&(t.alternate=null,SR(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Nr],delete e[fh],delete e[b_],delete e[nO],delete e[rO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function PR(t){return t.tag===5||t.tag===3||t.tag===4}function K0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||PR(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function q_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Kf));else if(r!==4&&(t=t.child,t!==null))for(q_(t,e,n),t=t.sibling;t!==null;)q_(t,e,n),t=t.sibling}function W_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(W_(t,e,n),t=t.sibling;t!==null;)W_(t,e,n),t=t.sibling}var Nt=null,gr=!1;function Yi(t,e,n){for(n=n.child;n!==null;)RR(t,e,n),n=n.sibling}function RR(t,e,n){if(Vr&&typeof Vr.onCommitFiberUnmount=="function")try{Vr.onCommitFiberUnmount(Jp,n)}catch{}switch(n.tag){case 5:Ht||za(n,e);case 6:var r=Nt,i=gr;Nt=null,Yi(t,e,n),Nt=r,gr=i,Nt!==null&&(gr?(t=Nt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Nt.removeChild(n.stateNode));break;case 18:Nt!==null&&(gr?(t=Nt,n=n.stateNode,t.nodeType===8?cy(t.parentNode,n):t.nodeType===1&&cy(t,n),lh(t)):cy(Nt,n.stateNode));break;case 4:r=Nt,i=gr,Nt=n.stateNode.containerInfo,gr=!0,Yi(t,e,n),Nt=r,gr=i;break;case 0:case 11:case 14:case 15:if(!Ht&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&B_(n,e,o),i=i.next}while(i!==r)}Yi(t,e,n);break;case 1:if(!Ht&&(za(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){rt(n,e,l)}Yi(t,e,n);break;case 21:Yi(t,e,n);break;case 22:n.mode&1?(Ht=(r=Ht)||n.memoizedState!==null,Yi(t,e,n),Ht=r):Yi(t,e,n);break;default:Yi(t,e,n)}}function G0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new vO),e.forEach(function(r){var i=bO.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function fr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Nt=l.stateNode,gr=!1;break e;case 3:Nt=l.stateNode.containerInfo,gr=!0;break e;case 4:Nt=l.stateNode.containerInfo,gr=!0;break e}l=l.return}if(Nt===null)throw Error(W(160));RR(s,o,i),Nt=null,gr=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(h){rt(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)CR(e,t),e=e.sibling}function CR(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(fr(e,t),br(t),r&4){try{Mc(3,t,t.return),om(3,t)}catch(C){rt(t,t.return,C)}try{Mc(5,t,t.return)}catch(C){rt(t,t.return,C)}}break;case 1:fr(e,t),br(t),r&512&&n!==null&&za(n,n.return);break;case 5:if(fr(e,t),br(t),r&512&&n!==null&&za(n,n.return),t.flags&32){var i=t.stateNode;try{ih(i,"")}catch(C){rt(t,t.return,C)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Y1(i,s),m_(l,o);var h=m_(l,s);for(o=0;o<u.length;o+=2){var f=u[o],p=u[o+1];f==="style"?tP(i,p):f==="dangerouslySetInnerHTML"?Z1(i,p):f==="children"?ih(i,p):gw(i,f,p,h)}switch(l){case"input":c_(i,s);break;case"textarea":X1(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var I=s.value;I!=null?Qa(i,!!s.multiple,I,!1):g!==!!s.multiple&&(s.defaultValue!=null?Qa(i,!!s.multiple,s.defaultValue,!0):Qa(i,!!s.multiple,s.multiple?[]:"",!1))}i[fh]=s}catch(C){rt(t,t.return,C)}}break;case 6:if(fr(e,t),br(t),r&4){if(t.stateNode===null)throw Error(W(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(C){rt(t,t.return,C)}}break;case 3:if(fr(e,t),br(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{lh(e.containerInfo)}catch(C){rt(t,t.return,C)}break;case 4:fr(e,t),br(t);break;case 13:fr(e,t),br(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Qw=at())),r&4&&G0(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Ht=(h=Ht)||f,fr(e,t),Ht=h):fr(e,t),br(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!f&&t.mode&1)for(Y=t,f=t.child;f!==null;){for(p=Y=f;Y!==null;){switch(g=Y,I=g.child,g.tag){case 0:case 11:case 14:case 15:Mc(4,g,g.return);break;case 1:za(g,g.return);var A=g.stateNode;if(typeof A.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(C){rt(r,n,C)}}break;case 5:za(g,g.return);break;case 22:if(g.memoizedState!==null){Y0(p);continue}}I!==null?(I.return=g,Y=I):Y0(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=eP("display",o))}catch(C){rt(t,t.return,C)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=h?"":p.memoizedProps}catch(C){rt(t,t.return,C)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:fr(e,t),br(t),r&4&&G0(t);break;case 21:break;default:fr(e,t),br(t)}}function br(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(PR(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ih(i,""),r.flags&=-33);var s=K0(t);W_(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=K0(t);q_(t,l,o);break;default:throw Error(W(161))}}catch(u){rt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function EO(t,e,n){Y=t,bR(t)}function bR(t,e,n){for(var r=(t.mode&1)!==0;Y!==null;){var i=Y,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||$d;if(!o){var l=i.alternate,u=l!==null&&l.memoizedState!==null||Ht;l=$d;var h=Ht;if($d=o,(Ht=u)&&!h)for(Y=i;Y!==null;)o=Y,u=o.child,o.tag===22&&o.memoizedState!==null?X0(i):u!==null?(u.return=o,Y=u):X0(i);for(;s!==null;)Y=s,bR(s),s=s.sibling;Y=i,$d=l,Ht=h}Q0(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Y=s):Q0(t)}}function Q0(t){for(;Y!==null;){var e=Y;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ht||om(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ht)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:mr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&D0(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}D0(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var f=h.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&lh(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Ht||e.flags&512&&z_(e)}catch(g){rt(e,e.return,g)}}if(e===t){Y=null;break}if(n=e.sibling,n!==null){n.return=e.return,Y=n;break}Y=e.return}}function Y0(t){for(;Y!==null;){var e=Y;if(e===t){Y=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Y=n;break}Y=e.return}}function X0(t){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{om(4,e)}catch(u){rt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){rt(e,i,u)}}var s=e.return;try{z_(e)}catch(u){rt(e,s,u)}break;case 5:var o=e.return;try{z_(e)}catch(u){rt(e,o,u)}}}catch(u){rt(e,e.return,u)}if(e===t){Y=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Y=l;break}Y=e.return}}var TO=Math.ceil,ip=Hi.ReactCurrentDispatcher,Kw=Hi.ReactCurrentOwner,Kn=Hi.ReactCurrentBatchConfig,xe=0,Pt=null,ht=null,Mt=0,xn=0,qa=Hs(0),wt=0,vh=null,Go=0,am=0,Gw=0,Lc=null,gn=null,Qw=0,gl=1/0,di=null,sp=!1,H_=null,Ts=null,Fd=!1,ds=null,op=0,$c=0,K_=null,df=-1,ff=0;function on(){return xe&6?at():df!==-1?df:df=at()}function Is(t){return t.mode&1?xe&2&&Mt!==0?Mt&-Mt:sO.transition!==null?(ff===0&&(ff=fP()),ff):(t=Le,t!==0||(t=window.event,t=t===void 0?16:wP(t.type)),t):1}function Tr(t,e,n,r){if(50<$c)throw $c=0,K_=null,Error(W(185));Hh(t,n,r),(!(xe&2)||t!==Pt)&&(t===Pt&&(!(xe&2)&&(am|=n),wt===4&&ss(t,Mt)),wn(t,r),n===1&&xe===0&&!(e.mode&1)&&(gl=at()+500,rm&&Ks()))}function wn(t,e){var n=t.callbackNode;s2(t,e);var r=zf(t,t===Pt?Mt:0);if(r===0)n!==null&&o0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&o0(n),e===1)t.tag===0?iO(J0.bind(null,t)):FP(J0.bind(null,t)),eO(function(){!(xe&6)&&Ks()}),n=null;else{switch(pP(r)){case 1:n=Ew;break;case 4:n=hP;break;case 16:n=Bf;break;case 536870912:n=dP;break;default:n=Bf}n=LR(n,kR.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function kR(t,e){if(df=-1,ff=0,xe&6)throw Error(W(327));var n=t.callbackNode;if(el()&&t.callbackNode!==n)return null;var r=zf(t,t===Pt?Mt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ap(t,r);else{e=r;var i=xe;xe|=2;var s=NR();(Pt!==t||Mt!==e)&&(di=null,gl=at()+500,Fo(t,e));do try{SO();break}catch(l){xR(t,l)}while(!0);Vw(),ip.current=s,xe=i,ht!==null?e=0:(Pt=null,Mt=0,e=wt)}if(e!==0){if(e===2&&(i=w_(t),i!==0&&(r=i,e=G_(t,i))),e===1)throw n=vh,Fo(t,0),ss(t,r),wn(t,at()),n;if(e===6)ss(t,r);else{if(i=t.current.alternate,!(r&30)&&!IO(i)&&(e=ap(t,r),e===2&&(s=w_(t),s!==0&&(r=s,e=G_(t,s))),e===1))throw n=vh,Fo(t,0),ss(t,r),wn(t,at()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:To(t,gn,di);break;case 3:if(ss(t,r),(r&130023424)===r&&(e=Qw+500-at(),10<e)){if(zf(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){on(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=C_(To.bind(null,t,gn,di),e);break}To(t,gn,di);break;case 4:if(ss(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Er(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=at()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*TO(r/1960))-r,10<r){t.timeoutHandle=C_(To.bind(null,t,gn,di),r);break}To(t,gn,di);break;case 5:To(t,gn,di);break;default:throw Error(W(329))}}}return wn(t,at()),t.callbackNode===n?kR.bind(null,t):null}function G_(t,e){var n=Lc;return t.current.memoizedState.isDehydrated&&(Fo(t,e).flags|=256),t=ap(t,e),t!==2&&(e=gn,gn=n,e!==null&&Q_(e)),t}function Q_(t){gn===null?gn=t:gn.push.apply(gn,t)}function IO(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ar(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ss(t,e){for(e&=~Gw,e&=~am,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Er(e),r=1<<n;t[n]=-1,e&=~r}}function J0(t){if(xe&6)throw Error(W(327));el();var e=zf(t,0);if(!(e&1))return wn(t,at()),null;var n=ap(t,e);if(t.tag!==0&&n===2){var r=w_(t);r!==0&&(e=r,n=G_(t,r))}if(n===1)throw n=vh,Fo(t,0),ss(t,e),wn(t,at()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,To(t,gn,di),wn(t,at()),null}function Yw(t,e){var n=xe;xe|=1;try{return t(e)}finally{xe=n,xe===0&&(gl=at()+500,rm&&Ks())}}function Qo(t){ds!==null&&ds.tag===0&&!(xe&6)&&el();var e=xe;xe|=1;var n=Kn.transition,r=Le;try{if(Kn.transition=null,Le=1,t)return t()}finally{Le=r,Kn.transition=n,xe=e,!(xe&6)&&Ks()}}function Xw(){xn=qa.current,We(qa)}function Fo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Z2(n)),ht!==null)for(n=ht.return;n!==null;){var r=n;switch(xw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Gf();break;case 3:pl(),We(_n),We(Yt),jw();break;case 5:Fw(r);break;case 4:pl();break;case 13:We(Ye);break;case 19:We(Ye);break;case 10:Ow(r.type._context);break;case 22:case 23:Xw()}n=n.return}if(Pt=t,ht=t=As(t.current,null),Mt=xn=e,wt=0,vh=null,Gw=am=Go=0,gn=Lc=null,ko!==null){for(e=0;e<ko.length;e++)if(n=ko[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ko=null}return t}function xR(t,e){do{var n=ht;try{if(Vw(),uf.current=rp,np){for(var r=Xe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}np=!1}if(Ko=0,It=_t=Xe=null,Oc=!1,gh=0,Kw.current=null,n===null||n.return===null){wt=1,vh=e,ht=null;break}e:{var s=t,o=n.return,l=n,u=e;if(e=Mt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var I=F0(o);if(I!==null){I.flags&=-257,j0(I,o,l,s,e),I.mode&1&&$0(s,h,e),e=I,u=h;var A=e.updateQueue;if(A===null){var C=new Set;C.add(u),e.updateQueue=C}else A.add(u);break e}else{if(!(e&1)){$0(s,h,e),Jw();break e}u=Error(W(426))}}else if(Ke&&l.mode&1){var N=F0(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),j0(N,o,l,s,e),Nw(ml(u,l));break e}}s=u=ml(u,l),wt!==4&&(wt=2),Lc===null?Lc=[s]:Lc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var P=pR(s,u,e);N0(s,P);break e;case 1:l=u;var R=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof R.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ts===null||!Ts.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=mR(s,l,e);N0(s,O);break e}}s=s.return}while(s!==null)}VR(n)}catch(M){e=M,ht===n&&n!==null&&(ht=n=n.return);continue}break}while(!0)}function NR(){var t=ip.current;return ip.current=rp,t===null?rp:t}function Jw(){(wt===0||wt===3||wt===2)&&(wt=4),Pt===null||!(Go&268435455)&&!(am&268435455)||ss(Pt,Mt)}function ap(t,e){var n=xe;xe|=2;var r=NR();(Pt!==t||Mt!==e)&&(di=null,Fo(t,e));do try{AO();break}catch(i){xR(t,i)}while(!0);if(Vw(),xe=n,ip.current=r,ht!==null)throw Error(W(261));return Pt=null,Mt=0,wt}function AO(){for(;ht!==null;)DR(ht)}function SO(){for(;ht!==null&&!YV();)DR(ht)}function DR(t){var e=MR(t.alternate,t,xn);t.memoizedProps=t.pendingProps,e===null?VR(t):ht=e,Kw.current=null}function VR(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_O(n,e),n!==null){n.flags&=32767,ht=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wt=6,ht=null;return}}else if(n=yO(n,e,xn),n!==null){ht=n;return}if(e=e.sibling,e!==null){ht=e;return}ht=e=t}while(e!==null);wt===0&&(wt=5)}function To(t,e,n){var r=Le,i=Kn.transition;try{Kn.transition=null,Le=1,PO(t,e,n,r)}finally{Kn.transition=i,Le=r}return null}function PO(t,e,n,r){do el();while(ds!==null);if(xe&6)throw Error(W(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(o2(t,s),t===Pt&&(ht=Pt=null,Mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Fd||(Fd=!0,LR(Bf,function(){return el(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Kn.transition,Kn.transition=null;var o=Le;Le=1;var l=xe;xe|=4,Kw.current=null,wO(t,n),CR(n,t),H2(P_),qf=!!S_,P_=S_=null,t.current=n,EO(n),XV(),xe=l,Le=o,Kn.transition=s}else t.current=n;if(Fd&&(Fd=!1,ds=t,op=i),s=t.pendingLanes,s===0&&(Ts=null),e2(n.stateNode),wn(t,at()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(sp)throw sp=!1,t=H_,H_=null,t;return op&1&&t.tag!==0&&el(),s=t.pendingLanes,s&1?t===K_?$c++:($c=0,K_=t):$c=0,Ks(),null}function el(){if(ds!==null){var t=pP(op),e=Kn.transition,n=Le;try{if(Kn.transition=null,Le=16>t?16:t,ds===null)var r=!1;else{if(t=ds,ds=null,op=0,xe&6)throw Error(W(331));var i=xe;for(xe|=4,Y=t.current;Y!==null;){var s=Y,o=s.child;if(Y.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(Y=h;Y!==null;){var f=Y;switch(f.tag){case 0:case 11:case 15:Mc(8,f,s)}var p=f.child;if(p!==null)p.return=f,Y=p;else for(;Y!==null;){f=Y;var g=f.sibling,I=f.return;if(SR(f),f===h){Y=null;break}if(g!==null){g.return=I,Y=g;break}Y=I}}}var A=s.alternate;if(A!==null){var C=A.child;if(C!==null){A.child=null;do{var N=C.sibling;C.sibling=null,C=N}while(C!==null)}}Y=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Y=o;else e:for(;Y!==null;){if(s=Y,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Mc(9,s,s.return)}var P=s.sibling;if(P!==null){P.return=s.return,Y=P;break e}Y=s.return}}var R=t.current;for(Y=R;Y!==null;){o=Y;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,Y=x;else e:for(o=R;Y!==null;){if(l=Y,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:om(9,l)}}catch(M){rt(l,l.return,M)}if(l===o){Y=null;break e}var O=l.sibling;if(O!==null){O.return=l.return,Y=O;break e}Y=l.return}}if(xe=i,Ks(),Vr&&typeof Vr.onPostCommitFiberRoot=="function")try{Vr.onPostCommitFiberRoot(Jp,t)}catch{}r=!0}return r}finally{Le=n,Kn.transition=e}}return!1}function Z0(t,e,n){e=ml(n,e),e=pR(t,e,1),t=Es(t,e,1),e=on(),t!==null&&(Hh(t,1,e),wn(t,e))}function rt(t,e,n){if(t.tag===3)Z0(t,t,n);else for(;e!==null;){if(e.tag===3){Z0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ts===null||!Ts.has(r))){t=ml(n,t),t=mR(e,t,1),e=Es(e,t,1),t=on(),e!==null&&(Hh(e,1,t),wn(e,t));break}}e=e.return}}function RO(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=on(),t.pingedLanes|=t.suspendedLanes&n,Pt===t&&(Mt&n)===n&&(wt===4||wt===3&&(Mt&130023424)===Mt&&500>at()-Qw?Fo(t,0):Gw|=n),wn(t,e)}function OR(t,e){e===0&&(t.mode&1?(e=bd,bd<<=1,!(bd&130023424)&&(bd=4194304)):e=1);var n=on();t=Ni(t,e),t!==null&&(Hh(t,e,n),wn(t,n))}function CO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),OR(t,n)}function bO(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),OR(t,n)}var MR;MR=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_n.current)yn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yn=!1,gO(t,e,n);yn=!!(t.flags&131072)}else yn=!1,Ke&&e.flags&1048576&&jP(e,Xf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;hf(t,e),t=e.pendingProps;var i=hl(e,Yt.current);Za(e,n),i=Bw(null,e,r,t,i,n);var s=zw();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vn(r)?(s=!0,Qf(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Lw(e),i.updater=sm,e.stateNode=i,i._reactInternals=e,O_(e,r,t,n),e=$_(null,e,r,!0,s,n)):(e.tag=0,Ke&&s&&kw(e),rn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(hf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=xO(r),t=mr(r,t),i){case 0:e=L_(null,e,r,t,n);break e;case 1:e=z0(null,e,r,t,n);break e;case 11:e=U0(null,e,r,t,n);break e;case 14:e=B0(null,e,r,mr(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mr(r,i),L_(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mr(r,i),z0(t,e,r,i,n);case 3:e:{if(vR(e),t===null)throw Error(W(387));r=e.pendingProps,s=e.memoizedState,i=s.element,HP(t,e),ep(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ml(Error(W(423)),e),e=q0(t,e,r,n,i);break e}else if(r!==i){i=ml(Error(W(424)),e),e=q0(t,e,r,n,i);break e}else for(Vn=ws(e.stateNode.containerInfo.firstChild),On=e,Ke=!0,yr=null,n=qP(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(dl(),r===i){e=Di(t,e,n);break e}rn(t,e,r,n)}e=e.child}return e;case 5:return KP(e),t===null&&N_(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,R_(r,i)?o=null:s!==null&&R_(r,s)&&(e.flags|=32),_R(t,e),rn(t,e,o,n),e.child;case 6:return t===null&&N_(e),null;case 13:return wR(t,e,n);case 4:return $w(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=fl(e,null,r,n):rn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mr(r,i),U0(t,e,r,i,n);case 7:return rn(t,e,e.pendingProps,n),e.child;case 8:return rn(t,e,e.pendingProps.children,n),e.child;case 12:return rn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Be(Jf,r._currentValue),r._currentValue=o,s!==null)if(Ar(s.value,o)){if(s.children===i.children&&!_n.current){e=Di(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Ii(-1,n&-n),u.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var f=h.pending;f===null?u.next=u:(u.next=f.next,f.next=u),h.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),D_(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(W(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),D_(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}rn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Za(e,n),i=Qn(i),r=r(i),e.flags|=1,rn(t,e,r,n),e.child;case 14:return r=e.type,i=mr(r,e.pendingProps),i=mr(r.type,i),B0(t,e,r,i,n);case 15:return gR(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mr(r,i),hf(t,e),e.tag=1,vn(r)?(t=!0,Qf(e)):t=!1,Za(e,n),fR(e,r,i),O_(e,r,i,n),$_(null,e,r,!0,t,n);case 19:return ER(t,e,n);case 22:return yR(t,e,n)}throw Error(W(156,e.tag))};function LR(t,e){return cP(t,e)}function kO(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hn(t,e,n,r){return new kO(t,e,n,r)}function Zw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xO(t){if(typeof t=="function")return Zw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===_w)return 11;if(t===vw)return 14}return 2}function As(t,e){var n=t.alternate;return n===null?(n=Hn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function pf(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Zw(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Va:return jo(n.children,i,s,e);case yw:o=8,i|=8;break;case s_:return t=Hn(12,n,e,i|2),t.elementType=s_,t.lanes=s,t;case o_:return t=Hn(13,n,e,i),t.elementType=o_,t.lanes=s,t;case a_:return t=Hn(19,n,e,i),t.elementType=a_,t.lanes=s,t;case K1:return lm(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case W1:o=10;break e;case H1:o=9;break e;case _w:o=11;break e;case vw:o=14;break e;case ns:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=Hn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function jo(t,e,n,r){return t=Hn(7,t,r,e),t.lanes=n,t}function lm(t,e,n,r){return t=Hn(22,t,r,e),t.elementType=K1,t.lanes=n,t.stateNode={isHidden:!1},t}function _y(t,e,n){return t=Hn(6,t,null,e),t.lanes=n,t}function vy(t,e,n){return e=Hn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function NO(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zg(0),this.expirationTimes=Zg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function eE(t,e,n,r,i,s,o,l,u){return t=new NO(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Hn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lw(s),t}function DO(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Da,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function $R(t){if(!t)return Ds;t=t._reactInternals;e:{if(ua(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(vn(n))return $P(t,n,e)}return e}function FR(t,e,n,r,i,s,o,l,u){return t=eE(n,r,!0,t,i,s,o,l,u),t.context=$R(null),n=t.current,r=on(),i=Is(n),s=Ii(r,i),s.callback=e??null,Es(n,s,i),t.current.lanes=i,Hh(t,i,r),wn(t,r),t}function um(t,e,n,r){var i=e.current,s=on(),o=Is(i);return n=$R(n),e.context===null?e.context=n:e.pendingContext=n,e=Ii(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Es(i,e,o),t!==null&&(Tr(t,i,o,s),lf(t,i,o)),o}function lp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function eI(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function tE(t,e){eI(t,e),(t=t.alternate)&&eI(t,e)}function VO(){return null}var jR=typeof reportError=="function"?reportError:function(t){console.error(t)};function nE(t){this._internalRoot=t}cm.prototype.render=nE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));um(t,e,null,null)};cm.prototype.unmount=nE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Qo(function(){um(null,t,null,null)}),e[xi]=null}};function cm(t){this._internalRoot=t}cm.prototype.unstable_scheduleHydration=function(t){if(t){var e=yP();t={blockedOn:null,target:t,priority:e};for(var n=0;n<is.length&&e!==0&&e<is[n].priority;n++);is.splice(n,0,t),n===0&&vP(t)}};function rE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function tI(){}function OO(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=lp(o);s.call(h)}}var o=FR(e,r,t,0,null,!1,!1,"",tI);return t._reactRootContainer=o,t[xi]=o.current,hh(t.nodeType===8?t.parentNode:t),Qo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var h=lp(u);l.call(h)}}var u=eE(t,0,!1,null,null,!1,!1,"",tI);return t._reactRootContainer=u,t[xi]=u.current,hh(t.nodeType===8?t.parentNode:t),Qo(function(){um(e,u,n,r)}),u}function dm(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var u=lp(o);l.call(u)}}um(e,o,t,i)}else o=OO(n,e,t,i,r);return lp(o)}mP=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=dc(e.pendingLanes);n!==0&&(Tw(e,n|1),wn(e,at()),!(xe&6)&&(gl=at()+500,Ks()))}break;case 13:Qo(function(){var r=Ni(t,1);if(r!==null){var i=on();Tr(r,t,1,i)}}),tE(t,1)}};Iw=function(t){if(t.tag===13){var e=Ni(t,134217728);if(e!==null){var n=on();Tr(e,t,134217728,n)}tE(t,134217728)}};gP=function(t){if(t.tag===13){var e=Is(t),n=Ni(t,e);if(n!==null){var r=on();Tr(n,t,e,r)}tE(t,e)}};yP=function(){return Le};_P=function(t,e){var n=Le;try{return Le=t,e()}finally{Le=n}};y_=function(t,e,n){switch(e){case"input":if(c_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=nm(r);if(!i)throw Error(W(90));Q1(r),c_(r,i)}}}break;case"textarea":X1(t,n);break;case"select":e=n.value,e!=null&&Qa(t,!!n.multiple,e,!1)}};iP=Yw;sP=Qo;var MO={usingClientEntryPoint:!1,Events:[Gh,$a,nm,nP,rP,Yw]},ic={findFiberByHostInstance:bo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LO={bundleType:ic.bundleType,version:ic.version,rendererPackageName:ic.rendererPackageName,rendererConfig:ic.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=lP(t),t===null?null:t.stateNode},findFiberByHostInstance:ic.findFiberByHostInstance||VO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jd.isDisabled&&jd.supportsFiber)try{Jp=jd.inject(LO),Vr=jd}catch{}}Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MO;Fn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rE(e))throw Error(W(200));return DO(t,e,null,n)};Fn.createRoot=function(t,e){if(!rE(t))throw Error(W(299));var n=!1,r="",i=jR;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=eE(t,1,!1,null,null,n,!1,r,i),t[xi]=e.current,hh(t.nodeType===8?t.parentNode:t),new nE(e)};Fn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=lP(e),t=t===null?null:t.stateNode,t};Fn.flushSync=function(t){return Qo(t)};Fn.hydrate=function(t,e,n){if(!hm(e))throw Error(W(200));return dm(null,t,e,!0,n)};Fn.hydrateRoot=function(t,e,n){if(!rE(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=jR;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=FR(e,null,t,1,n??null,i,!1,s,o),t[xi]=e.current,hh(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new cm(e)};Fn.render=function(t,e,n){if(!hm(e))throw Error(W(200));return dm(null,t,e,!1,n)};Fn.unmountComponentAtNode=function(t){if(!hm(t))throw Error(W(40));return t._reactRootContainer?(Qo(function(){dm(null,null,t,!1,function(){t._reactRootContainer=null,t[xi]=null})}),!0):!1};Fn.unstable_batchedUpdates=Yw;Fn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!hm(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return dm(t,e,n,!1,r)};Fn.version="18.3.1-next-f1338f8080-20240426";function UR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(UR)}catch(t){console.error(t)}}UR(),U1.exports=Fn;var BR=U1.exports,nI=BR;r_.createRoot=nI.createRoot,r_.hydrateRoot=nI.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wh(){return wh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wh.apply(this,arguments)}var fs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(fs||(fs={}));const rI="popstate";function $O(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:l}=r.location;return Y_("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:up(i)}return jO(e,n,null,t)}function Je(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zR(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function FO(){return Math.random().toString(36).substr(2,8)}function iI(t,e){return{usr:t.state,key:t.key,idx:e}}function Y_(t,e,n,r){return n===void 0&&(n=null),wh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ol(e):e,{state:n,key:e&&e.key||r||FO()})}function up(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ol(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function jO(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,l=fs.Pop,u=null,h=f();h==null&&(h=0,o.replaceState(wh({},o.state,{idx:h}),""));function f(){return(o.state||{idx:null}).idx}function p(){l=fs.Pop;let N=f(),P=N==null?null:N-h;h=N,u&&u({action:l,location:C.location,delta:P})}function g(N,P){l=fs.Push;let R=Y_(C.location,N,P);h=f()+1;let x=iI(R,h),O=C.createHref(R);try{o.pushState(x,"",O)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;i.location.assign(O)}s&&u&&u({action:l,location:C.location,delta:1})}function I(N,P){l=fs.Replace;let R=Y_(C.location,N,P);h=f();let x=iI(R,h),O=C.createHref(R);o.replaceState(x,"",O),s&&u&&u({action:l,location:C.location,delta:0})}function A(N){let P=i.location.origin!=="null"?i.location.origin:i.location.href,R=typeof N=="string"?N:up(N);return R=R.replace(/ $/,"%20"),Je(P,"No window.location.(origin|href) available to create URL for href: "+R),new URL(R,P)}let C={get action(){return l},get location(){return t(i,o)},listen(N){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(rI,p),u=N,()=>{i.removeEventListener(rI,p),u=null}},createHref(N){return e(i,N)},createURL:A,encodeLocation(N){let P=A(N);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:g,replace:I,go(N){return o.go(N)}};return C}var sI;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(sI||(sI={}));function UO(t,e,n){return n===void 0&&(n="/"),BO(t,e,n)}function BO(t,e,n,r){let i=typeof e=="string"?Ol(e):e,s=yl(i.pathname||"/",n);if(s==null)return null;let o=qR(t);zO(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let h=eM(s);l=JO(o[u],h)}return l}function qR(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,l)=>{let u={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};u.relativePath.startsWith("/")&&(Je(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let h=Ss([r,u.relativePath]),f=n.concat(u);s.children&&s.children.length>0&&(Je(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),qR(s.children,e,f,h)),!(s.path==null&&!s.index)&&e.push({path:h,score:YO(h,s.index),routesMeta:f})};return t.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let u of WR(s.path))i(s,o,u)}),e}function WR(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=WR(r.join("/")),l=[];return l.push(...o.map(u=>u===""?s:[s,u].join("/"))),i&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function zO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:XO(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const qO=/^:[\w-]+$/,WO=3,HO=2,KO=1,GO=10,QO=-2,oI=t=>t==="*";function YO(t,e){let n=t.split("/"),r=n.length;return n.some(oI)&&(r+=QO),e&&(r+=HO),n.filter(i=>!oI(i)).reduce((i,s)=>i+(qO.test(s)?WO:s===""?KO:GO),r)}function XO(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function JO(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],h=l===r.length-1,f=s==="/"?e:e.slice(s.length)||"/",p=X_({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},f),g=u.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Ss([s,p.pathname]),pathnameBase:iM(Ss([s,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(s=Ss([s,p.pathnameBase]))}return o}function X_(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=ZO(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((h,f,p)=>{let{paramName:g,isOptional:I}=f;if(g==="*"){let C=l[p]||"";o=s.slice(0,s.length-C.length).replace(/(.)\/+$/,"$1")}const A=l[p];return I&&!A?h[g]=void 0:h[g]=(A||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:t}}function ZO(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),zR(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function eM(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zR(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function yl(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function tM(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Ol(t):t;return{pathname:n?n.startsWith("/")?n:nM(n,e):e,search:sM(r),hash:oM(i)}}function nM(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function wy(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rM(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function iE(t,e){let n=rM(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function sE(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Ol(t):(i=wh({},t),Je(!i.pathname||!i.pathname.includes("?"),wy("?","pathname","search",i)),Je(!i.pathname||!i.pathname.includes("#"),wy("#","pathname","hash",i)),Je(!i.search||!i.search.includes("#"),wy("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;i.pathname=g.join("/")}l=p>=0?e[p]:"/"}let u=tM(i,l),h=o&&o!=="/"&&o.endsWith("/"),f=(s||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(h||f)&&(u.pathname+="/"),u}const Ss=t=>t.join("/").replace(/\/\/+/g,"/"),iM=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),sM=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,oM=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function aM(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const HR=["post","put","patch","delete"];new Set(HR);const lM=["get",...HR];new Set(lM);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Eh(){return Eh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Eh.apply(this,arguments)}const fm=D.createContext(null),KR=D.createContext(null),Ki=D.createContext(null),pm=D.createContext(null),Gs=D.createContext({outlet:null,matches:[],isDataRoute:!1}),GR=D.createContext(null);function uM(t,e){let{relative:n}=e===void 0?{}:e;Ml()||Je(!1);let{basename:r,navigator:i}=D.useContext(Ki),{hash:s,pathname:o,search:l}=mm(t,{relative:n}),u=o;return r!=="/"&&(u=o==="/"?r:Ss([r,o])),i.createHref({pathname:u,search:l,hash:s})}function Ml(){return D.useContext(pm)!=null}function Ll(){return Ml()||Je(!1),D.useContext(pm).location}function QR(t){D.useContext(Ki).static||D.useLayoutEffect(t)}function YR(){let{isDataRoute:t}=D.useContext(Gs);return t?TM():cM()}function cM(){Ml()||Je(!1);let t=D.useContext(fm),{basename:e,future:n,navigator:r}=D.useContext(Ki),{matches:i}=D.useContext(Gs),{pathname:s}=Ll(),o=JSON.stringify(iE(i,n.v7_relativeSplatPath)),l=D.useRef(!1);return QR(()=>{l.current=!0}),D.useCallback(function(h,f){if(f===void 0&&(f={}),!l.current)return;if(typeof h=="number"){r.go(h);return}let p=sE(h,JSON.parse(o),s,f.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Ss([e,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[e,r,o,s,t])}function mm(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=D.useContext(Ki),{matches:i}=D.useContext(Gs),{pathname:s}=Ll(),o=JSON.stringify(iE(i,r.v7_relativeSplatPath));return D.useMemo(()=>sE(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function hM(t,e){return dM(t,e)}function dM(t,e,n,r){Ml()||Je(!1);let{navigator:i}=D.useContext(Ki),{matches:s}=D.useContext(Gs),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let h=Ll(),f;if(e){var p;let N=typeof e=="string"?Ol(e):e;u==="/"||(p=N.pathname)!=null&&p.startsWith(u)||Je(!1),f=N}else f=h;let g=f.pathname||"/",I=g;if(u!=="/"){let N=u.replace(/^\//,"").split("/");I="/"+g.replace(/^\//,"").split("/").slice(N.length).join("/")}let A=UO(t,{pathname:I}),C=yM(A&&A.map(N=>Object.assign({},N,{params:Object.assign({},l,N.params),pathname:Ss([u,i.encodeLocation?i.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?u:Ss([u,i.encodeLocation?i.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),s,n,r);return e&&C?D.createElement(pm.Provider,{value:{location:Eh({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:fs.Pop}},C):C}function fM(){let t=EM(),e=aM(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},e),n?D.createElement("pre",{style:i},n):null,null)}const pM=D.createElement(fM,null);class mM extends D.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?D.createElement(Gs.Provider,{value:this.props.routeContext},D.createElement(GR.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function gM(t){let{routeContext:e,match:n,children:r}=t,i=D.useContext(fm);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),D.createElement(Gs.Provider,{value:e},r)}function yM(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(i=n)==null?void 0:i.errors;if(l!=null){let f=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);f>=0||Je(!1),o=o.slice(0,Math.min(o.length,f+1))}let u=!1,h=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<o.length;f++){let p=o[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:g,errors:I}=n,A=p.route.loader&&g[p.route.id]===void 0&&(!I||I[p.route.id]===void 0);if(p.route.lazy||A){u=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}return o.reduceRight((f,p,g)=>{let I,A=!1,C=null,N=null;n&&(I=l&&p.route.id?l[p.route.id]:void 0,C=p.route.errorElement||pM,u&&(h<0&&g===0?(IM("route-fallback"),A=!0,N=null):h===g&&(A=!0,N=p.route.hydrateFallbackElement||null)));let P=e.concat(o.slice(0,g+1)),R=()=>{let x;return I?x=C:A?x=N:p.route.Component?x=D.createElement(p.route.Component,null):p.route.element?x=p.route.element:x=f,D.createElement(gM,{match:p,routeContext:{outlet:f,matches:P,isDataRoute:n!=null},children:x})};return n&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?D.createElement(mM,{location:n.location,revalidation:n.revalidation,component:C,error:I,children:R(),routeContext:{outlet:null,matches:P,isDataRoute:!0}}):R()},null)}var XR=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(XR||{}),JR=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(JR||{});function _M(t){let e=D.useContext(fm);return e||Je(!1),e}function vM(t){let e=D.useContext(KR);return e||Je(!1),e}function wM(t){let e=D.useContext(Gs);return e||Je(!1),e}function ZR(t){let e=wM(),n=e.matches[e.matches.length-1];return n.route.id||Je(!1),n.route.id}function EM(){var t;let e=D.useContext(GR),n=vM(),r=ZR();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function TM(){let{router:t}=_M(XR.UseNavigateStable),e=ZR(JR.UseNavigateStable),n=D.useRef(!1);return QR(()=>{n.current=!0}),D.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Eh({fromRouteId:e},s)))},[t,e])}const aI={};function IM(t,e,n){aI[t]||(aI[t]=!0)}function AM(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function lI(t){let{to:e,replace:n,state:r,relative:i}=t;Ml()||Je(!1);let{future:s,static:o}=D.useContext(Ki),{matches:l}=D.useContext(Gs),{pathname:u}=Ll(),h=YR(),f=sE(e,iE(l,s.v7_relativeSplatPath),u,i==="path"),p=JSON.stringify(f);return D.useEffect(()=>h(JSON.parse(p),{replace:n,state:r,relative:i}),[h,p,i,n,r]),null}function pr(t){Je(!1)}function SM(t){let{basename:e="/",children:n=null,location:r,navigationType:i=fs.Pop,navigator:s,static:o=!1,future:l}=t;Ml()&&Je(!1);let u=e.replace(/^\/*/,"/"),h=D.useMemo(()=>({basename:u,navigator:s,static:o,future:Eh({v7_relativeSplatPath:!1},l)}),[u,l,s,o]);typeof r=="string"&&(r=Ol(r));let{pathname:f="/",search:p="",hash:g="",state:I=null,key:A="default"}=r,C=D.useMemo(()=>{let N=yl(f,u);return N==null?null:{location:{pathname:N,search:p,hash:g,state:I,key:A},navigationType:i}},[u,f,p,g,I,A,i]);return C==null?null:D.createElement(Ki.Provider,{value:h},D.createElement(pm.Provider,{children:n,value:C}))}function PM(t){let{children:e,location:n}=t;return hM(J_(e),n)}new Promise(()=>{});function J_(t,e){e===void 0&&(e=[]);let n=[];return D.Children.forEach(t,(r,i)=>{if(!D.isValidElement(r))return;let s=[...e,i];if(r.type===D.Fragment){n.push.apply(n,J_(r.props.children,s));return}r.type!==pr&&Je(!1),!r.props.index||!r.props.children||Je(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=J_(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cp(){return cp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},cp.apply(this,arguments)}function eC(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function RM(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function CM(t,e){return t.button===0&&(!e||e==="_self")&&!RM(t)}const bM=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kM=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],xM="6";try{window.__reactRouterVersion=xM}catch{}const NM=D.createContext({isTransitioning:!1}),DM="startTransition",uI=n_[DM];function VM(t){let{basename:e,children:n,future:r,window:i}=t,s=D.useRef();s.current==null&&(s.current=$O({window:i,v5Compat:!0}));let o=s.current,[l,u]=D.useState({action:o.action,location:o.location}),{v7_startTransition:h}=r||{},f=D.useCallback(p=>{h&&uI?uI(()=>u(p)):u(p)},[u,h]);return D.useLayoutEffect(()=>o.listen(f),[o,f]),D.useEffect(()=>AM(r),[r]),D.createElement(SM,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const OM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",MM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LM=D.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:l,target:u,to:h,preventScrollReset:f,viewTransition:p}=e,g=eC(e,bM),{basename:I}=D.useContext(Ki),A,C=!1;if(typeof h=="string"&&MM.test(h)&&(A=h,OM))try{let x=new URL(window.location.href),O=h.startsWith("//")?new URL(x.protocol+h):new URL(h),M=yl(O.pathname,I);O.origin===x.origin&&M!=null?h=M+O.search+O.hash:C=!0}catch{}let N=uM(h,{relative:i}),P=jM(h,{replace:o,state:l,target:u,preventScrollReset:f,relative:i,viewTransition:p});function R(x){r&&r(x),x.defaultPrevented||P(x)}return D.createElement("a",cp({},g,{href:A||N,onClick:C||s?r:R,ref:n,target:u}))}),$M=D.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:o=!1,style:l,to:u,viewTransition:h,children:f}=e,p=eC(e,kM),g=mm(u,{relative:p.relative}),I=Ll(),A=D.useContext(KR),{navigator:C,basename:N}=D.useContext(Ki),P=A!=null&&UM(g)&&h===!0,R=C.encodeLocation?C.encodeLocation(g).pathname:g.pathname,x=I.pathname,O=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;i||(x=x.toLowerCase(),O=O?O.toLowerCase():null,R=R.toLowerCase()),O&&N&&(O=yl(O,N)||O);const M=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let $=x===R||!o&&x.startsWith(R)&&x.charAt(M)==="/",v=O!=null&&(O===R||!o&&O.startsWith(R)&&O.charAt(R.length)==="/"),y={isActive:$,isPending:v,isTransitioning:P},_=$?r:void 0,E;typeof s=="function"?E=s(y):E=[s,$?"active":null,v?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let S=typeof l=="function"?l(y):l;return D.createElement(LM,cp({},p,{"aria-current":_,className:E,ref:n,style:S,to:u,viewTransition:h}),typeof f=="function"?f(y):f)});var Z_;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Z_||(Z_={}));var cI;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(cI||(cI={}));function FM(t){let e=D.useContext(fm);return e||Je(!1),e}function jM(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:l}=e===void 0?{}:e,u=YR(),h=Ll(),f=mm(t,{relative:o});return D.useCallback(p=>{if(CM(p,n)){p.preventDefault();let g=r!==void 0?r:up(h)===up(f);u(t,{replace:g,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[h,u,f,r,i,n,t,s,o,l])}function UM(t,e){e===void 0&&(e={});let n=D.useContext(NM);n==null&&Je(!1);let{basename:r}=FM(Z_.useViewTransitionState),i=mm(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=yl(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=yl(n.nextLocation.pathname,r)||n.nextLocation.pathname;return X_(i.pathname,o)!=null||X_(i.pathname,s)!=null}const BM=()=>{};var hI={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},zM=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],l=t[n++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},nC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,l=o?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let g=(l&15)<<2|h>>6,I=h&63;u||(I=64,o||(g=64)),r.push(n[f],n[p],n[g],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(tC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):zM(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const h=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||h==null||p==null)throw new qM;const g=s<<2|l>>4;if(r.push(g),h!==64){const I=l<<4&240|h>>2;if(r.push(I),p!==64){const A=h<<6&192|p;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let qM=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const WM=function(t){const e=tC(t);return nC.encodeByteArray(e,!0)},hp=function(t){return WM(t).replace(/\./g,"")},rC=function(t){try{return nC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=()=>HM().__FIREBASE_DEFAULTS__,GM=()=>{if(typeof process>"u"||typeof hI>"u")return;const t=hI.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},QM=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&rC(t[1]);return e&&JSON.parse(e)},gm=()=>{try{return BM()||KM()||GM()||QM()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},iC=t=>{var e,n;return(n=(e=gm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},sC=t=>{const e=iC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},oC=()=>{var t;return(t=gm())===null||t===void 0?void 0:t.config},aC=t=>{var e;return(e=gm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function oE(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[hp(JSON.stringify(n)),hp(JSON.stringify(o)),""].join(".")}const Fc={};function JM(){const t={prod:[],emulator:[]};for(const e of Object.keys(Fc))Fc[e]?t.emulator.push(e):t.prod.push(e);return t}function ZM(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let dI=!1;function aE(t,e){if(typeof window>"u"||typeof document>"u"||!ca(window.location.host)||Fc[t]===e||Fc[t]||dI)return;Fc[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=JM().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,I){g.setAttribute("width","24"),g.setAttribute("id",I),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{dI=!0,o()},g}function f(g,I){g.setAttribute("id",I),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=ZM(r),I=n("text"),A=document.getElementById(I)||document.createElement("span"),C=n("learnmore"),N=document.getElementById(C)||document.createElement("a"),P=n("preprendIcon"),R=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const x=g.element;l(x),f(N,C);const O=h();u(R,P),x.append(R,A,N,O),document.body.appendChild(x)}s?(A.innerText="Preview backend disconnected.",R.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(R.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xt())}function tL(){var t;const e=(t=gm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rL(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function iL(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sL(){const t=Xt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function oL(){return!tL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function lC(){try{return typeof indexedDB=="object"}catch{return!1}}function uC(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function aL(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL="FirebaseError";let Qs=class cC extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=lL,Object.setPrototypeOf(this,cC.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ha.prototype.create)}},ha=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?uL(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Qs(i,l,r)}};function uL(t,e){return t.replace(cL,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const cL=/\{\$([^}]+)}/g;function hL(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Yo(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(fI(s)&&fI(o)){if(!Yo(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function fI(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function dL(t,e){const n=new fL(t,e);return n.subscribe.bind(n)}let fL=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");pL(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Ey),i.error===void 0&&(i.error=Ey),i.complete===void 0&&(i.complete=Ey);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function pL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ey(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(t){return t&&t._delegate?t._delegate:t}let Xn=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new YM;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yL(e))try{this.getOrInitializeService({instanceIdentifier:Io})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Io){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Io){return this.instances.has(e)}getOptions(e=Io){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:gL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Io){return this.component?this.component.multipleInstances?e:Io:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gL(t){return t===Io?void 0:t}function yL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new mL(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const vL={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},wL=ye.INFO,EL={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},TL=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=EL[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let lE=class{constructor(e){this.name=e,this._logLevel=wL,this._logHandler=TL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}};const IL=(t,e)=>e.some(n=>t instanceof n);let pI,mI;function AL(){return pI||(pI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SL(){return mI||(mI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const hC=new WeakMap,ev=new WeakMap,dC=new WeakMap,Ty=new WeakMap,uE=new WeakMap;function PL(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Ai(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&hC.set(n,t)}).catch(()=>{}),uE.set(e,t),e}function RL(t){if(ev.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});ev.set(t,e)}let tv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ev.get(t);if(e==="objectStoreNames")return t.objectStoreNames||dC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ai(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function CL(t){tv=t(tv)}function bL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Iy(this),e,...n);return dC.set(r,e.sort?e.sort():[e]),Ai(r)}:SL().includes(t)?function(...e){return t.apply(Iy(this),e),Ai(hC.get(this))}:function(...e){return Ai(t.apply(Iy(this),e))}}function kL(t){return typeof t=="function"?bL(t):(t instanceof IDBTransaction&&RL(t),IL(t,AL())?new Proxy(t,tv):t)}function Ai(t){if(t instanceof IDBRequest)return PL(t);if(Ty.has(t))return Ty.get(t);const e=kL(t);return e!==t&&(Ty.set(t,e),uE.set(e,t)),e}const Iy=t=>uE.get(t);function Xh(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),l=Ai(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Ai(o.result),u.oldVersion,u.newVersion,Ai(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}function Ay(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Ai(n).then(()=>{})}const xL=["get","getKey","getAll","getAllKeys","count"],NL=["put","add","delete","clear"],Sy=new Map;function gI(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Sy.get(e))return Sy.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=NL.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||xL.includes(n)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),i&&u.done]))[0]};return Sy.set(e,s),s}CL(t=>({...t,get:(e,n,r)=>gI(e,n)||t.get(e,n,r),has:(e,n)=>!!gI(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DL=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(VL(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function VL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const nv="@firebase/app",yI="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi=new lE("@firebase/app"),OL="@firebase/app-compat",ML="@firebase/analytics-compat",LL="@firebase/analytics",$L="@firebase/app-check-compat",FL="@firebase/app-check",jL="@firebase/auth",UL="@firebase/auth-compat",BL="@firebase/database",zL="@firebase/data-connect",qL="@firebase/database-compat",WL="@firebase/functions",HL="@firebase/functions-compat",KL="@firebase/installations",GL="@firebase/installations-compat",QL="@firebase/messaging",YL="@firebase/messaging-compat",XL="@firebase/performance",JL="@firebase/performance-compat",ZL="@firebase/remote-config",e$="@firebase/remote-config-compat",t$="@firebase/storage",n$="@firebase/storage-compat",r$="@firebase/firestore",i$="@firebase/ai",s$="@firebase/firestore-compat",o$="firebase",a$="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="[DEFAULT]",l$={[nv]:"fire-core",[OL]:"fire-core-compat",[LL]:"fire-analytics",[ML]:"fire-analytics-compat",[FL]:"fire-app-check",[$L]:"fire-app-check-compat",[jL]:"fire-auth",[UL]:"fire-auth-compat",[BL]:"fire-rtdb",[zL]:"fire-data-connect",[qL]:"fire-rtdb-compat",[WL]:"fire-fn",[HL]:"fire-fn-compat",[KL]:"fire-iid",[GL]:"fire-iid-compat",[QL]:"fire-fcm",[YL]:"fire-fcm-compat",[XL]:"fire-perf",[JL]:"fire-perf-compat",[ZL]:"fire-rc",[e$]:"fire-rc-compat",[t$]:"fire-gcs",[n$]:"fire-gcs-compat",[r$]:"fire-fst",[s$]:"fire-fst-compat",[i$]:"fire-vertex","fire-js":"fire-js",[o$]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th=new Map,u$=new Map,iv=new Map;function _I(t,e){try{t.container.addComponent(e)}catch(n){Vi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Sr(t){const e=t.name;if(iv.has(e))return Vi.debug(`There were multiple attempts to register component ${e}.`),!1;iv.set(e,t);for(const n of Th.values())_I(n,t);for(const n of u$.values())_I(n,t);return!0}function da(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function _r(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c$={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ps=new ha("app","Firebase",c$);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h${constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ps.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l=a$;function fC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:rv,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw Ps.create("bad-app-name",{appName:String(i)});if(n||(n=oC()),!n)throw Ps.create("no-options");const s=Th.get(i);if(s){if(Yo(n,s.options)&&Yo(r,s.config))return s;throw Ps.create("duplicate-app",{appName:i})}const o=new _L(i);for(const u of iv.values())o.addComponent(u);const l=new h$(n,r,o);return Th.set(i,l),l}function ym(t=rv){const e=Th.get(t);if(!e&&t===rv&&oC())return fC();if(!e)throw Ps.create("no-app",{appName:t});return e}function d$(){return Array.from(Th.values())}function En(t,e,n){var r;let i=(r=l$[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vi.warn(l.join(" "));return}Sr(new Xn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f$="firebase-heartbeat-database",p$=1,Ih="firebase-heartbeat-store";let Py=null;function pC(){return Py||(Py=Xh(f$,p$,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ih)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ps.create("idb-open",{originalErrorMessage:t.message})})),Py}async function m$(t){try{const n=(await pC()).transaction(Ih),r=await n.objectStore(Ih).get(mC(t));return await n.done,r}catch(e){if(e instanceof Qs)Vi.warn(e.message);else{const n=Ps.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Vi.warn(n.message)}}}async function vI(t,e){try{const r=(await pC()).transaction(Ih,"readwrite");await r.objectStore(Ih).put(e,mC(t)),await r.done}catch(n){if(n instanceof Qs)Vi.warn(n.message);else{const r=Ps.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Vi.warn(r.message)}}}function mC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g$=1024,y$=30;let _$=class{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new w$(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=wI();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>y$){const o=E$(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Vi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=wI(),{heartbeatsToSend:r,unsentEntries:i}=v$(this._heartbeatsCache.heartbeats),s=hp(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Vi.warn(n),""}}};function wI(){return new Date().toISOString().substring(0,10)}function v$(t,e=g$){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),EI(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),EI(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}let w$=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return lC()?uC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await m$(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return vI(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return vI(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function EI(t){return hp(JSON.stringify({version:2,heartbeats:t})).length}function E$(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T$(t){Sr(new Xn("platform-logger",e=>new DL(e),"PRIVATE")),Sr(new Xn("heartbeat",e=>new _$(e),"PRIVATE")),En(nv,yI,t),En(nv,yI,"esm2017"),En("fire-js","")}T$("");var I$="firebase",A$="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */En(I$,A$,"app");var TI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rs,gC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,y){function _(){}_.prototype=y.prototype,v.D=y.prototype,v.prototype=new _,v.prototype.constructor=v,v.C=function(E,S,b){for(var w=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)w[Te-2]=arguments[Te];return y.prototype[S].apply(E,w)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,y,_){_||(_=0);var E=Array(16);if(typeof y=="string")for(var S=0;16>S;++S)E[S]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(S=0;16>S;++S)E[S]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=v.g[0],_=v.g[1],S=v.g[2];var b=v.g[3],w=y+(b^_&(S^b))+E[0]+3614090360&4294967295;y=_+(w<<7&4294967295|w>>>25),w=b+(S^y&(_^S))+E[1]+3905402710&4294967295,b=y+(w<<12&4294967295|w>>>20),w=S+(_^b&(y^_))+E[2]+606105819&4294967295,S=b+(w<<17&4294967295|w>>>15),w=_+(y^S&(b^y))+E[3]+3250441966&4294967295,_=S+(w<<22&4294967295|w>>>10),w=y+(b^_&(S^b))+E[4]+4118548399&4294967295,y=_+(w<<7&4294967295|w>>>25),w=b+(S^y&(_^S))+E[5]+1200080426&4294967295,b=y+(w<<12&4294967295|w>>>20),w=S+(_^b&(y^_))+E[6]+2821735955&4294967295,S=b+(w<<17&4294967295|w>>>15),w=_+(y^S&(b^y))+E[7]+4249261313&4294967295,_=S+(w<<22&4294967295|w>>>10),w=y+(b^_&(S^b))+E[8]+1770035416&4294967295,y=_+(w<<7&4294967295|w>>>25),w=b+(S^y&(_^S))+E[9]+2336552879&4294967295,b=y+(w<<12&4294967295|w>>>20),w=S+(_^b&(y^_))+E[10]+4294925233&4294967295,S=b+(w<<17&4294967295|w>>>15),w=_+(y^S&(b^y))+E[11]+2304563134&4294967295,_=S+(w<<22&4294967295|w>>>10),w=y+(b^_&(S^b))+E[12]+1804603682&4294967295,y=_+(w<<7&4294967295|w>>>25),w=b+(S^y&(_^S))+E[13]+4254626195&4294967295,b=y+(w<<12&4294967295|w>>>20),w=S+(_^b&(y^_))+E[14]+2792965006&4294967295,S=b+(w<<17&4294967295|w>>>15),w=_+(y^S&(b^y))+E[15]+1236535329&4294967295,_=S+(w<<22&4294967295|w>>>10),w=y+(S^b&(_^S))+E[1]+4129170786&4294967295,y=_+(w<<5&4294967295|w>>>27),w=b+(_^S&(y^_))+E[6]+3225465664&4294967295,b=y+(w<<9&4294967295|w>>>23),w=S+(y^_&(b^y))+E[11]+643717713&4294967295,S=b+(w<<14&4294967295|w>>>18),w=_+(b^y&(S^b))+E[0]+3921069994&4294967295,_=S+(w<<20&4294967295|w>>>12),w=y+(S^b&(_^S))+E[5]+3593408605&4294967295,y=_+(w<<5&4294967295|w>>>27),w=b+(_^S&(y^_))+E[10]+38016083&4294967295,b=y+(w<<9&4294967295|w>>>23),w=S+(y^_&(b^y))+E[15]+3634488961&4294967295,S=b+(w<<14&4294967295|w>>>18),w=_+(b^y&(S^b))+E[4]+3889429448&4294967295,_=S+(w<<20&4294967295|w>>>12),w=y+(S^b&(_^S))+E[9]+568446438&4294967295,y=_+(w<<5&4294967295|w>>>27),w=b+(_^S&(y^_))+E[14]+3275163606&4294967295,b=y+(w<<9&4294967295|w>>>23),w=S+(y^_&(b^y))+E[3]+4107603335&4294967295,S=b+(w<<14&4294967295|w>>>18),w=_+(b^y&(S^b))+E[8]+1163531501&4294967295,_=S+(w<<20&4294967295|w>>>12),w=y+(S^b&(_^S))+E[13]+2850285829&4294967295,y=_+(w<<5&4294967295|w>>>27),w=b+(_^S&(y^_))+E[2]+4243563512&4294967295,b=y+(w<<9&4294967295|w>>>23),w=S+(y^_&(b^y))+E[7]+1735328473&4294967295,S=b+(w<<14&4294967295|w>>>18),w=_+(b^y&(S^b))+E[12]+2368359562&4294967295,_=S+(w<<20&4294967295|w>>>12),w=y+(_^S^b)+E[5]+4294588738&4294967295,y=_+(w<<4&4294967295|w>>>28),w=b+(y^_^S)+E[8]+2272392833&4294967295,b=y+(w<<11&4294967295|w>>>21),w=S+(b^y^_)+E[11]+1839030562&4294967295,S=b+(w<<16&4294967295|w>>>16),w=_+(S^b^y)+E[14]+4259657740&4294967295,_=S+(w<<23&4294967295|w>>>9),w=y+(_^S^b)+E[1]+2763975236&4294967295,y=_+(w<<4&4294967295|w>>>28),w=b+(y^_^S)+E[4]+1272893353&4294967295,b=y+(w<<11&4294967295|w>>>21),w=S+(b^y^_)+E[7]+4139469664&4294967295,S=b+(w<<16&4294967295|w>>>16),w=_+(S^b^y)+E[10]+3200236656&4294967295,_=S+(w<<23&4294967295|w>>>9),w=y+(_^S^b)+E[13]+681279174&4294967295,y=_+(w<<4&4294967295|w>>>28),w=b+(y^_^S)+E[0]+3936430074&4294967295,b=y+(w<<11&4294967295|w>>>21),w=S+(b^y^_)+E[3]+3572445317&4294967295,S=b+(w<<16&4294967295|w>>>16),w=_+(S^b^y)+E[6]+76029189&4294967295,_=S+(w<<23&4294967295|w>>>9),w=y+(_^S^b)+E[9]+3654602809&4294967295,y=_+(w<<4&4294967295|w>>>28),w=b+(y^_^S)+E[12]+3873151461&4294967295,b=y+(w<<11&4294967295|w>>>21),w=S+(b^y^_)+E[15]+530742520&4294967295,S=b+(w<<16&4294967295|w>>>16),w=_+(S^b^y)+E[2]+3299628645&4294967295,_=S+(w<<23&4294967295|w>>>9),w=y+(S^(_|~b))+E[0]+4096336452&4294967295,y=_+(w<<6&4294967295|w>>>26),w=b+(_^(y|~S))+E[7]+1126891415&4294967295,b=y+(w<<10&4294967295|w>>>22),w=S+(y^(b|~_))+E[14]+2878612391&4294967295,S=b+(w<<15&4294967295|w>>>17),w=_+(b^(S|~y))+E[5]+4237533241&4294967295,_=S+(w<<21&4294967295|w>>>11),w=y+(S^(_|~b))+E[12]+1700485571&4294967295,y=_+(w<<6&4294967295|w>>>26),w=b+(_^(y|~S))+E[3]+2399980690&4294967295,b=y+(w<<10&4294967295|w>>>22),w=S+(y^(b|~_))+E[10]+4293915773&4294967295,S=b+(w<<15&4294967295|w>>>17),w=_+(b^(S|~y))+E[1]+2240044497&4294967295,_=S+(w<<21&4294967295|w>>>11),w=y+(S^(_|~b))+E[8]+1873313359&4294967295,y=_+(w<<6&4294967295|w>>>26),w=b+(_^(y|~S))+E[15]+4264355552&4294967295,b=y+(w<<10&4294967295|w>>>22),w=S+(y^(b|~_))+E[6]+2734768916&4294967295,S=b+(w<<15&4294967295|w>>>17),w=_+(b^(S|~y))+E[13]+1309151649&4294967295,_=S+(w<<21&4294967295|w>>>11),w=y+(S^(_|~b))+E[4]+4149444226&4294967295,y=_+(w<<6&4294967295|w>>>26),w=b+(_^(y|~S))+E[11]+3174756917&4294967295,b=y+(w<<10&4294967295|w>>>22),w=S+(y^(b|~_))+E[2]+718787259&4294967295,S=b+(w<<15&4294967295|w>>>17),w=_+(b^(S|~y))+E[9]+3951481745&4294967295,v.g[0]=v.g[0]+y&4294967295,v.g[1]=v.g[1]+(S+(w<<21&4294967295|w>>>11))&4294967295,v.g[2]=v.g[2]+S&4294967295,v.g[3]=v.g[3]+b&4294967295}r.prototype.u=function(v,y){y===void 0&&(y=v.length);for(var _=y-this.blockSize,E=this.B,S=this.h,b=0;b<y;){if(S==0)for(;b<=_;)i(this,v,b),b+=this.blockSize;if(typeof v=="string"){for(;b<y;)if(E[S++]=v.charCodeAt(b++),S==this.blockSize){i(this,E),S=0;break}}else for(;b<y;)if(E[S++]=v[b++],S==this.blockSize){i(this,E),S=0;break}}this.h=S,this.o+=y},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var y=1;y<v.length-8;++y)v[y]=0;var _=8*this.o;for(y=v.length-8;y<v.length;++y)v[y]=_&255,_/=256;for(this.u(v),v=Array(16),y=_=0;4>y;++y)for(var E=0;32>E;E+=8)v[_++]=this.g[y]>>>E&255;return v};function s(v,y){var _=l;return Object.prototype.hasOwnProperty.call(_,v)?_[v]:_[v]=y(v)}function o(v,y){this.h=y;for(var _=[],E=!0,S=v.length-1;0<=S;S--){var b=v[S]|0;E&&b==y||(_[S]=b,E=!1)}this.g=_}var l={};function u(v){return-128<=v&&128>v?s(v,function(y){return new o([y|0],0>y?-1:0)}):new o([v|0],0>v?-1:0)}function h(v){if(isNaN(v)||!isFinite(v))return p;if(0>v)return N(h(-v));for(var y=[],_=1,E=0;v>=_;E++)y[E]=v/_|0,_*=4294967296;return new o(y,0)}function f(v,y){if(v.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(v.charAt(0)=="-")return N(f(v.substring(1),y));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=h(Math.pow(y,8)),E=p,S=0;S<v.length;S+=8){var b=Math.min(8,v.length-S),w=parseInt(v.substring(S,S+b),y);8>b?(b=h(Math.pow(y,b)),E=E.j(b).add(h(w))):(E=E.j(_),E=E.add(h(w)))}return E}var p=u(0),g=u(1),I=u(16777216);t=o.prototype,t.m=function(){if(C(this))return-N(this).m();for(var v=0,y=1,_=0;_<this.g.length;_++){var E=this.i(_);v+=(0<=E?E:4294967296+E)*y,y*=4294967296}return v},t.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(A(this))return"0";if(C(this))return"-"+N(this).toString(v);for(var y=h(Math.pow(v,6)),_=this,E="";;){var S=O(_,y).g;_=P(_,S.j(y));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(v);if(_=S,A(_))return b+E;for(;6>b.length;)b="0"+b;E=b+E}},t.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function A(v){if(v.h!=0)return!1;for(var y=0;y<v.g.length;y++)if(v.g[y]!=0)return!1;return!0}function C(v){return v.h==-1}t.l=function(v){return v=P(this,v),C(v)?-1:A(v)?0:1};function N(v){for(var y=v.g.length,_=[],E=0;E<y;E++)_[E]=~v.g[E];return new o(_,~v.h).add(g)}t.abs=function(){return C(this)?N(this):this},t.add=function(v){for(var y=Math.max(this.g.length,v.g.length),_=[],E=0,S=0;S<=y;S++){var b=E+(this.i(S)&65535)+(v.i(S)&65535),w=(b>>>16)+(this.i(S)>>>16)+(v.i(S)>>>16);E=w>>>16,b&=65535,w&=65535,_[S]=w<<16|b}return new o(_,_[_.length-1]&-2147483648?-1:0)};function P(v,y){return v.add(N(y))}t.j=function(v){if(A(this)||A(v))return p;if(C(this))return C(v)?N(this).j(N(v)):N(N(this).j(v));if(C(v))return N(this.j(N(v)));if(0>this.l(I)&&0>v.l(I))return h(this.m()*v.m());for(var y=this.g.length+v.g.length,_=[],E=0;E<2*y;E++)_[E]=0;for(E=0;E<this.g.length;E++)for(var S=0;S<v.g.length;S++){var b=this.i(E)>>>16,w=this.i(E)&65535,Te=v.i(S)>>>16,Oe=v.i(S)&65535;_[2*E+2*S]+=w*Oe,R(_,2*E+2*S),_[2*E+2*S+1]+=b*Oe,R(_,2*E+2*S+1),_[2*E+2*S+1]+=w*Te,R(_,2*E+2*S+1),_[2*E+2*S+2]+=b*Te,R(_,2*E+2*S+2)}for(E=0;E<y;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=y;E<2*y;E++)_[E]=0;return new o(_,0)};function R(v,y){for(;(v[y]&65535)!=v[y];)v[y+1]+=v[y]>>>16,v[y]&=65535,y++}function x(v,y){this.g=v,this.h=y}function O(v,y){if(A(y))throw Error("division by zero");if(A(v))return new x(p,p);if(C(v))return y=O(N(v),y),new x(N(y.g),N(y.h));if(C(y))return y=O(v,N(y)),new x(N(y.g),y.h);if(30<v.g.length){if(C(v)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var _=g,E=y;0>=E.l(v);)_=M(_),E=M(E);var S=$(_,1),b=$(E,1);for(E=$(E,2),_=$(_,2);!A(E);){var w=b.add(E);0>=w.l(v)&&(S=S.add(_),b=w),E=$(E,1),_=$(_,1)}return y=P(v,S.j(y)),new x(S,y)}for(S=p;0<=v.l(y);){for(_=Math.max(1,Math.floor(v.m()/y.m())),E=Math.ceil(Math.log(_)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),b=h(_),w=b.j(y);C(w)||0<w.l(v);)_-=E,b=h(_),w=b.j(y);A(b)&&(b=g),S=S.add(b),v=P(v,w)}return new x(S,v)}t.A=function(v){return O(this,v).h},t.and=function(v){for(var y=Math.max(this.g.length,v.g.length),_=[],E=0;E<y;E++)_[E]=this.i(E)&v.i(E);return new o(_,this.h&v.h)},t.or=function(v){for(var y=Math.max(this.g.length,v.g.length),_=[],E=0;E<y;E++)_[E]=this.i(E)|v.i(E);return new o(_,this.h|v.h)},t.xor=function(v){for(var y=Math.max(this.g.length,v.g.length),_=[],E=0;E<y;E++)_[E]=this.i(E)^v.i(E);return new o(_,this.h^v.h)};function M(v){for(var y=v.g.length+1,_=[],E=0;E<y;E++)_[E]=v.i(E)<<1|v.i(E-1)>>>31;return new o(_,v.h)}function $(v,y){var _=y>>5;y%=32;for(var E=v.g.length-_,S=[],b=0;b<E;b++)S[b]=0<y?v.i(b+_)>>>y|v.i(b+_+1)<<32-y:v.i(b+_);return new o(S,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,gC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,Rs=o}).apply(typeof TI<"u"?TI:typeof self<"u"?self:typeof window<"u"?window:{});var Ud=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yC,pc,_C,mf,sv,vC,wC,EC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,c,d){return a==Array.prototype||a==Object.prototype||(a[c]=d.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ud=="object"&&Ud];for(var c=0;c<a.length;++c){var d=a[c];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=n(this);function i(a,c){if(c)e:{var d=r;a=a.split(".");for(var m=0;m<a.length-1;m++){var k=a[m];if(!(k in d))break e;d=d[k]}a=a[a.length-1],m=d[a],c=c(m),c!=m&&c!=null&&e(d,a,{configurable:!0,writable:!0,value:c})}}function s(a,c){a instanceof String&&(a+="");var d=0,m=!1,k={next:function(){if(!m&&d<a.length){var V=d++;return{value:c(V,a[V]),done:!1}}return m=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}i("Array.prototype.values",function(a){return a||function(){return s(this,function(c,d){return d})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var c=typeof a;return c=c!="object"?c:a?Array.isArray(a)?"array":c:"null",c=="array"||c=="object"&&typeof a.length=="number"}function h(a){var c=typeof a;return c=="object"&&a!=null||c=="function"}function f(a,c,d){return a.call.apply(a.bind,arguments)}function p(a,c,d){if(!a)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,m),a.apply(c,k)}}return function(){return a.apply(c,arguments)}}function g(a,c,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function I(a,c){var d=Array.prototype.slice.call(arguments,1);return function(){var m=d.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function A(a,c){function d(){}d.prototype=c.prototype,a.aa=c.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(m,k,V){for(var L=Array(arguments.length-2),te=2;te<arguments.length;te++)L[te-2]=arguments[te];return c.prototype[k].apply(m,L)}}function C(a){const c=a.length;if(0<c){const d=Array(c);for(let m=0;m<c;m++)d[m]=a[m];return d}return[]}function N(a,c){for(let d=1;d<arguments.length;d++){const m=arguments[d];if(u(m)){const k=a.length||0,V=m.length||0;a.length=k+V;for(let L=0;L<V;L++)a[k+L]=m[L]}else a.push(m)}}class P{constructor(c,d){this.i=c,this.j=d,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function R(a){return/^[\s\xa0]*$/.test(a)}function x(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function O(a){return O[" "](a),a}O[" "]=function(){};var M=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function $(a,c,d){for(const m in a)c.call(d,a[m],m,a)}function v(a,c){for(const d in a)c.call(void 0,a[d],d,a)}function y(a){const c={};for(const d in a)c[d]=a[d];return c}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(a,c){let d,m;for(let k=1;k<arguments.length;k++){m=arguments[k];for(d in m)a[d]=m[d];for(let V=0;V<_.length;V++)d=_[V],Object.prototype.hasOwnProperty.call(m,d)&&(a[d]=m[d])}}function S(a){var c=1;a=a.split(":");const d=[];for(;0<c&&a.length;)d.push(a.shift()),c--;return a.length&&d.push(a.join(":")),d}function b(a){l.setTimeout(()=>{throw a},0)}function w(){var a=G;let c=null;return a.g&&(c=a.g,a.g=a.g.next,a.g||(a.h=null),c.next=null),c}class Te{constructor(){this.h=this.g=null}add(c,d){const m=Oe.get();m.set(c,d),this.h?this.h.next=m:this.g=m,this.h=m}}var Oe=new P(()=>new jt,a=>a.reset());class jt{constructor(){this.next=this.g=this.h=null}set(c,d){this.h=c,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Ue,U=!1,G=new Te,B=()=>{const a=l.Promise.resolve(void 0);Ue=()=>{a.then(Z)}};var Z=()=>{for(var a;a=w();){try{a.h.call(a.g)}catch(d){b(d)}var c=Oe;c.j(a),100>c.h&&(c.h++,a.next=c.g,c.g=a)}U=!1};function oe(){this.s=this.s,this.C=this.C}oe.prototype.s=!1,oe.prototype.ma=function(){this.s||(this.s=!0,this.N())},oe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(a,c){this.type=a,this.g=this.target=c,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var He=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,c=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const d=()=>{};l.addEventListener("test",d,c),l.removeEventListener("test",d,c)}catch{}return a}();function Ie(a,c){if(H.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=c,c=a.relatedTarget){if(M){e:{try{O(c.nodeName);var k=!0;break e}catch{}k=!1}k||(c=null)}}else d=="mouseover"?c=a.fromElement:d=="mouseout"&&(c=a.toElement);this.relatedTarget=c,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:it[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Ie.aa.h.call(this)}}A(Ie,H);var it={2:"touch",3:"pen",4:"mouse"};Ie.prototype.h=function(){Ie.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var nt="closure_listenable_"+(1e6*Math.random()|0),Pn=0;function cn(a,c,d,m,k){this.listener=a,this.proxy=null,this.src=c,this.type=d,this.capture=!!m,this.ha=k,this.key=++Pn,this.da=this.fa=!1}function hn(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function dn(a){this.src=a,this.g={},this.h=0}dn.prototype.add=function(a,c,d,m,k){var V=a.toString();a=this.g[V],a||(a=this.g[V]=[],this.h++);var L=Js(a,c,m,k);return-1<L?(c=a[L],d||(c.fa=!1)):(c=new cn(c,this.src,V,!!m,k),c.fa=d,a.push(c)),c};function Gr(a,c){var d=c.type;if(d in a.g){var m=a.g[d],k=Array.prototype.indexOf.call(m,c,void 0),V;(V=0<=k)&&Array.prototype.splice.call(m,k,1),V&&(hn(c),a.g[d].length==0&&(delete a.g[d],a.h--))}}function Js(a,c,d,m){for(var k=0;k<a.length;++k){var V=a[k];if(!V.da&&V.listener==c&&V.capture==!!d&&V.ha==m)return k}return-1}var Zs="closure_lm_"+(1e6*Math.random()|0),eo={};function Jl(a,c,d,m,k){if(Array.isArray(c)){for(var V=0;V<c.length;V++)Jl(a,c[V],d,m,k);return null}return d=tu(d),a&&a[nt]?a.K(c,d,h(m)?!!m.capture:!1,k):vg(a,c,d,!1,m,k)}function vg(a,c,d,m,k,V){if(!c)throw Error("Invalid event type");var L=h(k)?!!k.capture:!!k,te=no(a);if(te||(a[Zs]=te=new dn(a)),d=te.add(c,d,m,L,V),d.proxy)return d;if(m=wg(),d.proxy=m,m.src=a,m.listener=d,a.addEventListener)He||(k=L),k===void 0&&(k=!1),a.addEventListener(c.toString(),m,k);else if(a.attachEvent)a.attachEvent(eu(c.toString()),m);else if(a.addListener&&a.removeListener)a.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return d}function wg(){function a(d){return c.call(a.src,a.listener,d)}const c=Eg;return a}function Zl(a,c,d,m,k){if(Array.isArray(c))for(var V=0;V<c.length;V++)Zl(a,c[V],d,m,k);else m=h(m)?!!m.capture:!!m,d=tu(d),a&&a[nt]?(a=a.i,c=String(c).toString(),c in a.g&&(V=a.g[c],d=Js(V,d,m,k),-1<d&&(hn(V[d]),Array.prototype.splice.call(V,d,1),V.length==0&&(delete a.g[c],a.h--)))):a&&(a=no(a))&&(c=a.g[c.toString()],a=-1,c&&(a=Js(c,d,m,k)),(d=-1<a?c[a]:null)&&to(d))}function to(a){if(typeof a!="number"&&a&&!a.da){var c=a.src;if(c&&c[nt])Gr(c.i,a);else{var d=a.type,m=a.proxy;c.removeEventListener?c.removeEventListener(d,m,a.capture):c.detachEvent?c.detachEvent(eu(d),m):c.addListener&&c.removeListener&&c.removeListener(m),(d=no(c))?(Gr(d,a),d.h==0&&(d.src=null,c[Zs]=null)):hn(a)}}}function eu(a){return a in eo?eo[a]:eo[a]="on"+a}function Eg(a,c){if(a.da)a=!0;else{c=new Ie(c,this);var d=a.listener,m=a.ha||a.src;a.fa&&to(a),a=d.call(m,c)}return a}function no(a){return a=a[Zs],a instanceof dn?a:null}var ro="__closure_events_fn_"+(1e9*Math.random()>>>0);function tu(a){return typeof a=="function"?a:(a[ro]||(a[ro]=function(c){return a.handleEvent(c)}),a[ro])}function Re(){oe.call(this),this.i=new dn(this),this.M=this,this.F=null}A(Re,oe),Re.prototype[nt]=!0,Re.prototype.removeEventListener=function(a,c,d,m){Zl(this,a,c,d,m)};function De(a,c){var d,m=a.F;if(m)for(d=[];m;m=m.F)d.push(m);if(a=a.M,m=c.type||c,typeof c=="string")c=new H(c,a);else if(c instanceof H)c.target=c.target||a;else{var k=c;c=new H(m,a),E(c,k)}if(k=!0,d)for(var V=d.length-1;0<=V;V--){var L=c.g=d[V];k=Qr(L,m,!0,c)&&k}if(L=c.g=a,k=Qr(L,m,!0,c)&&k,k=Qr(L,m,!1,c)&&k,d)for(V=0;V<d.length;V++)L=c.g=d[V],k=Qr(L,m,!1,c)&&k}Re.prototype.N=function(){if(Re.aa.N.call(this),this.i){var a=this.i,c;for(c in a.g){for(var d=a.g[c],m=0;m<d.length;m++)hn(d[m]);delete a.g[c],a.h--}}this.F=null},Re.prototype.K=function(a,c,d,m){return this.i.add(String(a),c,!1,d,m)},Re.prototype.L=function(a,c,d,m){return this.i.add(String(a),c,!0,d,m)};function Qr(a,c,d,m){if(c=a.i.g[String(c)],!c)return!0;c=c.concat();for(var k=!0,V=0;V<c.length;++V){var L=c[V];if(L&&!L.da&&L.capture==d){var te=L.listener,we=L.ha||L.src;L.fa&&Gr(a.i,L),k=te.call(we,m)!==!1&&k}}return k&&!m.defaultPrevented}function nu(a,c,d){if(typeof a=="function")d&&(a=g(a,d));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(a,c||0)}function ru(a){a.g=nu(()=>{a.g=null,a.i&&(a.i=!1,ru(a))},a.l);const c=a.h;a.h=null,a.m.apply(null,c)}class Tg extends oe{constructor(c,d){super(),this.m=c,this.l=d,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:ru(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function er(a){oe.call(this),this.h=a,this.g={}}A(er,oe);var iu=[];function su(a){$(a.g,function(c,d){this.g.hasOwnProperty(d)&&to(c)},a),a.g={}}er.prototype.N=function(){er.aa.N.call(this),su(this)},er.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var io=l.JSON.stringify,Ig=l.JSON.parse,Ag=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function so(){}so.prototype.h=null;function ou(a){return a.h||(a.h=a.i())}function au(){}var tr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function oo(){H.call(this,"d")}A(oo,H);function ao(){H.call(this,"c")}A(ao,H);var Zt={},lu=null;function Yr(){return lu=lu||new Re}Zt.La="serverreachability";function uu(a){H.call(this,Zt.La,a)}A(uu,H);function nr(a){const c=Yr();De(c,new uu(c))}Zt.STAT_EVENT="statevent";function cu(a,c){H.call(this,Zt.STAT_EVENT,a),this.stat=c}A(cu,H);function Ve(a){const c=Yr();De(c,new cu(c,a))}Zt.Ma="timingevent";function hu(a,c){H.call(this,Zt.Ma,a),this.size=c}A(hu,H);function rr(a,c){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},c)}function ir(){this.g=!0}ir.prototype.xa=function(){this.g=!1};function Sg(a,c,d,m,k,V){a.info(function(){if(a.g)if(V)for(var L="",te=V.split("&"),we=0;we<te.length;we++){var J=te[we].split("=");if(1<J.length){var Ce=J[0];J=J[1];var be=Ce.split("_");L=2<=be.length&&be[1]=="type"?L+(Ce+"="+J+"&"):L+(Ce+"=redacted&")}}else L=null;else L=V;return"XMLHTTP REQ ("+m+") [attempt "+k+"]: "+c+`
`+d+`
`+L})}function Pg(a,c,d,m,k,V,L){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+k+"]: "+c+`
`+d+`
`+V+" "+L})}function Rn(a,c,d,m){a.info(function(){return"XMLHTTP TEXT ("+c+"): "+Cg(a,d)+(m?" "+m:"")})}function Rg(a,c){a.info(function(){return"TIMEOUT: "+c})}ir.prototype.info=function(){};function Cg(a,c){if(!a.g)return c;if(!c)return null;try{var d=JSON.parse(c);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var m=d[a];if(!(2>m.length)){var k=m[1];if(Array.isArray(k)&&!(1>k.length)){var V=k[0];if(V!="noop"&&V!="stop"&&V!="close")for(var L=1;L<k.length;L++)k[L]=""}}}}return io(d)}catch{return c}}var Xr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},du={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},lo;function Jr(){}A(Jr,so),Jr.prototype.g=function(){return new XMLHttpRequest},Jr.prototype.i=function(){return{}},lo=new Jr;function bt(a,c,d,m){this.j=a,this.i=c,this.l=d,this.R=m||1,this.U=new er(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new fu}function fu(){this.i=null,this.g="",this.h=!1}var pu={},uo={};function co(a,c,d){a.L=1,a.v=ni(gt(c)),a.m=d,a.P=!0,mu(a,null)}function mu(a,c){a.F=Date.now(),Zr(a),a.A=gt(a.v);var d=a.A,m=a.R;Array.isArray(m)||(m=[String(m)]),bu(d.i,"t",m),a.C=0,d=a.j.J,a.h=new fu,a.g=Ku(a.j,d?c:null,!a.m),0<a.O&&(a.M=new Tg(g(a.Y,a,a.g),a.O)),c=a.U,d=a.g,m=a.ca;var k="readystatechange";Array.isArray(k)||(k&&(iu[0]=k.toString()),k=iu);for(var V=0;V<k.length;V++){var L=Jl(d,k[V],m||c.handleEvent,!1,c.h||c);if(!L)break;c.g[L.key]=L}c=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,c)):(a.u="GET",a.g.ea(a.A,a.u,null,c)),nr(),Sg(a.i,a.u,a.A,a.l,a.R,a.m)}bt.prototype.ca=function(a){a=a.target;const c=this.M;c&&yt(a)==3?c.j():this.Y(a)},bt.prototype.Y=function(a){try{if(a==this.g)e:{const be=yt(this.g);var c=this.g.Ba();const kn=this.g.Z();if(!(3>be)&&(be!=3||this.g&&(this.h.h||this.g.oa()||Mu(this.g)))){this.J||be!=4||c==7||(c==8||0>=kn?nr(3):nr(2)),ho(this);var d=this.g.Z();this.X=d;t:if(gu(this)){var m=Mu(this.g);a="";var k=m.length,V=yt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){en(this),sr(this);var L="";break t}this.h.i=new l.TextDecoder}for(c=0;c<k;c++)this.h.h=!0,a+=this.h.i.decode(m[c],{stream:!(V&&c==k-1)});m.length=0,this.h.g+=a,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=d==200,Pg(this.i,this.u,this.A,this.l,this.R,be,d),this.o){if(this.T&&!this.K){t:{if(this.g){var te,we=this.g;if((te=we.g?we.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(te)){var J=te;break t}}J=null}if(d=J)Rn(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,fo(this,d);else{this.o=!1,this.s=3,Ve(12),en(this),sr(this);break e}}if(this.P){d=!0;let Qe;for(;!this.J&&this.C<L.length;)if(Qe=bg(this,L),Qe==uo){be==4&&(this.s=4,Ve(14),d=!1),Rn(this.i,this.l,null,"[Incomplete Response]");break}else if(Qe==pu){this.s=4,Ve(15),Rn(this.i,this.l,L,"[Invalid Chunk]"),d=!1;break}else Rn(this.i,this.l,Qe,null),fo(this,Qe);if(gu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),be!=4||L.length!=0||this.h.h||(this.s=1,Ve(16),d=!1),this.o=this.o&&d,!d)Rn(this.i,this.l,L,"[Invalid Chunked Response]"),en(this),sr(this);else if(0<L.length&&!this.W){this.W=!0;var Ce=this.j;Ce.g==this&&Ce.ba&&!Ce.M&&(Ce.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),vo(Ce),Ce.M=!0,Ve(11))}}else Rn(this.i,this.l,L,null),fo(this,L);be==4&&en(this),this.o&&!this.J&&(be==4?zu(this.j,this):(this.o=!1,Zr(this)))}else Hg(this.g),d==400&&0<L.indexOf("Unknown SID")?(this.s=3,Ve(12)):(this.s=0,Ve(13)),en(this),sr(this)}}}catch{}finally{}};function gu(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function bg(a,c){var d=a.C,m=c.indexOf(`
`,d);return m==-1?uo:(d=Number(c.substring(d,m)),isNaN(d)?pu:(m+=1,m+d>c.length?uo:(c=c.slice(m,m+d),a.C=m+d,c)))}bt.prototype.cancel=function(){this.J=!0,en(this)};function Zr(a){a.S=Date.now()+a.I,yu(a,a.I)}function yu(a,c){if(a.B!=null)throw Error("WatchDog timer not null");a.B=rr(g(a.ba,a),c)}function ho(a){a.B&&(l.clearTimeout(a.B),a.B=null)}bt.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Rg(this.i,this.A),this.L!=2&&(nr(),Ve(17)),en(this),this.s=2,sr(this)):yu(this,this.S-a)};function sr(a){a.j.G==0||a.J||zu(a.j,a)}function en(a){ho(a);var c=a.M;c&&typeof c.ma=="function"&&c.ma(),a.M=null,su(a.U),a.g&&(c=a.g,a.g=null,c.abort(),c.ma())}function fo(a,c){try{var d=a.j;if(d.G!=0&&(d.g==a||po(d.h,a))){if(!a.K&&po(d.h,a)&&d.G==3){try{var m=d.Da.g.parse(c)}catch{m=null}if(Array.isArray(m)&&m.length==3){var k=m;if(k[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)li(d),oi(d);else break e;_o(d),Ve(18)}}else d.za=k[1],0<d.za-d.T&&37500>k[2]&&d.F&&d.v==0&&!d.C&&(d.C=rr(g(d.Za,d),6e3));if(1>=wu(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else nn(d,11)}else if((a.K||d.g==a)&&li(d),!R(c))for(k=d.Da.g.parse(c),c=0;c<k.length;c++){let J=k[c];if(d.T=J[0],J=J[1],d.G==2)if(J[0]=="c"){d.K=J[1],d.ia=J[2];const Ce=J[3];Ce!=null&&(d.la=Ce,d.j.info("VER="+d.la));const be=J[4];be!=null&&(d.Aa=be,d.j.info("SVER="+d.Aa));const kn=J[5];kn!=null&&typeof kn=="number"&&0<kn&&(m=1.5*kn,d.L=m,d.j.info("backChannelRequestTimeoutMs_="+m)),m=d;const Qe=a.g;if(Qe){const ci=Qe.g?Qe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ci){var V=m.h;V.g||ci.indexOf("spdy")==-1&&ci.indexOf("quic")==-1&&ci.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(mo(V,V.h),V.h=null))}if(m.D){const wo=Qe.g?Qe.g.getResponseHeader("X-HTTP-Session-Id"):null;wo&&(m.ya=wo,ie(m.I,m.D,wo))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),m=d;var L=a;if(m.qa=Hu(m,m.J?m.ia:null,m.W),L.K){Eu(m.h,L);var te=L,we=m.L;we&&(te.I=we),te.B&&(ho(te),Zr(te)),m.g=L}else Uu(m);0<d.i.length&&ai(d)}else J[0]!="stop"&&J[0]!="close"||nn(d,7);else d.G==3&&(J[0]=="stop"||J[0]=="close"?J[0]=="stop"?nn(d,7):yo(d):J[0]!="noop"&&d.l&&d.l.ta(J),d.v=0)}}nr(4)}catch{}}var kg=class{constructor(a,c){this.g=a,this.map=c}};function _u(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function vu(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function wu(a){return a.h?1:a.g?a.g.size:0}function po(a,c){return a.h?a.h==c:a.g?a.g.has(c):!1}function mo(a,c){a.g?a.g.add(c):a.h=c}function Eu(a,c){a.h&&a.h==c?a.h=null:a.g&&a.g.has(c)&&a.g.delete(c)}_u.prototype.cancel=function(){if(this.i=Tu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Tu(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let c=a.i;for(const d of a.g.values())c=c.concat(d.D);return c}return C(a.i)}function xg(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var c=[],d=a.length,m=0;m<d;m++)c.push(a[m]);return c}c=[],d=0;for(m in a)c[d++]=a[m];return c}function Ng(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var c=[];a=a.length;for(var d=0;d<a;d++)c.push(d);return c}c=[],d=0;for(const m in a)c[d++]=m;return c}}}function Iu(a,c){if(a.forEach&&typeof a.forEach=="function")a.forEach(c,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,c,void 0);else for(var d=Ng(a),m=xg(a),k=m.length,V=0;V<k;V++)c.call(void 0,m[V],d&&d[V],a)}var Au=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Dg(a,c){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var m=a[d].indexOf("="),k=null;if(0<=m){var V=a[d].substring(0,m);k=a[d].substring(m+1)}else V=a[d];c(V,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function tn(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof tn){this.h=a.h,ei(this,a.j),this.o=a.o,this.g=a.g,ti(this,a.s),this.l=a.l;var c=a.i,d=new lr;d.i=c.i,c.g&&(d.g=new Map(c.g),d.h=c.h),Su(this,d),this.m=a.m}else a&&(c=String(a).match(Au))?(this.h=!1,ei(this,c[1]||"",!0),this.o=or(c[2]||""),this.g=or(c[3]||"",!0),ti(this,c[4]),this.l=or(c[5]||"",!0),Su(this,c[6]||"",!0),this.m=or(c[7]||"")):(this.h=!1,this.i=new lr(null,this.h))}tn.prototype.toString=function(){var a=[],c=this.j;c&&a.push(ar(c,Pu,!0),":");var d=this.g;return(d||c=="file")&&(a.push("//"),(c=this.o)&&a.push(ar(c,Pu,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(ar(d,d.charAt(0)=="/"?Mg:Og,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",ar(d,$g)),a.join("")};function gt(a){return new tn(a)}function ei(a,c,d){a.j=d?or(c,!0):c,a.j&&(a.j=a.j.replace(/:$/,""))}function ti(a,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);a.s=c}else a.s=null}function Su(a,c,d){c instanceof lr?(a.i=c,Fg(a.i,a.h)):(d||(c=ar(c,Lg)),a.i=new lr(c,a.h))}function ie(a,c,d){a.i.set(c,d)}function ni(a){return ie(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function or(a,c){return a?c?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function ar(a,c,d){return typeof a=="string"?(a=encodeURI(a).replace(c,Vg),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Vg(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Pu=/[#\/\?@]/g,Og=/[#\?:]/g,Mg=/[#\?]/g,Lg=/[#\?@]/g,$g=/#/g;function lr(a,c){this.h=this.g=null,this.i=a||null,this.j=!!c}function kt(a){a.g||(a.g=new Map,a.h=0,a.i&&Dg(a.i,function(c,d){a.add(decodeURIComponent(c.replace(/\+/g," ")),d)}))}t=lr.prototype,t.add=function(a,c){kt(this),this.i=null,a=Cn(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(c),this.h+=1,this};function Ru(a,c){kt(a),c=Cn(a,c),a.g.has(c)&&(a.i=null,a.h-=a.g.get(c).length,a.g.delete(c))}function Cu(a,c){return kt(a),c=Cn(a,c),a.g.has(c)}t.forEach=function(a,c){kt(this),this.g.forEach(function(d,m){d.forEach(function(k){a.call(c,k,m,this)},this)},this)},t.na=function(){kt(this);const a=Array.from(this.g.values()),c=Array.from(this.g.keys()),d=[];for(let m=0;m<c.length;m++){const k=a[m];for(let V=0;V<k.length;V++)d.push(c[m])}return d},t.V=function(a){kt(this);let c=[];if(typeof a=="string")Cu(this,a)&&(c=c.concat(this.g.get(Cn(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)c=c.concat(a[d])}return c},t.set=function(a,c){return kt(this),this.i=null,a=Cn(this,a),Cu(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[c]),this.h+=1,this},t.get=function(a,c){return a?(a=this.V(a),0<a.length?String(a[0]):c):c};function bu(a,c,d){Ru(a,c),0<d.length&&(a.i=null,a.g.set(Cn(a,c),C(d)),a.h+=d.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],c=Array.from(this.g.keys());for(var d=0;d<c.length;d++){var m=c[d];const V=encodeURIComponent(String(m)),L=this.V(m);for(m=0;m<L.length;m++){var k=V;L[m]!==""&&(k+="="+encodeURIComponent(String(L[m]))),a.push(k)}}return this.i=a.join("&")};function Cn(a,c){return c=String(c),a.j&&(c=c.toLowerCase()),c}function Fg(a,c){c&&!a.j&&(kt(a),a.i=null,a.g.forEach(function(d,m){var k=m.toLowerCase();m!=k&&(Ru(this,m),bu(this,k,d))},a)),a.j=c}function jg(a,c){const d=new ir;if(l.Image){const m=new Image;m.onload=I(xt,d,"TestLoadImage: loaded",!0,c,m),m.onerror=I(xt,d,"TestLoadImage: error",!1,c,m),m.onabort=I(xt,d,"TestLoadImage: abort",!1,c,m),m.ontimeout=I(xt,d,"TestLoadImage: timeout",!1,c,m),l.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else c(!1)}function Ug(a,c){const d=new ir,m=new AbortController,k=setTimeout(()=>{m.abort(),xt(d,"TestPingServer: timeout",!1,c)},1e4);fetch(a,{signal:m.signal}).then(V=>{clearTimeout(k),V.ok?xt(d,"TestPingServer: ok",!0,c):xt(d,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(k),xt(d,"TestPingServer: error",!1,c)})}function xt(a,c,d,m,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),m(d)}catch{}}function Bg(){this.g=new Ag}function zg(a,c,d){const m=d||"";try{Iu(a,function(k,V){let L=k;h(k)&&(L=io(k)),c.push(m+V+"="+encodeURIComponent(L))})}catch(k){throw c.push(m+"type="+encodeURIComponent("_badmap")),k}}function ri(a){this.l=a.Ub||null,this.j=a.eb||!1}A(ri,so),ri.prototype.g=function(){return new ii(this.l,this.j)},ri.prototype.i=function(a){return function(){return a}}({});function ii(a,c){Re.call(this),this.D=a,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(ii,Re),t=ii.prototype,t.open=function(a,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=c,this.readyState=1,cr(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(c.body=a),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ur(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,cr(this)),this.g&&(this.readyState=3,cr(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ku(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function ku(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var c=a.value?a.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!a.done}))&&(this.response=this.responseText+=c)}a.done?ur(this):cr(this),this.readyState==3&&ku(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,ur(this))},t.Qa=function(a){this.g&&(this.response=a,ur(this))},t.ga=function(){this.g&&ur(this)};function ur(a){a.readyState=4,a.l=null,a.j=null,a.v=null,cr(a)}t.setRequestHeader=function(a,c){this.u.append(a,c)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],c=this.h.entries();for(var d=c.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=c.next();return a.join(`\r
`)};function cr(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ii.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function xu(a){let c="";return $(a,function(d,m){c+=m,c+=":",c+=d,c+=`\r
`}),c}function go(a,c,d){e:{for(m in d){var m=!1;break e}m=!0}m||(d=xu(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):ie(a,c,d))}function he(a){Re.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(he,Re);var qg=/^https?$/i,Wg=["POST","PUT"];t=he.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,c,d,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);c=c?c.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():lo.g(),this.v=this.o?ou(this.o):ou(lo),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(c,String(a),!0),this.B=!1}catch(V){Nu(this,V);return}if(a=d||"",d=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var k in m)d.set(k,m[k]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(const V of m.keys())d.set(V,m.get(V));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(d.keys()).find(V=>V.toLowerCase()=="content-type"),k=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Wg,c,void 0))||m||k||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,L]of d)this.g.setRequestHeader(V,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ou(this),this.u=!0,this.g.send(a),this.u=!1}catch(V){Nu(this,V)}};function Nu(a,c){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=c,a.m=5,Du(a),si(a)}function Du(a){a.A||(a.A=!0,De(a,"complete"),De(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,De(this,"complete"),De(this,"abort"),si(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),si(this,!0)),he.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Vu(this):this.bb())},t.bb=function(){Vu(this)};function Vu(a){if(a.h&&typeof o<"u"&&(!a.v[1]||yt(a)!=4||a.Z()!=2)){if(a.u&&yt(a)==4)nu(a.Ea,0,a);else if(De(a,"readystatechange"),yt(a)==4){a.h=!1;try{const L=a.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var d;if(!(d=c)){var m;if(m=L===0){var k=String(a.D).match(Au)[1]||null;!k&&l.self&&l.self.location&&(k=l.self.location.protocol.slice(0,-1)),m=!qg.test(k?k.toLowerCase():"")}d=m}if(d)De(a,"complete"),De(a,"success");else{a.m=6;try{var V=2<yt(a)?a.g.statusText:""}catch{V=""}a.l=V+" ["+a.Z()+"]",Du(a)}}finally{si(a)}}}}function si(a,c){if(a.g){Ou(a);const d=a.g,m=a.v[0]?()=>{}:null;a.g=null,a.v=null,c||De(a,"ready");try{d.onreadystatechange=m}catch{}}}function Ou(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function yt(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<yt(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var c=this.g.responseText;return a&&c.indexOf(a)==0&&(c=c.substring(a.length)),Ig(c)}};function Mu(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Hg(a){const c={};a=(a.g&&2<=yt(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<a.length;m++){if(R(a[m]))continue;var d=S(a[m]);const k=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();const V=c[k]||[];c[k]=V,V.push(d)}v(c,function(m){return m.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function hr(a,c,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||c}function Lu(a){this.Aa=0,this.i=[],this.j=new ir,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=hr("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=hr("baseRetryDelayMs",5e3,a),this.cb=hr("retryDelaySeedMs",1e4,a),this.Wa=hr("forwardChannelMaxRetries",2,a),this.wa=hr("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new _u(a&&a.concurrentRequestLimit),this.Da=new Bg,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Lu.prototype,t.la=8,t.G=1,t.connect=function(a,c,d,m){Ve(0),this.W=a,this.H=c||{},d&&m!==void 0&&(this.H.OSID=d,this.H.OAID=m),this.F=this.X,this.I=Hu(this,null,this.W),ai(this)};function yo(a){if($u(a),a.G==3){var c=a.U++,d=gt(a.I);if(ie(d,"SID",a.K),ie(d,"RID",c),ie(d,"TYPE","terminate"),dr(a,d),c=new bt(a,a.j,c),c.L=2,c.v=ni(gt(d)),d=!1,l.navigator&&l.navigator.sendBeacon)try{d=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!d&&l.Image&&(new Image().src=c.v,d=!0),d||(c.g=Ku(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Zr(c)}Wu(a)}function oi(a){a.g&&(vo(a),a.g.cancel(),a.g=null)}function $u(a){oi(a),a.u&&(l.clearTimeout(a.u),a.u=null),li(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function ai(a){if(!vu(a.h)&&!a.s){a.s=!0;var c=a.Ga;Ue||B(),U||(Ue(),U=!0),G.add(c,a),a.B=0}}function Kg(a,c){return wu(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=c.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=rr(g(a.Ga,a,c),qu(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const k=new bt(this,this.j,a);let V=this.o;if(this.S&&(V?(V=y(V),E(V,this.S)):V=this.S),this.m!==null||this.O||(k.H=V,V=null),this.P)e:{for(var c=0,d=0;d<this.i.length;d++){t:{var m=this.i[d];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(c+=m,4096<c){c=d;break e}if(c===4096||d===this.i.length-1){c=d+1;break e}}c=1e3}else c=1e3;c=ju(this,k,c),d=gt(this.I),ie(d,"RID",a),ie(d,"CVER",22),this.D&&ie(d,"X-HTTP-Session-Id",this.D),dr(this,d),V&&(this.O?c="headers="+encodeURIComponent(String(xu(V)))+"&"+c:this.m&&go(d,this.m,V)),mo(this.h,k),this.Ua&&ie(d,"TYPE","init"),this.P?(ie(d,"$req",c),ie(d,"SID","null"),k.T=!0,co(k,d,null)):co(k,d,c),this.G=2}}else this.G==3&&(a?Fu(this,a):this.i.length==0||vu(this.h)||Fu(this))};function Fu(a,c){var d;c?d=c.l:d=a.U++;const m=gt(a.I);ie(m,"SID",a.K),ie(m,"RID",d),ie(m,"AID",a.T),dr(a,m),a.m&&a.o&&go(m,a.m,a.o),d=new bt(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),c&&(a.i=c.D.concat(a.i)),c=ju(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),mo(a.h,d),co(d,m,c)}function dr(a,c){a.H&&$(a.H,function(d,m){ie(c,m,d)}),a.l&&Iu({},function(d,m){ie(c,m,d)})}function ju(a,c,d){d=Math.min(a.i.length,d);var m=a.l?g(a.l.Na,a.l,a):null;e:{var k=a.i;let V=-1;for(;;){const L=["count="+d];V==-1?0<d?(V=k[0].g,L.push("ofs="+V)):V=0:L.push("ofs="+V);let te=!0;for(let we=0;we<d;we++){let J=k[we].g;const Ce=k[we].map;if(J-=V,0>J)V=Math.max(0,k[we].g-100),te=!1;else try{zg(Ce,L,"req"+J+"_")}catch{m&&m(Ce)}}if(te){m=L.join("&");break e}}}return a=a.i.splice(0,d),c.D=a,m}function Uu(a){if(!a.g&&!a.u){a.Y=1;var c=a.Fa;Ue||B(),U||(Ue(),U=!0),G.add(c,a),a.v=0}}function _o(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=rr(g(a.Fa,a),qu(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Bu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=rr(g(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ve(10),oi(this),Bu(this))};function vo(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Bu(a){a.g=new bt(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var c=gt(a.qa);ie(c,"RID","rpc"),ie(c,"SID",a.K),ie(c,"AID",a.T),ie(c,"CI",a.F?"0":"1"),!a.F&&a.ja&&ie(c,"TO",a.ja),ie(c,"TYPE","xmlhttp"),dr(a,c),a.m&&a.o&&go(c,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=ni(gt(c)),d.m=null,d.P=!0,mu(d,a)}t.Za=function(){this.C!=null&&(this.C=null,oi(this),_o(this),Ve(19))};function li(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function zu(a,c){var d=null;if(a.g==c){li(a),vo(a),a.g=null;var m=2}else if(po(a.h,c))d=c.D,Eu(a.h,c),m=1;else return;if(a.G!=0){if(c.o)if(m==1){d=c.m?c.m.length:0,c=Date.now()-c.F;var k=a.B;m=Yr(),De(m,new hu(m,d)),ai(a)}else Uu(a);else if(k=c.s,k==3||k==0&&0<c.X||!(m==1&&Kg(a,c)||m==2&&_o(a)))switch(d&&0<d.length&&(c=a.h,c.i=c.i.concat(d)),k){case 1:nn(a,5);break;case 4:nn(a,10);break;case 3:nn(a,6);break;default:nn(a,2)}}}function qu(a,c){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*c}function nn(a,c){if(a.j.info("Error code "+c),c==2){var d=g(a.fb,a),m=a.Xa;const k=!m;m=new tn(m||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ei(m,"https"),ni(m),k?jg(m.toString(),d):Ug(m.toString(),d)}else Ve(2);a.G=0,a.l&&a.l.sa(c),Wu(a),$u(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function Wu(a){if(a.G=0,a.ka=[],a.l){const c=Tu(a.h);(c.length!=0||a.i.length!=0)&&(N(a.ka,c),N(a.ka,a.i),a.h.i.length=0,C(a.i),a.i.length=0),a.l.ra()}}function Hu(a,c,d){var m=d instanceof tn?gt(d):new tn(d);if(m.g!="")c&&(m.g=c+"."+m.g),ti(m,m.s);else{var k=l.location;m=k.protocol,c=c?c+"."+k.hostname:k.hostname,k=+k.port;var V=new tn(null);m&&ei(V,m),c&&(V.g=c),k&&ti(V,k),d&&(V.l=d),m=V}return d=a.D,c=a.ya,d&&c&&ie(m,d,c),ie(m,"VER",a.la),dr(a,m),m}function Ku(a,c,d){if(c&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=a.Ca&&!a.pa?new he(new ri({eb:d})):new he(a.pa),c.Ha(a.J),c}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gu(){}t=Gu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ui(){}ui.prototype.g=function(a,c){return new Fe(a,c)};function Fe(a,c){Re.call(this),this.g=new Lu(c),this.l=a,this.h=c&&c.messageUrlParams||null,a=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(a?a["X-WebChannel-Content-Type"]=c.messageContentType:a={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(a?a["X-WebChannel-Client-Profile"]=c.va:a={"X-WebChannel-Client-Profile":c.va}),this.g.S=a,(a=c&&c.Sb)&&!R(a)&&(this.g.m=a),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!R(c)&&(this.g.D=c,a=this.h,a!==null&&c in a&&(a=this.h,c in a&&delete a[c])),this.j=new bn(this)}A(Fe,Re),Fe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Fe.prototype.close=function(){yo(this.g)},Fe.prototype.o=function(a){var c=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=io(a),a=d);c.i.push(new kg(c.Ya++,a)),c.G==3&&ai(c)},Fe.prototype.N=function(){this.g.l=null,delete this.j,yo(this.g),delete this.g,Fe.aa.N.call(this)};function Qu(a){oo.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var c=a.__sm__;if(c){e:{for(const d in c){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,c=c!==null&&a in c?c[a]:void 0),this.data=c}else this.data=a}A(Qu,oo);function Yu(){ao.call(this),this.status=1}A(Yu,ao);function bn(a){this.g=a}A(bn,Gu),bn.prototype.ua=function(){De(this.g,"a")},bn.prototype.ta=function(a){De(this.g,new Qu(a))},bn.prototype.sa=function(a){De(this.g,new Yu)},bn.prototype.ra=function(){De(this.g,"b")},ui.prototype.createWebChannel=ui.prototype.g,Fe.prototype.send=Fe.prototype.o,Fe.prototype.open=Fe.prototype.m,Fe.prototype.close=Fe.prototype.close,EC=function(){return new ui},wC=function(){return Yr()},vC=Zt,sv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Xr.NO_ERROR=0,Xr.TIMEOUT=8,Xr.HTTP_ERROR=6,mf=Xr,du.COMPLETE="complete",_C=du,au.EventType=tr,tr.OPEN="a",tr.CLOSE="b",tr.ERROR="c",tr.MESSAGE="d",Re.prototype.listen=Re.prototype.K,pc=au,he.prototype.listenOnce=he.prototype.L,he.prototype.getLastError=he.prototype.Ka,he.prototype.getLastErrorCode=he.prototype.Ba,he.prototype.getStatus=he.prototype.Z,he.prototype.getResponseJson=he.prototype.Oa,he.prototype.getResponseText=he.prototype.oa,he.prototype.send=he.prototype.ea,he.prototype.setWithCredentials=he.prototype.Ha,yC=he}).apply(typeof Ud<"u"?Ud:typeof self<"u"?self:typeof window<"u"?window:{});const II="@firebase/firestore",AI="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Wt.UNAUTHENTICATED=new Wt(null),Wt.GOOGLE_CREDENTIALS=new Wt("google-credentials-uid"),Wt.FIRST_PARTY=new Wt("first-party-uid"),Wt.MOCK_USER=new Wt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fl="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=new lE("@firebase/firestore");function Aa(){return Xo.logLevel}function Q(t,...e){if(Xo.logLevel<=ye.DEBUG){const n=e.map(cE);Xo.debug(`Firestore (${Fl}): ${t}`,...n)}}function Oi(t,...e){if(Xo.logLevel<=ye.ERROR){const n=e.map(cE);Xo.error(`Firestore (${Fl}): ${t}`,...n)}}function Vs(t,...e){if(Xo.logLevel<=ye.WARN){const n=e.map(cE);Xo.warn(`Firestore (${Fl}): ${t}`,...n)}}function cE(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function re(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,TC(t,r,n)}function TC(t,e,n){let r=`FIRESTORE (${Fl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Oi(r),new Error(r)}function Pe(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||TC(e,i,r)}function ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};let K=class extends Qs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Si=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let IC=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},S$=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Wt.UNAUTHENTICATED))}shutdown(){}};class P${constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}let R$=class{constructor(e){this.t=e,this.currentUser=Wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Pe(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new Si;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Si,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Si)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Pe(typeof r.accessToken=="string",31837,{l:r}),new IC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pe(e===null||typeof e=="string",2055,{h:e}),new Wt(e)}},C$=class{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Wt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},b$=class{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new C$(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},SI=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},k$=class{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_r(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Pe(this.o===void 0,3512);const r=s=>{s.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new SI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Pe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new SI(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x$(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AC(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hE=class{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=x$(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}};function me(t,e){return t<e?-1:t>e?1:0}function ov(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),i=e.codePointAt(n);if(r!==i){if(r<128&&i<128)return me(r,i);{const s=AC(),o=N$(s.encode(PI(t,n)),s.encode(PI(e,n)));return o!==0?o:me(r,i)}}n+=r>65535?2:1}return me(t.length,e.length)}function PI(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function N$(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return me(t[n],e[n]);return me(t.length,e.length)}function _l(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="__name__";let SC=class ts{constructor(e,n,r){n===void 0?n=0:n>e.length&&re(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&re(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ts.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ts?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=ts.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return me(e.length,n.length)}static compareSegments(e,n){const r=ts.isNumericId(e),i=ts.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?ts.extractNumericId(e).compare(ts.extractNumericId(n)):ov(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Rs.fromString(e.substring(4,e.length-2))}},Ge=class gf extends SC{construct(e,n,r){return new gf(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new K(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new gf(n)}static emptyPath(){return new gf([])}};const D$=/^[_a-zA-Z][_a-zA-Z0-9]*$/;let Ir=class Sa extends SC{construct(e,n,r){return new Sa(e,n,r)}static isValidIdentifier(e){return D$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Sa.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===RI}static keyField(){return new Sa([RI])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new K(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new K(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new K(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new K(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Sa(n)}static emptyPath(){return new Sa([])}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let se=class mc{constructor(e){this.path=e}static fromPath(e){return new mc(Ge.fromString(e))}static fromName(e){return new mc(Ge.fromString(e).popFirst(5))}static empty(){return new mc(Ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new mc(new Ge(e.slice()))}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PC(t,e,n){if(!n)throw new K(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function V$(t,e,n,r){if(e===!0&&r===!0)throw new K(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function CI(t){if(!se.isDocumentKey(t))throw new K(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function bI(t){if(se.isDocumentKey(t))throw new K(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function RC(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function _m(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":re(12329,{type:typeof t})}function Mn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new K(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=_m(t);throw new K(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function O$(t,e){if(e<=0)throw new K(F.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(t,e){const n={typeString:t};return e&&(n.value=e),n}function Jh(t,e){if(!RC(t))throw new K(F.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new K(F.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI=-62135596800,xI=1e6;let Rt=class Ao{static now(){return Ao.fromMillis(Date.now())}static fromDate(e){return Ao.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*xI);return new Ao(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new K(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new K(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<kI)throw new K(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/xI}_compareTo(e){return this.seconds===e.seconds?me(this.nanoseconds,e.nanoseconds):me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ao._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Jh(e,Ao._jsonSchema))return new Ao(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-kI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Rt._jsonSchemaVersion="firestore/timestamp/1.0",Rt._jsonSchema={type:ft("string",Rt._jsonSchemaVersion),seconds:ft("number"),nanoseconds:ft("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let de=class yf{static fromTimestamp(e){return new yf(e)}static min(){return new yf(new Rt(0,0))}static max(){return new yf(new Rt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=-1;function M$(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=de.fromTimestamp(r===1e9?new Rt(n+1,0):new Rt(n,r));return new Sh(i,se.empty(),e)}function L$(t){return new Sh(t.readTime,t.key,Ah)}let Sh=class av{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new av(de.min(),se.empty(),Ah)}static max(){return new av(de.max(),se.empty(),Ah)}};function $$(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:me(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";let j$=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jl(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==F$)throw t;Q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let q=class fn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new fn((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof fn?n:fn.resolve(n)}catch(n){return fn.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):fn.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):fn.reject(n)}static resolve(e){return new fn((n,r)=>{n(e)})}static reject(e){return new fn((n,r)=>{r(e)})}static waitFor(e){return new fn((n,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=fn.resolve(!1);for(const r of e)n=n.next(i=>i?fn.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new fn((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;n(e[h]).next(f=>{o[h]=f,++l,l===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new fn((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};function U$(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ul(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vm=class{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}};vm.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE=-1;function Zh(t){return t==null}function dp(t){return t===0&&1/t==-1/0}function B$(t){return typeof t=="number"&&Number.isInteger(t)&&!dp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC="";function z$(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=NI(e)),e=q$(t.get(n),e);return NI(e)}function q$(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case CC:n+="";break;default:n+=s}}return n}function NI(t){return t+CC+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ys(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function bC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mt=class lv{constructor(e,n){this.comparator=e,this.root=n||Cs.EMPTY}insert(e,n){return new lv(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Cs.BLACK,null,null))}remove(e){return new lv(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cs.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bd(this.root,e,this.comparator,!0)}},Bd=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Cs=class hi{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??hi.RED,this.left=i??hi.EMPTY,this.right=s??hi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new hi(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return hi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return hi.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,hi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,hi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw re(27949);return e+(this.isRed()?0:1)}};Cs.EMPTY=null,Cs.RED=!0,Cs.BLACK=!1;Cs.EMPTY=new class{constructor(){this.size=0}get key(){throw re(57766)}get value(){throw re(16141)}get color(){throw re(16727)}get left(){throw re(29726)}get right(){throw re(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Cs(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gt=class uv{constructor(e){this.comparator=e,this.data=new mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new VI(this.data.getIterator())}getIteratorFrom(e){return new VI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof uv)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new uv(this.comparator);return n.data=e,n}},VI=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dr=class cv{constructor(e){this.fields=e,e.sort(Ir.comparator)}static empty(){return new cv([])}unionWith(e){let n=new Gt(Ir.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new cv(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return _l(this.fields,e.fields,(n,r)=>n.isEqual(r))}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kC=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let In=class hv{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new kC("Invalid base64 string: "+s):s}}(e);return new hv(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new hv(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};In.EMPTY_BYTE_STRING=new In("");const W$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Os(t){if(Pe(!!t,39018),typeof t=="string"){let e=0;const n=W$.exec(t);if(Pe(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:st(t.seconds),nanos:st(t.nanos)}}function st(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ms(t){return typeof t=="string"?In.fromBase64String(t):In.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC="server_timestamp",NC="__type__",DC="__previous_value__",VC="__local_write_time__";function fE(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[NC])===null||n===void 0?void 0:n.stringValue)===xC}function wm(t){const e=t.mapValue.fields[DC];return fE(e)?wm(e):e}function Ph(t){const e=Os(t.mapValue.fields[VC].timestampValue);return new Rt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let H$=class{constructor(e,n,r,i,s,o,l,u,h,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}};const fp="(default)";let OC=class dv{constructor(e,n){this.projectId=e,this.database=n||fp}static empty(){return new dv("","")}get isDefaultDatabase(){return this.database===fp}isEqual(e){return e instanceof dv&&e.projectId===this.projectId&&e.database===this.database}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC="__type__",K$="__max__",zd={mapValue:{}},LC="__vector__",pp="value";function Ls(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fE(t)?4:Q$(t)?9007199254740991:G$(t)?10:11:re(28295,{value:t})}function zr(t,e){if(t===e)return!0;const n=Ls(t);if(n!==Ls(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ph(t).isEqual(Ph(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Os(i.timestampValue),l=Os(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ms(i.bytesValue).isEqual(Ms(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return st(i.geoPointValue.latitude)===st(s.geoPointValue.latitude)&&st(i.geoPointValue.longitude)===st(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return st(i.integerValue)===st(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=st(i.doubleValue),l=st(s.doubleValue);return o===l?dp(o)===dp(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return _l(t.arrayValue.values||[],e.arrayValue.values||[],zr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(DI(o)!==DI(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!zr(o[u],l[u])))return!1;return!0}(t,e);default:return re(52216,{left:t})}}function Rh(t,e){return(t.values||[]).find(n=>zr(n,e))!==void 0}function vl(t,e){if(t===e)return 0;const n=Ls(t),r=Ls(e);if(n!==r)return me(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return me(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=st(s.integerValue||s.doubleValue),u=st(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return OI(t.timestampValue,e.timestampValue);case 4:return OI(Ph(t),Ph(e));case 5:return ov(t.stringValue,e.stringValue);case 6:return function(s,o){const l=Ms(s),u=Ms(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=me(l[h],u[h]);if(f!==0)return f}return me(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=me(st(s.latitude),st(o.latitude));return l!==0?l:me(st(s.longitude),st(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return MI(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,u,h,f;const p=s.fields||{},g=o.fields||{},I=(l=p[pp])===null||l===void 0?void 0:l.arrayValue,A=(u=g[pp])===null||u===void 0?void 0:u.arrayValue,C=me(((h=I==null?void 0:I.values)===null||h===void 0?void 0:h.length)||0,((f=A==null?void 0:A.values)===null||f===void 0?void 0:f.length)||0);return C!==0?C:MI(I,A)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===zd.mapValue&&o===zd.mapValue)return 0;if(s===zd.mapValue)return 1;if(o===zd.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const g=ov(u[p],f[p]);if(g!==0)return g;const I=vl(l[u[p]],h[f[p]]);if(I!==0)return I}return me(u.length,f.length)}(t.mapValue,e.mapValue);default:throw re(23264,{le:n})}}function OI(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return me(t,e);const n=Os(t),r=Os(e),i=me(n.seconds,r.seconds);return i!==0?i:me(n.nanos,r.nanos)}function MI(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=vl(n[i],r[i]);if(s)return s}return me(n.length,r.length)}function wl(t){return fv(t)}function fv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Os(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ms(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=fv(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${fv(n.fields[o])}`;return i+"}"}(t.mapValue):re(61005,{value:t})}function _f(t){switch(Ls(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wm(t);return e?16+_f(e):16;case 5:return 2*t.stringValue.length;case 6:return Ms(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+_f(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Ys(r.fields,(s,o)=>{i+=s.length+_f(o)}),i}(t.mapValue);default:throw re(13486,{value:t})}}function LI(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function pv(t){return!!t&&"integerValue"in t}function pE(t){return!!t&&"arrayValue"in t}function $I(t){return!!t&&"nullValue"in t}function FI(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vf(t){return!!t&&"mapValue"in t}function G$(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[MC])===null||n===void 0?void 0:n.stringValue)===LC}function jc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ys(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=jc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=jc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Q$(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===K$}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qn=class mv{constructor(e){this.value=e}static empty(){return new mv({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!vf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=jc(n)}setAll(e){let n=Ir.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=jc(o):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());vf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return zr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];vf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ys(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new mv(jc(this.value))}};function $C(t){const e=[];return Ys(t.fields,(n,r)=>{const i=new Ir([n]);if(vf(r)){const s=$C(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Dr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pr=class So{constructor(e,n,r,i,s,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new So(e,0,de.min(),de.min(),de.min(),qn.empty(),0)}static newFoundDocument(e,n,r,i){return new So(e,1,n,de.min(),r,i,0)}static newNoDocument(e,n){return new So(e,2,n,de.min(),de.min(),qn.empty(),0)}static newUnknownDocument(e,n){return new So(e,3,n,de.min(),de.min(),qn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(de.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=de.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof So&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new So(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mp=class{constructor(e,n){this.position=e,this.inclusive=n}};function jI(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=se.comparator(se.fromName(o.referenceValue),n.key):r=vl(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function UI(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!zr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ch=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function Y$(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FC=class{},At=class jC extends FC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new J$(e,n,r):n==="array-contains"?new tF(e,r):n==="in"?new nF(e,r):n==="not-in"?new rF(e,r):n==="array-contains-any"?new iF(e,r):new jC(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Z$(e,r):new eF(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(vl(n,this.value)):n!==null&&Ls(this.value)===Ls(n)&&this.matchesComparison(vl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Mi=class UC extends FC{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new UC(e,n)}matches(e){return BC(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function BC(t){return t.op==="and"}function zC(t){return X$(t)&&BC(t)}function X$(t){for(const e of t.filters)if(e instanceof Mi)return!1;return!0}function gv(t){if(t instanceof At)return t.field.canonicalString()+t.op.toString()+wl(t.value);if(zC(t))return t.filters.map(e=>gv(e)).join(",");{const e=t.filters.map(n=>gv(n)).join(",");return`${t.op}(${e})`}}function qC(t,e){return t instanceof At?function(r,i){return i instanceof At&&r.op===i.op&&r.field.isEqual(i.field)&&zr(r.value,i.value)}(t,e):t instanceof Mi?function(r,i){return i instanceof Mi&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&qC(o,i.filters[l]),!0):!1}(t,e):void re(19439)}function WC(t){return t instanceof At?function(n){return`${n.field.canonicalString()} ${n.op} ${wl(n.value)}`}(t):t instanceof Mi?function(n){return n.op.toString()+" {"+n.getFilters().map(WC).join(" ,")+"}"}(t):"Filter"}let J$=class extends At{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}},Z$=class extends At{constructor(e,n){super(e,"in",n),this.keys=HC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},eF=class extends At{constructor(e,n){super(e,"not-in",n),this.keys=HC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function HC(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}let tF=class extends At{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return pE(n)&&Rh(n.arrayValue,this.value)}},nF=class extends At{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Rh(this.value.arrayValue,n)}},rF=class extends At{constructor(e,n){super(e,"not-in",n)}matches(e){if(Rh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Rh(this.value.arrayValue,n)}},iF=class extends At{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!pE(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Rh(this.value.arrayValue,r))}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sF=class{constructor(e,n=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.Pe=null}};function BI(t,e=null,n=[],r=[],i=null,s=null,o=null){return new sF(t,e,n,r,i,s,o)}function mE(t){const e=ce(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>gv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Zh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>wl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>wl(r)).join(",")),e.Pe=n}return e.Pe}function gE(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Y$(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!qC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!UI(t.startAt,e.startAt)&&UI(t.endAt,e.endAt)}function yv(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bl=class{constructor(e,n=null,r=[],i=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function oF(t,e,n,r,i,s,o,l){return new Bl(t,e,n,r,i,s,o,l)}function yE(t){return new Bl(t)}function zI(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function KC(t){return t.collectionGroup!==null}function Uc(t){const e=ce(t);if(e.Te===null){e.Te=[];const n=new Set;for(const s of e.explicitOrderBy)e.Te.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Gt(Ir.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Ch(s,r))}),n.has(Ir.keyField().canonicalString())||e.Te.push(new Ch(Ir.keyField(),r))}return e.Te}function Mr(t){const e=ce(t);return e.Ie||(e.Ie=aF(e,Uc(t))),e.Ie}function aF(t,e){if(t.limitType==="F")return BI(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ch(i.field,s)});const n=t.endAt?new mp(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new mp(t.startAt.position,t.startAt.inclusive):null;return BI(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function _v(t,e){const n=t.filters.concat([e]);return new Bl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function gp(t,e,n){return new Bl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Em(t,e){return gE(Mr(t),Mr(e))&&t.limitType===e.limitType}function GC(t){return`${mE(Mr(t))}|lt:${t.limitType}`}function Pa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>WC(i)).join(", ")}]`),Zh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>wl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>wl(i)).join(",")),`Target(${r})`}(Mr(t))}; limitType=${t.limitType})`}function Tm(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Uc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,u){const h=jI(o,l,u);return o.inclusive?h<=0:h<0}(r.startAt,Uc(r),i)||r.endAt&&!function(o,l,u){const h=jI(o,l,u);return o.inclusive?h>=0:h>0}(r.endAt,Uc(r),i))}(t,e)}function lF(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function QC(t){return(e,n)=>{let r=!1;for(const i of Uc(t)){const s=uF(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function uF(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?vl(u,h):re(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return re(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fa=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ys(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return bC(this.inner)}size(){return this.innerSize}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF=new mt(se.comparator);function Li(){return cF}const YC=new mt(se.comparator);function gc(...t){let e=YC;for(const n of t)e=e.insert(n.key,n);return e}function XC(t){let e=YC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function No(){return Bc()}function JC(){return Bc()}function Bc(){return new fa(t=>t.toString(),(t,e)=>t.isEqual(e))}const hF=new mt(se.comparator),dF=new Gt(se.comparator);function _e(...t){let e=dF;for(const n of t)e=e.add(n);return e}const fF=new Gt(me);function pF(){return fF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dp(e)?"-0":e}}function ZC(t){return{integerValue:""+t}}function mF(t,e){return B$(e)?ZC(e):_E(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Im=class{constructor(){this._=void 0}};function gF(t,e,n){return t instanceof bh?function(i,s){const o={fields:{[NC]:{stringValue:xC},[VC]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&fE(s)&&(s=wm(s)),s&&(o.fields[DC]=s),{mapValue:o}}(n,e):t instanceof kh?tb(t,e):t instanceof xh?nb(t,e):function(i,s){const o=eb(i,s),l=qI(o)+qI(i.Ee);return pv(o)&&pv(i.Ee)?ZC(l):_E(i.serializer,l)}(t,e)}function yF(t,e,n){return t instanceof kh?tb(t,e):t instanceof xh?nb(t,e):n}function eb(t,e){return t instanceof yp?function(r){return pv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}let bh=class extends Im{},kh=class extends Im{constructor(e){super(),this.elements=e}};function tb(t,e){const n=rb(e);for(const r of t.elements)n.some(i=>zr(i,r))||n.push(r);return{arrayValue:{values:n}}}let xh=class extends Im{constructor(e){super(),this.elements=e}};function nb(t,e){let n=rb(e);for(const r of t.elements)n=n.filter(i=>!zr(i,r));return{arrayValue:{values:n}}}let yp=class extends Im{constructor(e,n){super(),this.serializer=e,this.Ee=n}};function qI(t){return st(t.integerValue||t.doubleValue)}function rb(t){return pE(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _F=class{constructor(e,n){this.field=e,this.transform=n}};function vF(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof kh&&i instanceof kh||r instanceof xh&&i instanceof xh?_l(r.elements,i.elements,zr):r instanceof yp&&i instanceof yp?zr(r.Ee,i.Ee):r instanceof bh&&i instanceof bh}(t.transform,e.transform)}let wF=class{constructor(e,n){this.version=e,this.transformResults=n}},Nn=class wf{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new wf}static exists(e){return new wf(void 0,e)}static updateTime(e){return new wf(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ef(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}let Am=class{};function ib(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Sm(t.key,Nn.none()):new ed(t.key,t.data,Nn.none());{const n=t.data,r=qn.empty();let i=new Gt(Ir.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Xs(t.key,r,new Dr(i.toArray()),Nn.none())}}function EF(t,e,n){t instanceof ed?function(i,s,o){const l=i.value.clone(),u=HI(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Xs?function(i,s,o){if(!Ef(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=HI(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(sb(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function zc(t,e,n,r){return t instanceof ed?function(s,o,l,u){if(!Ef(s.precondition,o))return l;const h=s.value.clone(),f=KI(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Xs?function(s,o,l,u){if(!Ef(s.precondition,o))return l;const h=KI(s.fieldTransforms,u,o),f=o.data;return f.setAll(sb(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,l){return Ef(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function TF(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=eb(r.transform,i||null);s!=null&&(n===null&&(n=qn.empty()),n.set(r.field,s))}return n||null}function WI(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&_l(r,i,(s,o)=>vF(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}let ed=class extends Am{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Xs=class extends Am{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function sb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function HI(t,e,n){const r=new Map;Pe(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,yF(o,l,n[i]))}return r}function KI(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,gF(s,o,e))}return r}let Sm=class extends Am{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ob=class extends Am{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let IF=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&EF(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=zc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=zc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=JC();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=n.has(i.key)?null:l;const u=ib(o,l);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(de.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),_e())}isEqual(e){return this.batchId===e.batchId&&_l(this.mutations,e.mutations,(n,r)=>WI(n,r))&&_l(this.baseMutations,e.baseMutations,(n,r)=>WI(n,r))}},AF=class ab{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Pe(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=function(){return hF}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new ab(e,n,r,i)}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SF=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PF=class{constructor(e,n){this.count=e,this.unchangedNames=n}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut,Ae;function lb(t){switch(t){case F.OK:return re(64938);case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0;default:return re(15467,{code:t})}}function ub(t){if(t===void 0)return Oi("GRPC error has no .code"),F.UNKNOWN;switch(t){case ut.OK:return F.OK;case ut.CANCELLED:return F.CANCELLED;case ut.UNKNOWN:return F.UNKNOWN;case ut.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case ut.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case ut.INTERNAL:return F.INTERNAL;case ut.UNAVAILABLE:return F.UNAVAILABLE;case ut.UNAUTHENTICATED:return F.UNAUTHENTICATED;case ut.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case ut.NOT_FOUND:return F.NOT_FOUND;case ut.ALREADY_EXISTS:return F.ALREADY_EXISTS;case ut.PERMISSION_DENIED:return F.PERMISSION_DENIED;case ut.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case ut.ABORTED:return F.ABORTED;case ut.OUT_OF_RANGE:return F.OUT_OF_RANGE;case ut.UNIMPLEMENTED:return F.UNIMPLEMENTED;case ut.DATA_LOSS:return F.DATA_LOSS;default:return re(39323,{code:t})}}(Ae=ut||(ut={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RF=new Rs([4294967295,4294967295],0);function GI(t){const e=AC().encode(t),n=new gC;return n.update(e),new Uint8Array(n.digest())}function QI(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Rs([n,r],0),new Rs([i,s],0)]}let CF=class cb{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new yc(`Invalid padding: ${n}`);if(r<0)throw new yc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new yc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new yc(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=Rs.fromNumber(this.fe)}pe(e,n,r){let i=e.add(n.multiply(Rs.fromNumber(r)));return i.compare(RF)===1&&(i=new Rs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=GI(e),[r,i]=QI(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new cb(s,i,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.fe===0)return;const n=GI(e),[r,i]=QI(n);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);this.we(o)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},yc=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hb=class fb{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,vE.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new fb(de.min(),i,new mt(me),Li(),_e())}},vE=class pb{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new pb(r,n,_e(),_e(),_e())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf=class{constructor(e,n,r,i){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=i}},mb=class{constructor(e,n){this.targetId=e,this.De=n}},gb=class{constructor(e,n,r=In.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},YI=class{constructor(){this.ve=0,this.Ce=XI(),this.Fe=In.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=_e(),n=_e(),r=_e();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:re(38017,{changeType:s})}}),new vE(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=XI()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Pe(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},bF=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=Li(),this.je=qd(),this.Je=qd(),this.He=new mt(me)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:re(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,i)=>{this.nt(i)&&n(i)})}it(e){const n=e.targetId,r=e.De.count,i=this.st(n);if(i){const s=i.target;if(yv(s))if(r===0){const o=new se(s.path);this.Xe(n,o,Pr.newNoDocument(o,de.min()))}else Pe(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const l=this._t(e),u=l?this.ut(l,e,o):1;if(u!==0){this.rt(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,h)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,l;try{o=Ms(r).toUint8Array()}catch(u){if(u instanceof kC)return Vs("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new CF(o,i,s)}catch(u){return Vs(u instanceof yc?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.fe===0?null:l}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.We.lt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Xe(n,s,null),i++)}),i}Pt(e){const n=new Map;this.Ge.forEach((s,o)=>{const l=this.st(o);if(l){if(s.current&&yv(l.target)){const u=new se(l.target.path);this.Tt(u).has(o)||this.It(o,u)||this.Xe(o,u,Pr.newNoDocument(u,e))}s.Ne&&(n.set(o,s.Le()),s.ke())}});let r=_e();this.Je.forEach((s,o)=>{let l=!0;o.forEachWhile(u=>{const h=this.st(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(e));const i=new hb(e,n,this.He,this.ze,r);return this.ze=Li(),this.je=qd(),this.Je=qd(),this.He=new mt(me),i}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const i=this.tt(e);this.It(e,n)?i.qe(n,1):i.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new YI,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new Gt(me),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new Gt(me),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||Q("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new YI),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}};function qd(){return new mt(se.comparator)}function XI(){return new mt(se.comparator)}const kF={asc:"ASCENDING",desc:"DESCENDING"},xF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NF={and:"AND",or:"OR"};let DF=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function vv(t,e){return t.useProto3Json||Zh(e)?e:{value:e}}function _p(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function VF(t,e){return _p(t,e.toTimestamp())}function Ln(t){return Pe(!!t,49232),de.fromTimestamp(function(n){const r=Os(n);return new Rt(r.seconds,r.nanos)}(t))}function wE(t,e){return wv(t,e).canonicalString()}function wv(t,e){const n=function(i){return new Ge(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function _b(t){const e=Ge.fromString(t);return Pe(Ab(e),10190,{key:e.toString()}),e}function vp(t,e){return wE(t.databaseId,e.path)}function qc(t,e){const n=_b(e);if(n.get(1)!==t.databaseId.projectId)throw new K(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new K(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(wb(n))}function vb(t,e){return wE(t.databaseId,e)}function OF(t){const e=_b(t);return e.length===4?Ge.emptyPath():wb(e)}function Ev(t){return new Ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function wb(t){return Pe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function JI(t,e,n){return{name:vp(t,e),fields:n.value.mapValue.fields}}function MF(t,e){return"found"in e?function(r,i){Pe(!!i.found,43571),i.found.name,i.found.updateTime;const s=qc(r,i.found.name),o=Ln(i.found.updateTime),l=i.found.createTime?Ln(i.found.createTime):de.min(),u=new qn({mapValue:{fields:i.found.fields}});return Pr.newFoundDocument(s,o,l,u)}(t,e):"missing"in e?function(r,i){Pe(!!i.missing,3894),Pe(!!i.readTime,22933);const s=qc(r,i.missing),o=Ln(i.readTime);return Pr.newNoDocument(s,o)}(t,e):re(7234,{result:e})}function LF(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:re(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,f){return h.useProto3Json?(Pe(f===void 0||typeof f=="string",58123),In.fromBase64String(f||"")):(Pe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),In.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(h){const f=h.code===void 0?F.UNKNOWN:ub(h.code);return new K(f,h.message||"")}(o);n=new gb(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=qc(t,r.document.name),s=Ln(r.document.updateTime),o=r.document.createTime?Ln(r.document.createTime):de.min(),l=new qn({mapValue:{fields:r.document.fields}}),u=Pr.newFoundDocument(i,s,o,l),h=r.targetIds||[],f=r.removedTargetIds||[];n=new Tf(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=qc(t,r.document),s=r.readTime?Ln(r.readTime):de.min(),o=Pr.newNoDocument(i,s),l=r.removedTargetIds||[];n=new Tf([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=qc(t,r.document),s=r.removedTargetIds||[];n=new Tf([],s,i,null)}else{if(!("filter"in e))return re(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new PF(i,s),l=r.targetId;n=new mb(l,o)}}return n}function Eb(t,e){let n;if(e instanceof ed)n={update:JI(t,e.key,e.value)};else if(e instanceof Sm)n={delete:vp(t,e.key)};else if(e instanceof Xs)n={update:JI(t,e.key,e.data),updateMask:HF(e.fieldMask)};else{if(!(e instanceof ob))return re(16599,{Rt:e.type});n={verify:vp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof bh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof kh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof xh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof yp)return{fieldPath:o.field.canonicalString(),increment:l.Ee};throw re(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:VF(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:re(27497)}(t,e.precondition)),n}function $F(t,e){return t&&t.length>0?(Pe(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?Ln(i.updateTime):Ln(s);return o.isEqual(de.min())&&(o=Ln(s)),new wF(o,i.transformResults||[])}(n,e))):[]}function FF(t,e){return{documents:[vb(t,e.path)]}}function jF(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=vb(t,i);const s=function(h){if(h.length!==0)return Ib(Mi.create(h,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(f=>function(g){return{field:Ra(g.field),direction:zF(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=vv(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{Vt:n,parent:i}}function UF(t){let e=OF(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Pe(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(p){const g=Tb(p);return g instanceof Mi&&zC(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(A){return new Ch(Ca(A.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(p){let g;return g=typeof p=="object"?p.value:p,Zh(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(p){const g=!!p.before,I=p.values||[];return new mp(I,g)}(n.startAt));let h=null;return n.endAt&&(h=function(p){const g=!p.before,I=p.values||[];return new mp(I,g)}(n.endAt)),oF(e,i,o,s,l,"F",u,h)}function BF(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return re(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Tb(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ca(n.unaryFilter.field);return At.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ca(n.unaryFilter.field);return At.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ca(n.unaryFilter.field);return At.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ca(n.unaryFilter.field);return At.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return re(61313);default:return re(60726)}}(t):t.fieldFilter!==void 0?function(n){return At.create(Ca(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return re(58110);default:return re(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Mi.create(n.compositeFilter.filters.map(r=>Tb(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return re(1026)}}(n.compositeFilter.op))}(t):re(30097,{filter:t})}function zF(t){return kF[t]}function qF(t){return xF[t]}function WF(t){return NF[t]}function Ra(t){return{fieldPath:t.canonicalString()}}function Ca(t){return Ir.fromServerFormat(t.fieldPath)}function Ib(t){return t instanceof At?function(n){if(n.op==="=="){if(FI(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NAN"}};if($I(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(FI(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NOT_NAN"}};if($I(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ra(n.field),op:qF(n.op),value:n.value}}}(t):t instanceof Mi?function(n){const r=n.getFilters().map(i=>Ib(i));return r.length===1?r[0]:{compositeFilter:{op:WF(n.op),filters:r}}}(t):re(54877,{filter:t})}function HF(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Ab(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EE=class _c{constructor(e,n,r,i,s=de.min(),o=de.min(),l=In.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new _c(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new _c(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _c(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _c(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let KF=class{constructor(e){this.gt=e}};function GF(t){const e=UF({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?gp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QF=class{constructor(){this.Dn=new YF}addToCollectionParentIndex(e,n){return this.Dn.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(Sh.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(Sh.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}},YF=class{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Gt(Ge.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Gt(Ge.comparator)).toArray()}};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sb=41943040;class pn{static withCacheSize(e){return new pn(e,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn.DEFAULT_COLLECTION_PERCENTILE=10,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pn.DEFAULT=new pn(Sb,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pn.DISABLED=new pn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tv=class Iv{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Iv(0)}static ur(){return new Iv(-1)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA="LruGarbageCollector",XF=1048576;function tA([t,e],[n,r]){const i=me(t,n);return i===0?me(e,r):i}class JF{constructor(e){this.Tr=e,this.buffer=new Gt(tA),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();tA(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ZF{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Q(eA,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ul(n)?Q(eA,"Ignoring IndexedDB error during garbage collection: ",n):await jl(n)}await this.Rr(3e5)})}}class e4{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve(vm.ue);const r=new JF(n);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Q("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(ZI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZI):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,i,s,o,l,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(Q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,l=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(h=Date.now(),Aa()<=ye.DEBUG&&Q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function t4(t,e){return new e4(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let n4=class{constructor(){this.changes=new fa(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Pr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let r4=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let i4=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&zc(r.mutation,i,Dr.empty(),Rt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,_e()).next(()=>r))}getLocalViewOfDocuments(e,n,r=_e()){const i=No();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=gc();return s.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=No();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,_e()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,i){let s=Li();const o=Bc(),l=function(){return Bc()}();return n.forEach((u,h)=>{const f=r.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof Xs)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),zc(f.mutation,h,f.mutation.getFieldMask(),Rt.now())):o.set(h.key,Dr.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((h,f)=>o.set(h,f)),n.forEach((h,f)=>{var p;return l.set(h,new r4(f,(p=o.get(h))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Bc();let i=new mt((o,l)=>o-l),s=_e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let f=r.get(u)||Dr.empty();f=l.applyToLocalView(h,f),r.set(u,f);const p=(i.get(l.batchId)||_e()).add(u);i=i.insert(l.batchId,p)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=JC();f.forEach(g=>{if(!s.has(g)){const I=ib(n.get(g),r.get(g));I!==null&&p.set(g,I),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):KC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):q.resolve(No());let l=Ah,u=s;return o.next(h=>q.forEach(h,(f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?q.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,u,h,_e())).next(f=>({batchId:l,changes:XC(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let i=gc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=gc();return this.indexManager.getCollectionParents(e,s).next(l=>q.forEach(l,u=>{const h=function(p,g){return new Bl(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Pr.newInvalidDocument(f)))});let l=gc();return o.forEach((u,h)=>{const f=s.get(u);f!==void 0&&zc(f.mutation,h,Dr.empty(),Rt.now()),Tm(n,h)&&(l=l.insert(u,h))}),l})}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s4=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return q.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ln(i.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(i){return{name:i.name,query:GF(i.bundledQuery),readTime:Ln(i.readTime)}}(n)),q.resolve()}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let o4=class{constructor(){this.overlays=new mt(se.comparator),this.kr=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=No();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.wt(e,n,s)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const i=No(),s=n.length+1,o=new se(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return q.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new mt((h,f)=>h-f);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let f=s.get(h.largestBatchId);f===null&&(f=No(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=No(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>l.set(h,f)),!(l.size()>=i)););return q.resolve(l)}wt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new SF(n,r));let s=this.kr.get(n);s===void 0&&(s=_e(),this.kr.set(n,s)),this.kr.set(n,s.add(r.key))}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a4=class{constructor(){this.sessionToken=In.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TE=class{constructor(){this.qr=new Gt(Et.Qr),this.$r=new Gt(Et.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new Et(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new Et(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new se(new Ge([])),r=new Et(n,e),i=new Et(n,e+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new se(new Ge([])),r=new Et(n,e),i=new Et(n,e+1);let s=_e();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Et(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},Et=class{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return se.comparator(e.key,n.key)||me(e.Hr,n.Hr)}static Ur(e,n){return me(e.Hr,n.Hr)||se.comparator(e.key,n.key)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l4=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Gt(Et.Qr)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new IF(s,n,r,i);this.mutationQueue.push(o);for(const l of i)this.Yr=this.Yr.add(new Et(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?dE:this.er-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Et(n,0),i=new Et(n,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{const l=this.Zr(o.Hr);s.push(l)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Gt(me);return n.forEach(i=>{const s=new Et(i,0),o=new Et(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],l=>{r=r.add(l.Hr)})}),q.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;se.isDocumentKey(s)||(s=s.child(""));const o=new Et(new se(s),0);let l=new Gt(me);return this.Yr.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(l=l.add(u.Hr)),!0)},o),q.resolve(this.ei(l))}ei(e){const n=[];return e.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Pe(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return q.forEach(n.mutations,i=>{const s=new Et(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new Et(n,0),i=this.Yr.firstAfterOrEqual(r);return q.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let u4=class{constructor(e){this.ni=e,this.docs=function(){return new mt(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():Pr.newInvalidDocument(n))}getEntries(e,n){let r=Li();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Pr.newInvalidDocument(i))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Li();const o=n.path,l=new se(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||$$(L$(f),r)<=0||(i.has(f.key)||Tm(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,n,r,i){re(9500)}ri(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new c4(this)}getSize(e){return q.resolve(this.size)}},c4=class extends n4{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h4=class{constructor(e){this.persistence=e,this.ii=new fa(n=>mE(n),gE),this.lastRemoteSnapshotVersion=de.min(),this.highestTargetId=0,this.si=0,this.oi=new TE,this.targetCount=0,this._i=Tv.ar()}forEachTarget(e,n){return this.ii.forEach((r,i)=>n(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),q.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new Tv(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.hr(n),q.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.ii.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),q.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this.oi.containsKey(n))}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pb=class{constructor(e,n){this.ai={},this.overlays={},this.ui=new vm(0),this.ci=!1,this.ci=!0,this.li=new a4,this.referenceDelegate=e(this),this.hi=new h4(this),this.indexManager=new QF,this.remoteDocumentCache=function(i){return new u4(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new KF(n),this.Ti=new s4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new o4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new l4(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){Q("MemoryPersistence","Starting transaction:",e);const i=new d4(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,n){return q.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}},d4=class extends j${constructor(e){super(),this.currentSequenceNumber=e}},f4=class Rb{constructor(e){this.persistence=e,this.Ai=new TE,this.Ri=null}static Vi(e){return new Rb(e)}get mi(){if(this.Ri)return this.Ri;throw re(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),q.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.mi,r=>{const i=se.fromPath(r);return this.fi(e,i).next(s=>{s||n.removeEntry(i,de.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return q.or([()=>q.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}};class wp{constructor(e,n){this.persistence=e,this.gi=new fa(r=>z$(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=t4(this,n)}static Vi(e,n){return new wp(e,n)}Ii(){}di(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return q.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?q.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,n).next(l=>{l||(r++,s.removeEntry(o,de.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),q.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=_f(e.data.value)),n}Sr(e,n,r){return q.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.gi.get(n);return q.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let p4=class Cb{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=i}static Es(e,n){let r=_e(),i=_e();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Cb(e,n.fromCache,r,i)}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m4=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g4=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return oL()?8:U$(Xt())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ps(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new m4;return this.ws(e,n,o).next(l=>{if(s.result=l,this.Rs)return this.Ss(e,n,o,l.size)})}).next(()=>s.result)}Ss(e,n,r,i){return r.documentReadCount<this.Vs?(Aa()<=ye.DEBUG&&Q("QueryEngine","SDK will not create cache indexes for query:",Pa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),q.resolve()):(Aa()<=ye.DEBUG&&Q("QueryEngine","Query:",Pa(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Aa()<=ye.DEBUG&&Q("QueryEngine","The SDK decides to create cache indexes for query:",Pa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Mr(n))):q.resolve())}ps(e,n){if(zI(n))return q.resolve(null);let r=Mr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=gp(n,null,"F"),r=Mr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=_e(...s);return this.gs.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.bs(n,l);return this.Ds(n,h,o,u.readTime)?this.ps(e,gp(n,null,"F")):this.vs(e,h,n,u)}))})))}ys(e,n,r,i){return zI(n)||i.isEqual(de.min())?q.resolve(null):this.gs.getDocuments(e,r).next(s=>{const o=this.bs(n,s);return this.Ds(n,o,r,i)?q.resolve(null):(Aa()<=ye.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Pa(n)),this.vs(e,o,n,M$(i,Ah)).next(l=>l))})}bs(e,n){let r=new Gt(QC(e));return n.forEach((i,s)=>{Tm(e,s)&&(r=r.add(s))}),r}Ds(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,n,r){return Aa()<=ye.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",Pa(n)),this.gs.getDocumentsMatchingQuery(e,n,Sh.min(),r)}vs(e,n,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="LocalStore",y4=3e8;let _4=class{constructor(e,n,r,i){this.persistence=e,this.Cs=n,this.serializer=i,this.Fs=new mt(me),this.Ms=new fa(s=>mE(s),gE),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new i4(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}};function v4(t,e,n,r){return new _4(t,e,n,r)}async function bb(t,e){const n=ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let u=_e();for(const h of i){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(h=>({Bs:h,removedBatchIds:o,addedBatchIds:l}))})})}function w4(t,e){const n=ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Os.newChangeBuffer({trackRemovals:!0});return function(l,u,h,f){const p=h.batch,g=p.keys();let I=q.resolve();return g.forEach(A=>{I=I.next(()=>f.getEntry(u,A)).next(C=>{const N=h.docVersions.get(A);Pe(N!==null,48541),C.version.compareTo(N)<0&&(p.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),f.addEntry(C)))})}),I.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=_e();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function kb(t){const e=ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function E4(t,e){const n=ce(t),r=e.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const l=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;l.push(n.hi.removeMatchingKeys(s,f.removedDocuments,p).next(()=>n.hi.addMatchingKeys(s,f.addedDocuments,p)));let I=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?I=I.withResumeToken(In.EMPTY_BYTE_STRING,de.min()).withLastLimboFreeSnapshotVersion(de.min()):f.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(f.resumeToken,r)),i=i.insert(p,I),function(C,N,P){return C.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=y4?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(g,I,f)&&l.push(n.hi.updateTargetData(s,I))});let u=Li(),h=_e();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),l.push(T4(s,o,e.documentUpdates).next(f=>{u=f.Ls,h=f.ks})),!r.isEqual(de.min())){const f=n.hi.getLastRemoteSnapshotVersion(s).next(p=>n.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(f)}return q.waitFor(l).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(n.Fs=i,s))}function T4(t,e,n){let r=_e(),i=_e();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Li();return n.forEach((l,u)=>{const h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(de.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):Q(IE,"Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ls:o,ks:i}})}function I4(t,e){const n=ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=dE),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function A4(t,e){const n=ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.hi.getTargetData(r,e).next(s=>s?(i=s,q.resolve(i)):n.hi.allocateTargetId(r).next(o=>(i=new EE(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function Av(t,e,n){const r=ce(t),i=r.Fs.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Ul(o))throw o;Q(IE,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function nA(t,e,n){const r=ce(t);let i=de.min(),s=_e();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,f){const p=ce(u),g=p.Ms.get(f);return g!==void 0?q.resolve(p.Fs.get(g)):p.hi.getTargetData(h,f)}(r,o,Mr(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{s=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?i:de.min(),n?s:_e())).next(l=>(S4(r,lF(e),l),{documents:l,qs:s})))}function S4(t,e,n){let r=t.xs.get(e)||de.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.xs.set(e,r)}let rA=class{constructor(){this.activeTargetIds=pF()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},P4=class{constructor(){this.Fo=new rA,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new rA,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R4=class{xo(e){}shutdown(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="ConnectivityMonitor";let sA=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Q(iA,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Q(iA,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wd=null;function Sv(){return Wd===null?Wd=function(){return 268435456+Math.round(2147483648*Math.random())}():Wd++,"0x"+Wd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ry="RestConnection",C4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class b4{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===fp?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,n,r,i,s){const o=Sv(),l=this.Go(e,n.toUriEncodedString());Q(Ry,`Sending RPC '${e}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,i,s);const{host:h}=new URL(l),f=ca(h);return this.jo(e,l,u,r,f).then(p=>(Q(Ry,`Received RPC '${e}' ${o}: `,p),p),p=>{throw Vs(Ry,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",r),p})}Jo(e,n,r,i,s,o){return this.Wo(e,n,r,i,s)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Fl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,n){const r=C4[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let k4=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zt="WebChannelConnection";let x4=class extends b4{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,i,s){const o=Sv();return new Promise((l,u)=>{const h=new yC;h.setWithCredentials(!0),h.listenOnce(_C.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case mf.NO_ERROR:const p=h.getResponseJson();Q(zt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case mf.TIMEOUT:Q(zt,`RPC '${e}' ${o} timed out`),u(new K(F.DEADLINE_EXCEEDED,"Request time out"));break;case mf.HTTP_ERROR:const g=h.getStatus();if(Q(zt,`RPC '${e}' ${o} failed with status:`,g,"response text:",h.getResponseText()),g>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const A=I==null?void 0:I.error;if(A&&A.status&&A.message){const C=function(P){const R=P.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(R)>=0?R:F.UNKNOWN}(A.status);u(new K(C,A.message))}else u(new K(F.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new K(F.UNAVAILABLE,"Connection failed."));break;default:re(9055,{c_:e,streamId:o,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{Q(zt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);Q(zt,`RPC '${e}' ${o} sending request:`,i),h.send(n,"POST",f,r,15)})}P_(e,n,r){const i=Sv(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=EC(),l=wC(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=s.join("");Q(zt,`Creating RPC '${e}' stream ${i}: ${f}`,u);const p=o.createWebChannel(f,u);this.T_(p);let g=!1,I=!1;const A=new k4({Ho:N=>{I?Q(zt,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(g||(Q(zt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),Q(zt,`RPC '${e}' stream ${i} sending:`,N),p.send(N))},Yo:()=>p.close()}),C=(N,P,R)=>{N.listen(P,x=>{try{R(x)}catch(O){setTimeout(()=>{throw O},0)}})};return C(p,pc.EventType.OPEN,()=>{I||(Q(zt,`RPC '${e}' stream ${i} transport opened.`),A.s_())}),C(p,pc.EventType.CLOSE,()=>{I||(I=!0,Q(zt,`RPC '${e}' stream ${i} transport closed`),A.__(),this.I_(p))}),C(p,pc.EventType.ERROR,N=>{I||(I=!0,Vs(zt,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),A.__(new K(F.UNAVAILABLE,"The operation could not be completed")))}),C(p,pc.EventType.MESSAGE,N=>{var P;if(!I){const R=N.data[0];Pe(!!R,16349);const x=R,O=(x==null?void 0:x.error)||((P=x[0])===null||P===void 0?void 0:P.error);if(O){Q(zt,`RPC '${e}' stream ${i} received error:`,O);const M=O.status;let $=function(_){const E=ut[_];if(E!==void 0)return ub(E)}(M),v=O.message;$===void 0&&($=F.INTERNAL,v="Unknown error status: "+M+" with message "+O.message),I=!0,A.__(new K($,v)),p.close()}else Q(zt,`RPC '${e}' stream ${i} received:`,R),A.a_(R)}}),C(l,vC.STAT_EVENT,N=>{N.stat===sv.PROXY?Q(zt,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===sv.NOPROXY&&Q(zt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.o_()},0),A}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}};function Cy(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t){return new DF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AE=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,n-r);i>0&&Q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA="PersistentStream";let xb=class{constructor(e,n,r,i,s,o,l,u){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new AE(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(Oi(n.toString()),Oi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===n&&this.W_(r,i)},r=>{e(()=>{const i=new K(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return Q(oA,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(Q(oA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},N4=class extends xb{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=LF(this.serializer,e),r=function(s){if(!("targetChange"in s))return de.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?de.min():o.readTime?Ln(o.readTime):de.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=Ev(this.serializer),n.addTarget=function(s,o){let l;const u=o.target;if(l=yv(u)?{documents:FF(s,u)}:{query:jF(s,u).Vt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=yb(s,o.resumeToken);const h=vv(s,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(de.min())>0){l.readTime=_p(s,o.snapshotVersion.toTimestamp());const h=vv(s,o.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=BF(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=Ev(this.serializer),n.removeTarget=e,this.k_(n)}},D4=class extends xb{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return Pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=$F(e.writeResults,e.commitTime),r=Ln(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=Ev(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Eb(this.serializer,r))};this.k_(n)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4{}let O4=class extends V4{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new K(F.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,wv(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new K(F.UNKNOWN,s.toString())})}Jo(e,n,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Jo(e,wv(n,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new K(F.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},M4=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Oi(n),this._a=!1):Q("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo="RemoteStore";let L4=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{pa(this)&&(Q(Jo,"Restarting streams for network reachability change."),await async function(u){const h=ce(u);h.Ia.add(4),await td(h),h.Aa.set("Unknown"),h.Ia.delete(4),await Rm(h)}(this))})}),this.Aa=new M4(r,i)}};async function Rm(t){if(pa(t))for(const e of t.da)await e(!0)}async function td(t){for(const e of t.da)await e(!1)}function Nb(t,e){const n=ce(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),CE(n)?RE(n):zl(n).x_()&&PE(n,e))}function SE(t,e){const n=ce(t),r=zl(n);n.Ta.delete(e),r.x_()&&Db(n,e),n.Ta.size===0&&(r.x_()?r.B_():pa(n)&&n.Aa.set("Unknown"))}function PE(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(de.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}zl(t).H_(e)}function Db(t,e){t.Ra.$e(e),zl(t).Y_(e)}function RE(t){t.Ra=new bF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),zl(t).start(),t.Aa.aa()}function CE(t){return pa(t)&&!zl(t).M_()&&t.Ta.size>0}function pa(t){return ce(t).Ia.size===0}function Vb(t){t.Ra=void 0}async function $4(t){t.Aa.set("Online")}async function F4(t){t.Ta.forEach((e,n)=>{PE(t,e)})}async function j4(t,e){Vb(t),CE(t)?(t.Aa.la(e),RE(t)):t.Aa.set("Unknown")}async function U4(t,e,n){if(t.Aa.set("Online"),e instanceof gb&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.Ta.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ta.delete(l),i.Ra.removeTarget(l))}(t,e)}catch(r){Q(Jo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ep(t,r)}else if(e instanceof Tf?t.Ra.Ye(e):e instanceof mb?t.Ra.it(e):t.Ra.et(e),!n.isEqual(de.min()))try{const r=await kb(t.localStore);n.compareTo(r)>=0&&await function(s,o){const l=s.Ra.Pt(o);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=s.Ta.get(h);f&&s.Ta.set(h,f.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,h)=>{const f=s.Ta.get(u);if(!f)return;s.Ta.set(u,f.withResumeToken(In.EMPTY_BYTE_STRING,f.snapshotVersion)),Db(s,u);const p=new EE(f.target,u,h,f.sequenceNumber);PE(s,p)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Q(Jo,"Failed to raise snapshot:",r),await Ep(t,r)}}async function Ep(t,e,n){if(!Ul(e))throw e;t.Ia.add(1),await td(t),t.Aa.set("Offline"),n||(n=()=>kb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Q(Jo,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await Rm(t)})}function Ob(t,e){return e().catch(n=>Ep(t,n,e))}async function Cm(t){const e=ce(t),n=$s(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:dE;for(;B4(e);)try{const i=await I4(e.localStore,r);if(i===null){e.Pa.length===0&&n.B_();break}r=i.batchId,z4(e,i)}catch(i){await Ep(e,i)}Mb(e)&&Lb(e)}function B4(t){return pa(t)&&t.Pa.length<10}function z4(t,e){t.Pa.push(e);const n=$s(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function Mb(t){return pa(t)&&!$s(t).M_()&&t.Pa.length>0}function Lb(t){$s(t).start()}async function q4(t){$s(t).na()}async function W4(t){const e=$s(t);for(const n of t.Pa)e.X_(n.mutations)}async function H4(t,e,n){const r=t.Pa.shift(),i=AF.from(r,e,n);await Ob(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Cm(t)}async function K4(t,e){e&&$s(t).Z_&&await async function(r,i){if(function(o){return lb(o)&&o!==F.ABORTED}(i.code)){const s=r.Pa.shift();$s(r).N_(),await Ob(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Cm(r)}}(t,e),Mb(t)&&Lb(t)}async function aA(t,e){const n=ce(t);n.asyncQueue.verifyOperationInProgress(),Q(Jo,"RemoteStore received new credentials");const r=pa(n);n.Ia.add(3),await td(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await Rm(n)}async function G4(t,e){const n=ce(t);e?(n.Ia.delete(2),await Rm(n)):e||(n.Ia.add(2),await td(n),n.Aa.set("Unknown"))}function zl(t){return t.Va||(t.Va=function(n,r,i){const s=ce(n);return s.ia(),new N4(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:$4.bind(null,t),e_:F4.bind(null,t),n_:j4.bind(null,t),J_:U4.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),CE(t)?RE(t):t.Aa.set("Unknown")):(await t.Va.stop(),Vb(t))})),t.Va}function $s(t){return t.ma||(t.ma=function(n,r,i){const s=ce(n);return s.ia(),new D4(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:q4.bind(null,t),n_:K4.bind(null,t),ea:W4.bind(null,t),ta:H4.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await Cm(t)):(await t.ma.stop(),t.Pa.length>0&&(Q(Jo,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q4=class $b{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Si,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,l=new $b(e,n,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function bE(t,e){if(Oi("AsyncQueue",`${e}: ${t}`),Ul(t))return new K(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fb=class If{static emptySet(e){return new If(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=gc(),this.sortedSet=new mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof If)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new If;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lA=class{constructor(){this.fa=new mt(se.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):re(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}},Tp=class jb{constructor(e,n,r,i,s,o,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new jb(e,n,Fb.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Em(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Y4=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},X4=class{constructor(){this.queries=uA(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const i=ce(n),s=i.queries;i.queries=uA(),s.forEach((o,l)=>{for(const u of l.wa)u.onError(r)})})(this,new K(F.ABORTED,"Firestore shutting down"))}};function uA(){return new fa(t=>GC(t),Em)}async function Ub(t,e){const n=ce(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new Y4,r=e.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=bE(o,`Initialization of query '${Pa(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.wa.push(e),e.va(n.onlineState),s.ya&&e.Ca(s.ya)&&kE(n)}async function Bb(t,e){const n=ce(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function J4(t,e){const n=ce(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const l of o.wa)l.Ca(i)&&(r=!0);o.ya=i}}r&&kE(n)}function Z4(t,e,n){const r=ce(t),i=r.queries.get(e);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(e)}function kE(t){t.Da.forEach(e=>{e.next()})}var Pv,cA;(cA=Pv||(Pv={})).Fa="default",cA.Cache="cache";let zb=class{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Tp(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=Tp.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Pv.Cache}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qb=class{constructor(e){this.key=e}},Wb=class{constructor(e){this.key=e}},ej=class{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=_e(),this.mutatedKeys=_e(),this.Xa=QC(e),this.eu=new Fb(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new lA,i=n?n.eu:this.eu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),I=Tm(this.query,p)?p:null,A=!!g&&this.mutatedKeys.has(g.key),C=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let N=!1;g&&I?g.data.isEqual(I.data)?A!==C&&(r.track({type:3,doc:I}),N=!0):this.iu(g,I)||(r.track({type:2,doc:I}),N=!0,(u&&this.Xa(I,u)>0||h&&this.Xa(I,h)<0)&&(l=!0)):!g&&I?(r.track({type:0,doc:I}),N=!0):g&&!I&&(r.track({type:1,doc:g}),N=!0,(u||h)&&(l=!0)),N&&(I?(o=o.add(I),s=C?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{eu:o,ru:r,Ds:l,mutatedKeys:s}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((f,p)=>function(I,A){const C=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return re(20277,{At:N})}};return C(I)-C(A)}(f.type,p.type)||this.Xa(f.doc,p.doc)),this.su(r),i=i!=null&&i;const l=n&&!i?this.ou():[],u=this.Za.size===0&&this.current&&!i?1:0,h=u!==this.Ya;return this.Ya=u,o.length!==0||h?{snapshot:new Tp(this.query,e.eu,s,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:l}:{_u:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new lA,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=_e(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new Wb(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new qb(r))}),n}uu(e){this.Ha=e.qs,this.Za=_e();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return Tp.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}};const xE="SyncEngine";let tj=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},nj=class{constructor(e){this.key=e,this.lu=!1}},rj=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new fa(l=>GC(l),Em),this.Tu=new Map,this.Iu=new Set,this.du=new mt(se.comparator),this.Eu=new Map,this.Au=new TE,this.Ru={},this.Vu=new Map,this.mu=Tv.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};async function ij(t,e,n=!0){const r=Xb(t);let i;const s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await Hb(r,e,n,!0),i}async function sj(t,e){const n=Xb(t);await Hb(n,e,!0,!1)}async function Hb(t,e,n,r){const i=await A4(t.localStore,Mr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await oj(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Nb(t.remoteStore,i),l}async function oj(t,e,n,r,i){t.gu=(p,g,I)=>async function(C,N,P,R){let x=N.view.nu(P);x.Ds&&(x=await nA(C.localStore,N.query,!1).then(({documents:v})=>N.view.nu(v,x)));const O=R&&R.targetChanges.get(N.targetId),M=R&&R.targetMismatches.get(N.targetId)!=null,$=N.view.applyChanges(x,C.isPrimaryClient,O,M);return dA(C,N.targetId,$._u),$.snapshot}(t,p,g,I);const s=await nA(t.localStore,e,!0),o=new ej(e,s.qs),l=o.nu(s.documents),u=vE.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),h=o.applyChanges(l,t.isPrimaryClient,u);dA(t,n,h._u);const f=new tj(e,n,o);return t.Pu.set(e,f),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),h.snapshot}async function aj(t,e,n){const r=ce(t),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!Em(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Av(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&SE(r.remoteStore,i.targetId),Rv(r,i.targetId)}).catch(jl)):(Rv(r,i.targetId),await Av(r.localStore,i.targetId,!0))}async function lj(t,e){const n=ce(t),r=n.Pu.get(e),i=n.Tu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),SE(n.remoteStore,r.targetId))}async function uj(t,e,n){const r=gj(t);try{const i=await function(o,l){const u=ce(o),h=Rt.now(),f=l.reduce((I,A)=>I.add(A.key),_e());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",I=>{let A=Li(),C=_e();return u.Os.getEntries(I,f).next(N=>{A=N,A.forEach((P,R)=>{R.isValidDocument()||(C=C.add(P))})}).next(()=>u.localDocuments.getOverlayedDocuments(I,A)).next(N=>{p=N;const P=[];for(const R of l){const x=TF(R,p.get(R.key).overlayedDocument);x!=null&&P.push(new Xs(R.key,x,$C(x.value.mapValue),Nn.exists(!0)))}return u.mutationQueue.addMutationBatch(I,h,P,l)}).next(N=>{g=N;const P=N.applyToLocalDocumentSet(p,C);return u.documentOverlayCache.saveOverlays(I,N.batchId,P)})}).then(()=>({batchId:g.batchId,changes:XC(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,u){let h=o.Ru[o.currentUser.toKey()];h||(h=new mt(me)),h=h.insert(l,u),o.Ru[o.currentUser.toKey()]=h}(r,i.batchId,n),await nd(r,i.changes),await Cm(r.remoteStore)}catch(i){const s=bE(i,"Failed to persist write");n.reject(s)}}async function Kb(t,e){const n=ce(t);try{const r=await E4(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Eu.get(s);o&&(Pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?Pe(o.lu,14607):i.removedDocuments.size>0&&(Pe(o.lu,42227),o.lu=!1))}),await nd(n,r,e)}catch(r){await jl(r)}}function hA(t,e,n){const r=ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Pu.forEach((s,o)=>{const l=o.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const u=ce(o);u.onlineState=l;let h=!1;u.queries.forEach((f,p)=>{for(const g of p.wa)g.va(l)&&(h=!0)}),h&&kE(u)}(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function cj(t,e,n){const r=ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Eu.get(e),s=i&&i.key;if(s){let o=new mt(se.comparator);o=o.insert(s,Pr.newNoDocument(s,de.min()));const l=_e().add(s),u=new hb(de.min(),new Map,new mt(me),o,l);await Kb(r,u),r.du=r.du.remove(s),r.Eu.delete(e),NE(r)}else await Av(r.localStore,e,!1).then(()=>Rv(r,e,n)).catch(jl)}async function hj(t,e){const n=ce(t),r=e.batch.batchId;try{const i=await w4(n.localStore,e);Qb(n,r,null),Gb(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await nd(n,i)}catch(i){await jl(i)}}async function dj(t,e,n){const r=ce(t);try{const i=await function(o,l){const u=ce(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next(p=>(Pe(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(r.localStore,e);Qb(r,e,n),Gb(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await nd(r,i)}catch(i){await jl(i)}}function Gb(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function Qb(t,e,n){const r=ce(t);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function Rv(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||Yb(t,r)})}function Yb(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(SE(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),NE(t))}function dA(t,e,n){for(const r of n)r instanceof qb?(t.Au.addReference(r.key,e),fj(t,r)):r instanceof Wb?(Q(xE,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||Yb(t,r.key)):re(19791,{yu:r})}function fj(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(Q(xE,"New document in limbo: "+n),t.Iu.add(r),NE(t))}function NE(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new se(Ge.fromString(e)),r=t.mu.next();t.Eu.set(r,new nj(n)),t.du=t.du.insert(n,r),Nb(t.remoteStore,new EE(Mr(yE(n.path)),r,"TargetPurposeLimboResolution",vm.ue))}}async function nd(t,e,n){const r=ce(t),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((l,u)=>{o.push(r.gu(u,e,n).then(h=>{var f;if((h||n)&&r.isPrimaryClient){const p=h?!h.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(h){i.push(h);const p=p4.Es(u.targetId,h);s.push(p)}}))}),await Promise.all(o),r.hu.J_(i),await async function(u,h){const f=ce(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>q.forEach(h,g=>q.forEach(g.Is,I=>f.persistence.referenceDelegate.addReference(p,g.targetId,I)).next(()=>q.forEach(g.ds,I=>f.persistence.referenceDelegate.removeReference(p,g.targetId,I)))))}catch(p){if(!Ul(p))throw p;Q(IE,"Failed to update sequence numbers: "+p)}for(const p of h){const g=p.targetId;if(!p.fromCache){const I=f.Fs.get(g),A=I.snapshotVersion,C=I.withLastLimboFreeSnapshotVersion(A);f.Fs=f.Fs.insert(g,C)}}}(r.localStore,s))}async function pj(t,e){const n=ce(t);if(!n.currentUser.isEqual(e)){Q(xE,"User change. New user:",e.toKey());const r=await bb(n.localStore,e);n.currentUser=e,function(s,o){s.Vu.forEach(l=>{l.forEach(u=>{u.reject(new K(F.CANCELLED,o))})}),s.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await nd(n,r.Bs)}}function mj(t,e){const n=ce(t),r=n.Eu.get(e);if(r&&r.lu)return _e().add(r.key);{let i=_e();const s=n.Tu.get(e);if(!s)return i;for(const o of s){const l=n.Pu.get(o);i=i.unionWith(l.view.tu)}return i}}function Xb(t){const e=ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Kb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cj.bind(null,e),e.hu.J_=J4.bind(null,e.eventManager),e.hu.pu=Z4.bind(null,e.eventManager),e}function gj(t){const e=ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dj.bind(null,e),e}let Ip=class{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Pm(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return v4(this.persistence,new g4,e.initialUser,this.serializer)}Du(e){return new Pb(f4.Vi,this.serializer)}bu(e){return new P4}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};Ip.provider={build:()=>new Ip};class yj extends Ip{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){Pe(this.persistence.referenceDelegate instanceof wp,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ZF(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new Pb(r=>wp.Vi(r,n),this.serializer)}}let Cv=class{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>hA(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=pj.bind(null,this.syncEngine),await G4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new X4}()}createDatastore(e){const n=Pm(e.databaseInfo.databaseId),r=function(s){return new x4(s)}(e.databaseInfo);return function(s,o,l,u){return new O4(s,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,l){return new L4(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>hA(this.syncEngine,n,0),function(){return sA.C()?new sA:new R4}())}createSyncEngine(e,n){return function(i,s,o,l,u,h,f){const p=new rj(i,s,o,l,u,h);return f&&(p.fu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ce(i);Q(Jo,"RemoteStore shutting down."),s.Ia.add(5),await td(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}};Cv.provider={build:()=>new Cv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jb=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Oi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new K(F.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(i,s){const o=ce(i),l={documents:s.map(p=>vp(o.serializer,p))},u=await o.Jo("BatchGetDocuments",o.serializer.databaseId,Ge.emptyPath(),l,s.length),h=new Map;u.forEach(p=>{const g=MF(o.serializer,p);h.set(g.key.toString(),g)});const f=[];return s.forEach(p=>{const g=h.get(p.toString());Pe(!!g,55234,{key:p}),f.push(g)}),f}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Sm(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=se.fromPath(r);this.mutations.push(new ob(i,this.precondition(i)))}),await async function(r,i){const s=ce(r),o={writes:i.map(l=>Eb(s.serializer,l))};await s.Wo("Commit",s.serializer.databaseId,Ge.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw re(50498,{Wu:e.constructor.name});n=de.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new K(F.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(de.min())?Nn.exists(!1):Nn.updateTime(n):Nn.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(de.min()))throw new K(F.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Nn.updateTime(n)}return Nn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Gu=r.maxAttempts,this.F_=new AE(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new _j(this.datastore),n=this.Ju(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Hu(i)}))}).catch(r=>{this.Hu(r)})})}Ju(e){try{const n=this.updateFunction(e);return!Zh(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!lb(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs="FirestoreClient";let wj=class{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Wt.UNAUTHENTICATED,this.clientId=hE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Q(Fs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Q(Fs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Si;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=bE(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function by(t,e){t.asyncQueue.verifyOperationInProgress(),Q(Fs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await bb(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>{Vs("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{Q("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Vs("Terminating Firestore due to IndexedDb database deletion failed",i)})}),t._offlineComponents=e}async function fA(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Ej(t);Q(Fs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>aA(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>aA(e.remoteStore,i)),t._onlineComponents=e}async function Ej(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Q(Fs,"Using user provided OfflineComponentProvider");try{await by(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===F.FAILED_PRECONDITION||i.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Vs("Error using user provided cache. Falling back to memory cache: "+n),await by(t,new Ip)}}else Q(Fs,"Using default OfflineComponentProvider"),await by(t,new yj(void 0));return t._offlineComponents}async function DE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Q(Fs,"Using user provided OnlineComponentProvider"),await fA(t,t._uninitializedComponentsProvider._online)):(Q(Fs,"Using default OnlineComponentProvider"),await fA(t,new Cv))),t._onlineComponents}function Tj(t){return DE(t).then(e=>e.syncEngine)}function Ij(t){return DE(t).then(e=>e.datastore)}async function bv(t){const e=await DE(t),n=e.eventManager;return n.onListen=ij.bind(null,e.syncEngine),n.onUnlisten=aj.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=sj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=lj.bind(null,e.syncEngine),n}function Aj(t,e,n={}){const r=new Si;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,h){const f=new Jb({next:g=>{f.Ou(),o.enqueueAndForget(()=>Bb(s,p)),g.fromCache&&u.source==="server"?h.reject(new K(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(g)},error:g=>h.reject(g)}),p=new zb(l,f,{includeMetadataChanges:!0,ka:!0});return Ub(s,p)}(await bv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek="firestore.googleapis.com",mA=!0;let gA=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new K(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ek,this.ssl=mA}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:mA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Sb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<XF)throw new K(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}V$("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Zb((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},bm=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new S$;switch(r.type){case"firstParty":return new b$(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=pA.get(n);r&&(Q("ComponentProvider","Removing Datastore"),pA.delete(n),r.terminate())}(this),Promise.resolve()}};function Sj(t,e,n,r={}){var i;t=Mn(t,bm);const s=ca(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${n}`;s&&(oE(`https://${u}`),aE("Firestore",!0)),o.host!==ek&&o.host!==u&&Vs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h=Object.assign(Object.assign({},o),{host:u,ssl:s,emulatorOptions:r});if(!Yo(h,l)&&(t._setSettings(h),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=Wt.MOCK_USER;else{f=XM(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new K(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Wt(g)}t._authCredentials=new P$(new IC(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ma=class tk{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new tk(this.firestore,e,this._query)}},Lt=class vc{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vc(this.firestore,e,this._key)}toJSON(){return{type:vc._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Jh(n,vc._jsonSchema))return new vc(e,r||null,new se(Ge.fromString(n.referencePath)))}};Lt._jsonSchemaVersion="firestore/documentReference/1.0",Lt._jsonSchema={type:ft("string",Lt._jsonSchemaVersion),referencePath:ft("string")};let tl=class nk extends ma{constructor(e,n,r){super(e,n,yE(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Lt(this.firestore,null,new se(e))}withConverter(e){return new nk(this.firestore,e,this._path)}};function Dt(t,e,...n){if(t=et(t),PC("collection","path",e),t instanceof bm){const r=Ge.fromString(e,...n);return bI(r),new tl(t,null,r)}{if(!(t instanceof Lt||t instanceof tl))throw new K(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return bI(r),new tl(t.firestore,null,r)}}function Jt(t,e,...n){if(t=et(t),arguments.length===1&&(e=hE.newId()),PC("doc","path",e),t instanceof bm){const r=Ge.fromString(e,...n);return CI(r),new Lt(t,null,new se(r))}{if(!(t instanceof Lt||t instanceof tl))throw new K(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return CI(r),new Lt(t.firestore,t instanceof tl?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA="AsyncQueue";let _A=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new AE(this,"async_queue_retry"),this.oc=()=>{const r=Cy();r&&Q(yA,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=Cy();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=Cy();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new Si;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Ul(e))throw e;Q(yA,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Oi("INTERNAL UNHANDLED ERROR: ",vA(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const i=Q4.createAndSchedule(this,e,n,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&re(47125,{hc:vA(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}};function vA(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}let $i=class extends bm{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new _A,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _A(e),this._firestoreClient=void 0,await e}}};function Pj(t,e){const n=typeof t=="object"?t:ym(),r=typeof t=="string"?t:fp,i=da(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=sC("firestore");s&&Sj(i,...s)}return i}function km(t){if(t._terminated)throw new K(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Rj(t),t._firestoreClient}function Rj(t){var e,n,r;const i=t._freezeSettings(),s=function(l,u,h,f){return new H$(l,u,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Zb(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new wj(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uo=class ba{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ba(In.fromBase64String(e))}catch(n){throw new K(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ba(In.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ba._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Jh(e,ba._jsonSchema))return ba.fromBase64String(e.bytes)}};Uo._jsonSchemaVersion="firestore/bytes/1.0",Uo._jsonSchema={type:ft("string",Uo._jsonSchemaVersion),bytes:ft("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rd=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new K(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ir(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xm=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nl=class Af{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new K(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new K(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return me(this._lat,e._lat)||me(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Af._jsonSchemaVersion}}static fromJSON(e){if(Jh(e,Af._jsonSchema))return new Af(e.latitude,e.longitude)}};nl._jsonSchemaVersion="firestore/geoPoint/1.0",nl._jsonSchema={type:ft("string",nl._jsonSchemaVersion),latitude:ft("number"),longitude:ft("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rl=class Sf{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Sf._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Jh(e,Sf._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Sf(e.vectorValues);throw new K(F.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};rl._jsonSchemaVersion="firestore/vectorValue/1.0",rl._jsonSchema={type:ft("string",rl._jsonSchemaVersion),vectorValues:ft("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj=/^__.*__$/;let bj=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Xs(e,this.data,this.fieldMask,n,this.fieldTransforms):new ed(e,this.data,n,this.fieldTransforms)}};class rk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Xs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function ik(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw re(40011,{Ec:t})}}let kj=class sk{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new sk(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Ap(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(ik(this.Ec)&&Cj.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},xj=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Pm(e)}Dc(e,n,r,i=!1){return new kj({Ec:e,methodName:n,bc:r,path:Ir.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function id(t){const e=t._freezeSettings(),n=Pm(t._databaseId);return new xj(t._databaseId,!!e.ignoreUndefinedProperties,n)}function VE(t,e,n,r,i,s={}){const o=t.Dc(s.merge||s.mergeFields?2:0,e,n,i);OE("Data must be an object, but it was:",o,r);const l=uk(r,o);let u,h;if(s.merge)u=new Dr(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=kv(e,p,n);if(!o.contains(g))throw new K(F.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);hk(f,g)||f.push(g)}u=new Dr(f),h=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,h=o.fieldTransforms;return new bj(new qn(l),u,h)}class Nm extends xm{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Nm}}let Nj=class ok extends xm{_toFieldTransform(e){return new _F(e.path,new bh)}isEqual(e){return e instanceof ok}};function ak(t,e,n,r){const i=t.Dc(1,e,n);OE("Data must be an object, but it was:",i,r);const s=[],o=qn.empty();Ys(r,(u,h)=>{const f=ME(e,u,n);h=et(h);const p=i.gc(f);if(h instanceof Nm)s.push(f);else{const g=sd(h,p);g!=null&&(s.push(f),o.set(f,g))}});const l=new Dr(s);return new rk(o,l,i.fieldTransforms)}function lk(t,e,n,r,i,s){const o=t.Dc(1,e,n),l=[kv(e,r,n)],u=[i];if(s.length%2!=0)throw new K(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(kv(e,s[g])),u.push(s[g+1]);const h=[],f=qn.empty();for(let g=l.length-1;g>=0;--g)if(!hk(h,l[g])){const I=l[g];let A=u[g];A=et(A);const C=o.gc(I);if(A instanceof Nm)h.push(I);else{const N=sd(A,C);N!=null&&(h.push(I),f.set(I,N))}}const p=new Dr(h);return new rk(f,p,o.fieldTransforms)}function Dj(t,e,n,r=!1){return sd(n,t.Dc(r?4:3,e))}function sd(t,e){if(ck(t=et(t)))return OE("Unsupported field value:",e,t),uk(t,e);if(t instanceof xm)return function(r,i){if(!ik(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let u=sd(l,i.yc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=et(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return mF(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Rt.fromDate(r);return{timestampValue:_p(i.serializer,s)}}if(r instanceof Rt){const s=new Rt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:_p(i.serializer,s)}}if(r instanceof nl)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Uo)return{bytesValue:yb(i.serializer,r._byteString)};if(r instanceof Lt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:wE(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof rl)return function(o,l){return{mapValue:{fields:{[MC]:{stringValue:LC},[pp]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw l.wc("VectorValues must only contain numeric values.");return _E(l.serializer,h)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${_m(r)}`)}(t,e)}function uk(t,e){const n={};return bC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ys(t,(r,i)=>{const s=sd(i,e.Vc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function ck(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Rt||t instanceof nl||t instanceof Uo||t instanceof Lt||t instanceof xm||t instanceof rl)}function OE(t,e,n){if(!ck(n)||!RC(n)){const r=_m(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function kv(t,e,n){if((e=et(e))instanceof rd)return e._internalPath;if(typeof e=="string")return ME(t,e);throw Ap("Field path arguments must be of type string or ",t,!1,void 0,n)}const Vj=new RegExp("[~\\*/\\[\\]]");function ME(t,e,n){if(e.search(Vj)>=0)throw Ap(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rd(...e.split("."))._internalPath}catch{throw Ap(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ap(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new K(F.INVALID_ARGUMENT,l+t+u)}function hk(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sp=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Oj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Dm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},Oj=class extends Sp{data(){return super.data()}};function Dm(t,e){return typeof e=="string"?ME(t,e):e instanceof rd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new K(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}let LE=class{},$E=class extends LE{};function sn(t,e,...n){let r=[];e instanceof LE&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof Mj).length,l=s.filter(u=>u instanceof fk).length;if(o>1||o>0&&l>0)throw new K(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}let fk=class pk extends $E{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new pk(e,n,r)}_apply(e){const n=this._parse(e);return _k(e._query,n),new ma(e.firestore,e.converter,_v(e._query,n))}_parse(e){const n=id(e.firestore);return function(s,o,l,u,h,f,p){let g;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new K(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){TA(p,f);const A=[];for(const C of p)A.push(EA(u,s,C));g={arrayValue:{values:A}}}else g=EA(u,s,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||TA(p,f),g=Dj(l,o,p,f==="in"||f==="not-in");return At.create(h,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function vt(t,e,n){const r=e,i=Dm("where",t);return fk._create(i,r,n)}let Mj=class mk extends LE{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new mk(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Mi.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const u of l)_k(o,u),o=_v(o,u)}(e._query,n),new ma(e.firestore,e.converter,_v(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}},Lj=class gk extends $E{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new gk(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new K(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new K(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ch(s,o)}(e._query,this._field,this._direction);return new ma(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Bl(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function _i(t,e="asc"){const n=e,r=Dm("orderBy",t);return Lj._create(r,n)}let $j=class yk extends $E{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new yk(e,n,r)}_apply(e){return new ma(e.firestore,e.converter,gp(e._query,this._limit,this._limitType))}};function Pp(t){return O$("limit",t),$j._create("limit",t,"F")}function EA(t,e,n){if(typeof(n=et(n))=="string"){if(n==="")throw new K(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!KC(e)&&n.indexOf("/")!==-1)throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ge.fromString(n));if(!se.isDocumentKey(r))throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return LI(t,new se(r))}if(n instanceof Lt)return LI(t,n._key);throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_m(n)}.`)}function TA(t,e){if(!Array.isArray(t)||t.length===0)throw new K(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _k(t,e){const n=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new K(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new K(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}let vk=class{convertValue(e,n="none"){switch(Ls(e)){case 0:return null;case 1:return e.booleanValue;case 2:return st(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ms(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw re(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ys(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n[pp].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>st(o.doubleValue));return new rl(s)}convertGeoPoint(e){return new nl(st(e.latitude),st(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=wm(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ph(e));default:return null}}convertTimestamp(e){const n=Os(e);return new Rt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ge.fromString(e);Pe(Ab(r),9688,{name:e});const i=new OC(r.get(1),r.get(3)),s=new se(r.popFirst(5));return i.isEqual(n)||Oi(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Fj extends vk{constructor(e){super(),this.firestore=e}convertBytes(e){return new Uo(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,n)}}let Wa=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},il=class wk extends Sp{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Pf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Dm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new K(F.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=wk._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}};il._jsonSchemaVersion="firestore/documentSnapshot/1.0",il._jsonSchema={type:ft("string",il._jsonSchemaVersion),bundleSource:ft("string","DocumentSnapshot"),bundleName:ft("string"),bundle:ft("string")};let Pf=class extends il{data(e={}){return super.data(e)}},Wc=class Ek{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Wa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Pf(this._firestore,this._userDataWriter,r.key,r,new Wa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new K(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const u=new Pf(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Wa(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new Pf(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Wa(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:jj(l.type),doc:u,oldIndex:h,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new K(F.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ek._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hE.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function jj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return re(61501,{type:t})}}Wc._jsonSchemaVersion="firestore/querySnapshot/1.0",Wc._jsonSchema={type:ft("string",Wc._jsonSchemaVersion),bundleSource:ft("string","QuerySnapshot"),bundleName:ft("string"),bundle:ft("string")};let Vm=class extends vk{constructor(e){super(),this.firestore=e}convertBytes(e){return new Uo(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,n)}};function Do(t){t=Mn(t,ma);const e=Mn(t.firestore,$i),n=km(e),r=new Vm(e);return dk(t._query),Aj(n,t._query).then(i=>new Wc(e,r,t,i))}function Om(t,e,n){t=Mn(t,Lt);const r=Mn(t.firestore,$i),i=FE(t.converter,e,n);return Mm(r,[VE(id(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Nn.none())])}function Hc(t,e,n,...r){t=Mn(t,Lt);const i=Mn(t.firestore,$i),s=id(i);let o;return o=typeof(e=et(e))=="string"||e instanceof rd?lk(s,"updateDoc",t._key,e,n,r):ak(s,"updateDoc",t._key,e),Mm(i,[o.toMutation(t._key,Nn.exists(!0))])}function Tk(t){return Mm(Mn(t.firestore,$i),[new Sm(t._key,Nn.none())])}function ky(t,e){const n=Mn(t.firestore,$i),r=Jt(t),i=FE(t.converter,e);return Mm(n,[VE(id(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Nn.exists(!1))]).then(()=>r)}function Pi(t,...e){var n,r,i;t=et(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||wA(e[o])||(s=e[o++]);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(wA(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let u,h,f;if(t instanceof Lt)h=Mn(t.firestore,$i),f=yE(t._key.path),u={next:p=>{e[o]&&e[o](Uj(h,t,p))},error:e[o+1],complete:e[o+2]};else{const p=Mn(t,ma);h=Mn(p.firestore,$i),f=p._query;const g=new Vm(h);u={next:I=>{e[o]&&e[o](new Wc(h,g,p,I))},error:e[o+1],complete:e[o+2]},dk(t._query)}return function(g,I,A,C){const N=new Jb(C),P=new zb(I,N,A);return g.asyncQueue.enqueueAndForget(async()=>Ub(await bv(g),P)),()=>{N.Ou(),g.asyncQueue.enqueueAndForget(async()=>Bb(await bv(g),P))}}(km(h),f,l,u)}function Mm(t,e){return function(r,i){const s=new Si;return r.asyncQueue.enqueueAndForget(async()=>uj(await Tj(r),i,s)),s.promise}(km(t),e)}function Uj(t,e,n){const r=n.docs.get(e._key),i=new Vm(t);return new il(t,i,e._key,r,new Wa(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj={maxAttempts:5};function wc(t,e){if((t=et(t)).firestore!==e)throw new K(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=id(e)}get(e){const n=wc(e,this._firestore),r=new Fj(this._firestore);return this._transaction.lookup([n._key]).then(i=>{if(!i||i.length!==1)return re(24041);const s=i[0];if(s.isFoundDocument())return new Sp(this._firestore,r,s.key,s,n.converter);if(s.isNoDocument())return new Sp(this._firestore,r,n._key,null,n.converter);throw re(18433,{doc:s})})}set(e,n,r){const i=wc(e,this._firestore),s=FE(i.converter,n,r),o=VE(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,n,r,...i){const s=wc(e,this._firestore);let o;return o=typeof(n=et(n))=="string"||n instanceof rd?lk(this._dataReader,"Transaction.update",s._key,n,r,i):ak(this._dataReader,"Transaction.update",s._key,n),this._transaction.update(s._key,o),this}delete(e){const n=wc(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj extends zj{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=wc(e,this._firestore),r=new Vm(this._firestore);return super.get(e).then(i=>new il(this._firestore,r,n._key,i._document,new Wa(!1,!1),n.converter))}}function Wj(t,e,n){t=Mn(t,$i);const r=Object.assign(Object.assign({},Bj),n);return function(s){if(s.maxAttempts<1)throw new K(F.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,l){const u=new Si;return s.asyncQueue.enqueueAndForget(async()=>{const h=await Ij(s);new vj(s.asyncQueue,h,l,o,u).zu()}),u.promise}(km(t),i=>e(new qj(t,i)),r)}function Ot(){return new Nj("serverTimestamp")}(function(e,n=!0){(function(i){Fl=i})($l),Sr(new Xn("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new $i(new R$(r.getProvider("auth-internal")),new k$(o,r.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new K(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new OC(h.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),En(II,AI,e),En(II,AI,"esm2017")})();function od(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Ik(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Hj=Ik,Ak=new ha("auth","Firebase",Ik());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp=new lE("@firebase/auth");function Kj(t,...e){Rp.logLevel<=ye.WARN&&Rp.warn(`Auth (${$l}): ${t}`,...e)}function Rf(t,...e){Rp.logLevel<=ye.ERROR&&Rp.error(`Auth (${$l}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(t,...e){throw jE(t,...e)}function Lr(t,...e){return jE(t,...e)}function Sk(t,e,n){const r=Object.assign(Object.assign({},Hj()),{[e]:n});return new ha("auth","Firebase",r).create(e,{appName:t.name})}function Bo(t){return Sk(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jE(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Ak.create(t,...e)}function ae(t,e,...n){if(!t)throw jE(e,...n)}function vi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Rf(e),new Error(e)}function ji(t,e){t||vi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Gj(){return IA()==="http:"||IA()==="https:"}function IA(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Gj()||rL()||"connection"in navigator)?navigator.onLine:!0}function Yj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ad=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,ji(n>e,"Short delay should be less than long delay!"),this.isMobile=eL()||iL()}get(){return Qj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(t,e){ji(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pk=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Zj=new ad(3e4,6e4);function BE(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ql(t,e,n,r,i={}){return Rk(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=Yh(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:u},s);return nL()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&ca(t.emulatorConfig.host)&&(h.credentials="include"),Pk.fetch()(await Ck(t,t.config.apiHost,n,l),h)})}async function Rk(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Xj),e);try{const i=new tU(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Hd(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hd(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Hd(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Hd(t,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Sk(t,f,h);Fi(t,f)}}catch(i){if(i instanceof Qs)throw i;Fi(t,"network-request-failed",{message:String(i)})}}async function eU(t,e,n,r,i={}){const s=await ql(t,e,n,r,i);return"mfaPendingCredential"in s&&Fi(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function Ck(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?UE(t.config,i):`${t.config.apiScheme}://${i}`;return Jj.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}let tU=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Lr(this.auth,"network-request-failed")),Zj.get())})}};function Hd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Lr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nU(t,e){return ql(t,"POST","/v1/accounts:delete",e)}async function Cp(t,e){return ql(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function rU(t,e=!1){const n=et(t),r=await n.getIdToken(e),i=zE(r);ae(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Kc(xy(i.auth_time)),issuedAtTime:Kc(xy(i.iat)),expirationTime:Kc(xy(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function xy(t){return Number(t)*1e3}function zE(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Rf("JWT malformed, contained fewer than 3 sections"),null;try{const i=rC(n);return i?JSON.parse(i):(Rf("Failed to decode base64 JWT payload"),null)}catch(i){return Rf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function AA(t){const e=zE(t);return ae(e,"internal-error"),ae(typeof e.exp<"u","internal-error"),ae(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nh(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Qs&&iU(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function iU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sU=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nv=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kc(this.lastLoginAt),this.creationTime=Kc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bp(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Nh(t,Cp(n,{idToken:r}));ae(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?bk(s.providerUserInfo):[],l=aU(t.providerData,o),u=t.isAnonymous,h=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),f=u?h:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Nv(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function oU(t){const e=et(t);await bp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function aU(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function bk(t){return t.map(e=>{var{providerId:n}=e,r=od(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lU(t,e){const n=await Rk(t,{},async()=>{const r=Yh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await Ck(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return t.emulatorConfig&&ca(t.emulatorConfig.host)&&(u.credentials="include"),Pk.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function uU(t,e){return ql(t,"POST","/v2/accounts:revokeToken",BE(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ny=class Dv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ae(e.idToken,"internal-error"),ae(typeof e.idToken<"u","internal-error"),ae(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):AA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ae(e.length!==0,"internal-error");const n=AA(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ae(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await lU(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Dv;return r&&(ae(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ae(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ae(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Dv,this.toJSON())}_performRefresh(){return vi("not implemented")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(t,e){ae(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}let Ha=class Ec{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=od(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Nv(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Nh(this,this.stsTokenManager.getToken(this.auth,e));return ae(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return rU(this,e)}reload(){return oU(this)}_assign(e){this!==e&&(ae(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ec(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await bp(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_r(this.auth.app))return Promise.reject(Bo(this.auth));const e=await this.getIdToken();return await Nh(this,nU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,l,u,h,f;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(i=n.email)!==null&&i!==void 0?i:void 0,I=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,A=(o=n.photoURL)!==null&&o!==void 0?o:void 0,C=(l=n.tenantId)!==null&&l!==void 0?l:void 0,N=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,P=(h=n.createdAt)!==null&&h!==void 0?h:void 0,R=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:x,emailVerified:O,isAnonymous:M,providerData:$,stsTokenManager:v}=n;ae(x&&v,e,"internal-error");const y=Ny.fromJSON(this.name,v);ae(typeof x=="string",e,"internal-error"),Xi(p,e.name),Xi(g,e.name),ae(typeof O=="boolean",e,"internal-error"),ae(typeof M=="boolean",e,"internal-error"),Xi(I,e.name),Xi(A,e.name),Xi(C,e.name),Xi(N,e.name),Xi(P,e.name),Xi(R,e.name);const _=new Ec({uid:x,auth:e,email:g,emailVerified:O,displayName:p,isAnonymous:M,photoURL:A,phoneNumber:I,tenantId:C,stsTokenManager:y,createdAt:P,lastLoginAt:R});return $&&Array.isArray($)&&(_.providerData=$.map(E=>Object.assign({},E))),N&&(_._redirectEventId=N),_}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ny;i.updateFromServerResponse(n);const s=new Ec({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await bp(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];ae(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?bk(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new Ny;l.updateFromIdToken(r);const u=new Ec({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Nv(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,h),u}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=new Map;function wi(t){ji(t instanceof Function,"Expected a class definition");let e=SA.get(t);return e?(ji(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,SA.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kk=class{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}};kk.type="NONE";const PA=kk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(t,e,n){return`firebase:${t}:${e}:${n}`}let RA=class bf{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Cf(this.userKey,i.apiKey,s),this.fullPersistenceKey=Cf("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Cp(this.auth,{idToken:e}).catch(()=>{});return n?Ha._fromGetAccountInfoResponse(this.auth,n,e):null}return Ha._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new bf(wi(PA),e,r);const i=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||wi(PA);const o=Cf(r,e.config.apiKey,e.name);let l=null;for(const h of n)try{const f=await h._get(o);if(f){let p;if(typeof f=="string"){const g=await Cp(e,{idToken:f}).catch(()=>{});if(!g)break;p=await Ha._fromGetAccountInfoResponse(e,g,f)}else p=Ha._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new bf(s,e,r):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(n.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new bf(s,e,r))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Vk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Mk(e))return"Blackberry";if(Lk(e))return"Webos";if(Nk(e))return"Safari";if((e.includes("chrome/")||Dk(e))&&!e.includes("edge/"))return"Chrome";if(Ok(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function xk(t=Xt()){return/firefox\//i.test(t)}function Nk(t=Xt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Dk(t=Xt()){return/crios\//i.test(t)}function Vk(t=Xt()){return/iemobile/i.test(t)}function Ok(t=Xt()){return/android/i.test(t)}function Mk(t=Xt()){return/blackberry/i.test(t)}function Lk(t=Xt()){return/webos/i.test(t)}function qE(t=Xt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function cU(t=Xt()){var e;return qE(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function hU(){return sL()&&document.documentMode===10}function $k(t=Xt()){return qE(t)||Ok(t)||Lk(t)||Mk(t)||/windows phone/i.test(t)||Vk(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fk(t,e=[]){let n;switch(t){case"Browser":n=CA(Xt());break;case"Worker":n=`${CA(Xt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${$l}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dU=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fU(t,e={}){return ql(t,"GET","/v2/passwordPolicy",BE(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU=6;let mU=class{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:pU,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gU=class{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bA(this),this.idTokenSubscription=new bA(this),this.beforeStateQueue=new dU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ak,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=wi(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await RA.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Cp(this,{idToken:e}),r=await Ha._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(_r(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ae(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await bp(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Yj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_r(this.app))return Promise.reject(Bo(this));const n=e?et(e):null;return n&&ae(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ae(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _r(this.app)?Promise.reject(Bo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _r(this.app)?Promise.reject(Bo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await fU(this),n=new mU(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ha("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await uU(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&wi(e)||this._popupRedirectResolver;ae(n,this,"argument-error"),this.redirectPersistenceManager=await RA.create(this,[wi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ae(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Fk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;if(_r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Kj(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}};function WE(t){return et(t)}let bA=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=dL(n=>this.observer=n)}get next(){return ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let HE={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yU(t){HE=t}function _U(t){return HE.loadJS(t)}function vU(){return HE.gapiScript}function wU(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EU(t,e){const n=da(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Yo(s,e??{}))return i;Fi(i,"already-initialized")}return n.initialize({options:e})}function TU(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(wi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function IU(t,e,n){const r=WE(t);ae(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=jk(e),{host:o,port:l}=AU(e),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){ae(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ae(Yo(h,r.config.emulator)&&Yo(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,ca(o)?(oE(`${s}//${o}${u}`),aE("Auth",!0)):SU()}function jk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function AU(t){const e=jk(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:kA(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:kA(o)}}}function kA(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function SU(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uk=class{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return vi("not implemented")}_getIdTokenResponse(e){return vi("not implemented")}_linkToIdToken(e,n){return vi("not implemented")}_getReauthenticationResolver(e){return vi("not implemented")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sl(t,e){return eU(t,"POST","/v1/accounts:signInWithIdp",BE(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PU="http://localhost";class Zo extends Uk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Zo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Fi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=od(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Zo(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return sl(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,sl(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,sl(e,n)}buildRequest(){const e={requestUri:PU,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Yh(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld extends Bk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os extends ld{constructor(){super("facebook.com")}static credential(e){return Zo._fromParams({providerId:os.PROVIDER_ID,signInMethod:os.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return os.credentialFromTaggedObject(e)}static credentialFromError(e){return os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return os.credential(e.oauthAccessToken)}catch{return null}}}os.FACEBOOK_SIGN_IN_METHOD="facebook.com";os.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as extends ld{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Zo._fromParams({providerId:as.PROVIDER_ID,signInMethod:as.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return as.credentialFromTaggedObject(e)}static credentialFromError(e){return as.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return as.credential(n,r)}catch{return null}}}as.GOOGLE_SIGN_IN_METHOD="google.com";as.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls extends ld{constructor(){super("github.com")}static credential(e){return Zo._fromParams({providerId:ls.PROVIDER_ID,signInMethod:ls.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ls.credentialFromTaggedObject(e)}static credentialFromError(e){return ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ls.credential(e.oauthAccessToken)}catch{return null}}}ls.GITHUB_SIGN_IN_METHOD="github.com";ls.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us extends ld{constructor(){super("twitter.com")}static credential(e,n){return Zo._fromParams({providerId:us.PROVIDER_ID,signInMethod:us.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return us.credentialFromTaggedObject(e)}static credentialFromError(e){return us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return us.credential(n,r)}catch{return null}}}us.TWITTER_SIGN_IN_METHOD="twitter.com";us.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let KE=class Vv{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Ha._fromIdTokenResponse(e,r,i),o=xA(r);return new Vv({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=xA(r);return new Vv({user:e,providerId:i,_tokenResponse:r,operationType:n})}};function xA(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RU=class Ov extends Qs{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Ov.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Ov(e,n,r,i)}};function zk(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?RU._fromErrorAndOperation(t,s,e,r):s})}async function CU(t,e,n=!1){const r=await Nh(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return KE._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bU(t,e,n=!1){const{auth:r}=t;if(_r(r.app))return Promise.reject(Bo(r));const i="reauthenticate";try{const s=await Nh(t,zk(r,i,e,t),n);ae(s.idToken,r,"internal-error");const o=zE(s.idToken);ae(o,r,"internal-error");const{sub:l}=o;return ae(t.uid===l,r,"user-mismatch"),KE._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Fi(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kU(t,e,n=!1){if(_r(t.app))return Promise.reject(Bo(t));const r="signIn",i=await zk(t,r,e),s=await KE._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function xU(t,e,n,r){return et(t).onIdTokenChanged(e,n,r)}function NU(t,e,n){return et(t).beforeAuthStateChanged(e,n)}const kp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(kp,"1"),this.storage.removeItem(kp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DU=1e3,VU=10;class Wk extends qk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$k(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);hU()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,VU):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},DU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Wk.type="LOCAL";const OU=Wk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk extends qk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Hk.type="SESSION";const Kk=Hk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MU(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Lm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async h=>h(n.origin,s)),u=await MU(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Lm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=GE("",20);i.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(){return window}function $U(t){$r().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(){return typeof $r().WorkerGlobalScope<"u"&&typeof $r().importScripts=="function"}async function FU(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jU(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function UU(){return Gk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qk="firebaseLocalStorageDb",BU=1,xp="firebaseLocalStorage",Yk="fbase_key";class ud{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function $m(t,e){return t.transaction([xp],e?"readwrite":"readonly").objectStore(xp)}function zU(){const t=indexedDB.deleteDatabase(Qk);return new ud(t).toPromise()}function Mv(){const t=indexedDB.open(Qk,BU);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(xp,{keyPath:Yk})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(xp)?e(r):(r.close(),await zU(),e(await Mv()))})})}async function NA(t,e,n){const r=$m(t,!0).put({[Yk]:e,value:n});return new ud(r).toPromise()}async function qU(t,e){const n=$m(t,!1).get(e),r=await new ud(n).toPromise();return r===void 0?null:r.value}function DA(t,e){const n=$m(t,!0).delete(e);return new ud(n).toPromise()}const WU=800,HU=3;class Xk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>HU)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Gk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Lm._getInstance(UU()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await FU(),!this.activeServiceWorker)return;this.sender=new LU(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jU()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mv();return await NA(e,kp,"1"),await DA(e,kp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>NA(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>qU(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>DA(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=$m(i,!1).getAll();return new ud(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Xk.type="LOCAL";const KU=Xk;new ad(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(t,e){return e?wi(e):(ae(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE extends Uk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return sl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return sl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return sl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function QU(t){return kU(t.auth,new QE(t),t.bypassAuthState)}function YU(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),bU(n,new QE(t),t.bypassAuthState)}async function XU(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),CU(n,new QE(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QU;case"linkViaPopup":case"linkViaRedirect":return XU;case"reauthViaPopup":case"reauthViaRedirect":return YU;default:Fi(this.auth,"internal-error")}}resolve(e){ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JU=new ad(2e3,1e4);class Ka extends Jk{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ka.currentPopupAction&&Ka.currentPopupAction.cancel(),Ka.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ae(e,this.auth,"internal-error"),e}async onExecution(){ji(this.filter.length===1,"Popup operations only handle one event");const e=GE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ka.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,JU.get())};e()}}Ka.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZU="pendingRedirect",kf=new Map;class e9 extends Jk{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=kf.get(this.auth._key());if(!e){try{const r=await t9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}kf.set(this.auth._key(),e)}return this.bypassAuthState||kf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function t9(t,e){const n=i9(e),r=r9(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function n9(t,e){kf.set(t._key(),e)}function r9(t){return wi(t._redirectPersistence)}function i9(t){return Cf(ZU,t.config.apiKey,t.name)}async function s9(t,e,n=!1){if(_r(t.app))return Promise.reject(Bo(t));const r=WE(t),i=GU(r,e),o=await new e9(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o9=10*60*1e3;class a9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!l9(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Zk(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Lr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=o9&&this.cachedEventUids.clear(),this.cachedEventUids.has(VA(e))}saveEventToCache(e){this.cachedEventUids.add(VA(e)),this.lastProcessedEventTime=Date.now()}}function VA(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Zk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function l9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Zk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u9(t,e={}){return ql(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,h9=/^https?/;async function d9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await u9(t);for(const n of e)try{if(f9(n))return}catch{}Fi(t,"unauthorized-domain")}function f9(t){const e=xv(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!h9.test(n))return!1;if(c9.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p9=new ad(3e4,6e4);function OA(){const t=$r().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function m9(t){return new Promise((e,n)=>{var r,i,s;function o(){OA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{OA(),n(Lr(t,"network-request-failed"))},timeout:p9.get()})}if(!((i=(r=$r().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=$r().gapi)===null||s===void 0)&&s.load)o();else{const l=wU("iframefcb");return $r()[l]=()=>{gapi.load?o():n(Lr(t,"network-request-failed"))},_U(`${vU()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw xf=null,e})}let xf=null;function g9(t){return xf=xf||m9(t),xf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y9=new ad(5e3,15e3),_9="__/auth/iframe",v9="emulator/auth/iframe",w9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},E9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function T9(t){const e=t.config;ae(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?UE(e,v9):`https://${t.config.authDomain}/${_9}`,r={apiKey:e.apiKey,appName:t.name,v:$l},i=E9.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Yh(r).slice(1)}`}async function I9(t){const e=await g9(t),n=$r().gapi;return ae(n,t,"internal-error"),e.open({where:document.body,url:T9(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:w9,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Lr(t,"network-request-failed"),l=$r().setTimeout(()=>{s(o)},y9.get());function u(){$r().clearTimeout(l),i(r)}r.ping(u).then(u,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},S9=500,P9=600,R9="_blank",C9="http://localhost";class MA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function b9(t,e,n,r=S9,i=P9){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},A9),{width:r.toString(),height:i.toString(),top:s,left:o}),h=Xt().toLowerCase();n&&(l=Dk(h)?R9:n),xk(h)&&(e=e||C9,u.scrollbars="yes");const f=Object.entries(u).reduce((g,[I,A])=>`${g}${I}=${A},`,"");if(cU(h)&&l!=="_self")return k9(e||"",l),new MA(null);const p=window.open(e||"",l,f);ae(p,t,"popup-blocked");try{p.focus()}catch{}return new MA(p)}function k9(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x9="__/auth/handler",N9="emulator/auth/handler",D9=encodeURIComponent("fac");async function LA(t,e,n,r,i,s){ae(t.config.authDomain,t,"auth-domain-config-required"),ae(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:$l,eventId:i};if(e instanceof Bk){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",hL(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof ld){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await t._getAppCheckToken(),h=u?`#${D9}=${encodeURIComponent(u)}`:"";return`${V9(t)}?${Yh(l).slice(1)}${h}`}function V9({config:t}){return t.emulator?UE(t,N9):`https://${t.authDomain}/${x9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy="webStorageSupport";class O9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Kk,this._completeRedirectFn=s9,this._overrideRedirectResult=n9}async _openPopup(e,n,r,i){var s;ji((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await LA(e,n,r,xv(),i);return b9(e,o,GE())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await LA(e,n,r,xv(),i);return $U(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ji(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await I9(e),r=new a9(e);return n.register("authEvent",i=>(ae(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Dy,{type:Dy},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Dy];o!==void 0&&n(!!o),Fi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=d9(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return $k()||Nk()||qE()}}const M9=O9;var $A="@firebase/auth",FA="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let L9=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function F9(t){Sr(new Xn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ae(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Fk(t)},h=new gU(r,i,s,u);return TU(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Sr(new Xn("auth-internal",e=>{const n=WE(e.getProvider("auth").getImmediate());return(r=>new L9(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),En($A,FA,$9(t)),En($A,FA,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j9=5*60,U9=aC("authIdTokenMaxAge")||j9;let jA=null;const B9=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>U9)return;const i=n==null?void 0:n.token;jA!==i&&(jA=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function z9(t=ym()){const e=da(t,"auth");if(e.isInitialized())return e.getImmediate();const n=EU(t,{popupRedirectResolver:M9,persistence:[KU,OU,Kk]}),r=aC("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=B9(s.toString());NU(n,o,()=>o(n.currentUser)),xU(n,l=>o(l))}}const i=iC("auth");return i&&IU(n,`http://${i}`),n}function q9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}yU({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Lr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",q9().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});F9("Browser");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W9{constructor(e,n,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,_r(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i==null||i.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lv="us-central1";class H9{constructor(e,n,r,i,s=Lv,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new W9(e,n,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Lv}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function K9(t,e,n){const r=ca(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(oE(t.emulatorOrigin),aE("Functions",!0))}const UA="@firebase/functions",BA="0.12.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G9="auth-internal",Q9="app-check-internal",Y9="messaging-internal";function X9(t){const e=(n,{instanceIdentifier:r})=>{const i=n.getProvider("app").getImmediate(),s=n.getProvider(G9),o=n.getProvider(Y9),l=n.getProvider(Q9);return new H9(i,s,o,l,r)};Sr(new Xn(ex,e,"PUBLIC").setMultipleInstances(!0)),En(UA,BA,t),En(UA,BA,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J9(t=ym(),e=Lv){const r=da(et(t),ex).getImmediate({identifier:e}),i=sC("functions");return i&&Z9(r,...i),r}function Z9(t,e,n){K9(et(t),e,n)}X9();const tx="@firebase/installations",YE="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nx=1e4,rx=`w:${YE}`,ix="FIS_v2",e6="https://firebaseinstallations.googleapis.com/v1",t6=60*60*1e3,n6="installations",r6="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ea=new ha(n6,r6,i6);function sx(t){return t instanceof Qs&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox({projectId:t}){return`${e6}/projects/${t}/installations`}function ax(t){return{token:t.token,requestStatus:2,expiresIn:o6(t.expiresIn),creationTime:Date.now()}}async function lx(t,e){const r=(await e.json()).error;return ea.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function ux({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function s6(t,{refreshToken:e}){const n=ux(t);return n.append("Authorization",a6(e)),n}async function cx(t){const e=await t();return e.status>=500&&e.status<600?t():e}function o6(t){return Number(t.replace("s","000"))}function a6(t){return`${ix} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l6({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=ox(t),i=ux(t),s=e.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&i.append("x-firebase-client",h)}const o={fid:n,authVersion:ix,appId:t.appId,sdkVersion:rx},l={method:"POST",headers:i,body:JSON.stringify(o)},u=await cx(()=>fetch(r,l));if(u.ok){const h=await u.json();return{fid:h.fid||n,registrationStatus:2,refreshToken:h.refreshToken,authToken:ax(h.authToken)}}else throw await lx("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hx(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c6=/^[cdef][\w-]{21}$/,$v="";function h6(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=d6(t);return c6.test(n)?n:$v}catch{return $v}}function d6(t){return u6(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fm(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx=new Map;function fx(t,e){const n=Fm(t);px(n,e),f6(n,e)}function px(t,e){const n=dx.get(t);if(n)for(const r of n)r(e)}function f6(t,e){const n=p6();n&&n.postMessage({key:t,fid:e}),m6()}let Vo=null;function p6(){return!Vo&&"BroadcastChannel"in self&&(Vo=new BroadcastChannel("[Firebase] FID Change"),Vo.onmessage=t=>{px(t.data.key,t.data.fid)}),Vo}function m6(){dx.size===0&&Vo&&(Vo.close(),Vo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g6="firebase-installations-database",y6=1,ta="firebase-installations-store";let Vy=null;function XE(){return Vy||(Vy=Xh(g6,y6,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ta)}}})),Vy}async function Np(t,e){const n=Fm(t),i=(await XE()).transaction(ta,"readwrite"),s=i.objectStore(ta),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&fx(t,e.fid),e}async function mx(t){const e=Fm(t),r=(await XE()).transaction(ta,"readwrite");await r.objectStore(ta).delete(e),await r.done}async function jm(t,e){const n=Fm(t),i=(await XE()).transaction(ta,"readwrite"),s=i.objectStore(ta),o=await s.get(n),l=e(o);return l===void 0?await s.delete(n):await s.put(l,n),await i.done,l&&(!o||o.fid!==l.fid)&&fx(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JE(t){let e;const n=await jm(t.appConfig,r=>{const i=_6(r),s=v6(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===$v?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function _6(t){const e=t||{fid:h6(),registrationStatus:0};return gx(e)}function v6(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(ea.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=w6(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:E6(t)}:{installationEntry:e}}async function w6(t,e){try{const n=await l6(t,e);return Np(t.appConfig,n)}catch(n){throw sx(n)&&n.customData.serverCode===409?await mx(t.appConfig):await Np(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function E6(t){let e=await zA(t.appConfig);for(;e.registrationStatus===1;)await hx(100),e=await zA(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await JE(t);return r||n}return e}function zA(t){return jm(t,e=>{if(!e)throw ea.create("installation-not-found");return gx(e)})}function gx(t){return T6(t)?{fid:t.fid,registrationStatus:0}:t}function T6(t){return t.registrationStatus===1&&t.registrationTime+nx<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I6({appConfig:t,heartbeatServiceProvider:e},n){const r=A6(t,n),i=s6(t,n),s=e.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&i.append("x-firebase-client",h)}const o={installation:{sdkVersion:rx,appId:t.appId}},l={method:"POST",headers:i,body:JSON.stringify(o)},u=await cx(()=>fetch(r,l));if(u.ok){const h=await u.json();return ax(h)}else throw await lx("Generate Auth Token",u)}function A6(t,{fid:e}){return`${ox(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZE(t,e=!1){let n;const r=await jm(t.appConfig,s=>{if(!yx(s))throw ea.create("not-registered");const o=s.authToken;if(!e&&R6(o))return s;if(o.requestStatus===1)return n=S6(t,e),s;{if(!navigator.onLine)throw ea.create("app-offline");const l=b6(s);return n=P6(t,l),l}});return n?await n:r.authToken}async function S6(t,e){let n=await qA(t.appConfig);for(;n.authToken.requestStatus===1;)await hx(100),n=await qA(t.appConfig);const r=n.authToken;return r.requestStatus===0?ZE(t,e):r}function qA(t){return jm(t,e=>{if(!yx(e))throw ea.create("not-registered");const n=e.authToken;return k6(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function P6(t,e){try{const n=await I6(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Np(t.appConfig,r),n}catch(n){if(sx(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await mx(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Np(t.appConfig,r)}throw n}}function yx(t){return t!==void 0&&t.registrationStatus===2}function R6(t){return t.requestStatus===2&&!C6(t)}function C6(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+t6}function b6(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function k6(t){return t.requestStatus===1&&t.requestTime+nx<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x6(t){const e=t,{installationEntry:n,registrationPromise:r}=await JE(e);return r?r.catch(console.error):ZE(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N6(t,e=!1){const n=t;return await D6(n),(await ZE(n,e)).token}async function D6(t){const{registrationPromise:e}=await JE(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V6(t){if(!t||!t.options)throw Oy("App Configuration");if(!t.name)throw Oy("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Oy(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Oy(t){return ea.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x="installations",O6="installations-internal",M6=t=>{const e=t.getProvider("app").getImmediate(),n=V6(e),r=da(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},L6=t=>{const e=t.getProvider("app").getImmediate(),n=da(e,_x).getImmediate();return{getId:()=>x6(n),getToken:i=>N6(n,i)}};function $6(){Sr(new Xn(_x,M6,"PUBLIC")),Sr(new Xn(O6,L6,"PRIVATE"))}$6();En(tx,YE);En(tx,YE,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6="/firebase-messaging-sw.js",j6="/firebase-cloud-messaging-push-scope",vx="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",U6="https://fcmregistrations.googleapis.com/v1",wx="google.c.a.c_id",B6="google.c.a.c_l",z6="google.c.a.ts",q6="google.c.a.e",WA=1e4;var HA;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(HA||(HA={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Dh;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Dh||(Dh={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function W6(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My="fcm_token_details_db",H6=5,KA="fcm_token_object_Store";async function K6(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(s=>s.name).includes(My))return null;let e=null;return(await Xh(My,H6,{upgrade:async(r,i,s,o)=>{var l;if(i<2||!r.objectStoreNames.contains(KA))return;const u=o.objectStore(KA),h=await u.index("fcmSenderId").get(t);if(await u.clear(),!!h){if(i===2){const f=h;if(!f.auth||!f.p256dh||!f.endpoint)return;e={token:f.fcmToken,createTime:(l=f.createTime)!==null&&l!==void 0?l:Date.now(),subscriptionOptions:{auth:f.auth,p256dh:f.p256dh,endpoint:f.endpoint,swScope:f.swScope,vapidKey:typeof f.vapidKey=="string"?f.vapidKey:fi(f.vapidKey)}}}else if(i===3){const f=h;e={token:f.fcmToken,createTime:f.createTime,subscriptionOptions:{auth:fi(f.auth),p256dh:fi(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:fi(f.vapidKey)}}}else if(i===4){const f=h;e={token:f.fcmToken,createTime:f.createTime,subscriptionOptions:{auth:fi(f.auth),p256dh:fi(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:fi(f.vapidKey)}}}}}})).close(),await Ay(My),await Ay("fcm_vapid_details_db"),await Ay("undefined"),G6(e)?e:null}function G6(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6="firebase-messaging-database",Y6=1,Vh="firebase-messaging-store";let Ly=null;function Ex(){return Ly||(Ly=Xh(Q6,Y6,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Vh)}}})),Ly}async function X6(t){const e=Tx(t),r=await(await Ex()).transaction(Vh).objectStore(Vh).get(e);if(r)return r;{const i=await K6(t.appConfig.senderId);if(i)return await eT(t,i),i}}async function eT(t,e){const n=Tx(t),i=(await Ex()).transaction(Vh,"readwrite");return await i.objectStore(Vh).put(e,n),await i.done,e}function Tx({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J6={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Qt=new ha("messaging","Messaging",J6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z6(t,e){const n=await nT(t),r=Ix(e),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{s=await(await fetch(tT(t.appConfig),i)).json()}catch(o){throw Qt.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw Qt.create("token-subscribe-failed",{errorInfo:o})}if(!s.token)throw Qt.create("token-subscribe-no-token");return s.token}async function e3(t,e){const n=await nT(t),r=Ix(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{s=await(await fetch(`${tT(t.appConfig)}/${e.token}`,i)).json()}catch(o){throw Qt.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(s.error){const o=s.error.message;throw Qt.create("token-update-failed",{errorInfo:o})}if(!s.token)throw Qt.create("token-update-no-token");return s.token}async function t3(t,e){const r={method:"DELETE",headers:await nT(t)};try{const s=await(await fetch(`${tT(t.appConfig)}/${e}`,r)).json();if(s.error){const o=s.error.message;throw Qt.create("token-unsubscribe-failed",{errorInfo:o})}}catch(i){throw Qt.create("token-unsubscribe-failed",{errorInfo:i==null?void 0:i.toString()})}}function tT({projectId:t}){return`${U6}/projects/${t}/registrations`}async function nT({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function Ix({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:e,p256dh:t}};return r!==vx&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=7*24*60*60*1e3;async function r3(t){const e=await s3(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:fi(e.getKey("auth")),p256dh:fi(e.getKey("p256dh"))},r=await X6(t.firebaseDependencies);if(r){if(o3(r.subscriptionOptions,n))return Date.now()>=r.createTime+n3?i3(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await t3(t.firebaseDependencies,r.token)}catch(i){console.warn(i)}return GA(t.firebaseDependencies,n)}else return GA(t.firebaseDependencies,n)}async function i3(t,e){try{const n=await e3(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await eT(t.firebaseDependencies,r),n}catch(n){throw n}}async function GA(t,e){const r={token:await Z6(t,e),createTime:Date.now(),subscriptionOptions:e};return await eT(t,r),r.token}async function s3(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:W6(e)})}function o3(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,s=e.p256dh===t.p256dh;return n&&r&&i&&s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return a3(e,t),l3(e,t),u3(e,t),e}function a3(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const i=e.notification.image;i&&(t.notification.image=i);const s=e.notification.icon;s&&(t.notification.icon=s)}function l3(t,e){e.data&&(t.data=e.data)}function u3(t,e){var n,r,i,s,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const l=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(s=e.notification)===null||s===void 0?void 0:s.click_action;l&&(t.fcmOptions.link=l);const u=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;u&&(t.fcmOptions.analyticsLabel=u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c3(t){return typeof t=="object"&&!!t&&wx in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h3(t){if(!t||!t.options)throw $y("App Configuration Object");if(!t.name)throw $y("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw $y(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function $y(t){return Qt.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d3=class{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=h3(e);this.firebaseDependencies={app:e,appConfig:i,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f3(t){try{t.swRegistration=await navigator.serviceWorker.register(F6,{scope:j6}),t.swRegistration.update().catch(()=>{}),await p3(t.swRegistration)}catch(e){throw Qt.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function p3(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${WA} ms`)),WA),i=t.installing||t.waiting;t.active?(clearTimeout(r),e()):i?i.onstatechange=s=>{var o;((o=s.target)===null||o===void 0?void 0:o.state)==="activated"&&(i.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m3(t,e){if(!e&&!t.swRegistration&&await f3(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Qt.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g3(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=vx)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ax(t,e){if(!navigator)throw Qt.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Qt.create("permission-blocked");return await g3(t,e==null?void 0:e.vapidKey),await m3(t,e==null?void 0:e.serviceWorkerRegistration),r3(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y3(t,e,n){const r=_3(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[wx],message_name:n[B6],message_time:n[z6],message_device_time:Math.floor(Date.now()/1e3)})}function _3(t){switch(t){case Dh.NOTIFICATION_CLICKED:return"notification_open";case Dh.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v3(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Dh.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(QA(n)):t.onMessageHandler.next(QA(n)));const r=n.data;c3(r)&&r[q6]==="1"&&await y3(t,n.messageType,r)}const YA="@firebase/messaging",XA="0.12.22";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3=t=>{const e=new d3(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>v3(e,n)),e},E3=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>Ax(e,r)}};function T3(){Sr(new Xn("messaging",w3,"PUBLIC")),Sr(new Xn("messaging-internal",E3,"PRIVATE")),En(YA,XA),En(YA,XA,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sx(){try{await uC()}catch{return!1}return typeof window<"u"&&lC()&&aL()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(t,e){if(!navigator)throw Qt.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Px(t=ym()){return Sx().then(e=>{if(!e)throw Qt.create("unsupported-browser")},e=>{throw Qt.create("indexed-db-unsupported")}),da(et(t),"messaging").getImmediate()}async function A3(t,e){return t=et(t),Ax(t,e)}function S3(t,e){return t=et(t),I3(t,e)}T3();const P3={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDMsLYmLj4qZR2Ty5sJJX9ZEZInc61dJos",VITE_FIREBASE_APP_ID:"1:494398949506:web:b4e591e20590044c72cc9b",VITE_FIREBASE_AUTH_DOMAIN:"bueno-brows-7cce7.firebaseapp.com",VITE_FIREBASE_FUNCTIONS_REGION:"us-central1",VITE_FIREBASE_MESSAGING_SENDER_ID:"494398949506",VITE_FIREBASE_PROJECT_ID:"bueno-brows-7cce7",VITE_FIREBASE_STORAGE_BUCKET:"bueno-brows-7cce7.firebasestorage.app",VITE_USE_EMULATORS:"0"};function Ea(t){const e=P3[t];if(!e){const n=t==="VITE_FIREBASE_API_KEY"?"***":"";throw console.error(`[Firebase] Missing env: ${t}${n?" ("+n+")":""}`),new Error(`Missing env ${t}`)}return e}let Kd=null;function R3(){if(Kd)return Kd;const t={apiKey:Ea("VITE_FIREBASE_API_KEY"),authDomain:Ea("VITE_FIREBASE_AUTH_DOMAIN"),projectId:Ea("VITE_FIREBASE_PROJECT_ID"),storageBucket:Ea("VITE_FIREBASE_STORAGE_BUCKET"),messagingSenderId:Ea("VITE_FIREBASE_MESSAGING_SENDER_ID"),appId:Ea("VITE_FIREBASE_APP_ID")},e=d$(),n=e.length>0?e[0]:fC(t);console.log("[Firebase] App initialized:",n.name,n.options.projectId);const r=Pj(n),i=z9(n);console.log("[Firebase] Firestore and Auth initialized");const o=J9(n,"us-central1");let l;return typeof window<"u"&&Sx().then(u=>{u&&(l=Px(n))}),Kd={app:n,db:r,auth:i,functions:o,messaging:l},Kd}const Rx=D.createContext(null);function C3({children:t}){const e=D.useMemo(()=>R3(),[]);return T.jsx(Rx.Provider,{value:e,children:t})}function Jn(){const t=D.useContext(Rx);if(!t)throw new Error("useFirebase must be used within FirebaseProvider");return t}var JA={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},b3=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],l=t[n++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},bx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,l=o?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,f=s>>2,p=(s&3)<<4|l>>4;let g=(l&15)<<2|h>>6,I=h&63;u||(I=64,o||(g=64)),r.push(n[f],n[p],n[g],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Cx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):b3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const h=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||h==null||p==null)throw new k3;const g=s<<2|l>>4;if(r.push(g),h!==64){const I=l<<4&240|h>>2;if(r.push(I),p!==64){const A=h<<6&192|p;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class k3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const x3=function(t){const e=Cx(t);return bx.encodeByteArray(e,!0)},kx=function(t){return x3(t).replace(/\./g,"")},xx=function(t){try{return bx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D3=()=>N3().__FIREBASE_DEFAULTS__,V3=()=>{if(typeof process>"u"||typeof JA>"u")return;const t=JA.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},O3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&xx(t[1]);return e&&JSON.parse(e)},Nx=()=>{try{return D3()||V3()||O3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},M3=t=>{var e;return(e=Nx())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function L3(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rr())}function $3(){var t;const e=(t=Nx())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function F3(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function j3(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function U3(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function B3(){return!$3()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function z3(){try{return typeof indexedDB=="object"}catch{return!1}}function q3(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3="FirebaseError";class Gi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=W3,Object.setPrototypeOf(this,Gi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cd.prototype.create)}}class cd{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?H3(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Gi(i,l,r)}}function H3(t,e){return t.replace(K3,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const K3=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Tc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ic(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function G3(t,e){const n=new Q3(t,e);return n.subscribe.bind(n)}class Q3{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Y3(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Fy),i.error===void 0&&(i.error=Fy),i.complete===void 0&&(i.complete=Fy);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Y3(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Fy(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function An(t){return t&&t._delegate?t._delegate:t}class El{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const X3={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},J3=Ee.INFO,Z3={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},e5=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=Z3[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class rT{constructor(e){this.name=e,this._logLevel=J3,this._logHandler=e5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?X3[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(n5(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function n5(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Fv="@firebase/app",ZA="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ui=new rT("@firebase/app"),r5="@firebase/app-compat",i5="@firebase/analytics-compat",s5="@firebase/analytics",o5="@firebase/app-check-compat",a5="@firebase/app-check",l5="@firebase/auth",u5="@firebase/auth-compat",c5="@firebase/database",h5="@firebase/data-connect",d5="@firebase/database-compat",f5="@firebase/functions",p5="@firebase/functions-compat",m5="@firebase/installations",g5="@firebase/installations-compat",y5="@firebase/messaging",_5="@firebase/messaging-compat",v5="@firebase/performance",w5="@firebase/performance-compat",E5="@firebase/remote-config",T5="@firebase/remote-config-compat",I5="@firebase/storage",A5="@firebase/storage-compat",S5="@firebase/firestore",P5="@firebase/vertexai-preview",R5="@firebase/firestore-compat",C5="firebase",b5="10.14.1",k5={[Fv]:"fire-core",[r5]:"fire-core-compat",[s5]:"fire-analytics",[i5]:"fire-analytics-compat",[a5]:"fire-app-check",[o5]:"fire-app-check-compat",[l5]:"fire-auth",[u5]:"fire-auth-compat",[c5]:"fire-rtdb",[h5]:"fire-data-connect",[d5]:"fire-rtdb-compat",[f5]:"fire-fn",[p5]:"fire-fn-compat",[m5]:"fire-iid",[g5]:"fire-iid-compat",[y5]:"fire-fcm",[_5]:"fire-fcm-compat",[v5]:"fire-perf",[w5]:"fire-perf-compat",[E5]:"fire-rc",[T5]:"fire-rc-compat",[I5]:"fire-gcs",[A5]:"fire-gcs-compat",[S5]:"fire-fst",[R5]:"fire-fst-compat",[P5]:"fire-vertex","fire-js":"fire-js",[C5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x5=new Map,N5=new Map,eS=new Map;function tS(t,e){try{t.container.addComponent(e)}catch(n){Ui.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Tl(t){const e=t.name;if(eS.has(e))return Ui.debug(`There were multiple attempts to register component ${e}.`),!1;eS.set(e,t);for(const n of x5.values())tS(n,t);for(const n of N5.values())tS(n,t);return!0}function Oo(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},iT=new cd("app","Firebase",D5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um=b5;function zo(t,e,n){var r;let i=(r=k5[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ui.warn(l.join(" "));return}Tl(new El(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V5="firebase-heartbeat-database",O5=1,Oh="firebase-heartbeat-store";let jy=null;function Vx(){return jy||(jy=Xh(V5,O5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Oh)}catch(n){console.warn(n)}}}}).catch(t=>{throw iT.create("idb-open",{originalErrorMessage:t.message})})),jy}async function M5(t){try{const n=(await Vx()).transaction(Oh),r=await n.objectStore(Oh).get(Ox(t));return await n.done,r}catch(e){if(e instanceof Gi)Ui.warn(e.message);else{const n=iT.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ui.warn(n.message)}}}async function nS(t,e){try{const r=(await Vx()).transaction(Oh,"readwrite");await r.objectStore(Oh).put(e,Ox(t)),await r.done}catch(n){if(n instanceof Gi)Ui.warn(n.message);else{const r=iT.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ui.warn(r.message)}}}function Ox(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L5=1024,$5=30*24*60*60*1e3;class F5{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new U5(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=rS();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=$5}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ui.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=rS(),{heartbeatsToSend:r,unsentEntries:i}=j5(this._heartbeatsCache.heartbeats),s=kx(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Ui.warn(n),""}}}function rS(){return new Date().toISOString().substring(0,10)}function j5(t,e=L5){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),iS(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),iS(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class U5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return z3()?q3().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await M5(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return nS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return nS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function iS(t){return kx(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B5(t){Tl(new El("platform-logger",e=>new t5(e),"PRIVATE")),Tl(new El("heartbeat",e=>new F5(e),"PRIVATE")),zo(Fv,ZA,t),zo(Fv,ZA,"esm2017"),zo("fire-js","")}B5("");function Mx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const z5=Mx,Lx=new cd("auth","Firebase",Mx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp=new rT("@firebase/auth");function q5(t,...e){Dp.logLevel<=Ee.WARN&&Dp.warn(`Auth (${Um}): ${t}`,...e)}function Nf(t,...e){Dp.logLevel<=Ee.ERROR&&Dp.error(`Auth (${Um}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(t,...e){throw oT(t,...e)}function sT(t,...e){return oT(t,...e)}function $x(t,e,n){const r=Object.assign(Object.assign({},z5()),{[e]:n});return new cd("auth","Firebase",r).create(e,{appName:t.name})}function ol(t){return $x(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function oT(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Lx.create(t,...e)}function ke(t,e,...n){if(!t)throw oT(e,...n)}function Ei(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Nf(e),new Error(e)}function Vp(t,e){t||Ei(e)}function W5(){return sS()==="http:"||sS()==="https:"}function sS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(W5()||j3()||"connection"in navigator)?navigator.onLine:!0}function K5(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e,n){this.shortDelay=e,this.longDelay=n,Vp(n>e,"Short delay should be less than long delay!"),this.isMobile=L3()||U3()}get(){return H5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G5(t,e){Vp(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y5=new hd(3e4,6e4);function Wl(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ga(t,e,n,r,i={}){return jx(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=Dx(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:u},s);return F3()||(h.referrerPolicy="no-referrer"),Fx.fetch()(Ux(t,t.config.apiHost,n,l),h)})}async function jx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Q5),e);try{const i=new J5(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Gd(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gd(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Gd(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Gd(t,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw $x(t,f,h);Mh(t,f)}}catch(i){if(i instanceof Gi)throw i;Mh(t,"network-request-failed",{message:String(i)})}}async function aT(t,e,n,r,i={}){const s=await ga(t,e,n,r,i);return"mfaPendingCredential"in s&&Mh(t,"multi-factor-auth-required",{_serverResponse:s}),s}function Ux(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?G5(t.config,i):`${t.config.apiScheme}://${i}`}function X5(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class J5{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(sT(this.auth,"network-request-failed")),Y5.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Gd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=sT(t,e,r);return i.customData._tokenResponse=n,i}function oS(t){return t!==void 0&&t.enterprise!==void 0}class Z5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return X5(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function eB(t,e){return ga(t,"GET","/v2/recaptchaConfig",Wl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tB(t,e){return ga(t,"POST","/v1/accounts:delete",e)}async function Bx(t,e){return ga(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function nB(t,e=!1){const n=An(t),r=await n.getIdToken(e),i=zx(r);ke(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Gc(Uy(i.auth_time)),issuedAtTime:Gc(Uy(i.iat)),expirationTime:Gc(Uy(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Uy(t){return Number(t)*1e3}function zx(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Nf("JWT malformed, contained fewer than 3 sections"),null;try{const i=xx(n);return i?JSON.parse(i):(Nf("Failed to decode base64 JWT payload"),null)}catch(i){return Nf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function aS(t){const e=zx(t);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jv(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Gi&&rB(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function rB({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gc(this.lastLoginAt),this.creationTime=Gc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Op(t){var e;const n=t.auth,r=await t.getIdToken(),i=await jv(t,Bx(n,{idToken:r}));ke(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?qx(s.providerUserInfo):[],l=oB(t.providerData,o),u=t.isAnonymous,h=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),f=u?h:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Uv(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,p)}async function sB(t){const e=An(t);await Op(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function oB(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function qx(t){return t.map(e=>{var{providerId:n}=e,r=od(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aB(t,e){const n=await jx(t,{},async()=>{const r=Dx({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=Ux(t,i,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Fx.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function lB(t,e){return ga(t,"POST","/v2/accounts:revokeToken",Wl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const n=aS(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await aB(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new al;return r&&(ke(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ke(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ke(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new al,this.toJSON())}_performRefresh(){return Ei("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(t,e){ke(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ti{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=od(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new iB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Uv(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await jv(this,this.stsTokenManager.getToken(this.auth,e));return ke(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return nB(this,e)}reload(){return sB(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ti(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Op(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Oo(this.auth.app))return Promise.reject(ol(this.auth));const e=await this.getIdToken();return await jv(this,tB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,l,u,h,f;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(i=n.email)!==null&&i!==void 0?i:void 0,I=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,A=(o=n.photoURL)!==null&&o!==void 0?o:void 0,C=(l=n.tenantId)!==null&&l!==void 0?l:void 0,N=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,P=(h=n.createdAt)!==null&&h!==void 0?h:void 0,R=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:x,emailVerified:O,isAnonymous:M,providerData:$,stsTokenManager:v}=n;ke(x&&v,e,"internal-error");const y=al.fromJSON(this.name,v);ke(typeof x=="string",e,"internal-error"),Ji(p,e.name),Ji(g,e.name),ke(typeof O=="boolean",e,"internal-error"),ke(typeof M=="boolean",e,"internal-error"),Ji(I,e.name),Ji(A,e.name),Ji(C,e.name),Ji(N,e.name),Ji(P,e.name),Ji(R,e.name);const _=new Ti({uid:x,auth:e,email:g,emailVerified:O,displayName:p,isAnonymous:M,photoURL:A,phoneNumber:I,tenantId:C,stsTokenManager:y,createdAt:P,lastLoginAt:R});return $&&Array.isArray($)&&(_.providerData=$.map(E=>Object.assign({},E))),N&&(_._redirectEventId=N),_}static async _fromIdTokenResponse(e,n,r=!1){const i=new al;i.updateFromServerResponse(n);const s=new Ti({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Op(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];ke(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?qx(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new al;l.updateFromIdToken(r);const u=new Ti({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Uv(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lS=new Map;function Mo(t){Vp(t instanceof Function,"Expected a class definition");let e=lS.get(t);return e?(Vp(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,lS.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Wx.type="NONE";const uS=Wx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function By(t,e,n){return`firebase:${t}:${e}:${n}`}class ll{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=By(this.userKey,i.apiKey,s),this.fullPersistenceKey=By("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ti._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ll(Mo(uS),e,r);const i=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||Mo(uS);const o=By(r,e.config.apiKey,e.name);let l=null;for(const h of n)try{const f=await h._get(o);if(f){const p=Ti._fromJSON(e,f);h!==s&&(l=p),s=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new ll(s,e,r):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(n.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new ll(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dB(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uB(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pB(e))return"Blackberry";if(mB(e))return"Webos";if(cB(e))return"Safari";if((e.includes("chrome/")||hB(e))&&!e.includes("edge/"))return"Chrome";if(fB(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function uB(t=Rr()){return/firefox\//i.test(t)}function cB(t=Rr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hB(t=Rr()){return/crios\//i.test(t)}function dB(t=Rr()){return/iemobile/i.test(t)}function fB(t=Rr()){return/android/i.test(t)}function pB(t=Rr()){return/blackberry/i.test(t)}function mB(t=Rr()){return/webos/i.test(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hx(t,e=[]){let n;switch(t){case"Browser":n=cS(Rr());break;case"Worker":n=`${cS(Rr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Um}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yB(t,e={}){return ga(t,"GET","/v2/passwordPolicy",Wl(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _B=6;class vB{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:_B,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wB{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hS(this),this.idTokenSubscription=new hS(this),this.beforeStateQueue=new gB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Lx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Mo(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ll.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Bx(this,{idToken:e}),r=await Ti._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Oo(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Op(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=K5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Oo(this.app))return Promise.reject(ol(this));const n=e?An(e):null;return n&&ke(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Oo(this.app)?Promise.reject(ol(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Oo(this.app)?Promise.reject(ol(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Mo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await yB(this),n=new vB(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new cd("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await lB(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Mo(e)||this._popupRedirectResolver;ke(n,this,"argument-error"),this.redirectPersistenceManager=await ll.create(this,[Mo(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Hx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&q5(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Bm(t){return An(t)}class hS{constructor(e){this.auth=e,this.observer=null,this.addObserver=G3(n=>this.observer=n)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lT={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EB(t){lT=t}function TB(t){return lT.loadJS(t)}function IB(){return lT.recaptchaEnterpriseScript}const AB="recaptcha-enterprise",SB="NO_RECAPTCHA";class PB{constructor(e){this.type=AB,this.auth=Bm(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{eB(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const h=new Z5(u);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(u=>{l(u)})})}function i(s,o,l){const u=window.grecaptcha;oS(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(SB)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(l=>{if(!n&&oS(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=IB();u.length!==0&&(u+=l),TB(u).then(()=>{i(l,s,o)}).catch(h=>{o(h)})}}).catch(l=>{o(l)})})}}async function dS(t,e,n,r=!1){const i=new PB(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function fS(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await dS(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await dS(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}function RB(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Mo);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CB{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ei("not implemented")}_getIdTokenResponse(e){return Ei("not implemented")}_linkToIdToken(e,n){return Ei("not implemented")}_getReauthenticationResolver(e){return Ei("not implemented")}}async function bB(t,e){return ga(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kB(t,e){return aT(t,"POST","/v1/accounts:signInWithPassword",Wl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xB(t,e){return aT(t,"POST","/v1/accounts:signInWithEmailLink",Wl(t,e))}async function NB(t,e){return aT(t,"POST","/v1/accounts:signInWithEmailLink",Wl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh extends CB{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Lh(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Lh(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return fS(e,n,"signInWithPassword",kB);case"emailLink":return xB(e,{email:this._email,oobCode:this._password});default:Mh(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return fS(e,r,"signUpPassword",bB);case"emailLink":return NB(e,{idToken:n,email:this._email,oobCode:this._password});default:Mh(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DB(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function VB(t){const e=Tc(Ic(t)).link,n=e?Tc(Ic(e)).deep_link_id:null,r=Tc(Ic(t)).deep_link_id;return(r?Tc(Ic(r)).link:null)||r||n||e||t}class uT{constructor(e){var n,r,i,s,o,l;const u=Tc(Ic(e)),h=(n=u.apiKey)!==null&&n!==void 0?n:null,f=(r=u.oobCode)!==null&&r!==void 0?r:null,p=DB((i=u.mode)!==null&&i!==void 0?i:null);ke(h&&f&&p,"argument-error"),this.apiKey=h,this.operation=p,this.code=f,this.continueUrl=(s=u.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=u.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=u.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=VB(e);try{return new uT(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(){this.providerId=Hl.PROVIDER_ID}static credential(e,n){return Lh._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=uT.parseLink(n);return ke(r,"argument-error"),Lh._fromEmailAndCode(e,r.code,r.tenantId)}}Hl.PROVIDER_ID="password";Hl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Hl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Ti._fromIdTokenResponse(e,r,i),o=pS(r);return new Mp({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=pS(r);return new Mp({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function pS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp extends Gi{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Lp.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Lp(e,n,r,i)}}function OB(t,e,n,r){return n._getIdTokenResponse(t).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Lp._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MB(t,e,n=!1){if(Oo(t.app))return Promise.reject(ol(t));const r="signIn",i=await OB(t,r,e),s=await Mp._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function LB(t,e){return MB(Bm(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $B(t){const e=Bm(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function FB(t,e,n){return Oo(t.app)?Promise.reject(ol(t)):LB(An(t),Hl.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&$B(t),r})}function jB(t,e,n,r){return An(t).onAuthStateChanged(e,n,r)}function UB(t){return An(t).signOut()}new hd(3e4,6e4);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new hd(2e3,1e4);/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new hd(3e4,6e4);/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new hd(5e3,15e3);var mS="@firebase/auth",gS="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BB{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zB(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function qB(t){Tl(new El("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ke(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hx(t)},h=new wB(r,i,s,u);return RB(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Tl(new El("auth-internal",e=>{const n=Bm(e.getProvider("auth").getImmediate());return(r=>new BB(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),zo(mS,gS,zB(t)),zo(mS,gS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WB=5*60;M3("authIdTokenMaxAge");function HB(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}EB({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=sT("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",HB().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});qB("Browser");function KB({children:t}){const[e,n]=D.useState("loading"),[r,i]=D.useState(""),{auth:s}=Jn();return D.useEffect(()=>jB(s,async o=>{if(!o)return n("unauthed");const u=(await o.getIdTokenResult(!0)).claims.role;n(u==="admin"?"authed":"restricted")}),[]),e==="loading"?T.jsx("div",{className:"p-8",children:"Loading"}):e==="restricted"?T.jsx("div",{className:"min-h-screen grid place-items-center bg-cream",children:T.jsxs("div",{className:"bg-white shadow-soft rounded-xl p-6 w-[380px]",children:[T.jsx("h1",{className:"text-xl font-serif text-slate-800 mb-2",children:"Access Restricted"}),T.jsxs("p",{className:"text-slate-600 text-sm",children:["Your account is signed in, but does not have the ",T.jsx("span",{className:"font-mono",children:'role: "admin"'})," claim."]})]})}):e==="unauthed"?T.jsx(GB,{onError:i,error:r}):T.jsx(T.Fragment,{children:t})}function GB({error:t,onError:e}){const[n,r]=D.useState(""),[i,s]=D.useState(""),{auth:o}=Jn();async function l(u){u.preventDefault();try{await FB(o,n,i)}catch(h){e(h.message)}}return T.jsx("div",{className:"min-h-screen grid place-items-center bg-cream",children:T.jsxs("form",{onSubmit:l,className:"bg-white shadow-soft rounded-xl p-6 w-[380px]",children:[T.jsx("h1",{className:"text-2xl font-serif text-slate-800 mb-4",children:"Admin Sign In"}),t&&T.jsx("p",{className:"text-sm text-red-600 mb-2",children:t}),T.jsx("input",{className:"w-full border rounded-md p-2 mb-3",placeholder:"Email",value:n,onChange:u=>r(u.target.value)}),T.jsx("input",{className:"w-full border rounded-md p-2 mb-4",type:"password",placeholder:"Password",value:i,onChange:u=>s(u.target.value)}),T.jsx("button",{className:"w-full bg-terracotta text-white rounded-md py-2",children:"Sign In"})]})})}const Zi=({to:t,children:e})=>T.jsx($M,{to:t,className:({isActive:n})=>`block px-4 py-2 rounded-md ${n?"bg-terracotta text-white":"text-slate-800 hover:bg-cream"}`,children:e});function QB(){return T.jsxs("aside",{className:"min-h-screen bg-white border-r p-4",children:[T.jsx("div",{className:"text-2xl font-serif text-terracotta mb-6",children:"BUENO BROWS"}),T.jsxs("nav",{className:"space-y-2",children:[T.jsx(Zi,{to:"/home",children:"Home"}),T.jsx(Zi,{to:"/schedule",children:"Schedule"}),T.jsx(Zi,{to:"/customers",children:"Customers"}),T.jsx(Zi,{to:"/services",children:"Services"}),T.jsx(Zi,{to:"/messages",children:"Messages"}),T.jsx(Zi,{to:"/sms",children:"SMS Support"}),T.jsx(Zi,{to:"/ai-conversations",children:"AI Conversations"}),T.jsx(Zi,{to:"/settings",children:"Settings"})]})]})}function YB(){const{auth:t}=Jn();return T.jsxs("header",{className:"flex items-center justify-between border-b bg-white px-6 py-3",children:[T.jsx("h1",{className:"font-serif text-xl text-slate-800",children:"Dashboard"}),T.jsx("button",{className:"text-terracotta",onClick:()=>UB(t),children:"Sign out"})]})}var yS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qo,Kx;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,y){function _(){}_.prototype=y.prototype,v.D=y.prototype,v.prototype=new _,v.prototype.constructor=v,v.C=function(E,S,b){for(var w=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)w[Te-2]=arguments[Te];return y.prototype[S].apply(E,w)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,y,_){_||(_=0);var E=Array(16);if(typeof y=="string")for(var S=0;16>S;++S)E[S]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(S=0;16>S;++S)E[S]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=v.g[0],_=v.g[1],S=v.g[2];var b=v.g[3],w=y+(b^_&(S^b))+E[0]+3614090360&4294967295;y=_+(w<<7&4294967295|w>>>25),w=b+(S^y&(_^S))+E[1]+3905402710&4294967295,b=y+(w<<12&4294967295|w>>>20),w=S+(_^b&(y^_))+E[2]+606105819&4294967295,S=b+(w<<17&4294967295|w>>>15),w=_+(y^S&(b^y))+E[3]+3250441966&4294967295,_=S+(w<<22&4294967295|w>>>10),w=y+(b^_&(S^b))+E[4]+4118548399&4294967295,y=_+(w<<7&4294967295|w>>>25),w=b+(S^y&(_^S))+E[5]+1200080426&4294967295,b=y+(w<<12&4294967295|w>>>20),w=S+(_^b&(y^_))+E[6]+2821735955&4294967295,S=b+(w<<17&4294967295|w>>>15),w=_+(y^S&(b^y))+E[7]+4249261313&4294967295,_=S+(w<<22&4294967295|w>>>10),w=y+(b^_&(S^b))+E[8]+1770035416&4294967295,y=_+(w<<7&4294967295|w>>>25),w=b+(S^y&(_^S))+E[9]+2336552879&4294967295,b=y+(w<<12&4294967295|w>>>20),w=S+(_^b&(y^_))+E[10]+4294925233&4294967295,S=b+(w<<17&4294967295|w>>>15),w=_+(y^S&(b^y))+E[11]+2304563134&4294967295,_=S+(w<<22&4294967295|w>>>10),w=y+(b^_&(S^b))+E[12]+1804603682&4294967295,y=_+(w<<7&4294967295|w>>>25),w=b+(S^y&(_^S))+E[13]+4254626195&4294967295,b=y+(w<<12&4294967295|w>>>20),w=S+(_^b&(y^_))+E[14]+2792965006&4294967295,S=b+(w<<17&4294967295|w>>>15),w=_+(y^S&(b^y))+E[15]+1236535329&4294967295,_=S+(w<<22&4294967295|w>>>10),w=y+(S^b&(_^S))+E[1]+4129170786&4294967295,y=_+(w<<5&4294967295|w>>>27),w=b+(_^S&(y^_))+E[6]+3225465664&4294967295,b=y+(w<<9&4294967295|w>>>23),w=S+(y^_&(b^y))+E[11]+643717713&4294967295,S=b+(w<<14&4294967295|w>>>18),w=_+(b^y&(S^b))+E[0]+3921069994&4294967295,_=S+(w<<20&4294967295|w>>>12),w=y+(S^b&(_^S))+E[5]+3593408605&4294967295,y=_+(w<<5&4294967295|w>>>27),w=b+(_^S&(y^_))+E[10]+38016083&4294967295,b=y+(w<<9&4294967295|w>>>23),w=S+(y^_&(b^y))+E[15]+3634488961&4294967295,S=b+(w<<14&4294967295|w>>>18),w=_+(b^y&(S^b))+E[4]+3889429448&4294967295,_=S+(w<<20&4294967295|w>>>12),w=y+(S^b&(_^S))+E[9]+568446438&4294967295,y=_+(w<<5&4294967295|w>>>27),w=b+(_^S&(y^_))+E[14]+3275163606&4294967295,b=y+(w<<9&4294967295|w>>>23),w=S+(y^_&(b^y))+E[3]+4107603335&4294967295,S=b+(w<<14&4294967295|w>>>18),w=_+(b^y&(S^b))+E[8]+1163531501&4294967295,_=S+(w<<20&4294967295|w>>>12),w=y+(S^b&(_^S))+E[13]+2850285829&4294967295,y=_+(w<<5&4294967295|w>>>27),w=b+(_^S&(y^_))+E[2]+4243563512&4294967295,b=y+(w<<9&4294967295|w>>>23),w=S+(y^_&(b^y))+E[7]+1735328473&4294967295,S=b+(w<<14&4294967295|w>>>18),w=_+(b^y&(S^b))+E[12]+2368359562&4294967295,_=S+(w<<20&4294967295|w>>>12),w=y+(_^S^b)+E[5]+4294588738&4294967295,y=_+(w<<4&4294967295|w>>>28),w=b+(y^_^S)+E[8]+2272392833&4294967295,b=y+(w<<11&4294967295|w>>>21),w=S+(b^y^_)+E[11]+1839030562&4294967295,S=b+(w<<16&4294967295|w>>>16),w=_+(S^b^y)+E[14]+4259657740&4294967295,_=S+(w<<23&4294967295|w>>>9),w=y+(_^S^b)+E[1]+2763975236&4294967295,y=_+(w<<4&4294967295|w>>>28),w=b+(y^_^S)+E[4]+1272893353&4294967295,b=y+(w<<11&4294967295|w>>>21),w=S+(b^y^_)+E[7]+4139469664&4294967295,S=b+(w<<16&4294967295|w>>>16),w=_+(S^b^y)+E[10]+3200236656&4294967295,_=S+(w<<23&4294967295|w>>>9),w=y+(_^S^b)+E[13]+681279174&4294967295,y=_+(w<<4&4294967295|w>>>28),w=b+(y^_^S)+E[0]+3936430074&4294967295,b=y+(w<<11&4294967295|w>>>21),w=S+(b^y^_)+E[3]+3572445317&4294967295,S=b+(w<<16&4294967295|w>>>16),w=_+(S^b^y)+E[6]+76029189&4294967295,_=S+(w<<23&4294967295|w>>>9),w=y+(_^S^b)+E[9]+3654602809&4294967295,y=_+(w<<4&4294967295|w>>>28),w=b+(y^_^S)+E[12]+3873151461&4294967295,b=y+(w<<11&4294967295|w>>>21),w=S+(b^y^_)+E[15]+530742520&4294967295,S=b+(w<<16&4294967295|w>>>16),w=_+(S^b^y)+E[2]+3299628645&4294967295,_=S+(w<<23&4294967295|w>>>9),w=y+(S^(_|~b))+E[0]+4096336452&4294967295,y=_+(w<<6&4294967295|w>>>26),w=b+(_^(y|~S))+E[7]+1126891415&4294967295,b=y+(w<<10&4294967295|w>>>22),w=S+(y^(b|~_))+E[14]+2878612391&4294967295,S=b+(w<<15&4294967295|w>>>17),w=_+(b^(S|~y))+E[5]+4237533241&4294967295,_=S+(w<<21&4294967295|w>>>11),w=y+(S^(_|~b))+E[12]+1700485571&4294967295,y=_+(w<<6&4294967295|w>>>26),w=b+(_^(y|~S))+E[3]+2399980690&4294967295,b=y+(w<<10&4294967295|w>>>22),w=S+(y^(b|~_))+E[10]+4293915773&4294967295,S=b+(w<<15&4294967295|w>>>17),w=_+(b^(S|~y))+E[1]+2240044497&4294967295,_=S+(w<<21&4294967295|w>>>11),w=y+(S^(_|~b))+E[8]+1873313359&4294967295,y=_+(w<<6&4294967295|w>>>26),w=b+(_^(y|~S))+E[15]+4264355552&4294967295,b=y+(w<<10&4294967295|w>>>22),w=S+(y^(b|~_))+E[6]+2734768916&4294967295,S=b+(w<<15&4294967295|w>>>17),w=_+(b^(S|~y))+E[13]+1309151649&4294967295,_=S+(w<<21&4294967295|w>>>11),w=y+(S^(_|~b))+E[4]+4149444226&4294967295,y=_+(w<<6&4294967295|w>>>26),w=b+(_^(y|~S))+E[11]+3174756917&4294967295,b=y+(w<<10&4294967295|w>>>22),w=S+(y^(b|~_))+E[2]+718787259&4294967295,S=b+(w<<15&4294967295|w>>>17),w=_+(b^(S|~y))+E[9]+3951481745&4294967295,v.g[0]=v.g[0]+y&4294967295,v.g[1]=v.g[1]+(S+(w<<21&4294967295|w>>>11))&4294967295,v.g[2]=v.g[2]+S&4294967295,v.g[3]=v.g[3]+b&4294967295}r.prototype.u=function(v,y){y===void 0&&(y=v.length);for(var _=y-this.blockSize,E=this.B,S=this.h,b=0;b<y;){if(S==0)for(;b<=_;)i(this,v,b),b+=this.blockSize;if(typeof v=="string"){for(;b<y;)if(E[S++]=v.charCodeAt(b++),S==this.blockSize){i(this,E),S=0;break}}else for(;b<y;)if(E[S++]=v[b++],S==this.blockSize){i(this,E),S=0;break}}this.h=S,this.o+=y},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var y=1;y<v.length-8;++y)v[y]=0;var _=8*this.o;for(y=v.length-8;y<v.length;++y)v[y]=_&255,_/=256;for(this.u(v),v=Array(16),y=_=0;4>y;++y)for(var E=0;32>E;E+=8)v[_++]=this.g[y]>>>E&255;return v};function s(v,y){var _=l;return Object.prototype.hasOwnProperty.call(_,v)?_[v]:_[v]=y(v)}function o(v,y){this.h=y;for(var _=[],E=!0,S=v.length-1;0<=S;S--){var b=v[S]|0;E&&b==y||(_[S]=b,E=!1)}this.g=_}var l={};function u(v){return-128<=v&&128>v?s(v,function(y){return new o([y|0],0>y?-1:0)}):new o([v|0],0>v?-1:0)}function h(v){if(isNaN(v)||!isFinite(v))return p;if(0>v)return N(h(-v));for(var y=[],_=1,E=0;v>=_;E++)y[E]=v/_|0,_*=4294967296;return new o(y,0)}function f(v,y){if(v.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(v.charAt(0)=="-")return N(f(v.substring(1),y));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=h(Math.pow(y,8)),E=p,S=0;S<v.length;S+=8){var b=Math.min(8,v.length-S),w=parseInt(v.substring(S,S+b),y);8>b?(b=h(Math.pow(y,b)),E=E.j(b).add(h(w))):(E=E.j(_),E=E.add(h(w)))}return E}var p=u(0),g=u(1),I=u(16777216);t=o.prototype,t.m=function(){if(C(this))return-N(this).m();for(var v=0,y=1,_=0;_<this.g.length;_++){var E=this.i(_);v+=(0<=E?E:4294967296+E)*y,y*=4294967296}return v},t.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(A(this))return"0";if(C(this))return"-"+N(this).toString(v);for(var y=h(Math.pow(v,6)),_=this,E="";;){var S=O(_,y).g;_=P(_,S.j(y));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(v);if(_=S,A(_))return b+E;for(;6>b.length;)b="0"+b;E=b+E}},t.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function A(v){if(v.h!=0)return!1;for(var y=0;y<v.g.length;y++)if(v.g[y]!=0)return!1;return!0}function C(v){return v.h==-1}t.l=function(v){return v=P(this,v),C(v)?-1:A(v)?0:1};function N(v){for(var y=v.g.length,_=[],E=0;E<y;E++)_[E]=~v.g[E];return new o(_,~v.h).add(g)}t.abs=function(){return C(this)?N(this):this},t.add=function(v){for(var y=Math.max(this.g.length,v.g.length),_=[],E=0,S=0;S<=y;S++){var b=E+(this.i(S)&65535)+(v.i(S)&65535),w=(b>>>16)+(this.i(S)>>>16)+(v.i(S)>>>16);E=w>>>16,b&=65535,w&=65535,_[S]=w<<16|b}return new o(_,_[_.length-1]&-2147483648?-1:0)};function P(v,y){return v.add(N(y))}t.j=function(v){if(A(this)||A(v))return p;if(C(this))return C(v)?N(this).j(N(v)):N(N(this).j(v));if(C(v))return N(this.j(N(v)));if(0>this.l(I)&&0>v.l(I))return h(this.m()*v.m());for(var y=this.g.length+v.g.length,_=[],E=0;E<2*y;E++)_[E]=0;for(E=0;E<this.g.length;E++)for(var S=0;S<v.g.length;S++){var b=this.i(E)>>>16,w=this.i(E)&65535,Te=v.i(S)>>>16,Oe=v.i(S)&65535;_[2*E+2*S]+=w*Oe,R(_,2*E+2*S),_[2*E+2*S+1]+=b*Oe,R(_,2*E+2*S+1),_[2*E+2*S+1]+=w*Te,R(_,2*E+2*S+1),_[2*E+2*S+2]+=b*Te,R(_,2*E+2*S+2)}for(E=0;E<y;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=y;E<2*y;E++)_[E]=0;return new o(_,0)};function R(v,y){for(;(v[y]&65535)!=v[y];)v[y+1]+=v[y]>>>16,v[y]&=65535,y++}function x(v,y){this.g=v,this.h=y}function O(v,y){if(A(y))throw Error("division by zero");if(A(v))return new x(p,p);if(C(v))return y=O(N(v),y),new x(N(y.g),N(y.h));if(C(y))return y=O(v,N(y)),new x(N(y.g),y.h);if(30<v.g.length){if(C(v)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var _=g,E=y;0>=E.l(v);)_=M(_),E=M(E);var S=$(_,1),b=$(E,1);for(E=$(E,2),_=$(_,2);!A(E);){var w=b.add(E);0>=w.l(v)&&(S=S.add(_),b=w),E=$(E,1),_=$(_,1)}return y=P(v,S.j(y)),new x(S,y)}for(S=p;0<=v.l(y);){for(_=Math.max(1,Math.floor(v.m()/y.m())),E=Math.ceil(Math.log(_)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),b=h(_),w=b.j(y);C(w)||0<w.l(v);)_-=E,b=h(_),w=b.j(y);A(b)&&(b=g),S=S.add(b),v=P(v,w)}return new x(S,v)}t.A=function(v){return O(this,v).h},t.and=function(v){for(var y=Math.max(this.g.length,v.g.length),_=[],E=0;E<y;E++)_[E]=this.i(E)&v.i(E);return new o(_,this.h&v.h)},t.or=function(v){for(var y=Math.max(this.g.length,v.g.length),_=[],E=0;E<y;E++)_[E]=this.i(E)|v.i(E);return new o(_,this.h|v.h)},t.xor=function(v){for(var y=Math.max(this.g.length,v.g.length),_=[],E=0;E<y;E++)_[E]=this.i(E)^v.i(E);return new o(_,this.h^v.h)};function M(v){for(var y=v.g.length+1,_=[],E=0;E<y;E++)_[E]=v.i(E)<<1|v.i(E-1)>>>31;return new o(_,v.h)}function $(v,y){var _=y>>5;y%=32;for(var E=v.g.length-_,S=[],b=0;b<E;b++)S[b]=0<y?v.i(b+_)>>>y|v.i(b+_+1)<<32-y:v.i(b+_);return new o(S,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Kx=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,qo=o}).apply(typeof yS<"u"?yS:typeof self<"u"?self:typeof window<"u"?window:{});var Qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gx,Ac,Qx,Df,Bv,Yx,Xx,Jx;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,c,d){return a==Array.prototype||a==Object.prototype||(a[c]=d.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qd=="object"&&Qd];for(var c=0;c<a.length;++c){var d=a[c];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=n(this);function i(a,c){if(c)e:{var d=r;a=a.split(".");for(var m=0;m<a.length-1;m++){var k=a[m];if(!(k in d))break e;d=d[k]}a=a[a.length-1],m=d[a],c=c(m),c!=m&&c!=null&&e(d,a,{configurable:!0,writable:!0,value:c})}}function s(a,c){a instanceof String&&(a+="");var d=0,m=!1,k={next:function(){if(!m&&d<a.length){var V=d++;return{value:c(V,a[V]),done:!1}}return m=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}i("Array.prototype.values",function(a){return a||function(){return s(this,function(c,d){return d})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var c=typeof a;return c=c!="object"?c:a?Array.isArray(a)?"array":c:"null",c=="array"||c=="object"&&typeof a.length=="number"}function h(a){var c=typeof a;return c=="object"&&a!=null||c=="function"}function f(a,c,d){return a.call.apply(a.bind,arguments)}function p(a,c,d){if(!a)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,m),a.apply(c,k)}}return function(){return a.apply(c,arguments)}}function g(a,c,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function I(a,c){var d=Array.prototype.slice.call(arguments,1);return function(){var m=d.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function A(a,c){function d(){}d.prototype=c.prototype,a.aa=c.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(m,k,V){for(var L=Array(arguments.length-2),te=2;te<arguments.length;te++)L[te-2]=arguments[te];return c.prototype[k].apply(m,L)}}function C(a){const c=a.length;if(0<c){const d=Array(c);for(let m=0;m<c;m++)d[m]=a[m];return d}return[]}function N(a,c){for(let d=1;d<arguments.length;d++){const m=arguments[d];if(u(m)){const k=a.length||0,V=m.length||0;a.length=k+V;for(let L=0;L<V;L++)a[k+L]=m[L]}else a.push(m)}}class P{constructor(c,d){this.i=c,this.j=d,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function R(a){return/^[\s\xa0]*$/.test(a)}function x(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function O(a){return O[" "](a),a}O[" "]=function(){};var M=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function $(a,c,d){for(const m in a)c.call(d,a[m],m,a)}function v(a,c){for(const d in a)c.call(void 0,a[d],d,a)}function y(a){const c={};for(const d in a)c[d]=a[d];return c}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(a,c){let d,m;for(let k=1;k<arguments.length;k++){m=arguments[k];for(d in m)a[d]=m[d];for(let V=0;V<_.length;V++)d=_[V],Object.prototype.hasOwnProperty.call(m,d)&&(a[d]=m[d])}}function S(a){var c=1;a=a.split(":");const d=[];for(;0<c&&a.length;)d.push(a.shift()),c--;return a.length&&d.push(a.join(":")),d}function b(a){l.setTimeout(()=>{throw a},0)}function w(){var a=G;let c=null;return a.g&&(c=a.g,a.g=a.g.next,a.g||(a.h=null),c.next=null),c}class Te{constructor(){this.h=this.g=null}add(c,d){const m=Oe.get();m.set(c,d),this.h?this.h.next=m:this.g=m,this.h=m}}var Oe=new P(()=>new jt,a=>a.reset());class jt{constructor(){this.next=this.g=this.h=null}set(c,d){this.h=c,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Ue,U=!1,G=new Te,B=()=>{const a=l.Promise.resolve(void 0);Ue=()=>{a.then(Z)}};var Z=()=>{for(var a;a=w();){try{a.h.call(a.g)}catch(d){b(d)}var c=Oe;c.j(a),100>c.h&&(c.h++,a.next=c.g,c.g=a)}U=!1};function oe(){this.s=this.s,this.C=this.C}oe.prototype.s=!1,oe.prototype.ma=function(){this.s||(this.s=!0,this.N())},oe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(a,c){this.type=a,this.g=this.target=c,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var He=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,c=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const d=()=>{};l.addEventListener("test",d,c),l.removeEventListener("test",d,c)}catch{}return a}();function Ie(a,c){if(H.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=c,c=a.relatedTarget){if(M){e:{try{O(c.nodeName);var k=!0;break e}catch{}k=!1}k||(c=null)}}else d=="mouseover"?c=a.fromElement:d=="mouseout"&&(c=a.toElement);this.relatedTarget=c,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:it[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Ie.aa.h.call(this)}}A(Ie,H);var it={2:"touch",3:"pen",4:"mouse"};Ie.prototype.h=function(){Ie.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var nt="closure_listenable_"+(1e6*Math.random()|0),Pn=0;function cn(a,c,d,m,k){this.listener=a,this.proxy=null,this.src=c,this.type=d,this.capture=!!m,this.ha=k,this.key=++Pn,this.da=this.fa=!1}function hn(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function dn(a){this.src=a,this.g={},this.h=0}dn.prototype.add=function(a,c,d,m,k){var V=a.toString();a=this.g[V],a||(a=this.g[V]=[],this.h++);var L=Js(a,c,m,k);return-1<L?(c=a[L],d||(c.fa=!1)):(c=new cn(c,this.src,V,!!m,k),c.fa=d,a.push(c)),c};function Gr(a,c){var d=c.type;if(d in a.g){var m=a.g[d],k=Array.prototype.indexOf.call(m,c,void 0),V;(V=0<=k)&&Array.prototype.splice.call(m,k,1),V&&(hn(c),a.g[d].length==0&&(delete a.g[d],a.h--))}}function Js(a,c,d,m){for(var k=0;k<a.length;++k){var V=a[k];if(!V.da&&V.listener==c&&V.capture==!!d&&V.ha==m)return k}return-1}var Zs="closure_lm_"+(1e6*Math.random()|0),eo={};function Jl(a,c,d,m,k){if(Array.isArray(c)){for(var V=0;V<c.length;V++)Jl(a,c[V],d,m,k);return null}return d=tu(d),a&&a[nt]?a.K(c,d,h(m)?!!m.capture:!1,k):vg(a,c,d,!1,m,k)}function vg(a,c,d,m,k,V){if(!c)throw Error("Invalid event type");var L=h(k)?!!k.capture:!!k,te=no(a);if(te||(a[Zs]=te=new dn(a)),d=te.add(c,d,m,L,V),d.proxy)return d;if(m=wg(),d.proxy=m,m.src=a,m.listener=d,a.addEventListener)He||(k=L),k===void 0&&(k=!1),a.addEventListener(c.toString(),m,k);else if(a.attachEvent)a.attachEvent(eu(c.toString()),m);else if(a.addListener&&a.removeListener)a.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return d}function wg(){function a(d){return c.call(a.src,a.listener,d)}const c=Eg;return a}function Zl(a,c,d,m,k){if(Array.isArray(c))for(var V=0;V<c.length;V++)Zl(a,c[V],d,m,k);else m=h(m)?!!m.capture:!!m,d=tu(d),a&&a[nt]?(a=a.i,c=String(c).toString(),c in a.g&&(V=a.g[c],d=Js(V,d,m,k),-1<d&&(hn(V[d]),Array.prototype.splice.call(V,d,1),V.length==0&&(delete a.g[c],a.h--)))):a&&(a=no(a))&&(c=a.g[c.toString()],a=-1,c&&(a=Js(c,d,m,k)),(d=-1<a?c[a]:null)&&to(d))}function to(a){if(typeof a!="number"&&a&&!a.da){var c=a.src;if(c&&c[nt])Gr(c.i,a);else{var d=a.type,m=a.proxy;c.removeEventListener?c.removeEventListener(d,m,a.capture):c.detachEvent?c.detachEvent(eu(d),m):c.addListener&&c.removeListener&&c.removeListener(m),(d=no(c))?(Gr(d,a),d.h==0&&(d.src=null,c[Zs]=null)):hn(a)}}}function eu(a){return a in eo?eo[a]:eo[a]="on"+a}function Eg(a,c){if(a.da)a=!0;else{c=new Ie(c,this);var d=a.listener,m=a.ha||a.src;a.fa&&to(a),a=d.call(m,c)}return a}function no(a){return a=a[Zs],a instanceof dn?a:null}var ro="__closure_events_fn_"+(1e9*Math.random()>>>0);function tu(a){return typeof a=="function"?a:(a[ro]||(a[ro]=function(c){return a.handleEvent(c)}),a[ro])}function Re(){oe.call(this),this.i=new dn(this),this.M=this,this.F=null}A(Re,oe),Re.prototype[nt]=!0,Re.prototype.removeEventListener=function(a,c,d,m){Zl(this,a,c,d,m)};function De(a,c){var d,m=a.F;if(m)for(d=[];m;m=m.F)d.push(m);if(a=a.M,m=c.type||c,typeof c=="string")c=new H(c,a);else if(c instanceof H)c.target=c.target||a;else{var k=c;c=new H(m,a),E(c,k)}if(k=!0,d)for(var V=d.length-1;0<=V;V--){var L=c.g=d[V];k=Qr(L,m,!0,c)&&k}if(L=c.g=a,k=Qr(L,m,!0,c)&&k,k=Qr(L,m,!1,c)&&k,d)for(V=0;V<d.length;V++)L=c.g=d[V],k=Qr(L,m,!1,c)&&k}Re.prototype.N=function(){if(Re.aa.N.call(this),this.i){var a=this.i,c;for(c in a.g){for(var d=a.g[c],m=0;m<d.length;m++)hn(d[m]);delete a.g[c],a.h--}}this.F=null},Re.prototype.K=function(a,c,d,m){return this.i.add(String(a),c,!1,d,m)},Re.prototype.L=function(a,c,d,m){return this.i.add(String(a),c,!0,d,m)};function Qr(a,c,d,m){if(c=a.i.g[String(c)],!c)return!0;c=c.concat();for(var k=!0,V=0;V<c.length;++V){var L=c[V];if(L&&!L.da&&L.capture==d){var te=L.listener,we=L.ha||L.src;L.fa&&Gr(a.i,L),k=te.call(we,m)!==!1&&k}}return k&&!m.defaultPrevented}function nu(a,c,d){if(typeof a=="function")d&&(a=g(a,d));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(a,c||0)}function ru(a){a.g=nu(()=>{a.g=null,a.i&&(a.i=!1,ru(a))},a.l);const c=a.h;a.h=null,a.m.apply(null,c)}class Tg extends oe{constructor(c,d){super(),this.m=c,this.l=d,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:ru(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function er(a){oe.call(this),this.h=a,this.g={}}A(er,oe);var iu=[];function su(a){$(a.g,function(c,d){this.g.hasOwnProperty(d)&&to(c)},a),a.g={}}er.prototype.N=function(){er.aa.N.call(this),su(this)},er.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var io=l.JSON.stringify,Ig=l.JSON.parse,Ag=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function so(){}so.prototype.h=null;function ou(a){return a.h||(a.h=a.i())}function au(){}var tr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function oo(){H.call(this,"d")}A(oo,H);function ao(){H.call(this,"c")}A(ao,H);var Zt={},lu=null;function Yr(){return lu=lu||new Re}Zt.La="serverreachability";function uu(a){H.call(this,Zt.La,a)}A(uu,H);function nr(a){const c=Yr();De(c,new uu(c))}Zt.STAT_EVENT="statevent";function cu(a,c){H.call(this,Zt.STAT_EVENT,a),this.stat=c}A(cu,H);function Ve(a){const c=Yr();De(c,new cu(c,a))}Zt.Ma="timingevent";function hu(a,c){H.call(this,Zt.Ma,a),this.size=c}A(hu,H);function rr(a,c){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},c)}function ir(){this.g=!0}ir.prototype.xa=function(){this.g=!1};function Sg(a,c,d,m,k,V){a.info(function(){if(a.g)if(V)for(var L="",te=V.split("&"),we=0;we<te.length;we++){var J=te[we].split("=");if(1<J.length){var Ce=J[0];J=J[1];var be=Ce.split("_");L=2<=be.length&&be[1]=="type"?L+(Ce+"="+J+"&"):L+(Ce+"=redacted&")}}else L=null;else L=V;return"XMLHTTP REQ ("+m+") [attempt "+k+"]: "+c+`
`+d+`
`+L})}function Pg(a,c,d,m,k,V,L){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+k+"]: "+c+`
`+d+`
`+V+" "+L})}function Rn(a,c,d,m){a.info(function(){return"XMLHTTP TEXT ("+c+"): "+Cg(a,d)+(m?" "+m:"")})}function Rg(a,c){a.info(function(){return"TIMEOUT: "+c})}ir.prototype.info=function(){};function Cg(a,c){if(!a.g)return c;if(!c)return null;try{var d=JSON.parse(c);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var m=d[a];if(!(2>m.length)){var k=m[1];if(Array.isArray(k)&&!(1>k.length)){var V=k[0];if(V!="noop"&&V!="stop"&&V!="close")for(var L=1;L<k.length;L++)k[L]=""}}}}return io(d)}catch{return c}}var Xr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},du={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},lo;function Jr(){}A(Jr,so),Jr.prototype.g=function(){return new XMLHttpRequest},Jr.prototype.i=function(){return{}},lo=new Jr;function bt(a,c,d,m){this.j=a,this.i=c,this.l=d,this.R=m||1,this.U=new er(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new fu}function fu(){this.i=null,this.g="",this.h=!1}var pu={},uo={};function co(a,c,d){a.L=1,a.v=ni(gt(c)),a.m=d,a.P=!0,mu(a,null)}function mu(a,c){a.F=Date.now(),Zr(a),a.A=gt(a.v);var d=a.A,m=a.R;Array.isArray(m)||(m=[String(m)]),bu(d.i,"t",m),a.C=0,d=a.j.J,a.h=new fu,a.g=Ku(a.j,d?c:null,!a.m),0<a.O&&(a.M=new Tg(g(a.Y,a,a.g),a.O)),c=a.U,d=a.g,m=a.ca;var k="readystatechange";Array.isArray(k)||(k&&(iu[0]=k.toString()),k=iu);for(var V=0;V<k.length;V++){var L=Jl(d,k[V],m||c.handleEvent,!1,c.h||c);if(!L)break;c.g[L.key]=L}c=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,c)):(a.u="GET",a.g.ea(a.A,a.u,null,c)),nr(),Sg(a.i,a.u,a.A,a.l,a.R,a.m)}bt.prototype.ca=function(a){a=a.target;const c=this.M;c&&yt(a)==3?c.j():this.Y(a)},bt.prototype.Y=function(a){try{if(a==this.g)e:{const be=yt(this.g);var c=this.g.Ba();const kn=this.g.Z();if(!(3>be)&&(be!=3||this.g&&(this.h.h||this.g.oa()||Mu(this.g)))){this.J||be!=4||c==7||(c==8||0>=kn?nr(3):nr(2)),ho(this);var d=this.g.Z();this.X=d;t:if(gu(this)){var m=Mu(this.g);a="";var k=m.length,V=yt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){en(this),sr(this);var L="";break t}this.h.i=new l.TextDecoder}for(c=0;c<k;c++)this.h.h=!0,a+=this.h.i.decode(m[c],{stream:!(V&&c==k-1)});m.length=0,this.h.g+=a,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=d==200,Pg(this.i,this.u,this.A,this.l,this.R,be,d),this.o){if(this.T&&!this.K){t:{if(this.g){var te,we=this.g;if((te=we.g?we.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(te)){var J=te;break t}}J=null}if(d=J)Rn(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,fo(this,d);else{this.o=!1,this.s=3,Ve(12),en(this),sr(this);break e}}if(this.P){d=!0;let Qe;for(;!this.J&&this.C<L.length;)if(Qe=bg(this,L),Qe==uo){be==4&&(this.s=4,Ve(14),d=!1),Rn(this.i,this.l,null,"[Incomplete Response]");break}else if(Qe==pu){this.s=4,Ve(15),Rn(this.i,this.l,L,"[Invalid Chunk]"),d=!1;break}else Rn(this.i,this.l,Qe,null),fo(this,Qe);if(gu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),be!=4||L.length!=0||this.h.h||(this.s=1,Ve(16),d=!1),this.o=this.o&&d,!d)Rn(this.i,this.l,L,"[Invalid Chunked Response]"),en(this),sr(this);else if(0<L.length&&!this.W){this.W=!0;var Ce=this.j;Ce.g==this&&Ce.ba&&!Ce.M&&(Ce.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),vo(Ce),Ce.M=!0,Ve(11))}}else Rn(this.i,this.l,L,null),fo(this,L);be==4&&en(this),this.o&&!this.J&&(be==4?zu(this.j,this):(this.o=!1,Zr(this)))}else Hg(this.g),d==400&&0<L.indexOf("Unknown SID")?(this.s=3,Ve(12)):(this.s=0,Ve(13)),en(this),sr(this)}}}catch{}finally{}};function gu(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function bg(a,c){var d=a.C,m=c.indexOf(`
`,d);return m==-1?uo:(d=Number(c.substring(d,m)),isNaN(d)?pu:(m+=1,m+d>c.length?uo:(c=c.slice(m,m+d),a.C=m+d,c)))}bt.prototype.cancel=function(){this.J=!0,en(this)};function Zr(a){a.S=Date.now()+a.I,yu(a,a.I)}function yu(a,c){if(a.B!=null)throw Error("WatchDog timer not null");a.B=rr(g(a.ba,a),c)}function ho(a){a.B&&(l.clearTimeout(a.B),a.B=null)}bt.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Rg(this.i,this.A),this.L!=2&&(nr(),Ve(17)),en(this),this.s=2,sr(this)):yu(this,this.S-a)};function sr(a){a.j.G==0||a.J||zu(a.j,a)}function en(a){ho(a);var c=a.M;c&&typeof c.ma=="function"&&c.ma(),a.M=null,su(a.U),a.g&&(c=a.g,a.g=null,c.abort(),c.ma())}function fo(a,c){try{var d=a.j;if(d.G!=0&&(d.g==a||po(d.h,a))){if(!a.K&&po(d.h,a)&&d.G==3){try{var m=d.Da.g.parse(c)}catch{m=null}if(Array.isArray(m)&&m.length==3){var k=m;if(k[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)li(d),oi(d);else break e;_o(d),Ve(18)}}else d.za=k[1],0<d.za-d.T&&37500>k[2]&&d.F&&d.v==0&&!d.C&&(d.C=rr(g(d.Za,d),6e3));if(1>=wu(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else nn(d,11)}else if((a.K||d.g==a)&&li(d),!R(c))for(k=d.Da.g.parse(c),c=0;c<k.length;c++){let J=k[c];if(d.T=J[0],J=J[1],d.G==2)if(J[0]=="c"){d.K=J[1],d.ia=J[2];const Ce=J[3];Ce!=null&&(d.la=Ce,d.j.info("VER="+d.la));const be=J[4];be!=null&&(d.Aa=be,d.j.info("SVER="+d.Aa));const kn=J[5];kn!=null&&typeof kn=="number"&&0<kn&&(m=1.5*kn,d.L=m,d.j.info("backChannelRequestTimeoutMs_="+m)),m=d;const Qe=a.g;if(Qe){const ci=Qe.g?Qe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ci){var V=m.h;V.g||ci.indexOf("spdy")==-1&&ci.indexOf("quic")==-1&&ci.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(mo(V,V.h),V.h=null))}if(m.D){const wo=Qe.g?Qe.g.getResponseHeader("X-HTTP-Session-Id"):null;wo&&(m.ya=wo,ie(m.I,m.D,wo))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),m=d;var L=a;if(m.qa=Hu(m,m.J?m.ia:null,m.W),L.K){Eu(m.h,L);var te=L,we=m.L;we&&(te.I=we),te.B&&(ho(te),Zr(te)),m.g=L}else Uu(m);0<d.i.length&&ai(d)}else J[0]!="stop"&&J[0]!="close"||nn(d,7);else d.G==3&&(J[0]=="stop"||J[0]=="close"?J[0]=="stop"?nn(d,7):yo(d):J[0]!="noop"&&d.l&&d.l.ta(J),d.v=0)}}nr(4)}catch{}}var kg=class{constructor(a,c){this.g=a,this.map=c}};function _u(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function vu(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function wu(a){return a.h?1:a.g?a.g.size:0}function po(a,c){return a.h?a.h==c:a.g?a.g.has(c):!1}function mo(a,c){a.g?a.g.add(c):a.h=c}function Eu(a,c){a.h&&a.h==c?a.h=null:a.g&&a.g.has(c)&&a.g.delete(c)}_u.prototype.cancel=function(){if(this.i=Tu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Tu(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let c=a.i;for(const d of a.g.values())c=c.concat(d.D);return c}return C(a.i)}function xg(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var c=[],d=a.length,m=0;m<d;m++)c.push(a[m]);return c}c=[],d=0;for(m in a)c[d++]=a[m];return c}function Ng(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var c=[];a=a.length;for(var d=0;d<a;d++)c.push(d);return c}c=[],d=0;for(const m in a)c[d++]=m;return c}}}function Iu(a,c){if(a.forEach&&typeof a.forEach=="function")a.forEach(c,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,c,void 0);else for(var d=Ng(a),m=xg(a),k=m.length,V=0;V<k;V++)c.call(void 0,m[V],d&&d[V],a)}var Au=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Dg(a,c){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var m=a[d].indexOf("="),k=null;if(0<=m){var V=a[d].substring(0,m);k=a[d].substring(m+1)}else V=a[d];c(V,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function tn(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof tn){this.h=a.h,ei(this,a.j),this.o=a.o,this.g=a.g,ti(this,a.s),this.l=a.l;var c=a.i,d=new lr;d.i=c.i,c.g&&(d.g=new Map(c.g),d.h=c.h),Su(this,d),this.m=a.m}else a&&(c=String(a).match(Au))?(this.h=!1,ei(this,c[1]||"",!0),this.o=or(c[2]||""),this.g=or(c[3]||"",!0),ti(this,c[4]),this.l=or(c[5]||"",!0),Su(this,c[6]||"",!0),this.m=or(c[7]||"")):(this.h=!1,this.i=new lr(null,this.h))}tn.prototype.toString=function(){var a=[],c=this.j;c&&a.push(ar(c,Pu,!0),":");var d=this.g;return(d||c=="file")&&(a.push("//"),(c=this.o)&&a.push(ar(c,Pu,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(ar(d,d.charAt(0)=="/"?Mg:Og,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",ar(d,$g)),a.join("")};function gt(a){return new tn(a)}function ei(a,c,d){a.j=d?or(c,!0):c,a.j&&(a.j=a.j.replace(/:$/,""))}function ti(a,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);a.s=c}else a.s=null}function Su(a,c,d){c instanceof lr?(a.i=c,Fg(a.i,a.h)):(d||(c=ar(c,Lg)),a.i=new lr(c,a.h))}function ie(a,c,d){a.i.set(c,d)}function ni(a){return ie(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function or(a,c){return a?c?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function ar(a,c,d){return typeof a=="string"?(a=encodeURI(a).replace(c,Vg),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Vg(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Pu=/[#\/\?@]/g,Og=/[#\?:]/g,Mg=/[#\?]/g,Lg=/[#\?@]/g,$g=/#/g;function lr(a,c){this.h=this.g=null,this.i=a||null,this.j=!!c}function kt(a){a.g||(a.g=new Map,a.h=0,a.i&&Dg(a.i,function(c,d){a.add(decodeURIComponent(c.replace(/\+/g," ")),d)}))}t=lr.prototype,t.add=function(a,c){kt(this),this.i=null,a=Cn(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(c),this.h+=1,this};function Ru(a,c){kt(a),c=Cn(a,c),a.g.has(c)&&(a.i=null,a.h-=a.g.get(c).length,a.g.delete(c))}function Cu(a,c){return kt(a),c=Cn(a,c),a.g.has(c)}t.forEach=function(a,c){kt(this),this.g.forEach(function(d,m){d.forEach(function(k){a.call(c,k,m,this)},this)},this)},t.na=function(){kt(this);const a=Array.from(this.g.values()),c=Array.from(this.g.keys()),d=[];for(let m=0;m<c.length;m++){const k=a[m];for(let V=0;V<k.length;V++)d.push(c[m])}return d},t.V=function(a){kt(this);let c=[];if(typeof a=="string")Cu(this,a)&&(c=c.concat(this.g.get(Cn(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)c=c.concat(a[d])}return c},t.set=function(a,c){return kt(this),this.i=null,a=Cn(this,a),Cu(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[c]),this.h+=1,this},t.get=function(a,c){return a?(a=this.V(a),0<a.length?String(a[0]):c):c};function bu(a,c,d){Ru(a,c),0<d.length&&(a.i=null,a.g.set(Cn(a,c),C(d)),a.h+=d.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],c=Array.from(this.g.keys());for(var d=0;d<c.length;d++){var m=c[d];const V=encodeURIComponent(String(m)),L=this.V(m);for(m=0;m<L.length;m++){var k=V;L[m]!==""&&(k+="="+encodeURIComponent(String(L[m]))),a.push(k)}}return this.i=a.join("&")};function Cn(a,c){return c=String(c),a.j&&(c=c.toLowerCase()),c}function Fg(a,c){c&&!a.j&&(kt(a),a.i=null,a.g.forEach(function(d,m){var k=m.toLowerCase();m!=k&&(Ru(this,m),bu(this,k,d))},a)),a.j=c}function jg(a,c){const d=new ir;if(l.Image){const m=new Image;m.onload=I(xt,d,"TestLoadImage: loaded",!0,c,m),m.onerror=I(xt,d,"TestLoadImage: error",!1,c,m),m.onabort=I(xt,d,"TestLoadImage: abort",!1,c,m),m.ontimeout=I(xt,d,"TestLoadImage: timeout",!1,c,m),l.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else c(!1)}function Ug(a,c){const d=new ir,m=new AbortController,k=setTimeout(()=>{m.abort(),xt(d,"TestPingServer: timeout",!1,c)},1e4);fetch(a,{signal:m.signal}).then(V=>{clearTimeout(k),V.ok?xt(d,"TestPingServer: ok",!0,c):xt(d,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(k),xt(d,"TestPingServer: error",!1,c)})}function xt(a,c,d,m,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),m(d)}catch{}}function Bg(){this.g=new Ag}function zg(a,c,d){const m=d||"";try{Iu(a,function(k,V){let L=k;h(k)&&(L=io(k)),c.push(m+V+"="+encodeURIComponent(L))})}catch(k){throw c.push(m+"type="+encodeURIComponent("_badmap")),k}}function ri(a){this.l=a.Ub||null,this.j=a.eb||!1}A(ri,so),ri.prototype.g=function(){return new ii(this.l,this.j)},ri.prototype.i=function(a){return function(){return a}}({});function ii(a,c){Re.call(this),this.D=a,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(ii,Re),t=ii.prototype,t.open=function(a,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=c,this.readyState=1,cr(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(c.body=a),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ur(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,cr(this)),this.g&&(this.readyState=3,cr(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ku(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function ku(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var c=a.value?a.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!a.done}))&&(this.response=this.responseText+=c)}a.done?ur(this):cr(this),this.readyState==3&&ku(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,ur(this))},t.Qa=function(a){this.g&&(this.response=a,ur(this))},t.ga=function(){this.g&&ur(this)};function ur(a){a.readyState=4,a.l=null,a.j=null,a.v=null,cr(a)}t.setRequestHeader=function(a,c){this.u.append(a,c)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],c=this.h.entries();for(var d=c.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=c.next();return a.join(`\r
`)};function cr(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ii.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function xu(a){let c="";return $(a,function(d,m){c+=m,c+=":",c+=d,c+=`\r
`}),c}function go(a,c,d){e:{for(m in d){var m=!1;break e}m=!0}m||(d=xu(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):ie(a,c,d))}function he(a){Re.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(he,Re);var qg=/^https?$/i,Wg=["POST","PUT"];t=he.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,c,d,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);c=c?c.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():lo.g(),this.v=this.o?ou(this.o):ou(lo),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(c,String(a),!0),this.B=!1}catch(V){Nu(this,V);return}if(a=d||"",d=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var k in m)d.set(k,m[k]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(const V of m.keys())d.set(V,m.get(V));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(d.keys()).find(V=>V.toLowerCase()=="content-type"),k=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Wg,c,void 0))||m||k||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,L]of d)this.g.setRequestHeader(V,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ou(this),this.u=!0,this.g.send(a),this.u=!1}catch(V){Nu(this,V)}};function Nu(a,c){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=c,a.m=5,Du(a),si(a)}function Du(a){a.A||(a.A=!0,De(a,"complete"),De(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,De(this,"complete"),De(this,"abort"),si(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),si(this,!0)),he.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Vu(this):this.bb())},t.bb=function(){Vu(this)};function Vu(a){if(a.h&&typeof o<"u"&&(!a.v[1]||yt(a)!=4||a.Z()!=2)){if(a.u&&yt(a)==4)nu(a.Ea,0,a);else if(De(a,"readystatechange"),yt(a)==4){a.h=!1;try{const L=a.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var d;if(!(d=c)){var m;if(m=L===0){var k=String(a.D).match(Au)[1]||null;!k&&l.self&&l.self.location&&(k=l.self.location.protocol.slice(0,-1)),m=!qg.test(k?k.toLowerCase():"")}d=m}if(d)De(a,"complete"),De(a,"success");else{a.m=6;try{var V=2<yt(a)?a.g.statusText:""}catch{V=""}a.l=V+" ["+a.Z()+"]",Du(a)}}finally{si(a)}}}}function si(a,c){if(a.g){Ou(a);const d=a.g,m=a.v[0]?()=>{}:null;a.g=null,a.v=null,c||De(a,"ready");try{d.onreadystatechange=m}catch{}}}function Ou(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function yt(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<yt(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var c=this.g.responseText;return a&&c.indexOf(a)==0&&(c=c.substring(a.length)),Ig(c)}};function Mu(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Hg(a){const c={};a=(a.g&&2<=yt(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<a.length;m++){if(R(a[m]))continue;var d=S(a[m]);const k=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();const V=c[k]||[];c[k]=V,V.push(d)}v(c,function(m){return m.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function hr(a,c,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||c}function Lu(a){this.Aa=0,this.i=[],this.j=new ir,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=hr("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=hr("baseRetryDelayMs",5e3,a),this.cb=hr("retryDelaySeedMs",1e4,a),this.Wa=hr("forwardChannelMaxRetries",2,a),this.wa=hr("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new _u(a&&a.concurrentRequestLimit),this.Da=new Bg,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Lu.prototype,t.la=8,t.G=1,t.connect=function(a,c,d,m){Ve(0),this.W=a,this.H=c||{},d&&m!==void 0&&(this.H.OSID=d,this.H.OAID=m),this.F=this.X,this.I=Hu(this,null,this.W),ai(this)};function yo(a){if($u(a),a.G==3){var c=a.U++,d=gt(a.I);if(ie(d,"SID",a.K),ie(d,"RID",c),ie(d,"TYPE","terminate"),dr(a,d),c=new bt(a,a.j,c),c.L=2,c.v=ni(gt(d)),d=!1,l.navigator&&l.navigator.sendBeacon)try{d=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!d&&l.Image&&(new Image().src=c.v,d=!0),d||(c.g=Ku(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Zr(c)}Wu(a)}function oi(a){a.g&&(vo(a),a.g.cancel(),a.g=null)}function $u(a){oi(a),a.u&&(l.clearTimeout(a.u),a.u=null),li(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function ai(a){if(!vu(a.h)&&!a.s){a.s=!0;var c=a.Ga;Ue||B(),U||(Ue(),U=!0),G.add(c,a),a.B=0}}function Kg(a,c){return wu(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=c.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=rr(g(a.Ga,a,c),qu(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const k=new bt(this,this.j,a);let V=this.o;if(this.S&&(V?(V=y(V),E(V,this.S)):V=this.S),this.m!==null||this.O||(k.H=V,V=null),this.P)e:{for(var c=0,d=0;d<this.i.length;d++){t:{var m=this.i[d];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(c+=m,4096<c){c=d;break e}if(c===4096||d===this.i.length-1){c=d+1;break e}}c=1e3}else c=1e3;c=ju(this,k,c),d=gt(this.I),ie(d,"RID",a),ie(d,"CVER",22),this.D&&ie(d,"X-HTTP-Session-Id",this.D),dr(this,d),V&&(this.O?c="headers="+encodeURIComponent(String(xu(V)))+"&"+c:this.m&&go(d,this.m,V)),mo(this.h,k),this.Ua&&ie(d,"TYPE","init"),this.P?(ie(d,"$req",c),ie(d,"SID","null"),k.T=!0,co(k,d,null)):co(k,d,c),this.G=2}}else this.G==3&&(a?Fu(this,a):this.i.length==0||vu(this.h)||Fu(this))};function Fu(a,c){var d;c?d=c.l:d=a.U++;const m=gt(a.I);ie(m,"SID",a.K),ie(m,"RID",d),ie(m,"AID",a.T),dr(a,m),a.m&&a.o&&go(m,a.m,a.o),d=new bt(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),c&&(a.i=c.D.concat(a.i)),c=ju(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),mo(a.h,d),co(d,m,c)}function dr(a,c){a.H&&$(a.H,function(d,m){ie(c,m,d)}),a.l&&Iu({},function(d,m){ie(c,m,d)})}function ju(a,c,d){d=Math.min(a.i.length,d);var m=a.l?g(a.l.Na,a.l,a):null;e:{var k=a.i;let V=-1;for(;;){const L=["count="+d];V==-1?0<d?(V=k[0].g,L.push("ofs="+V)):V=0:L.push("ofs="+V);let te=!0;for(let we=0;we<d;we++){let J=k[we].g;const Ce=k[we].map;if(J-=V,0>J)V=Math.max(0,k[we].g-100),te=!1;else try{zg(Ce,L,"req"+J+"_")}catch{m&&m(Ce)}}if(te){m=L.join("&");break e}}}return a=a.i.splice(0,d),c.D=a,m}function Uu(a){if(!a.g&&!a.u){a.Y=1;var c=a.Fa;Ue||B(),U||(Ue(),U=!0),G.add(c,a),a.v=0}}function _o(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=rr(g(a.Fa,a),qu(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Bu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=rr(g(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ve(10),oi(this),Bu(this))};function vo(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Bu(a){a.g=new bt(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var c=gt(a.qa);ie(c,"RID","rpc"),ie(c,"SID",a.K),ie(c,"AID",a.T),ie(c,"CI",a.F?"0":"1"),!a.F&&a.ja&&ie(c,"TO",a.ja),ie(c,"TYPE","xmlhttp"),dr(a,c),a.m&&a.o&&go(c,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=ni(gt(c)),d.m=null,d.P=!0,mu(d,a)}t.Za=function(){this.C!=null&&(this.C=null,oi(this),_o(this),Ve(19))};function li(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function zu(a,c){var d=null;if(a.g==c){li(a),vo(a),a.g=null;var m=2}else if(po(a.h,c))d=c.D,Eu(a.h,c),m=1;else return;if(a.G!=0){if(c.o)if(m==1){d=c.m?c.m.length:0,c=Date.now()-c.F;var k=a.B;m=Yr(),De(m,new hu(m,d)),ai(a)}else Uu(a);else if(k=c.s,k==3||k==0&&0<c.X||!(m==1&&Kg(a,c)||m==2&&_o(a)))switch(d&&0<d.length&&(c=a.h,c.i=c.i.concat(d)),k){case 1:nn(a,5);break;case 4:nn(a,10);break;case 3:nn(a,6);break;default:nn(a,2)}}}function qu(a,c){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*c}function nn(a,c){if(a.j.info("Error code "+c),c==2){var d=g(a.fb,a),m=a.Xa;const k=!m;m=new tn(m||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ei(m,"https"),ni(m),k?jg(m.toString(),d):Ug(m.toString(),d)}else Ve(2);a.G=0,a.l&&a.l.sa(c),Wu(a),$u(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function Wu(a){if(a.G=0,a.ka=[],a.l){const c=Tu(a.h);(c.length!=0||a.i.length!=0)&&(N(a.ka,c),N(a.ka,a.i),a.h.i.length=0,C(a.i),a.i.length=0),a.l.ra()}}function Hu(a,c,d){var m=d instanceof tn?gt(d):new tn(d);if(m.g!="")c&&(m.g=c+"."+m.g),ti(m,m.s);else{var k=l.location;m=k.protocol,c=c?c+"."+k.hostname:k.hostname,k=+k.port;var V=new tn(null);m&&ei(V,m),c&&(V.g=c),k&&ti(V,k),d&&(V.l=d),m=V}return d=a.D,c=a.ya,d&&c&&ie(m,d,c),ie(m,"VER",a.la),dr(a,m),m}function Ku(a,c,d){if(c&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=a.Ca&&!a.pa?new he(new ri({eb:d})):new he(a.pa),c.Ha(a.J),c}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gu(){}t=Gu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ui(){}ui.prototype.g=function(a,c){return new Fe(a,c)};function Fe(a,c){Re.call(this),this.g=new Lu(c),this.l=a,this.h=c&&c.messageUrlParams||null,a=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(a?a["X-WebChannel-Content-Type"]=c.messageContentType:a={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(a?a["X-WebChannel-Client-Profile"]=c.va:a={"X-WebChannel-Client-Profile":c.va}),this.g.S=a,(a=c&&c.Sb)&&!R(a)&&(this.g.m=a),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!R(c)&&(this.g.D=c,a=this.h,a!==null&&c in a&&(a=this.h,c in a&&delete a[c])),this.j=new bn(this)}A(Fe,Re),Fe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Fe.prototype.close=function(){yo(this.g)},Fe.prototype.o=function(a){var c=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=io(a),a=d);c.i.push(new kg(c.Ya++,a)),c.G==3&&ai(c)},Fe.prototype.N=function(){this.g.l=null,delete this.j,yo(this.g),delete this.g,Fe.aa.N.call(this)};function Qu(a){oo.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var c=a.__sm__;if(c){e:{for(const d in c){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,c=c!==null&&a in c?c[a]:void 0),this.data=c}else this.data=a}A(Qu,oo);function Yu(){ao.call(this),this.status=1}A(Yu,ao);function bn(a){this.g=a}A(bn,Gu),bn.prototype.ua=function(){De(this.g,"a")},bn.prototype.ta=function(a){De(this.g,new Qu(a))},bn.prototype.sa=function(a){De(this.g,new Yu)},bn.prototype.ra=function(){De(this.g,"b")},ui.prototype.createWebChannel=ui.prototype.g,Fe.prototype.send=Fe.prototype.o,Fe.prototype.open=Fe.prototype.m,Fe.prototype.close=Fe.prototype.close,Jx=function(){return new ui},Xx=function(){return Yr()},Yx=Zt,Bv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Xr.NO_ERROR=0,Xr.TIMEOUT=8,Xr.HTTP_ERROR=6,Df=Xr,du.COMPLETE="complete",Qx=du,au.EventType=tr,tr.OPEN="a",tr.CLOSE="b",tr.ERROR="c",tr.MESSAGE="d",Re.prototype.listen=Re.prototype.K,Ac=au,he.prototype.listenOnce=he.prototype.L,he.prototype.getLastError=he.prototype.Ka,he.prototype.getLastErrorCode=he.prototype.Ba,he.prototype.getStatus=he.prototype.Z,he.prototype.getResponseJson=he.prototype.Oa,he.prototype.getResponseText=he.prototype.oa,he.prototype.send=he.prototype.ea,he.prototype.setWithCredentials=he.prototype.Ha,Gx=he}).apply(typeof Qd<"u"?Qd:typeof self<"u"?self:typeof window<"u"?window:{});const _S="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}mn.UNAUTHENTICATED=new mn(null),mn.GOOGLE_CREDENTIALS=new mn("google-credentials-uid"),mn.FIRST_PARTY=new mn("first-party-uid"),mn.MOCK_USER=new mn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=new rT("@firebase/firestore");function sc(){return na.logLevel}function ee(t,...e){if(na.logLevel<=Ee.DEBUG){const n=e.map(cT);na.debug(`Firestore (${Kl}): ${t}`,...n)}}function Bi(t,...e){if(na.logLevel<=Ee.ERROR){const n=e.map(cT);na.error(`Firestore (${Kl}): ${t}`,...n)}}function Il(t,...e){if(na.logLevel<=Ee.WARN){const n=e.map(cT);na.warn(`Firestore (${Kl}): ${t}`,...n)}}function cT(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t="Unexpected state"){const e=`FIRESTORE (${Kl}) INTERNAL ASSERTION FAILED: `+t;throw Bi(e),new Error(e)}function $e(t,e){t||ue()}function pe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class X extends Gi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XB{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Zx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(mn.UNAUTHENTICATED))}shutdown(){}}class JB{constructor(e){this.t=e,this.currentUser=mn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){$e(this.o===void 0);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new bs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new bs,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new bs)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($e(typeof r.accessToken=="string"),new XB(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $e(e===null||typeof e=="string"),new mn(e)}}class ZB{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=mn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ez{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new ZB(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(mn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tz{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nz{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){$e(this.o===void 0);const r=s=>{s.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?($e(typeof n.token=="string"),this.R=n.token,new tz(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rz(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=rz(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function Ne(t,e){return t<e?-1:t>e?1:0}function Al(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new X(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new X(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new X(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new X(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return pt.fromMillis(Date.now())}static fromDate(e){return pt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new pt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fe(e)}static min(){return new fe(new pt(0,0))}static max(){return new fe(new pt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,n,r){n===void 0?n=0:n>e.length&&ue(),r===void 0?r=e.length-n:r>e.length-n&&ue(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return $h.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof $h?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class qe extends $h{construct(e,n,r){return new qe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new X(j.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new qe(n)}static emptyPath(){return new qe([])}}const iz=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class St extends $h{construct(e,n,r){return new St(e,n,r)}static isValidIdentifier(e){return iz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),St.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new St(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new X(j.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new X(j.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new X(j.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new X(j.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new St(n)}static emptyPath(){return new St([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.path=e}static fromPath(e){return new ne(qe.fromString(e))}static fromName(e){return new ne(qe.fromString(e).popFirst(5))}static empty(){return new ne(qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ne(new qe(e.slice()))}}function sz(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=fe.fromTimestamp(r===1e9?new pt(n+1,0):new pt(n,r));return new js(i,ne.empty(),e)}function oz(t){return new js(t.readTime,t.key,-1)}class js{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new js(fe.min(),ne.empty(),-1)}static max(){return new js(fe.max(),ne.empty(),-1)}}function az(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ne.comparator(t.documentKey,e.documentKey),n!==0?n:Ne(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lz="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dd(t){if(t.code!==j.FAILED_PRECONDITION||t.message!==lz)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ue(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,r)=>{n(e)})}static reject(e){return new z((n,r)=>{r(e)})}static waitFor(e){return new z((n,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=z.resolve(!1);for(const r of e)n=n.next(i=>i?z.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new z((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;n(e[h]).next(f=>{o[h]=f,++l,l===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new z((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function cz(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function fd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}dT.oe=-1;function zm(t){return t==null}function $p(t){return t===0&&1/t==-1/0}function hz(t){return typeof t=="number"&&Number.isInteger(t)&&!$p(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vS(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Gl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function eN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e,n){this.comparator=e,this.root=n||Vt.EMPTY}insert(e,n){return new tt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(e){return new tt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Yd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Yd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Yd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Yd(this.root,e,this.comparator,!0)}}class Yd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Vt.RED,this.left=i??Vt.EMPTY,this.right=s??Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Vt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Vt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ue();const e=this.left.check();if(e!==this.right.check())throw ue();return e+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue()}get value(){throw ue()}get color(){throw ue()}get left(){throw ue()}get right(){throw ue()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Vt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.comparator=e,this.data=new tt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new wS(this.data.getIterator())}getIteratorFrom(e){return new wS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof $t)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new $t(this.comparator);return n.data=e,n}}class wS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e){this.fields=e,e.sort(St.comparator)}static empty(){return new vr([])}unionWith(e){let n=new $t(St.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new vr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Al(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new tN("Invalid base64 string: "+s):s}}(e);return new Ct(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Ct(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ct.EMPTY_BYTE_STRING=new Ct("");const dz=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Us(t){if($e(!!t),typeof t=="string"){let e=0;const n=dz.exec(t);if($e(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ot(t.seconds),nanos:ot(t.nanos)}}function ot(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ra(t){return typeof t=="string"?Ct.fromBase64String(t):Ct.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fT(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function pT(t){const e=t.mapValue.fields.__previous_value__;return fT(e)?pT(e):e}function Fh(t){const e=Us(t.mapValue.fields.__local_write_time__.timestampValue);return new pt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fz{constructor(e,n,r,i,s,o,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Sl{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Sl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Sl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd={mapValue:{}};function ia(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fT(t)?4:mz(t)?9007199254740991:pz(t)?10:11:ue()}function qr(t,e){if(t===e)return!0;const n=ia(t);if(n!==ia(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Fh(t).isEqual(Fh(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Us(i.timestampValue),l=Us(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ra(i.bytesValue).isEqual(ra(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return ot(i.geoPointValue.latitude)===ot(s.geoPointValue.latitude)&&ot(i.geoPointValue.longitude)===ot(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ot(i.integerValue)===ot(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=ot(i.doubleValue),l=ot(s.doubleValue);return o===l?$p(o)===$p(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Al(t.arrayValue.values||[],e.arrayValue.values||[],qr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(vS(o)!==vS(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!qr(o[u],l[u])))return!1;return!0}(t,e);default:return ue()}}function jh(t,e){return(t.values||[]).find(n=>qr(n,e))!==void 0}function Pl(t,e){if(t===e)return 0;const n=ia(t),r=ia(e);if(n!==r)return Ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ne(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=ot(s.integerValue||s.doubleValue),u=ot(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return ES(t.timestampValue,e.timestampValue);case 4:return ES(Fh(t),Fh(e));case 5:return Ne(t.stringValue,e.stringValue);case 6:return function(s,o){const l=ra(s),u=ra(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const f=Ne(l[h],u[h]);if(f!==0)return f}return Ne(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=Ne(ot(s.latitude),ot(o.latitude));return l!==0?l:Ne(ot(s.longitude),ot(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return TS(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,u,h,f;const p=s.fields||{},g=o.fields||{},I=(l=p.value)===null||l===void 0?void 0:l.arrayValue,A=(u=g.value)===null||u===void 0?void 0:u.arrayValue,C=Ne(((h=I==null?void 0:I.values)===null||h===void 0?void 0:h.length)||0,((f=A==null?void 0:A.values)===null||f===void 0?void 0:f.length)||0);return C!==0?C:TS(I,A)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Xd.mapValue&&o===Xd.mapValue)return 0;if(s===Xd.mapValue)return 1;if(o===Xd.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const g=Ne(u[p],f[p]);if(g!==0)return g;const I=Pl(l[u[p]],h[f[p]]);if(I!==0)return I}return Ne(u.length,f.length)}(t.mapValue,e.mapValue);default:throw ue()}}function ES(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ne(t,e);const n=Us(t),r=Us(e),i=Ne(n.seconds,r.seconds);return i!==0?i:Ne(n.nanos,r.nanos)}function TS(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Pl(n[i],r[i]);if(s)return s}return Ne(n.length,r.length)}function Rl(t){return zv(t)}function zv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Us(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ra(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ne.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=zv(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${zv(n.fields[o])}`;return i+"}"}(t.mapValue):ue()}function IS(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function qv(t){return!!t&&"integerValue"in t}function mT(t){return!!t&&"arrayValue"in t}function AS(t){return!!t&&"nullValue"in t}function SS(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vf(t){return!!t&&"mapValue"in t}function pz(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Qc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Gl(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Qc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Qc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function mz(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.value=e}static empty(){return new Wn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Vf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qc(n)}setAll(e){let n=St.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=Qc(o):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Vf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return qr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Vf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Gl(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Wn(Qc(this.value))}}function nN(t){const e=[];return Gl(t.fields,(n,r)=>{const i=new St([n]);if(Vf(r)){const s=nN(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new vr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,n,r,i,s,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Kt(e,0,fe.min(),fe.min(),fe.min(),Wn.empty(),0)}static newFoundDocument(e,n,r,i){return new Kt(e,1,n,fe.min(),r,i,0)}static newNoDocument(e,n){return new Kt(e,2,n,fe.min(),fe.min(),Wn.empty(),0)}static newUnknownDocument(e,n){return new Kt(e,3,n,fe.min(),fe.min(),Wn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Kt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Kt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e,n){this.position=e,this.inclusive=n}}function PS(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ne.comparator(ne.fromName(o.referenceValue),n.key):r=Pl(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function RS(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!qr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n="asc"){this.field=e,this.dir=n}}function gz(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{}class dt extends rN{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new _z(e,n,r):n==="array-contains"?new Ez(e,r):n==="in"?new Tz(e,r):n==="not-in"?new Iz(e,r):n==="array-contains-any"?new Az(e,r):new dt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new vz(e,r):new wz(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Pl(n,this.value)):n!==null&&ia(this.value)===ia(n)&&this.matchesComparison(Pl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Cr extends rN{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Cr(e,n)}matches(e){return iN(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function iN(t){return t.op==="and"}function sN(t){return yz(t)&&iN(t)}function yz(t){for(const e of t.filters)if(e instanceof Cr)return!1;return!0}function Wv(t){if(t instanceof dt)return t.field.canonicalString()+t.op.toString()+Rl(t.value);if(sN(t))return t.filters.map(e=>Wv(e)).join(",");{const e=t.filters.map(n=>Wv(n)).join(",");return`${t.op}(${e})`}}function oN(t,e){return t instanceof dt?function(r,i){return i instanceof dt&&r.op===i.op&&r.field.isEqual(i.field)&&qr(r.value,i.value)}(t,e):t instanceof Cr?function(r,i){return i instanceof Cr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&oN(o,i.filters[l]),!0):!1}(t,e):void ue()}function aN(t){return t instanceof dt?function(n){return`${n.field.canonicalString()} ${n.op} ${Rl(n.value)}`}(t):t instanceof Cr?function(n){return n.op.toString()+" {"+n.getFilters().map(aN).join(" ,")+"}"}(t):"Filter"}class _z extends dt{constructor(e,n,r){super(e,n,r),this.key=ne.fromName(r.referenceValue)}matches(e){const n=ne.comparator(e.key,this.key);return this.matchesComparison(n)}}class vz extends dt{constructor(e,n){super(e,"in",n),this.keys=lN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class wz extends dt{constructor(e,n){super(e,"not-in",n),this.keys=lN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function lN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ne.fromName(r.referenceValue))}class Ez extends dt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return mT(n)&&jh(n.arrayValue,this.value)}}class Tz extends dt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&jh(this.value.arrayValue,n)}}class Iz extends dt{constructor(e,n){super(e,"not-in",n)}matches(e){if(jh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!jh(this.value.arrayValue,n)}}class Az extends dt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!mT(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>jh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(e,n=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function CS(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Sz(t,e,n,r,i,s,o)}function gT(t){const e=pe(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Wv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),zm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Rl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Rl(r)).join(",")),e.ue=n}return e.ue}function yT(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!gz(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!oN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!RS(t.startAt,e.startAt)&&RS(t.endAt,e.endAt)}function Hv(t){return ne.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(e,n=null,r=[],i=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Pz(t,e,n,r,i,s,o,l){return new Ql(t,e,n,r,i,s,o,l)}function _T(t){return new Ql(t)}function bS(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function uN(t){return t.collectionGroup!==null}function Yc(t){const e=pe(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new $t(St.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Uh(s,r))}),n.has(St.keyField().canonicalString())||e.ce.push(new Uh(St.keyField(),r))}return e.ce}function Fr(t){const e=pe(t);return e.le||(e.le=Rz(e,Yc(t))),e.le}function Rz(t,e){if(t.limitType==="F")return CS(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Uh(i.field,s)});const n=t.endAt?new Fp(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Fp(t.startAt.position,t.startAt.inclusive):null;return CS(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Kv(t,e){const n=t.filters.concat([e]);return new Ql(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function jp(t,e,n){return new Ql(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qm(t,e){return yT(Fr(t),Fr(e))&&t.limitType===e.limitType}function cN(t){return`${gT(Fr(t))}|lt:${t.limitType}`}function ka(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>aN(i)).join(", ")}]`),zm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Rl(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Rl(i)).join(",")),`Target(${r})`}(Fr(t))}; limitType=${t.limitType})`}function Wm(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ne.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Yc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,u){const h=PS(o,l,u);return o.inclusive?h<=0:h<0}(r.startAt,Yc(r),i)||r.endAt&&!function(o,l,u){const h=PS(o,l,u);return o.inclusive?h>=0:h>0}(r.endAt,Yc(r),i))}(t,e)}function Cz(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function hN(t){return(e,n)=>{let r=!1;for(const i of Yc(t)){const s=bz(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function bz(t,e,n){const r=t.field.isKeyField()?ne.comparator(e.key,n.key):function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?Pl(u,h):ue()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ue()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Gl(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return eN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kz=new tt(ne.comparator);function zi(){return kz}const dN=new tt(ne.comparator);function Sc(...t){let e=dN;for(const n of t)e=e.insert(n.key,n);return e}function fN(t){let e=dN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Lo(){return Xc()}function pN(){return Xc()}function Xc(){return new Yl(t=>t.toString(),(t,e)=>t.isEqual(e))}const xz=new tt(ne.comparator),Nz=new $t(ne.comparator);function ve(...t){let e=Nz;for(const n of t)e=e.add(n);return e}const Dz=new $t(Ne);function Vz(){return Dz}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$p(e)?"-0":e}}function mN(t){return{integerValue:""+t}}function Oz(t,e){return hz(e)?mN(e):vT(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(){this._=void 0}}function Mz(t,e,n){return t instanceof Bh?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&fT(s)&&(s=pT(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof zh?yN(t,e):t instanceof qh?_N(t,e):function(i,s){const o=gN(i,s),l=kS(o)+kS(i.Pe);return qv(o)&&qv(i.Pe)?mN(l):vT(i.serializer,l)}(t,e)}function Lz(t,e,n){return t instanceof zh?yN(t,e):t instanceof qh?_N(t,e):n}function gN(t,e){return t instanceof Up?function(r){return qv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Bh extends Hm{}class zh extends Hm{constructor(e){super(),this.elements=e}}function yN(t,e){const n=vN(e);for(const r of t.elements)n.some(i=>qr(i,r))||n.push(r);return{arrayValue:{values:n}}}class qh extends Hm{constructor(e){super(),this.elements=e}}function _N(t,e){let n=vN(e);for(const r of t.elements)n=n.filter(i=>!qr(i,r));return{arrayValue:{values:n}}}class Up extends Hm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function kS(t){return ot(t.integerValue||t.doubleValue)}function vN(t){return mT(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $z{constructor(e,n){this.field=e,this.transform=n}}function Fz(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof zh&&i instanceof zh||r instanceof qh&&i instanceof qh?Al(r.elements,i.elements,qr):r instanceof Up&&i instanceof Up?qr(r.Pe,i.Pe):r instanceof Bh&&i instanceof Bh}(t.transform,e.transform)}class jz{constructor(e,n){this.version=e,this.transformResults=n}}class Ri{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ri}static exists(e){return new Ri(void 0,e)}static updateTime(e){return new Ri(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Of(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Km{}function wN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new TN(t.key,Ri.none()):new pd(t.key,t.data,Ri.none());{const n=t.data,r=Wn.empty();let i=new $t(St.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ya(t.key,r,new vr(i.toArray()),Ri.none())}}function Uz(t,e,n){t instanceof pd?function(i,s,o){const l=i.value.clone(),u=NS(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ya?function(i,s,o){if(!Of(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=NS(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(EN(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Jc(t,e,n,r){return t instanceof pd?function(s,o,l,u){if(!Of(s.precondition,o))return l;const h=s.value.clone(),f=DS(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof ya?function(s,o,l,u){if(!Of(s.precondition,o))return l;const h=DS(s.fieldTransforms,u,o),f=o.data;return f.setAll(EN(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,l){return Of(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function Bz(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=gN(r.transform,i||null);s!=null&&(n===null&&(n=Wn.empty()),n.set(r.field,s))}return n||null}function xS(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Al(r,i,(s,o)=>Fz(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class pd extends Km{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ya extends Km{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function EN(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function NS(t,e,n){const r=new Map;$e(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,Lz(o,l,n[i]))}return r}function DS(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,Mz(s,o,e))}return r}class TN extends Km{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zz extends Km{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qz{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Uz(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Jc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Jc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=pN();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=n.has(i.key)?null:l;const u=wN(o,l);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ve())}isEqual(e){return this.batchId===e.batchId&&Al(this.mutations,e.mutations,(n,r)=>xS(n,r))&&Al(this.baseMutations,e.baseMutations,(n,r)=>xS(n,r))}}class wT{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){$e(e.mutations.length===r.length);let i=function(){return xz}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new wT(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wz{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct,Se;function Kz(t){switch(t){default:return ue();case j.CANCELLED:case j.UNKNOWN:case j.DEADLINE_EXCEEDED:case j.RESOURCE_EXHAUSTED:case j.INTERNAL:case j.UNAVAILABLE:case j.UNAUTHENTICATED:return!1;case j.INVALID_ARGUMENT:case j.NOT_FOUND:case j.ALREADY_EXISTS:case j.PERMISSION_DENIED:case j.FAILED_PRECONDITION:case j.ABORTED:case j.OUT_OF_RANGE:case j.UNIMPLEMENTED:case j.DATA_LOSS:return!0}}function IN(t){if(t===void 0)return Bi("GRPC error has no .code"),j.UNKNOWN;switch(t){case ct.OK:return j.OK;case ct.CANCELLED:return j.CANCELLED;case ct.UNKNOWN:return j.UNKNOWN;case ct.DEADLINE_EXCEEDED:return j.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return j.RESOURCE_EXHAUSTED;case ct.INTERNAL:return j.INTERNAL;case ct.UNAVAILABLE:return j.UNAVAILABLE;case ct.UNAUTHENTICATED:return j.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return j.INVALID_ARGUMENT;case ct.NOT_FOUND:return j.NOT_FOUND;case ct.ALREADY_EXISTS:return j.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return j.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return j.FAILED_PRECONDITION;case ct.ABORTED:return j.ABORTED;case ct.OUT_OF_RANGE:return j.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return j.UNIMPLEMENTED;case ct.DATA_LOSS:return j.DATA_LOSS;default:return ue()}}(Se=ct||(ct={}))[Se.OK=0]="OK",Se[Se.CANCELLED=1]="CANCELLED",Se[Se.UNKNOWN=2]="UNKNOWN",Se[Se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Se[Se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Se[Se.NOT_FOUND=5]="NOT_FOUND",Se[Se.ALREADY_EXISTS=6]="ALREADY_EXISTS",Se[Se.PERMISSION_DENIED=7]="PERMISSION_DENIED",Se[Se.UNAUTHENTICATED=16]="UNAUTHENTICATED",Se[Se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Se[Se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Se[Se.ABORTED=10]="ABORTED",Se[Se.OUT_OF_RANGE=11]="OUT_OF_RANGE",Se[Se.UNIMPLEMENTED=12]="UNIMPLEMENTED",Se[Se.INTERNAL=13]="INTERNAL",Se[Se.UNAVAILABLE=14]="UNAVAILABLE",Se[Se.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gz(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qz=new qo([4294967295,4294967295],0);function VS(t){const e=Gz().encode(t),n=new Kx;return n.update(e),new Uint8Array(n.digest())}function OS(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new qo([n,r],0),new qo([i,s],0)]}class ET{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Pc(`Invalid padding: ${n}`);if(r<0)throw new Pc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Pc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Pc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=qo.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(qo.fromNumber(r)));return i.compare(Qz)===1&&(i=new qo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=VS(e),[r,i]=OS(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new ET(s,i,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=VS(e),[r,i]=OS(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Pc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,md.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Gm(fe.min(),i,new tt(Ne),zi(),ve())}}class md{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new md(r,n,ve(),ve(),ve())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class AN{constructor(e,n){this.targetId=e,this.me=n}}class SN{constructor(e,n,r=Ct.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class MS{constructor(){this.fe=0,this.ge=$S(),this.pe=Ct.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ve(),n=ve(),r=ve();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ue()}}),new md(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=$S()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,$e(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Yz{constructor(e){this.Le=e,this.Be=new Map,this.ke=zi(),this.qe=LS(),this.Qe=new tt(Ne)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ue()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Hv(s))if(r===0){const o=new ne(s.path);this.Ue(n,o,Kt.newNoDocument(o,fe.min()))}else $e(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,l;try{o=ra(r).toUint8Array()}catch(u){if(u instanceof tN)return Il("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new ET(o,i,s)}catch(u){return Il(u instanceof Pc?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&Hv(l.target)){const u=new ne(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Kt.newNoDocument(u,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=ve();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Gm(e,n,this.Qe,this.ke,r);return this.ke=zi(),this.qe=LS(),this.Qe=new tt(Ne),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new MS,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new $t(Ne),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new MS),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function LS(){return new tt(ne.comparator)}function $S(){return new tt(ne.comparator)}const Xz={asc:"ASCENDING",desc:"DESCENDING"},Jz={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Zz={and:"AND",or:"OR"};class eq{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Gv(t,e){return t.useProto3Json||zm(e)?e:{value:e}}function Bp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function PN(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function tq(t,e){return Bp(t,e.toTimestamp())}function jr(t){return $e(!!t),fe.fromTimestamp(function(n){const r=Us(n);return new pt(r.seconds,r.nanos)}(t))}function TT(t,e){return Qv(t,e).canonicalString()}function Qv(t,e){const n=function(i){return new qe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function RN(t){const e=qe.fromString(t);return $e(NN(e)),e}function Yv(t,e){return TT(t.databaseId,e.path)}function zy(t,e){const n=RN(e);if(n.get(1)!==t.databaseId.projectId)throw new X(j.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new X(j.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ne(bN(n))}function CN(t,e){return TT(t.databaseId,e)}function nq(t){const e=RN(t);return e.length===4?qe.emptyPath():bN(e)}function Xv(t){return new qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function bN(t){return $e(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function FS(t,e,n){return{name:Yv(t,e),fields:n.value.mapValue.fields}}function rq(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ue()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,f){return h.useProto3Json?($e(f===void 0||typeof f=="string"),Ct.fromBase64String(f||"")):($e(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Ct.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(h){const f=h.code===void 0?j.UNKNOWN:IN(h.code);return new X(f,h.message||"")}(o);n=new SN(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=zy(t,r.document.name),s=jr(r.document.updateTime),o=r.document.createTime?jr(r.document.createTime):fe.min(),l=new Wn({mapValue:{fields:r.document.fields}}),u=Kt.newFoundDocument(i,s,o,l),h=r.targetIds||[],f=r.removedTargetIds||[];n=new Mf(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=zy(t,r.document),s=r.readTime?jr(r.readTime):fe.min(),o=Kt.newNoDocument(i,s),l=r.removedTargetIds||[];n=new Mf([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=zy(t,r.document),s=r.removedTargetIds||[];n=new Mf([],s,i,null)}else{if(!("filter"in e))return ue();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new Hz(i,s),l=r.targetId;n=new AN(l,o)}}return n}function iq(t,e){let n;if(e instanceof pd)n={update:FS(t,e.key,e.value)};else if(e instanceof TN)n={delete:Yv(t,e.key)};else if(e instanceof ya)n={update:FS(t,e.key,e.data),updateMask:fq(e.fieldMask)};else{if(!(e instanceof zz))return ue();n={verify:Yv(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Bh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof zh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof qh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Up)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ue()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:tq(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ue()}(t,e.precondition)),n}function sq(t,e){return t&&t.length>0?($e(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?jr(i.updateTime):jr(s);return o.isEqual(fe.min())&&(o=jr(s)),new jz(o,i.transformResults||[])}(n,e))):[]}function oq(t,e){return{documents:[CN(t,e.path)]}}function aq(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=CN(t,i);const s=function(h){if(h.length!==0)return xN(Cr.create(h,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(f=>function(g){return{field:xa(g.field),direction:cq(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Gv(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:i}}function lq(t){let e=nq(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){$e(r===1);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(p){const g=kN(p);return g instanceof Cr&&sN(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(A){return new Uh(Na(A.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(p){let g;return g=typeof p=="object"?p.value:p,zm(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(p){const g=!!p.before,I=p.values||[];return new Fp(I,g)}(n.startAt));let h=null;return n.endAt&&(h=function(p){const g=!p.before,I=p.values||[];return new Fp(I,g)}(n.endAt)),Pz(e,i,o,s,l,"F",u,h)}function uq(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function kN(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Na(n.unaryFilter.field);return dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Na(n.unaryFilter.field);return dt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Na(n.unaryFilter.field);return dt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Na(n.unaryFilter.field);return dt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ue()}}(t):t.fieldFilter!==void 0?function(n){return dt.create(Na(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ue()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Cr.create(n.compositeFilter.filters.map(r=>kN(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue()}}(n.compositeFilter.op))}(t):ue()}function cq(t){return Xz[t]}function hq(t){return Jz[t]}function dq(t){return Zz[t]}function xa(t){return{fieldPath:t.canonicalString()}}function Na(t){return St.fromServerFormat(t.fieldPath)}function xN(t){return t instanceof dt?function(n){if(n.op==="=="){if(SS(n.value))return{unaryFilter:{field:xa(n.field),op:"IS_NAN"}};if(AS(n.value))return{unaryFilter:{field:xa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(SS(n.value))return{unaryFilter:{field:xa(n.field),op:"IS_NOT_NAN"}};if(AS(n.value))return{unaryFilter:{field:xa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xa(n.field),op:hq(n.op),value:n.value}}}(t):t instanceof Cr?function(n){const r=n.getFilters().map(i=>xN(i));return r.length===1?r[0]:{compositeFilter:{op:dq(n.op),filters:r}}}(t):ue()}function fq(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function NN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,n,r,i,s=fe.min(),o=fe.min(),l=Ct.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new ps(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pq{constructor(e){this.ct=e}}function mq(t){const e=lq({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?jp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gq{constructor(){this.un=new yq}addToCollectionParentIndex(e,n){return this.un.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(js.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(js.min())}updateCollectionGroup(e,n,r){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class yq{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new $t(qe.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new $t(qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Cl(0)}static kn(){return new Cl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _q{constructor(){this.changes=new Yl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Kt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vq{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wq{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Jc(r.mutation,i,vr.empty(),pt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ve()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ve()){const i=Lo();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Sc();return s.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Lo();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ve()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,i){let s=zi();const o=Xc(),l=function(){return Xc()}();return n.forEach((u,h)=>{const f=r.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof ya)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),Jc(f.mutation,h,f.mutation.getFieldMask(),pt.now())):o.set(h.key,vr.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((h,f)=>o.set(h,f)),n.forEach((h,f)=>{var p;return l.set(h,new vq(f,(p=o.get(h))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Xc();let i=new tt((o,l)=>o-l),s=ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let f=r.get(u)||vr.empty();f=l.applyToLocalView(h,f),r.set(u,f);const p=(i.get(l.batchId)||ve()).add(u);i=i.insert(l.batchId,p)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,f=u.value,p=pN();f.forEach(g=>{if(!s.has(g)){const I=wN(n.get(g),r.get(g));I!==null&&p.set(g,I),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,p))}return z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ne.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):uN(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):z.resolve(Lo());let l=-1,u=s;return o.next(h=>z.forEach(h,(f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(f)?z.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,u,h,ve())).next(f=>({batchId:l,changes:fN(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ne(n)).next(r=>{let i=Sc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Sc();return this.indexManager.getCollectionParents(e,s).next(l=>z.forEach(l,u=>{const h=function(p,g){return new Ql(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Kt.newInvalidDocument(f)))});let l=Sc();return o.forEach((u,h)=>{const f=s.get(u);f!==void 0&&Jc(f.mutation,h,vr.empty(),pt.now()),Wm(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eq{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return z.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:jr(i.createTime)}}(n)),z.resolve()}getNamedQuery(e,n){return z.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:mq(i.bundledQuery),readTime:jr(i.readTime)}}(n)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tq{constructor(){this.overlays=new tt(ne.comparator),this.Ir=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Lo();return z.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),z.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),z.resolve()}getOverlaysForCollection(e,n,r){const i=Lo(),s=n.length+1,o=new ne(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return z.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new tt((h,f)=>h-f);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let f=s.get(h.largestBatchId);f===null&&(f=Lo(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const l=Lo(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>l.set(h,f)),!(l.size()>=i)););return z.resolve(l)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Wz(n,r));let s=this.Ir.get(n);s===void 0&&(s=ve(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iq{constructor(){this.sessionToken=Ct.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(){this.Tr=new $t(Tt.Er),this.dr=new $t(Tt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Tt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Tt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ne(new qe([])),r=new Tt(n,e),i=new Tt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ne(new qe([])),r=new Tt(n,e),i=new Tt(n,e+1);let s=ve();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Tt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Tt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ne.comparator(e.key,n.key)||Ne(e.wr,n.wr)}static Ar(e,n){return Ne(e.wr,n.wr)||ne.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aq{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new $t(Tt.Er)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new qz(s,n,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new Tt(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,n){return z.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return z.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Tt(n,0),i=new Tt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),z.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $t(Ne);return n.forEach(i=>{const s=new Tt(i,0),o=new Tt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),z.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ne.isDocumentKey(s)||(s=s.child(""));const o=new Tt(new ne(s),0);let l=new $t(Ne);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(l=l.add(u.wr)),!0)},o),z.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){$e(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return z.forEach(n.mutations,i=>{const s=new Tt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Tt(n,0),i=this.br.firstAfterOrEqual(r);return z.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sq{constructor(e){this.Mr=e,this.docs=function(){return new tt(ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return z.resolve(r?r.document.mutableCopy():Kt.newInvalidDocument(n))}getEntries(e,n){let r=zi();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Kt.newInvalidDocument(i))}),z.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=zi();const o=n.path,l=new ne(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||az(oz(f),r)<=0||(i.has(f.key)||Wm(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return z.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ue()}Or(e,n){return z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Pq(this)}getSize(e){return z.resolve(this.size)}}class Pq extends _q{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),z.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rq{constructor(e){this.persistence=e,this.Nr=new Yl(n=>gT(n),yT),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new IT,this.targetCount=0,this.kr=Cl.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),z.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Cl(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Kn(n),z.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),z.waitFor(s).next(()=>i)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return z.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),z.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),z.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return z.resolve(r)}containsKey(e,n){return z.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cq{constructor(e,n){this.qr={},this.overlays={},this.Qr=new dT(0),this.Kr=!1,this.Kr=!0,this.$r=new Iq,this.referenceDelegate=e(this),this.Ur=new Rq(this),this.indexManager=new gq,this.remoteDocumentCache=function(i){return new Sq(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new pq(n),this.Gr=new Eq(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Tq,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new Aq(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const i=new bq(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return z.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class bq extends uz{constructor(e){super(),this.currentSequenceNumber=e}}class AT{constructor(e){this.persistence=e,this.Jr=new IT,this.Yr=null}static Zr(e){return new AT(e)}get Xr(){if(this.Yr)return this.Yr;throw ue()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),z.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),z.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.Xr,r=>{const i=ne.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,fe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return z.or([()=>z.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=ve(),i=ve();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new ST(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kq{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xq{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return B3()?8:cz(Rr())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new kq;return this.Xi(e,n,o).next(l=>{if(s.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(sc()<=Ee.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",ka(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),z.resolve()):(sc()<=Ee.DEBUG&&ee("QueryEngine","Query:",ka(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(sc()<=Ee.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",ka(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fr(n))):z.resolve())}Yi(e,n){if(bS(n))return z.resolve(null);let r=Fr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=jp(n,null,"F"),r=Fr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ve(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,o,u.readTime)?this.Yi(e,jp(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,i){return bS(n)||i.isEqual(fe.min())?z.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?z.resolve(null):(sc()<=Ee.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ka(n)),this.rs(e,o,n,sz(i,-1)).next(l=>l))})}ts(e,n){let r=new $t(hN(e));return n.forEach((i,s)=>{Wm(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return sc()<=Ee.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",ka(n)),this.Ji.getDocumentsMatchingQuery(e,n,js.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nq{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new tt(Ne),this._s=new Yl(s=>gT(s),yT),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wq(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function Dq(t,e,n,r){return new Nq(t,e,n,r)}async function DN(t,e){const n=pe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let u=ve();for(const h of i){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of s){l.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:l}))})})}function Vq(t,e){const n=pe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,f){const p=h.batch,g=p.keys();let I=z.resolve();return g.forEach(A=>{I=I.next(()=>f.getEntry(u,A)).next(C=>{const N=h.docVersions.get(A);$e(N!==null),C.version.compareTo(N)<0&&(p.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),f.addEntry(C)))})}),I.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ve();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function VN(t){const e=pe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function Oq(t,e){const n=pe(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const l=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;l.push(n.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(s,f.addedDocuments,p)));let I=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?I=I.withResumeToken(Ct.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):f.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(f.resumeToken,r)),i=i.insert(p,I),function(C,N,P){return C.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(g,I,f)&&l.push(n.Ur.updateTargetData(s,I))});let u=zi(),h=ve();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),l.push(Mq(s,o,e.documentUpdates).next(f=>{u=f.Ps,h=f.Is})),!r.isEqual(fe.min())){const f=n.Ur.getLastRemoteSnapshotVersion(s).next(p=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(f)}return z.waitFor(l).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(n.os=i,s))}function Mq(t,e,n){let r=ve(),i=ve();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=zi();return n.forEach((l,u)=>{const h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(fe.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):ee("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function Lq(t,e){const n=pe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function $q(t,e){const n=pe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,z.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new ps(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Jv(t,e,n){const r=pe(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!fd(o))throw o;ee("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function jS(t,e,n){const r=pe(t);let i=fe.min(),s=ve();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,f){const p=pe(u),g=p._s.get(f);return g!==void 0?z.resolve(p.os.get(g)):p.Ur.getTargetData(h,f)}(r,o,Fr(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:fe.min(),n?s:ve())).next(l=>(Fq(r,Cz(e),l),{documents:l,Ts:s})))}function Fq(t,e,n){let r=t.us.get(e)||fe.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class US{constructor(){this.activeTargetIds=Vz()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jq{constructor(){this.so=new US,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new US,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uq{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ee("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ee("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jd=null;function qy(){return Jd===null?Jd=function(){return 268435456+Math.round(2147483648*Math.random())}():Jd++,"0x"+Jd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zq{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qt="WebChannelConnection";class qq extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const l=qy(),u=this.xo(n,r.toUriEncodedString());ee("RestConnection",`Sending RPC '${n}' ${l}:`,u,i);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,s,o),this.No(n,u,h,i).then(f=>(ee("RestConnection",`Received RPC '${n}' ${l}: `,f),f),f=>{throw Il("RestConnection",`RPC '${n}' ${l} failed with error: `,f,"url: ",u,"request:",i),f})}Lo(n,r,i,s,o,l){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Kl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=Bq[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=qy();return new Promise((o,l)=>{const u=new Gx;u.setWithCredentials(!0),u.listenOnce(Qx.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Df.NO_ERROR:const f=u.getResponseJson();ee(qt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case Df.TIMEOUT:ee(qt,`RPC '${e}' ${s} timed out`),l(new X(j.DEADLINE_EXCEEDED,"Request time out"));break;case Df.HTTP_ERROR:const p=u.getStatus();if(ee(qt,`RPC '${e}' ${s} failed with status:`,p,"response text:",u.getResponseText()),p>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const I=g==null?void 0:g.error;if(I&&I.status&&I.message){const A=function(N){const P=N.toLowerCase().replace(/_/g,"-");return Object.values(j).indexOf(P)>=0?P:j.UNKNOWN}(I.status);l(new X(A,I.message))}else l(new X(j.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new X(j.UNAVAILABLE,"Connection failed."));break;default:ue()}}finally{ee(qt,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);ee(qt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const i=qy(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Jx(),l=Xx(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=s.join("");ee(qt,`Creating RPC '${e}' stream ${i}: ${f}`,u);const p=o.createWebChannel(f,u);let g=!1,I=!1;const A=new zq({Io:N=>{I?ee(qt,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(g||(ee(qt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),ee(qt,`RPC '${e}' stream ${i} sending:`,N),p.send(N))},To:()=>p.close()}),C=(N,P,R)=>{N.listen(P,x=>{try{R(x)}catch(O){setTimeout(()=>{throw O},0)}})};return C(p,Ac.EventType.OPEN,()=>{I||(ee(qt,`RPC '${e}' stream ${i} transport opened.`),A.yo())}),C(p,Ac.EventType.CLOSE,()=>{I||(I=!0,ee(qt,`RPC '${e}' stream ${i} transport closed`),A.So())}),C(p,Ac.EventType.ERROR,N=>{I||(I=!0,Il(qt,`RPC '${e}' stream ${i} transport errored:`,N),A.So(new X(j.UNAVAILABLE,"The operation could not be completed")))}),C(p,Ac.EventType.MESSAGE,N=>{var P;if(!I){const R=N.data[0];$e(!!R);const x=R,O=x.error||((P=x[0])===null||P===void 0?void 0:P.error);if(O){ee(qt,`RPC '${e}' stream ${i} received error:`,O);const M=O.status;let $=function(_){const E=ct[_];if(E!==void 0)return IN(E)}(M),v=O.message;$===void 0&&($=j.INTERNAL,v="Unknown error status: "+M+" with message "+O.message),I=!0,A.So(new X($,v)),p.close()}else ee(qt,`RPC '${e}' stream ${i} received:`,R),A.bo(R)}}),C(l,Yx.STAT_EVENT,N=>{N.stat===Bv.PROXY?ee(qt,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Bv.NOPROXY&&ee(qt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.wo()},0),A}}function Wy(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(t){return new eq(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e,n,r,i,s,o,l,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new ON(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===j.RESOURCE_EXHAUSTED?(Bi(n.toString()),Bi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===j.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new X(j.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ee("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ee("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Wq extends MN{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=rq(this.serializer,e),r=function(s){if(!("targetChange"in s))return fe.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?jr(o.readTime):fe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Xv(this.serializer),n.addTarget=function(s,o){let l;const u=o.target;if(l=Hv(u)?{documents:oq(s,u)}:{query:aq(s,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=PN(s,o.resumeToken);const h=Gv(s,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(fe.min())>0){l.readTime=Bp(s,o.snapshotVersion.toTimestamp());const h=Gv(s,o.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=uq(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Xv(this.serializer),n.removeTarget=e,this.a_(n)}}class Hq extends MN{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return $e(!!e.streamToken),this.lastStreamToken=e.streamToken,$e(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){$e(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=sq(e.writeResults,e.commitTime),r=jr(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Xv(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>iq(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kq extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new X(j.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Qv(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new X(j.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Qv(n,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new X(j.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Gq{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Bi(n),this.D_=!1):ee("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qq{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{_a(this)&&(ee("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=pe(u);h.L_.add(4),await gd(h),h.q_.set("Unknown"),h.L_.delete(4),await Ym(h)}(this))})}),this.q_=new Gq(r,i)}}async function Ym(t){if(_a(t))for(const e of t.B_)await e(!0)}async function gd(t){for(const e of t.B_)await e(!1)}function LN(t,e){const n=pe(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),bT(n)?CT(n):Xl(n).r_()&&RT(n,e))}function PT(t,e){const n=pe(t),r=Xl(n);n.N_.delete(e),r.r_()&&$N(n,e),n.N_.size===0&&(r.r_()?r.o_():_a(n)&&n.q_.set("Unknown"))}function RT(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Xl(t).A_(e)}function $N(t,e){t.Q_.xe(e),Xl(t).R_(e)}function CT(t){t.Q_=new Yz({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Xl(t).start(),t.q_.v_()}function bT(t){return _a(t)&&!Xl(t).n_()&&t.N_.size>0}function _a(t){return pe(t).L_.size===0}function FN(t){t.Q_=void 0}async function Yq(t){t.q_.set("Online")}async function Xq(t){t.N_.forEach((e,n)=>{RT(t,e)})}async function Jq(t,e){FN(t),bT(t)?(t.q_.M_(e),CT(t)):t.q_.set("Unknown")}async function Zq(t,e,n){if(t.q_.set("Online"),e instanceof SN&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){ee("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zp(t,r)}else if(e instanceof Mf?t.Q_.Ke(e):e instanceof AN?t.Q_.He(e):t.Q_.We(e),!n.isEqual(fe.min()))try{const r=await VN(t.localStore);n.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=s.N_.get(h);f&&s.N_.set(h,f.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,h)=>{const f=s.N_.get(u);if(!f)return;s.N_.set(u,f.withResumeToken(Ct.EMPTY_BYTE_STRING,f.snapshotVersion)),$N(s,u);const p=new ps(f.target,u,h,f.sequenceNumber);RT(s,p)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ee("RemoteStore","Failed to raise snapshot:",r),await zp(t,r)}}async function zp(t,e,n){if(!fd(e))throw e;t.L_.add(1),await gd(t),t.q_.set("Offline"),n||(n=()=>VN(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Ym(t)})}function jN(t,e){return e().catch(n=>zp(t,n,e))}async function Xm(t){const e=pe(t),n=Bs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;e7(e);)try{const i=await Lq(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,t7(e,i)}catch(i){await zp(e,i)}UN(e)&&BN(e)}function e7(t){return _a(t)&&t.O_.length<10}function t7(t,e){t.O_.push(e);const n=Bs(t);n.r_()&&n.V_&&n.m_(e.mutations)}function UN(t){return _a(t)&&!Bs(t).n_()&&t.O_.length>0}function BN(t){Bs(t).start()}async function n7(t){Bs(t).p_()}async function r7(t){const e=Bs(t);for(const n of t.O_)e.m_(n.mutations)}async function i7(t,e,n){const r=t.O_.shift(),i=wT.from(r,e,n);await jN(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Xm(t)}async function s7(t,e){e&&Bs(t).V_&&await async function(r,i){if(function(o){return Kz(o)&&o!==j.ABORTED}(i.code)){const s=r.O_.shift();Bs(r).s_(),await jN(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Xm(r)}}(t,e),UN(t)&&BN(t)}async function zS(t,e){const n=pe(t);n.asyncQueue.verifyOperationInProgress(),ee("RemoteStore","RemoteStore received new credentials");const r=_a(n);n.L_.add(3),await gd(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Ym(n)}async function o7(t,e){const n=pe(t);e?(n.L_.delete(2),await Ym(n)):e||(n.L_.add(2),await gd(n),n.q_.set("Unknown"))}function Xl(t){return t.K_||(t.K_=function(n,r,i){const s=pe(n);return s.w_(),new Wq(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:Yq.bind(null,t),Ro:Xq.bind(null,t),mo:Jq.bind(null,t),d_:Zq.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),bT(t)?CT(t):t.q_.set("Unknown")):(await t.K_.stop(),FN(t))})),t.K_}function Bs(t){return t.U_||(t.U_=function(n,r,i){const s=pe(n);return s.w_(),new Hq(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:n7.bind(null,t),mo:s7.bind(null,t),f_:r7.bind(null,t),g_:i7.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Xm(t)):(await t.U_.stop(),t.O_.length>0&&(ee("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new bs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,l=new kT(e,n,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new X(j.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xT(t,e){if(Bi("AsyncQueue",`${e}: ${t}`),fd(t))return new X(j.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ne.comparator(n.key,r.key):(n,r)=>ne.comparator(n.key,r.key),this.keyedMap=Sc(),this.sortedSet=new tt(this.comparator)}static emptySet(e){return new ul(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ul)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ul;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(){this.W_=new tt(ne.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ue():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class bl{constructor(e,n,r,i,s,o,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new bl(e,n,ul.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a7{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class l7{constructor(){this.queries=WS(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=pe(n),s=i.queries;i.queries=WS(),s.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new X(j.ABORTED,"Firestore shutting down"))}}function WS(){return new Yl(t=>cN(t),qm)}async function zN(t,e){const n=pe(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new a7,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=xT(o,`Initialization of query '${ka(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&NT(n)}async function qN(t,e){const n=pe(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function u7(t,e){const n=pe(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&NT(n)}function c7(t,e,n){const r=pe(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function NT(t){t.Y_.forEach(e=>{e.next()})}var Zv,HS;(HS=Zv||(Zv={})).ea="default",HS.Cache="cache";class WN{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new bl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=bl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Zv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.key=e}}class KN{constructor(e){this.key=e}}class h7{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ve(),this.mutatedKeys=ve(),this.Aa=hN(e),this.Ra=new ul(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new qS,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),I=Wm(this.query,p)?p:null,A=!!g&&this.mutatedKeys.has(g.key),C=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let N=!1;g&&I?g.data.isEqual(I.data)?A!==C&&(r.track({type:3,doc:I}),N=!0):this.ga(g,I)||(r.track({type:2,doc:I}),N=!0,(u&&this.Aa(I,u)>0||h&&this.Aa(I,h)<0)&&(l=!0)):!g&&I?(r.track({type:0,doc:I}),N=!0):g&&!I&&(r.track({type:1,doc:g}),N=!0,(u||h)&&(l=!0)),N&&(I?(o=o.add(I),s=C?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((f,p)=>function(I,A){const C=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue()}};return C(I)-C(A)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(r),i=i!=null&&i;const l=n&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,h=u!==this.Ea;return this.Ea=u,o.length!==0||h?{snapshot:new bl(this.query,e.Ra,s,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new qS,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ve(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new KN(r))}),this.da.forEach(r=>{e.has(r)||n.push(new HN(r))}),n}ba(e){this.Ta=e.Ts,this.da=ve();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return bl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class d7{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class f7{constructor(e){this.key=e,this.va=!1}}class p7{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Yl(l=>cN(l),qm),this.Ma=new Map,this.xa=new Set,this.Oa=new tt(ne.comparator),this.Na=new Map,this.La=new IT,this.Ba={},this.ka=new Map,this.qa=Cl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function m7(t,e,n=!0){const r=ZN(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await GN(r,e,n,!0),i}async function g7(t,e){const n=ZN(t);await GN(n,e,!0,!1)}async function GN(t,e,n,r){const i=await $q(t.localStore,Fr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await y7(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&LN(t.remoteStore,i),l}async function y7(t,e,n,r,i){t.Ka=(p,g,I)=>async function(C,N,P,R){let x=N.view.ma(P);x.ns&&(x=await jS(C.localStore,N.query,!1).then(({documents:v})=>N.view.ma(v,x)));const O=R&&R.targetChanges.get(N.targetId),M=R&&R.targetMismatches.get(N.targetId)!=null,$=N.view.applyChanges(x,C.isPrimaryClient,O,M);return GS(C,N.targetId,$.wa),$.snapshot}(t,p,g,I);const s=await jS(t.localStore,e,!0),o=new h7(e,s.Ts),l=o.ma(s.documents),u=md.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),h=o.applyChanges(l,t.isPrimaryClient,u);GS(t,n,h.wa);const f=new d7(e,n,o);return t.Fa.set(e,f),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function _7(t,e,n){const r=pe(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!qm(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Jv(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&PT(r.remoteStore,i.targetId),ew(r,i.targetId)}).catch(dd)):(ew(r,i.targetId),await Jv(r.localStore,i.targetId,!0))}async function v7(t,e){const n=pe(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),PT(n.remoteStore,r.targetId))}async function w7(t,e,n){const r=R7(t);try{const i=await function(o,l){const u=pe(o),h=pt.now(),f=l.reduce((I,A)=>I.add(A.key),ve());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",I=>{let A=zi(),C=ve();return u.cs.getEntries(I,f).next(N=>{A=N,A.forEach((P,R)=>{R.isValidDocument()||(C=C.add(P))})}).next(()=>u.localDocuments.getOverlayedDocuments(I,A)).next(N=>{p=N;const P=[];for(const R of l){const x=Bz(R,p.get(R.key).overlayedDocument);x!=null&&P.push(new ya(R.key,x,nN(x.value.mapValue),Ri.exists(!0)))}return u.mutationQueue.addMutationBatch(I,h,P,l)}).next(N=>{g=N;const P=N.applyToLocalDocumentSet(p,C);return u.documentOverlayCache.saveOverlays(I,N.batchId,P)})}).then(()=>({batchId:g.batchId,changes:fN(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,u){let h=o.Ba[o.currentUser.toKey()];h||(h=new tt(Ne)),h=h.insert(l,u),o.Ba[o.currentUser.toKey()]=h}(r,i.batchId,n),await yd(r,i.changes),await Xm(r.remoteStore)}catch(i){const s=xT(i,"Failed to persist write");n.reject(s)}}async function QN(t,e){const n=pe(t);try{const r=await Oq(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&($e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?$e(o.va):i.removedDocuments.size>0&&($e(o.va),o.va=!1))}),await yd(n,r,e)}catch(r){await dd(r)}}function KS(t,e,n){const r=pe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const u=pe(o);u.onlineState=l;let h=!1;u.queries.forEach((f,p)=>{for(const g of p.j_)g.Z_(l)&&(h=!0)}),h&&NT(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function E7(t,e,n){const r=pe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new tt(ne.comparator);o=o.insert(s,Kt.newNoDocument(s,fe.min()));const l=ve().add(s),u=new Gm(fe.min(),new Map,new tt(Ne),o,l);await QN(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),DT(r)}else await Jv(r.localStore,e,!1).then(()=>ew(r,e,n)).catch(dd)}async function T7(t,e){const n=pe(t),r=e.batch.batchId;try{const i=await Vq(n.localStore,e);XN(n,r,null),YN(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await yd(n,i)}catch(i){await dd(i)}}async function I7(t,e,n){const r=pe(t);try{const i=await function(o,l){const u=pe(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,l).next(p=>($e(p!==null),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(r.localStore,e);XN(r,e,n),YN(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await yd(r,i)}catch(i){await dd(i)}}function YN(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function XN(t,e,n){const r=pe(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function ew(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||JN(t,r)})}function JN(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(PT(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),DT(t))}function GS(t,e,n){for(const r of n)r instanceof HN?(t.La.addReference(r.key,e),A7(t,r)):r instanceof KN?(ee("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||JN(t,r.key)):ue()}function A7(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ee("SyncEngine","New document in limbo: "+n),t.xa.add(r),DT(t))}function DT(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ne(qe.fromString(e)),r=t.qa.next();t.Na.set(r,new f7(n)),t.Oa=t.Oa.insert(n,r),LN(t.remoteStore,new ps(Fr(_T(n.path)),r,"TargetPurposeLimboResolution",dT.oe))}}async function yd(t,e,n){const r=pe(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(h=>{var f;if((h||n)&&r.isPrimaryClient){const p=h?!h.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(h){i.push(h);const p=ST.Wi(u.targetId,h);s.push(p)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(u,h){const f=pe(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>z.forEach(h,g=>z.forEach(g.$i,I=>f.persistence.referenceDelegate.addReference(p,g.targetId,I)).next(()=>z.forEach(g.Ui,I=>f.persistence.referenceDelegate.removeReference(p,g.targetId,I)))))}catch(p){if(!fd(p))throw p;ee("LocalStore","Failed to update sequence numbers: "+p)}for(const p of h){const g=p.targetId;if(!p.fromCache){const I=f.os.get(g),A=I.snapshotVersion,C=I.withLastLimboFreeSnapshotVersion(A);f.os=f.os.insert(g,C)}}}(r.localStore,s))}async function S7(t,e){const n=pe(t);if(!n.currentUser.isEqual(e)){ee("SyncEngine","User change. New user:",e.toKey());const r=await DN(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(u=>{u.reject(new X(j.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await yd(n,r.hs)}}function P7(t,e){const n=pe(t),r=n.Na.get(e);if(r&&r.va)return ve().add(r.key);{let i=ve();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const l=n.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function ZN(t){const e=pe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=QN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=P7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=E7.bind(null,e),e.Ca.d_=u7.bind(null,e.eventManager),e.Ca.$a=c7.bind(null,e.eventManager),e}function R7(t){const e=pe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=T7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=I7.bind(null,e),e}class qp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return Dq(this.persistence,new xq,e.initialUser,this.serializer)}Ga(e){return new Cq(AT.Zr,this.serializer)}Wa(e){return new jq}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qp.provider={build:()=>new qp};class tw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>KS(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=S7.bind(null,this.syncEngine),await o7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new l7}()}createDatastore(e){const n=Qm(e.databaseInfo.databaseId),r=function(s){return new qq(s)}(e.databaseInfo);return function(s,o,l,u){return new Kq(s,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,l){return new Qq(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>KS(this.syncEngine,n,0),function(){return BS.D()?new BS:new Uq}())}createSyncEngine(e,n){return function(i,s,o,l,u,h,f){const p=new p7(i,s,o,l,u,h);return f&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=pe(i);ee("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await gd(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}tw.provider={build:()=>new tw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Bi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C7{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=mn.UNAUTHENTICATED,this.clientId=hT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ee("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new bs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=xT(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Hy(t,e){t.asyncQueue.verifyOperationInProgress(),ee("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await DN(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function QS(t,e){t.asyncQueue.verifyOperationInProgress();const n=await b7(t);ee("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>zS(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>zS(e.remoteStore,i)),t._onlineComponents=e}async function b7(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee("FirestoreClient","Using user provided OfflineComponentProvider");try{await Hy(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===j.FAILED_PRECONDITION||i.code===j.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Il("Error using user provided cache. Falling back to memory cache: "+n),await Hy(t,new qp)}}else ee("FirestoreClient","Using default OfflineComponentProvider"),await Hy(t,new qp);return t._offlineComponents}async function tD(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee("FirestoreClient","Using user provided OnlineComponentProvider"),await QS(t,t._uninitializedComponentsProvider._online)):(ee("FirestoreClient","Using default OnlineComponentProvider"),await QS(t,new tw))),t._onlineComponents}function k7(t){return tD(t).then(e=>e.syncEngine)}async function nw(t){const e=await tD(t),n=e.eventManager;return n.onListen=m7.bind(null,e.syncEngine),n.onUnlisten=_7.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=g7.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=v7.bind(null,e.syncEngine),n}function x7(t,e,n={}){const r=new bs;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,h){const f=new eD({next:g=>{f.Za(),o.enqueueAndForget(()=>qN(s,p)),g.fromCache&&u.source==="server"?h.reject(new X(j.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(g)},error:g=>h.reject(g)}),p=new WN(l,f,{includeMetadataChanges:!0,_a:!0});return zN(s,p)}(await nw(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nD(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(t,e,n){if(!n)throw new X(j.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iD(t,e,n,r){if(e===!0&&r===!0)throw new X(j.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function XS(t){if(!ne.isDocumentKey(t))throw new X(j.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function JS(t){if(ne.isDocumentKey(t))throw new X(j.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Jm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue()}function ks(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new X(j.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Jm(t);throw new X(j.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function N7(t,e){if(e<=0)throw new X(j.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new X(j.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new X(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nD((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new X(j.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new X(j.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new X(j.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class VT{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ZS({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new X(j.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new X(j.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ZS(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Zx;switch(r.type){case"firstParty":return new ez(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new X(j.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=YS.get(n);r&&(ee("ComponentProvider","Removing Datastore"),YS.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Hr(this.firestore,e,this._query)}}class an{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ci(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new an(this.firestore,e,this._key)}}class Ci extends Hr{constructor(e,n,r){super(e,n,_T(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new an(this.firestore,null,new ne(e))}withConverter(e){return new Ci(this.firestore,e,this._path)}}function Gn(t,e,...n){if(t=An(t),rD("collection","path",e),t instanceof VT){const r=qe.fromString(e,...n);return JS(r),new Ci(t,null,r)}{if(!(t instanceof an||t instanceof Ci))throw new X(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(qe.fromString(e,...n));return JS(r),new Ci(t.firestore,null,r)}}function D7(t,e,...n){if(t=An(t),arguments.length===1&&(e=hT.newId()),rD("doc","path",e),t instanceof VT){const r=qe.fromString(e,...n);return XS(r),new an(t,null,new ne(r))}{if(!(t instanceof an||t instanceof Ci))throw new X(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(qe.fromString(e,...n));return XS(r),new an(t.firestore,t instanceof Ci?t.converter:null,new ne(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new ON(this,"async_queue_retry"),this.Vu=()=>{const r=Wy();r&&ee("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Wy();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Wy();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new bs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!fd(e))throw e;ee("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Bi("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=kT.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ue()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function t1(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class kl extends VT{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new e1,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new e1(e),this._firestoreClient=void 0,await e}}}function Zm(t){if(t._terminated)throw new X(j.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||V7(t),t._firestoreClient}function V7(t){var e,n,r;const i=t._freezeSettings(),s=function(l,u,h,f){return new fz(l,u,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,nD(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new C7(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sa(Ct.fromBase64String(e))}catch(n){throw new X(j.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new sa(Ct.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new X(j.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new St(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new X(j.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new X(j.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O7=/^__.*__$/;class M7{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ya(e,this.data,this.fieldMask,n,this.fieldTransforms):new pd(e,this.data,n,this.fieldTransforms)}}function sD(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue()}}class OT{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new OT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Wp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(sD(this.Cu)&&O7.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class L7{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Qm(e)}Qu(e,n,r,i=!1){return new OT({Cu:e,methodName:n,qu:r,path:St.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function oD(t){const e=t._freezeSettings(),n=Qm(t._databaseId);return new L7(t._databaseId,!!e.ignoreUndefinedProperties,n)}function $7(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);uD("Data must be an object, but it was:",o,r);const l=aD(r,o);let u,h;if(s.merge)u=new vr(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=j7(e,p,n);if(!o.contains(g))throw new X(j.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);B7(f,g)||f.push(g)}u=new vr(f),h=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,h=o.fieldTransforms;return new M7(new Wn(l),u,h)}class MT extends tg{_toFieldTransform(e){return new $z(e.path,new Bh)}isEqual(e){return e instanceof MT}}function F7(t,e,n,r=!1){return LT(n,t.Qu(r?4:3,e))}function LT(t,e){if(lD(t=An(t)))return uD("Unsupported field value:",e,t),aD(t,e);if(t instanceof tg)return function(r,i){if(!sD(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let u=LT(l,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=An(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Oz(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=pt.fromDate(r);return{timestampValue:Bp(i.serializer,s)}}if(r instanceof pt){const s=new pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Bp(i.serializer,s)}}if(r instanceof ng)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof sa)return{bytesValue:PN(i.serializer,r._byteString)};if(r instanceof an){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:TT(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof rg)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return vT(l.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Jm(r)}`)}(t,e)}function aD(t,e){const n={};return eN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gl(t,(r,i)=>{const s=LT(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function lD(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof pt||t instanceof ng||t instanceof sa||t instanceof an||t instanceof tg||t instanceof rg)}function uD(t,e,n){if(!lD(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Jm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function j7(t,e,n){if((e=An(e))instanceof eg)return e._internalPath;if(typeof e=="string")return cD(t,e);throw Wp("Field path arguments must be of type string or ",t,!1,void 0,n)}const U7=new RegExp("[~\\*/\\[\\]]");function cD(t,e,n){if(e.search(U7)>=0)throw Wp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new eg(...e.split("."))._internalPath}catch{throw Wp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Wp(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new X(j.INVALID_ARGUMENT,l+t+u)}function B7(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new an(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new z7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ig("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class z7 extends hD{data(){return super.data()}}function ig(t,e){return typeof e=="string"?cD(t,e):e instanceof eg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dD(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new X(j.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $T{}class sg extends $T{}function Wr(t,e,...n){let r=[];e instanceof $T&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof og).length,l=s.filter(u=>u instanceof _d).length;if(o>1||o>0&&l>0)throw new X(j.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class _d extends sg{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new _d(e,n,r)}_apply(e){const n=this._parse(e);return fD(e._query,n),new Hr(e.firestore,e.converter,Kv(e._query,n))}_parse(e){const n=oD(e.firestore);return function(s,o,l,u,h,f,p){let g;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new X(j.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){r1(p,f);const I=[];for(const A of p)I.push(n1(u,s,A));g={arrayValue:{values:I}}}else g=n1(u,s,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||r1(p,f),g=F7(l,o,p,f==="in"||f==="not-in");return dt.create(h,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function zs(t,e,n){const r=e,i=ig("where",t);return _d._create(i,r,n)}class og extends $T{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new og(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Cr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const u of l)fD(o,u),o=Kv(o,u)}(e._query,n),new Hr(e.firestore,e.converter,Kv(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ag extends sg{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new ag(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new X(j.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new X(j.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Uh(s,o)}(e._query,this._field,this._direction);return new Hr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Ql(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function xl(t,e="asc"){const n=e,r=ig("orderBy",t);return ag._create(r,n)}class lg extends sg{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new lg(e,n,r)}_apply(e){return new Hr(e.firestore,e.converter,jp(e._query,this._limit,this._limitType))}}function ug(t){return N7("limit",t),lg._create("limit",t,"F")}function n1(t,e,n){if(typeof(n=An(n))=="string"){if(n==="")throw new X(j.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uN(e)&&n.indexOf("/")!==-1)throw new X(j.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(qe.fromString(n));if(!ne.isDocumentKey(r))throw new X(j.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return IS(t,new ne(r))}if(n instanceof an)return IS(t,n._key);throw new X(j.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jm(n)}.`)}function r1(t,e){if(!Array.isArray(t)||t.length===0)throw new X(j.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function fD(t,e){const n=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new X(j.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new X(j.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class pD{convertValue(e,n="none"){switch(ia(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ra(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ue()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Gl(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>ot(o.doubleValue));return new rg(s)}convertGeoPoint(e){return new ng(ot(e.latitude),ot(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=pT(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Fh(e));default:return null}}convertTimestamp(e){const n=Us(e);return new pt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=qe.fromString(e);$e(NN(r));const i=new Sl(r.get(1),r.get(3)),s=new ne(r.popFirst(5));return i.isEqual(n)||Bi(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q7(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class FT extends hD{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Zc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ig("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Zc extends FT{data(e={}){return super.data(e)}}class jT{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ga(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Zc(this._firestore,this._userDataWriter,r.key,r,new Ga(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new X(j.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const u=new Zc(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ga(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new Zc(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ga(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,f=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:W7(l.type),doc:u,oldIndex:h,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function W7(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue()}}class UT extends pD{constructor(e){super(),this.firestore=e}convertBytes(e){return new sa(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new an(this.firestore,null,n)}}function mD(t){t=ks(t,Hr);const e=ks(t.firestore,kl),n=Zm(e),r=new UT(e);return dD(t._query),x7(n,t._query).then(i=>new jT(e,r,t,i))}function H7(t,e,n){t=ks(t,an);const r=ks(t.firestore,kl),i=q7(t.converter,e,n);return gD(r,[$7(oD(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Ri.none())])}function Ur(t,...e){var n,r,i;t=An(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||t1(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(t1(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let u,h,f;if(t instanceof an)h=ks(t.firestore,kl),f=_T(t._key.path),u={next:p=>{e[o]&&e[o](K7(h,t,p))},error:e[o+1],complete:e[o+2]};else{const p=ks(t,Hr);h=ks(p.firestore,kl),f=p._query;const g=new UT(h);u={next:I=>{e[o]&&e[o](new jT(h,g,p,I))},error:e[o+1],complete:e[o+2]},dD(t._query)}return function(g,I,A,C){const N=new eD(C),P=new WN(I,N,A);return g.asyncQueue.enqueueAndForget(async()=>zN(await nw(g),P)),()=>{N.Za(),g.asyncQueue.enqueueAndForget(async()=>qN(await nw(g),P))}}(Zm(h),f,l,u)}function gD(t,e){return function(r,i){const s=new bs;return r.asyncQueue.enqueueAndForget(async()=>w7(await k7(r),i,s)),s.promise}(Zm(t),e)}function K7(t,e,n){const r=n.docs.get(e._key),i=new UT(t);return new FT(t,i,e._key,r,new Ga(n.hasPendingWrites,n.fromCache),e.converter)}function G7(){return new MT("serverTimestamp")}(function(e,n=!0){(function(i){Kl=i})(Um),Tl(new El("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new kl(new JB(r.getProvider("auth-internal")),new nz(r.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new X(j.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sl(h.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),zo(_S,"4.7.3",e),zo(_S,"4.7.3","esm2017")})();const i1=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:pD,Bytes:sa,CollectionReference:Ci,DocumentReference:an,DocumentSnapshot:FT,FieldPath:eg,FieldValue:tg,Firestore:kl,FirestoreError:X,GeoPoint:ng,Query:Hr,QueryCompositeFilterConstraint:og,QueryConstraint:sg,QueryDocumentSnapshot:Zc,QueryFieldFilterConstraint:_d,QueryLimitConstraint:lg,QueryOrderByConstraint:ag,QuerySnapshot:jT,SnapshotMetadata:Ga,Timestamp:pt,VectorValue:rg,_AutoId:hT,_ByteString:Ct,_DatabaseId:Sl,_DocumentKey:ne,_EmptyAuthCredentialsProvider:Zx,_FieldPath:St,_cast:ks,_logWarn:Il,_validateIsNotUsedTogether:iD,collection:Gn,doc:D7,ensureFirestoreConfigured:Zm,executeWrite:gD,getDocs:mD,limit:ug,onSnapshot:Ur,orderBy:xl,query:Wr,serverTimestamp:G7,setDoc:H7,where:zs},Symbol.toStringTag,{value:"Module"}));function lt(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function qi(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function s1(t,e){const n=lt(t);if(isNaN(e))return qi(t,NaN);if(!e)return n;const r=n.getDate(),i=qi(t,n.getTime());i.setMonth(n.getMonth()+e+1,0);const s=i.getDate();return r>=s?i:(n.setFullYear(i.getFullYear(),i.getMonth(),r),n)}const yD=6048e5,Q7=864e5,_D=6e4,vD=36e5;let Y7={};function vd(){return Y7}function oa(t,e){var l,u,h,f;const n=vd(),r=(e==null?void 0:e.weekStartsOn)??((u=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??n.weekStartsOn??((f=(h=n.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,i=lt(t),s=i.getDay(),o=(s<r?7:0)+s-r;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function Hp(t){return oa(t,{weekStartsOn:1})}function wD(t){const e=lt(t),n=e.getFullYear(),r=qi(t,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const i=Hp(r),s=qi(t,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const o=Hp(s);return e.getTime()>=i.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function qs(t){const e=lt(t);return e.setHours(0,0,0,0),e}function o1(t){const e=lt(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function ED(t,e){const n=qs(t),r=qs(e),i=+n-o1(n),s=+r-o1(r);return Math.round((i-s)/Q7)}function X7(t){const e=wD(t),n=qi(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),Hp(n)}function Ky(t,e){const n=qs(t),r=qs(e);return+n==+r}function J7(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Z7(t){if(!J7(t)&&typeof t!="number")return!1;const e=lt(t);return!isNaN(Number(e))}function eW(t,e){const n=lt(t),r=lt(e),i=a1(n,r),s=Math.abs(ED(n,r));n.setDate(n.getDate()-i*s);const o=+(a1(n,r)===-i),l=i*(s-o);return l===0?0:l}function a1(t,e){const n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function l1(t){const e=lt(t);return e.setHours(23,59,59,999),e}function TD(t){const e=lt(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function ID(t){const e=lt(t);return e.setDate(1),e.setHours(0,0,0,0),e}function tW(t){const e=lt(t),n=e.getFullYear();return e.setFullYear(n+1,0,0),e.setHours(23,59,59,999),e}function AD(t){const e=lt(t),n=qi(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function SD(t,e){var l,u,h,f;const n=vd(),r=(e==null?void 0:e.weekStartsOn)??((u=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??n.weekStartsOn??((f=(h=n.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,i=lt(t),s=i.getDay(),o=(s<r?-7:0)+6-(s-r);return i.setDate(i.getDate()+o),i.setHours(23,59,59,999),i}const nW={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},rW=(t,e,n)=>{let r;const i=nW[t];return typeof i=="string"?r=i:e===1?r=i.one:r=i.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Gy(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const iW={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},sW={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},oW={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},aW={date:Gy({formats:iW,defaultWidth:"full"}),time:Gy({formats:sW,defaultWidth:"full"}),dateTime:Gy({formats:oW,defaultWidth:"full"})},lW={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},uW=(t,e,n,r)=>lW[t];function oc(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let i;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=n!=null&&n.width?String(n.width):o;i=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=n!=null&&n.width?String(n.width):t.defaultWidth;i=t.values[l]||t.values[o]}const s=t.argumentCallback?t.argumentCallback(e):e;return i[s]}}const cW={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},hW={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},dW={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},fW={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},pW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},mW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},gW=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},yW={ordinalNumber:gW,era:oc({values:cW,defaultWidth:"wide"}),quarter:oc({values:hW,defaultWidth:"wide",argumentCallback:t=>t-1}),month:oc({values:dW,defaultWidth:"wide"}),day:oc({values:fW,defaultWidth:"wide"}),dayPeriod:oc({values:pW,defaultWidth:"wide",formattingValues:mW,defaultFormattingWidth:"wide"})};function ac(t){return(e,n={})=>{const r=n.width,i=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],s=e.match(i);if(!s)return null;const o=s[0],l=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(l)?vW(l,p=>p.test(o)):_W(l,p=>p.test(o));let h;h=t.valueCallback?t.valueCallback(u):u,h=n.valueCallback?n.valueCallback(h):h;const f=e.slice(o.length);return{value:h,rest:f}}}function _W(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function vW(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function wW(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const i=r[0],s=e.match(t.parsePattern);if(!s)return null;let o=t.valueCallback?t.valueCallback(s[0]):s[0];o=n.valueCallback?n.valueCallback(o):o;const l=e.slice(i.length);return{value:o,rest:l}}}const EW=/^(\d+)(th|st|nd|rd)?/i,TW=/\d+/i,IW={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},AW={any:[/^b/i,/^(a|c)/i]},SW={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},PW={any:[/1/i,/2/i,/3/i,/4/i]},RW={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},CW={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},bW={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},kW={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},xW={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},NW={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},DW={ordinalNumber:wW({matchPattern:EW,parsePattern:TW,valueCallback:t=>parseInt(t,10)}),era:ac({matchPatterns:IW,defaultMatchWidth:"wide",parsePatterns:AW,defaultParseWidth:"any"}),quarter:ac({matchPatterns:SW,defaultMatchWidth:"wide",parsePatterns:PW,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ac({matchPatterns:RW,defaultMatchWidth:"wide",parsePatterns:CW,defaultParseWidth:"any"}),day:ac({matchPatterns:bW,defaultMatchWidth:"wide",parsePatterns:kW,defaultParseWidth:"any"}),dayPeriod:ac({matchPatterns:xW,defaultMatchWidth:"any",parsePatterns:NW,defaultParseWidth:"any"})},VW={code:"en-US",formatDistance:rW,formatLong:aW,formatRelative:uW,localize:yW,match:DW,options:{weekStartsOn:0,firstWeekContainsDate:1}};function OW(t){const e=lt(t);return ED(e,AD(e))+1}function MW(t){const e=lt(t),n=+Hp(e)-+X7(e);return Math.round(n/yD)+1}function PD(t,e){var f,p,g,I;const n=lt(t),r=n.getFullYear(),i=vd(),s=(e==null?void 0:e.firstWeekContainsDate)??((p=(f=e==null?void 0:e.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??i.firstWeekContainsDate??((I=(g=i.locale)==null?void 0:g.options)==null?void 0:I.firstWeekContainsDate)??1,o=qi(t,0);o.setFullYear(r+1,0,s),o.setHours(0,0,0,0);const l=oa(o,e),u=qi(t,0);u.setFullYear(r,0,s),u.setHours(0,0,0,0);const h=oa(u,e);return n.getTime()>=l.getTime()?r+1:n.getTime()>=h.getTime()?r:r-1}function LW(t,e){var l,u,h,f;const n=vd(),r=(e==null?void 0:e.firstWeekContainsDate)??((u=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??n.firstWeekContainsDate??((f=(h=n.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,i=PD(t,e),s=qi(t,0);return s.setFullYear(i,0,r),s.setHours(0,0,0,0),oa(s,e)}function $W(t,e){const n=lt(t),r=+oa(n,e)-+LW(n,e);return Math.round(r/yD)+1}function Me(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const es={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return Me(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):Me(n+1,2)},d(t,e){return Me(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return Me(t.getHours()%12||12,e.length)},H(t,e){return Me(t.getHours(),e.length)},m(t,e){return Me(t.getMinutes(),e.length)},s(t,e){return Me(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),i=Math.trunc(r*Math.pow(10,n-3));return Me(i,e.length)}},Ta={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},u1={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return es.y(t,e)},Y:function(t,e,n,r){const i=PD(t,r),s=i>0?i:1-i;if(e==="YY"){const o=s%100;return Me(o,2)}return e==="Yo"?n.ordinalNumber(s,{unit:"year"}):Me(s,e.length)},R:function(t,e){const n=wD(t);return Me(n,e.length)},u:function(t,e){const n=t.getFullYear();return Me(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return Me(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return Me(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return es.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return Me(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const i=$W(t,r);return e==="wo"?n.ordinalNumber(i,{unit:"week"}):Me(i,e.length)},I:function(t,e,n){const r=MW(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):Me(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):es.d(t,e)},D:function(t,e,n){const r=OW(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Me(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const i=t.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Me(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const i=t.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Me(s,e.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),i=r===0?7:r;switch(e){case"i":return String(i);case"ii":return Me(i,e.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let i;switch(r===12?i=Ta.noon:r===0?i=Ta.midnight:i=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let i;switch(r>=17?i=Ta.evening:r>=12?i=Ta.afternoon:r>=4?i=Ta.morning:i=Ta.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return es.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):es.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Me(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):Me(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):es.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):es.s(t,e)},S:function(t,e){return es.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return h1(r);case"XXXX":case"XX":return Po(r);case"XXXXX":case"XXX":default:return Po(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return h1(r);case"xxxx":case"xx":return Po(r);case"xxxxx":case"xxx":default:return Po(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+c1(r,":");case"OOOO":default:return"GMT"+Po(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+c1(r,":");case"zzzz":default:return"GMT"+Po(r,":")}},t:function(t,e,n){const r=Math.trunc(t.getTime()/1e3);return Me(r,e.length)},T:function(t,e,n){const r=t.getTime();return Me(r,e.length)}};function c1(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),i=Math.trunc(r/60),s=r%60;return s===0?n+String(i):n+String(i)+e+Me(s,2)}function h1(t,e){return t%60===0?(t>0?"-":"+")+Me(Math.abs(t)/60,2):Po(t,e)}function Po(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),i=Me(Math.trunc(r/60),2),s=Me(r%60,2);return n+i+e+s}const d1=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},RD=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},FW=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],i=n[2];if(!i)return d1(t,e);let s;switch(r){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",d1(r,e)).replace("{{time}}",RD(i,e))},jW={p:RD,P:FW},UW=/^D+$/,BW=/^Y+$/,zW=["D","DD","YY","YYYY"];function qW(t){return UW.test(t)}function WW(t){return BW.test(t)}function HW(t,e,n){const r=KW(t,e,n);if(console.warn(r),zW.includes(t))throw new RangeError(r)}function KW(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const GW=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,QW=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,YW=/^'([^]*?)'?$/,XW=/''/g,JW=/[a-zA-Z]/;function Dn(t,e,n){var f,p,g,I;const r=vd(),i=r.locale??VW,s=r.firstWeekContainsDate??((p=(f=r.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,o=r.weekStartsOn??((I=(g=r.locale)==null?void 0:g.options)==null?void 0:I.weekStartsOn)??0,l=lt(t);if(!Z7(l))throw new RangeError("Invalid time value");let u=e.match(QW).map(A=>{const C=A[0];if(C==="p"||C==="P"){const N=jW[C];return N(A,i.formatLong)}return A}).join("").match(GW).map(A=>{if(A==="''")return{isToken:!1,value:"'"};const C=A[0];if(C==="'")return{isToken:!1,value:ZW(A)};if(u1[C])return{isToken:!0,value:A};if(C.match(JW))throw new RangeError("Format string contains an unescaped latin alphabet character `"+C+"`");return{isToken:!1,value:A}});i.localize.preprocessor&&(u=i.localize.preprocessor(l,u));const h={firstWeekContainsDate:s,weekStartsOn:o,locale:i};return u.map(A=>{if(!A.isToken)return A.value;const C=A.value;(WW(C)||qW(C))&&HW(C,e,String(t));const N=u1[C[0]];return N(l,C,i.localize,h)}).join("")}function ZW(t){const e=t.match(YW);return e?e[1].replace(XW,"'"):t}function CD(t,e){const n=lt(t),r=lt(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function Kp(t,e){const r=rH(t);let i;if(r.date){const u=iH(r.date,2);i=sH(u.restDateString,u.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const s=i.getTime();let o=0,l;if(r.time&&(o=oH(r.time),isNaN(o)))return new Date(NaN);if(r.timezone){if(l=aH(r.timezone),isNaN(l))return new Date(NaN)}else{const u=new Date(s+o),h=new Date(0);return h.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),h.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),h}return new Date(s+o+l)}const Zd={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},eH=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,tH=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,nH=/^([+-])(\d{2})(?::?(\d{2}))?$/;function rH(t){const e={},n=t.split(Zd.dateTimeDelimiter);let r;if(n.length>2)return e;if(/:/.test(n[0])?r=n[0]:(e.date=n[0],r=n[1],Zd.timeZoneDelimiter.test(e.date)&&(e.date=t.split(Zd.timeZoneDelimiter)[0],r=t.substr(e.date.length,t.length))),r){const i=Zd.timezone.exec(r);i?(e.time=r.replace(i[1],""),e.timezone=i[1]):e.time=r}return e}function iH(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=t.match(n);if(!r)return{year:NaN,restDateString:""};const i=r[1]?parseInt(r[1]):null,s=r[2]?parseInt(r[2]):null;return{year:s===null?i:s*100,restDateString:t.slice((r[1]||r[2]).length)}}function sH(t,e){if(e===null)return new Date(NaN);const n=t.match(eH);if(!n)return new Date(NaN);const r=!!n[4],i=lc(n[1]),s=lc(n[2])-1,o=lc(n[3]),l=lc(n[4]),u=lc(n[5])-1;if(r)return dH(e,l,u)?lH(e,l,u):new Date(NaN);{const h=new Date(0);return!cH(e,s,o)||!hH(e,i)?new Date(NaN):(h.setUTCFullYear(e,s,Math.max(i,o)),h)}}function lc(t){return t?parseInt(t):1}function oH(t){const e=t.match(tH);if(!e)return NaN;const n=Qy(e[1]),r=Qy(e[2]),i=Qy(e[3]);return fH(n,r,i)?n*vD+r*_D+i*1e3:NaN}function Qy(t){return t&&parseFloat(t.replace(",","."))||0}function aH(t){if(t==="Z")return 0;const e=t.match(nH);if(!e)return 0;const n=e[1]==="+"?-1:1,r=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return pH(r,i)?n*(r*vD+i*_D):NaN}function lH(t,e,n){const r=new Date(0);r.setUTCFullYear(t,0,4);const i=r.getUTCDay()||7,s=(e-1)*7+n+1-i;return r.setUTCDate(r.getUTCDate()+s),r}const uH=[31,null,31,30,31,30,31,31,30,31,30,31];function bD(t){return t%400===0||t%4===0&&t%100!==0}function cH(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(uH[e]||(bD(t)?29:28))}function hH(t,e){return e>=1&&e<=(bD(t)?366:365)}function dH(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function fH(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function pH(t,e){return e>=0&&e<=59}function mH(){const[t,e]=D.useState("day"),[n,r]=D.useState(null),[i,s]=D.useState({}),[o,l]=D.useState([]),{db:u}=Jn();D.useEffect(()=>{const x=Gn(u,"settings");return Ur(x,O=>{const M=O.docs.find($=>$.id==="analyticsTargets");M!=null&&M.exists()&&r(M.data())})},[]),D.useEffect(()=>{const x=Gn(u,"services");return Ur(Wr(x),O=>{const M={};O.forEach($=>M[$.id]={id:$.id,...$.data()}),s(M)})},[]);const{fromISO:h,toISO:f}=D.useMemo(()=>yH(t),[t]);D.useEffect(()=>{const x=Gn(u,"appointments"),O=Wr(x,zs("start",">=",h),zs("start","<=",f),xl("start","asc"));return Ur(O,M=>{const $=[];M.forEach(v=>$.push({id:v.id,...v.data()})),l($)})},[h,f]);const{revenue:p,cancelledValue:g,uniqueCustomers:I,avgCustomerValue:A,expectedCogs:C,targetValue:N,progressPct:P,topServices:R}=D.useMemo(()=>{var Ue;const x=o.filter(U=>U.status==="confirmed"),O=o.filter(U=>U.status==="cancelled"),M=U=>U.reduce((G,B)=>{var Z;return G+(B.bookedPrice??((Z=i[B.serviceId])==null?void 0:Z.price)??0)},0),$=M(x),v=M(O),y=new Set(x.map(U=>U.customerId)).size||0,_=y?$/y:0,E=((n==null?void 0:n.defaultCogsRate)??0)/100,S=$*E,b=_H(t,n,h,f),w=b>0?Math.min(100,Math.round($/b*100)):0,Te=x.filter(U=>CD(Kp(U.start),new Date)),Oe={};for(const U of Te){const G=i[U.serviceId],B=(G==null?void 0:G.name)||"Unknown",Z=U.bookedPrice??(G==null?void 0:G.price)??0;Oe[Ue=U.serviceId]||(Oe[Ue]={name:B,count:0,value:0}),Oe[U.serviceId].count+=1,Oe[U.serviceId].value+=Z}const jt=Object.values(Oe).sort((U,G)=>G.value-U.value).slice(0,5);return{revenue:$,cancelledValue:v,uniqueCustomers:y,avgCustomerValue:_,expectedCogs:S,targetValue:b,progressPct:w,topServices:jt}},[o,i,n,t,h,f]);return T.jsxs("div",{className:"grid gap-6",children:[T.jsx("div",{className:"flex flex-wrap gap-2",children:["day","week","month","year","all"].map(x=>T.jsx("button",{onClick:()=>e(x),className:`px-3 py-1.5 rounded-md border text-sm ${x===t?"bg-terracotta text-white border-terracotta":"bg-white hover:bg-cream"}`,children:gH(x)},x))}),T.jsxs("section",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[T.jsx(uc,{title:"Revenue",value:Ia(p),subtitle:vH(h,f)}),T.jsx(uc,{title:"Target vs Actual",value:`${P}%`,subtitle:n?`Target ${Ia(N)}`:"Set targets in Settings",children:T.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:T.jsx("div",{className:"h-full bg-terracotta",style:{width:`${P}%`}})})}),T.jsx(uc,{title:"Avg customer value",value:Ia(A),subtitle:`${I} unique customers`}),T.jsx(uc,{title:"Cancelled value",value:Ia(g),subtitle:"Excluded from revenue"}),T.jsx(uc,{title:"Expected COGS",value:Ia(C),subtitle:`${(n==null?void 0:n.defaultCogsRate)??0}% of revenue`,className:"sm:col-span-2 lg:col-span-1"})]}),T.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-4",children:[T.jsx("h3",{className:"font-serif text-xl mb-2",children:"Top services this month"}),!R.length&&T.jsx("div",{className:"text-slate-500 text-sm",children:"No data yet."}),T.jsx("ul",{className:"divide-y",children:R.map((x,O)=>T.jsxs("li",{className:"flex items-center justify-between py-2",children:[T.jsxs("div",{children:[T.jsx("div",{className:"font-medium",children:x.name}),T.jsxs("div",{className:"text-xs text-slate-500",children:[x.count," bookings"]})]}),T.jsx("div",{className:"font-semibold",children:Ia(x.value)})]},O))})]})]})}function uc({title:t,value:e,subtitle:n,children:r,className:i=""}){return T.jsxs("div",{className:`bg-white rounded-xl shadow-soft p-4 ${i}`,children:[T.jsx("div",{className:"text-sm text-slate-500",children:t}),T.jsx("div",{className:"text-2xl font-semibold",children:e}),n&&T.jsx("div",{className:"text-xs text-slate-500 mt-1",children:n}),r&&T.jsx("div",{className:"mt-3",children:r})]})}function gH(t){return t==="day"?"Day":t==="week"?"Week":t==="month"?"Month":t==="year"?"Year":"All"}function yH(t){const e=new Date;let n,r;switch(t){case"day":n=qs(e),r=l1(e);break;case"week":n=oa(e,{weekStartsOn:0}),r=SD(e,{weekStartsOn:0});break;case"month":n=ID(e),r=TD(e);break;case"year":n=AD(e),r=tW(e);break;case"all":default:n=qs(new Date(e.getTime()-365*24*60*60*1e3)),r=l1(e)}return{fromISO:n.toISOString(),toISO:r.toISOString(),from:n,to:r}}function _H(t,e,n,r){if(!e)return 0;if(t==="day")return e.dailyTarget;if(t==="week")return e.weeklyTarget;if(t==="month")return e.monthlyTarget;if(t==="year")return e.monthlyTarget*12;const i=Math.max(1,eW(new Date(r),new Date(n))+1);return e.dailyTarget*i}function Ia(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t||0)}function vH(t,e){const n=new Date(t),r=new Date(e);return qs(n).getTime()===qs(r).getTime()?Dn(n,"PP"):`${Dn(n,"PP")}  ${Dn(r,"PP")}`}const wH="modulepreload",EH=function(t){return"/"+t},f1={},p1=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(u=>{if(u=EH(u),u in f1)return;f1[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":wH,h||(p.as="script"),p.crossOrigin="",p.href=u,l&&p.setAttribute("nonce",l),document.head.appendChild(p),h)return new Promise((g,I)=>{p.addEventListener("load",g),p.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};var TH=Object.defineProperty,IH=(t,e,n)=>e in t?TH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yy=(t,e,n)=>(IH(t,typeof e!="symbol"?e+"":e,n),n);let AH=class{constructor(){Yy(this,"current",this.detect()),Yy(this,"handoffState","pending"),Yy(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Br=new AH;function wd(t){var e;return Br.isServer?null:t==null?document:(e=t==null?void 0:t.ownerDocument)!=null?e:document}function rw(t){var e,n;return Br.isServer?null:t==null?document:(n=(e=t==null?void 0:t.getRootNode)==null?void 0:e.call(t))!=null?n:document}function kD(t){var e,n;return(n=(e=rw(t))==null?void 0:e.activeElement)!=null?n:null}function SH(t){return kD(t)===t}function cg(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function Qi(){let t=[],e={addEventListener(n,r,i,s){return n.addEventListener(r,i,s),e.add(()=>n.removeEventListener(r,i,s))},requestAnimationFrame(...n){let r=requestAnimationFrame(...n);return e.add(()=>cancelAnimationFrame(r))},nextFrame(...n){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...n))},setTimeout(...n){let r=setTimeout(...n);return e.add(()=>clearTimeout(r))},microTask(...n){let r={current:!0};return cg(()=>{r.current&&n[0]()}),e.add(()=>{r.current=!1})},style(n,r,i){let s=n.style.getPropertyValue(r);return Object.assign(n.style,{[r]:i}),this.add(()=>{Object.assign(n.style,{[r]:s})})},group(n){let r=Qi();return n(r),this.add(()=>r.dispose())},add(n){return t.includes(n)||t.push(n),()=>{let r=t.indexOf(n);if(r>=0)for(let i of t.splice(r,1))i()}},dispose(){for(let n of t.splice(0))n()}};return e}function hg(){let[t]=D.useState(Qi);return D.useEffect(()=>()=>t.dispose(),[t]),t}let Tn=(t,e)=>{Br.isServer?D.useEffect(t,e):D.useLayoutEffect(t,e)};function va(t){let e=D.useRef(t);return Tn(()=>{e.current=t},[t]),e}let je=function(t){let e=va(t);return le.useCallback((...n)=>e.current(...n),[e])};function Ed(t){return D.useMemo(()=>t,Object.values(t))}let PH=D.createContext(void 0);function RH(){return D.useContext(PH)}function iw(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function Wi(t,e,...n){if(t in e){let i=e[t];return typeof i=="function"?i(...n):i}let r=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Wi),r}var Gp=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(Gp||{}),ms=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(ms||{});function Zn(){let t=bH();return D.useCallback(e=>CH({mergeRefs:t,...e}),[t])}function CH({ourProps:t,theirProps:e,slot:n,defaultTag:r,features:i,visible:s=!0,name:o,mergeRefs:l}){l=l??kH;let u=xD(e,t);if(s)return ef(u,n,r,o,l);let h=i??0;if(h&2){let{static:f=!1,...p}=u;if(f)return ef(p,n,r,o,l)}if(h&1){let{unmount:f=!0,...p}=u;return Wi(f?0:1,{0(){return null},1(){return ef({...p,hidden:!0,style:{display:"none"}},n,r,o,l)}})}return ef(u,n,r,o,l)}function ef(t,e={},n,r,i){let{as:s=n,children:o,refName:l="ref",...u}=Xy(t,["unmount","static"]),h=t.ref!==void 0?{[l]:t.ref}:{},f=typeof o=="function"?o(e):o;"className"in u&&u.className&&typeof u.className=="function"&&(u.className=u.className(e)),u["aria-labelledby"]&&u["aria-labelledby"]===u.id&&(u["aria-labelledby"]=void 0);let p={};if(e){let g=!1,I=[];for(let[A,C]of Object.entries(e))typeof C=="boolean"&&(g=!0),C===!0&&I.push(A.replace(/([A-Z])/g,N=>`-${N.toLowerCase()}`));if(g){p["data-headlessui-state"]=I.join(" ");for(let A of I)p[`data-${A}`]=""}}if(eh(s)&&(Object.keys(Ro(u)).length>0||Object.keys(Ro(p)).length>0))if(!D.isValidElement(f)||Array.isArray(f)&&f.length>1||NH(f)){if(Object.keys(Ro(u)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Ro(u)).concat(Object.keys(Ro(p))).map(g=>`  - ${g}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(g=>`  - ${g}`).join(`
`)].join(`
`))}else{let g=f.props,I=g==null?void 0:g.className,A=typeof I=="function"?(...P)=>iw(I(...P),u.className):iw(I,u.className),C=A?{className:A}:{},N=xD(f.props,Ro(Xy(u,["ref"])));for(let P in p)P in N&&delete p[P];return D.cloneElement(f,Object.assign({},N,p,h,{ref:i(xH(f),h.ref)},C))}return D.createElement(s,Object.assign({},Xy(u,["ref"]),!eh(s)&&h,!eh(s)&&p),f)}function bH(){let t=D.useRef([]),e=D.useCallback(n=>{for(let r of t.current)r!=null&&(typeof r=="function"?r(n):r.current=n)},[]);return(...n)=>{if(!n.every(r=>r==null))return t.current=n,e}}function kH(...t){return t.every(e=>e==null)?void 0:e=>{for(let n of t)n!=null&&(typeof n=="function"?n(e):n.current=e)}}function xD(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},n={};for(let r of t)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(n[i]!=null||(n[i]=[]),n[i].push(r[i])):e[i]=r[i];if(e.disabled||e["aria-disabled"])for(let r in n)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(r)&&(n[r]=[i=>{var s;return(s=i==null?void 0:i.preventDefault)==null?void 0:s.call(i)}]);for(let r in n)Object.assign(e,{[r](i,...s){let o=n[r];for(let l of o){if((i instanceof Event||(i==null?void 0:i.nativeEvent)instanceof Event)&&i.defaultPrevented)return;l(i,...s)}}});return e}function Sn(t){var e;return Object.assign(D.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function Ro(t){let e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function Xy(t,e=[]){let n=Object.assign({},t);for(let r of e)r in n&&delete n[r];return n}function xH(t){return le.version.split(".")[0]>="19"?t.props.ref:t.ref}function eh(t){return t===D.Fragment||t===Symbol.for("react.fragment")}function NH(t){return eh(t.type)}let DH="span";var Qp=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(Qp||{});function VH(t,e){var n;let{features:r=1,...i}=t,s={ref:e,"aria-hidden":(r&2)===2?!0:(n=i["aria-hidden"])!=null?n:void 0,hidden:(r&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(r&4)===4&&(r&2)!==2&&{display:"none"}}};return Zn()({ourProps:s,theirProps:i,slot:{},defaultTag:DH,name:"Hidden"})}let sw=Sn(VH);function OH(t){return typeof t!="object"||t===null?!1:"nodeType"in t}function xs(t){return OH(t)&&"tagName"in t}function aa(t){return xs(t)&&"accessKey"in t}function gs(t){return xs(t)&&"tabIndex"in t}function MH(t){return xs(t)&&"style"in t}function LH(t){return aa(t)&&t.nodeName==="IFRAME"}function $H(t){return aa(t)&&t.nodeName==="INPUT"}let ND=Symbol();function FH(t,e=!0){return Object.assign(t,{[ND]:e})}function Kr(...t){let e=D.useRef(t);D.useEffect(()=>{e.current=t},[t]);let n=je(r=>{for(let i of e.current)i!=null&&(typeof i=="function"?i(r):i.current=r)});return t.every(r=>r==null||(r==null?void 0:r[ND]))?void 0:n}let BT=D.createContext(null);BT.displayName="DescriptionContext";function DD(){let t=D.useContext(BT);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,DD),e}return t}function jH(){let[t,e]=D.useState([]);return[t.length>0?t.join(" "):void 0,D.useMemo(()=>function(n){let r=je(s=>(e(o=>[...o,s]),()=>e(o=>{let l=o.slice(),u=l.indexOf(s);return u!==-1&&l.splice(u,1),l}))),i=D.useMemo(()=>({register:r,slot:n.slot,name:n.name,props:n.props,value:n.value}),[r,n.slot,n.name,n.props,n.value]);return le.createElement(BT.Provider,{value:i},n.children)},[e])]}let UH="p";function BH(t,e){let n=D.useId(),r=RH(),{id:i=`headlessui-description-${n}`,...s}=t,o=DD(),l=Kr(e);Tn(()=>o.register(i),[i,o.register]);let u=Ed({...o.slot,disabled:r||!1}),h={ref:l,...o.props,id:i};return Zn()({ourProps:h,theirProps:s,slot:u,defaultTag:UH,name:o.name||"Description"})}let zH=Sn(BH),qH=Object.assign(zH,{});var VD=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(VD||{});let WH=D.createContext(()=>{});function HH({value:t,children:e}){return le.createElement(WH.Provider,{value:t},e)}let OD=class extends Map{constructor(e){super(),this.factory=e}get(e){let n=super.get(e);return n===void 0&&(n=this.factory(e),this.set(e,n)),n}};var KH=Object.defineProperty,GH=(t,e,n)=>e in t?KH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,QH=(t,e,n)=>(GH(t,e+"",n),n),MD=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},Un=(t,e,n)=>(MD(t,e,"read from private field"),n?n.call(t):e.get(t)),Jy=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},m1=(t,e,n,r)=>(MD(t,e,"write to private field"),e.set(t,n),n),kr,Rc,Cc;let YH=class{constructor(e){Jy(this,kr,{}),Jy(this,Rc,new OD(()=>new Set)),Jy(this,Cc,new Set),QH(this,"disposables",Qi()),m1(this,kr,e),Br.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return Un(this,kr)}subscribe(e,n){if(Br.isServer)return()=>{};let r={selector:e,callback:n,current:e(Un(this,kr))};return Un(this,Cc).add(r),this.disposables.add(()=>{Un(this,Cc).delete(r)})}on(e,n){return Br.isServer?()=>{}:(Un(this,Rc).get(e).add(n),this.disposables.add(()=>{Un(this,Rc).get(e).delete(n)}))}send(e){let n=this.reduce(Un(this,kr),e);if(n!==Un(this,kr)){m1(this,kr,n);for(let r of Un(this,Cc)){let i=r.selector(Un(this,kr));LD(r.current,i)||(r.current=i,r.callback(i))}for(let r of Un(this,Rc).get(e.type))r(Un(this,kr),e)}}};kr=new WeakMap,Rc=new WeakMap,Cc=new WeakMap;function LD(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:Array.isArray(t)&&Array.isArray(e)?t.length!==e.length?!1:Zy(t[Symbol.iterator](),e[Symbol.iterator]()):t instanceof Map&&e instanceof Map||t instanceof Set&&e instanceof Set?t.size!==e.size?!1:Zy(t.entries(),e.entries()):g1(t)&&g1(e)?Zy(Object.entries(t)[Symbol.iterator](),Object.entries(e)[Symbol.iterator]()):!1}function Zy(t,e){do{let n=t.next(),r=e.next();if(n.done&&r.done)return!0;if(n.done||r.done||!Object.is(n.value,r.value))return!1}while(!0)}function g1(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}var XH=Object.defineProperty,JH=(t,e,n)=>e in t?XH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,y1=(t,e,n)=>(JH(t,typeof e!="symbol"?e+"":e,n),n),ZH=(t=>(t[t.Push=0]="Push",t[t.Pop=1]="Pop",t))(ZH||{});let e8={0(t,e){let n=e.id,r=t.stack,i=t.stack.indexOf(n);if(i!==-1){let s=t.stack.slice();return s.splice(i,1),s.push(n),r=s,{...t,stack:r}}return{...t,stack:[...t.stack,n]}},1(t,e){let n=e.id,r=t.stack.indexOf(n);if(r===-1)return t;let i=t.stack.slice();return i.splice(r,1),{...t,stack:i}}},t8=class $D extends YH{constructor(){super(...arguments),y1(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),y1(this,"selectors",{isTop:(e,n)=>e.stack[e.stack.length-1]===n,inStack:(e,n)=>e.stack.includes(n)})}static new(){return new $D({stack:[]})}reduce(e,n){return Wi(n.type,e8,e,n)}};const FD=new OD(()=>t8.new());var jD={exports:{}},UD={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Td=D;function n8(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var r8=typeof Object.is=="function"?Object.is:n8,i8=Td.useSyncExternalStore,s8=Td.useRef,o8=Td.useEffect,a8=Td.useMemo,l8=Td.useDebugValue;UD.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=s8(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=a8(function(){function u(I){if(!h){if(h=!0,f=I,I=r(I),i!==void 0&&o.hasValue){var A=o.value;if(i(A,I))return p=A}return p=I}if(A=p,r8(f,I))return A;var C=r(I);return i!==void 0&&i(A,C)?(f=I,A):(f=I,p=C)}var h=!1,f,p,g=n===void 0?null:n;return[function(){return u(e())},g===null?void 0:function(){return u(g())}]},[e,n,r,i]);var l=i8(t,s[0],s[1]);return o8(function(){o.hasValue=!0,o.value=l},[l]),l8(l),l};jD.exports=UD;var u8=jD.exports;function BD(t,e,n=LD){return u8.useSyncExternalStoreWithSelector(je(r=>t.subscribe(c8,r)),je(()=>t.state),je(()=>t.state),je(e),n)}function c8(t){return t}function Id(t,e){let n=D.useId(),r=FD.get(e),[i,s]=BD(r,D.useCallback(o=>[r.selectors.isTop(o,n),r.selectors.inStack(o,n)],[r,n]));return Tn(()=>{if(t)return r.actions.push(n),()=>r.actions.pop(n)},[r,t,n]),t?s?i:!0:!1}let ow=new Map,th=new Map;function _1(t){var e;let n=(e=th.get(t))!=null?e:0;return th.set(t,n+1),n!==0?()=>v1(t):(ow.set(t,{"aria-hidden":t.getAttribute("aria-hidden"),inert:t.inert}),t.setAttribute("aria-hidden","true"),t.inert=!0,()=>v1(t))}function v1(t){var e;let n=(e=th.get(t))!=null?e:1;if(n===1?th.delete(t):th.set(t,n-1),n!==1)return;let r=ow.get(t);r&&(r["aria-hidden"]===null?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",r["aria-hidden"]),t.inert=r.inert,ow.delete(t))}function h8(t,{allowed:e,disallowed:n}={}){let r=Id(t,"inert-others");Tn(()=>{var i,s;if(!r)return;let o=Qi();for(let u of(i=n==null?void 0:n())!=null?i:[])u&&o.add(_1(u));let l=(s=e==null?void 0:e())!=null?s:[];for(let u of l){if(!u)continue;let h=wd(u);if(!h)continue;let f=u.parentElement;for(;f&&f!==h.body;){for(let p of f.children)l.some(g=>p.contains(g))||o.add(_1(p));f=f.parentElement}}return o.dispose},[r,e,n])}function d8(t,e,n){let r=va(i=>{let s=i.getBoundingClientRect();s.x===0&&s.y===0&&s.width===0&&s.height===0&&n()});D.useEffect(()=>{if(!t)return;let i=e===null?null:aa(e)?e:e.current;if(!i)return;let s=Qi();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>r.current(i));o.observe(i),s.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>r.current(i));o.observe(i),s.add(()=>o.disconnect())}return()=>s.dispose()},[e,r,t])}let Yp=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(","),f8=["[data-autofocus]"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var mi=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t[t.AutoFocus=64]="AutoFocus",t))(mi||{}),aw=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(aw||{}),p8=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(p8||{});function m8(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(Yp)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}function g8(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(f8)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var zD=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(zD||{});function y8(t,e=0){var n;return t===((n=wd(t))==null?void 0:n.body)?!1:Wi(e,{0(){return t.matches(Yp)},1(){let r=t;for(;r!==null;){if(r.matches(Yp))return!0;r=r.parentElement}return!1}})}var _8=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(_8||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function bi(t){t==null||t.focus({preventScroll:!0})}let v8=["textarea","input"].join(",");function w8(t){var e,n;return(n=(e=t==null?void 0:t.matches)==null?void 0:e.call(t,v8))!=null?n:!1}function E8(t,e=n=>n){return t.slice().sort((n,r)=>{let i=e(n),s=e(r);if(i===null||s===null)return 0;let o=i.compareDocumentPosition(s);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function nh(t,e,{sorted:n=!0,relativeTo:r=null,skipElements:i=[]}={}){let s=Array.isArray(t)?t.length>0?rw(t[0]):document:rw(t),o=Array.isArray(t)?n?E8(t):t:e&64?g8(t):m8(t);i.length>0&&o.length>1&&(o=o.filter(I=>!i.some(A=>A!=null&&"current"in A?(A==null?void 0:A.current)===I:A===I))),r=r??(s==null?void 0:s.activeElement);let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(r))-1;if(e&4)return Math.max(0,o.indexOf(r))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),h=e&32?{preventScroll:!0}:{},f=0,p=o.length,g;do{if(f>=p||f+p<=0)return 0;let I=u+f;if(e&16)I=(I+p)%p;else{if(I<0)return 3;if(I>=p)return 1}g=o[I],g==null||g.focus(h),f+=l}while(g!==kD(g));return e&6&&w8(g)&&g.select(),2}function qD(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function T8(){return/Android/gi.test(window.navigator.userAgent)}function w1(){return qD()||T8()}function tf(t,e,n,r){let i=va(n);D.useEffect(()=>{if(!t)return;function s(o){i.current(o)}return document.addEventListener(e,s,r),()=>document.removeEventListener(e,s,r)},[t,e,r])}function WD(t,e,n,r){let i=va(n);D.useEffect(()=>{if(!t)return;function s(o){i.current(o)}return window.addEventListener(e,s,r),()=>window.removeEventListener(e,s,r)},[t,e,r])}const E1=30;function I8(t,e,n){let r=va(n),i=D.useCallback(function(l,u){if(l.defaultPrevented)return;let h=u(l);if(h===null||!h.getRootNode().contains(h)||!h.isConnected)return;let f=function p(g){return typeof g=="function"?p(g()):Array.isArray(g)||g instanceof Set?g:[g]}(e);for(let p of f)if(p!==null&&(p.contains(h)||l.composed&&l.composedPath().includes(p)))return;return!y8(h,zD.Loose)&&h.tabIndex!==-1&&l.preventDefault(),r.current(l,h)},[r,e]),s=D.useRef(null);tf(t,"pointerdown",l=>{var u,h;w1()||(s.current=((h=(u=l.composedPath)==null?void 0:u.call(l))==null?void 0:h[0])||l.target)},!0),tf(t,"pointerup",l=>{if(w1()||!s.current)return;let u=s.current;return s.current=null,i(l,()=>u)},!0);let o=D.useRef({x:0,y:0});tf(t,"touchstart",l=>{o.current.x=l.touches[0].clientX,o.current.y=l.touches[0].clientY},!0),tf(t,"touchend",l=>{let u={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(u.x-o.current.x)>=E1||Math.abs(u.y-o.current.y)>=E1))return i(l,()=>gs(l.target)?l.target:null)},!0),WD(t,"blur",l=>i(l,()=>LH(window.document.activeElement)?window.document.activeElement:null),!0)}function zT(...t){return D.useMemo(()=>wd(...t),[...t])}function HD(t,e,n,r){let i=va(n);D.useEffect(()=>{t=t??window;function s(o){i.current(o)}return t.addEventListener(e,s,r),()=>t.removeEventListener(e,s,r)},[t,e,r])}function A8(t){return D.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}function S8(t,e){let n=t(),r=new Set;return{getSnapshot(){return n},subscribe(i){return r.add(i),()=>r.delete(i)},dispatch(i,...s){let o=e[i].call(n,...s);o&&(n=o,r.forEach(l=>l()))}}}function P8(){let t;return{before({doc:e}){var n;let r=e.documentElement,i=(n=e.defaultView)!=null?n:window;t=Math.max(0,i.innerWidth-r.clientWidth)},after({doc:e,d:n}){let r=e.documentElement,i=Math.max(0,r.clientWidth-r.offsetWidth),s=Math.max(0,t-i);n.style(r,"paddingRight",`${s}px`)}}}function R8(){return qD()?{before({doc:t,d:e,meta:n}){function r(i){for(let s of n().containers)for(let o of s())if(o.contains(i))return!0;return!1}e.microTask(()=>{var i;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let l=Qi();l.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>l.dispose()))}let s=(i=window.scrollY)!=null?i:window.pageYOffset,o=null;e.addEventListener(t,"click",l=>{if(gs(l.target))try{let u=l.target.closest("a");if(!u)return;let{hash:h}=new URL(u.href),f=t.querySelector(h);gs(f)&&!r(f)&&(o=f)}catch{}},!0),e.group(l=>{e.addEventListener(t,"touchstart",u=>{if(l.dispose(),gs(u.target)&&MH(u.target))if(r(u.target)){let h=u.target;for(;h.parentElement&&r(h.parentElement);)h=h.parentElement;l.style(h,"overscrollBehavior","contain")}else l.style(u.target,"touchAction","none")})}),e.addEventListener(t,"touchmove",l=>{if(gs(l.target)){if($H(l.target))return;if(r(l.target)){let u=l.target;for(;u.parentElement&&u.dataset.headlessuiPortal!==""&&!(u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth);)u=u.parentElement;u.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),e.add(()=>{var l;let u=(l=window.scrollY)!=null?l:window.pageYOffset;s!==u&&window.scrollTo(0,s),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function C8(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function T1(t){let e={};for(let n of t)Object.assign(e,n(e));return e}let $o=S8(()=>new Map,{PUSH(t,e){var n;let r=(n=this.get(t))!=null?n:{doc:t,count:0,d:Qi(),meta:new Set,computedMeta:{}};return r.count++,r.meta.add(e),r.computedMeta=T1(r.meta),this.set(t,r),this},POP(t,e){let n=this.get(t);return n&&(n.count--,n.meta.delete(e),n.computedMeta=T1(n.meta)),this},SCROLL_PREVENT(t){let e={doc:t.doc,d:t.d,meta(){return t.computedMeta}},n=[R8(),P8(),C8()];n.forEach(({before:r})=>r==null?void 0:r(e)),n.forEach(({after:r})=>r==null?void 0:r(e))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});$o.subscribe(()=>{let t=$o.getSnapshot(),e=new Map;for(let[n]of t)e.set(n,n.documentElement.style.overflow);for(let n of t.values()){let r=e.get(n.doc)==="hidden",i=n.count!==0;(i&&!r||!i&&r)&&$o.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&$o.dispatch("TEARDOWN",n)}});function b8(t,e,n=()=>({containers:[]})){let r=A8($o),i=e?r.get(e):void 0,s=i?i.count>0:!1;return Tn(()=>{if(!(!e||!t))return $o.dispatch("PUSH",e,n),()=>$o.dispatch("POP",e,n)},[t,e]),s}function k8(t,e,n=()=>[document.body]){let r=Id(t,"scroll-lock");b8(r,e,i=>{var s;return{containers:[...(s=i.containers)!=null?s:[],n]}})}function x8(t=0){let[e,n]=D.useState(t),r=D.useCallback(u=>n(u),[]),i=D.useCallback(u=>n(h=>h|u),[]),s=D.useCallback(u=>(e&u)===u,[e]),o=D.useCallback(u=>n(h=>h&~u),[]),l=D.useCallback(u=>n(h=>h^u),[]);return{flags:e,setFlag:r,addFlag:i,hasFlag:s,removeFlag:o,toggleFlag:l}}var N8={},I1,A1;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((I1=process==null?void 0:N8)==null?void 0:I1.NODE_ENV)==="test"&&typeof((A1=Element==null?void 0:Element.prototype)==null?void 0:A1.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var D8=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(D8||{});function V8(t){let e={};for(let n in t)t[n]===!0&&(e[`data-${n}`]="");return e}function O8(t,e,n,r){let[i,s]=D.useState(n),{hasFlag:o,addFlag:l,removeFlag:u}=x8(t&&i?3:0),h=D.useRef(!1),f=D.useRef(!1),p=hg();return Tn(()=>{var g;if(t){if(n&&s(!0),!e){n&&l(3);return}return(g=r==null?void 0:r.start)==null||g.call(r,n),M8(e,{inFlight:h,prepare(){f.current?f.current=!1:f.current=h.current,h.current=!0,!f.current&&(n?(l(3),u(4)):(l(4),u(2)))},run(){f.current?n?(u(3),l(4)):(u(4),l(3)):n?u(1):l(1)},done(){var I;f.current&&F8(e)||(h.current=!1,u(7),n||s(!1),(I=r==null?void 0:r.end)==null||I.call(r,n))}})}},[t,n,e,p]),t?[i,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function M8(t,{prepare:e,run:n,done:r,inFlight:i}){let s=Qi();return $8(t,{prepare:e,inFlight:i}),s.nextFrame(()=>{n(),s.requestAnimationFrame(()=>{s.add(L8(t,r))})}),s.dispose}function L8(t,e){var n,r;let i=Qi();if(!t)return i.dispose;let s=!1;i.add(()=>{s=!0});let o=(r=(n=t.getAnimations)==null?void 0:n.call(t).filter(l=>l instanceof CSSTransition))!=null?r:[];return o.length===0?(e(),i.dispose):(Promise.allSettled(o.map(l=>l.finished)).then(()=>{s||e()}),i.dispose)}function $8(t,{inFlight:e,prepare:n}){if(e!=null&&e.current){n();return}let r=t.style.transition;t.style.transition="none",n(),t.offsetHeight,t.style.transition=r}function F8(t){var e,n;return((n=(e=t.getAnimations)==null?void 0:e.call(t))!=null?n:[]).some(r=>r instanceof CSSTransition&&r.playState!=="finished")}function qT(t,e){let n=D.useRef([]),r=je(t);D.useEffect(()=>{let i=[...n.current];for(let[s,o]of e.entries())if(n.current[s]!==o){let l=r(e,i);return n.current=e,l}},[r,...e])}let dg=D.createContext(null);dg.displayName="OpenClosedContext";var wr=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(wr||{});function fg(){return D.useContext(dg)}function j8({value:t,children:e}){return le.createElement(dg.Provider,{value:t},e)}function U8({children:t}){return le.createElement(dg.Provider,{value:null},t)}function B8(t){function e(){document.readyState!=="loading"&&(t(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let cs=[];B8(()=>{function t(e){if(!gs(e.target)||e.target===document.body||cs[0]===e.target)return;let n=e.target;n=n.closest(Yp),cs.unshift(n??e.target),cs=cs.filter(r=>r!=null&&r.isConnected),cs.splice(10)}window.addEventListener("click",t,{capture:!0}),window.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("focus",t,{capture:!0}),document.body.addEventListener("click",t,{capture:!0}),document.body.addEventListener("mousedown",t,{capture:!0}),document.body.addEventListener("focus",t,{capture:!0})});function KD(t){let e=je(t),n=D.useRef(!1);D.useEffect(()=>(n.current=!1,()=>{n.current=!0,cg(()=>{n.current&&e()})}),[e])}let GD=D.createContext(!1);function z8(){return D.useContext(GD)}function S1(t){return le.createElement(GD.Provider,{value:t.force},t.children)}function q8(t){let e=z8(),n=D.useContext(YD),[r,i]=D.useState(()=>{var s;if(!e&&n!==null)return(s=n.current)!=null?s:null;if(Br.isServer)return null;let o=t==null?void 0:t.getElementById("headlessui-portal-root");if(o)return o;if(t===null)return null;let l=t.createElement("div");return l.setAttribute("id","headlessui-portal-root"),t.body.appendChild(l)});return D.useEffect(()=>{r!==null&&(t!=null&&t.body.contains(r)||t==null||t.body.appendChild(r))},[r,t]),D.useEffect(()=>{e||n!==null&&i(n.current)},[n,i,e]),r}let QD=D.Fragment,W8=Sn(function(t,e){let{ownerDocument:n=null,...r}=t,i=D.useRef(null),s=Kr(FH(g=>{i.current=g}),e),o=zT(i.current),l=n??o,u=q8(l),h=D.useContext(lw),f=hg(),p=Zn();return KD(()=>{var g;u&&u.childNodes.length<=0&&((g=u.parentElement)==null||g.removeChild(u))}),u?BR.createPortal(le.createElement("div",{"data-headlessui-portal":"",ref:g=>{f.dispose(),h&&g&&f.add(h.register(g))}},p({ourProps:{ref:s},theirProps:r,slot:{},defaultTag:QD,name:"Portal"})),u):null});function H8(t,e){let n=Kr(e),{enabled:r=!0,ownerDocument:i,...s}=t,o=Zn();return r?le.createElement(W8,{...s,ownerDocument:i,ref:n}):o({ourProps:{ref:n},theirProps:s,slot:{},defaultTag:QD,name:"Portal"})}let K8=D.Fragment,YD=D.createContext(null);function G8(t,e){let{target:n,...r}=t,i={ref:Kr(e)},s=Zn();return le.createElement(YD.Provider,{value:n},s({ourProps:i,theirProps:r,defaultTag:K8,name:"Popover.Group"}))}let lw=D.createContext(null);function Q8(){let t=D.useContext(lw),e=D.useRef([]),n=je(s=>(e.current.push(s),t&&t.register(s),()=>r(s))),r=je(s=>{let o=e.current.indexOf(s);o!==-1&&e.current.splice(o,1),t&&t.unregister(s)}),i=D.useMemo(()=>({register:n,unregister:r,portals:e}),[n,r,e]);return[e,D.useMemo(()=>function({children:s}){return le.createElement(lw.Provider,{value:i},s)},[i])]}let Y8=Sn(H8),XD=Sn(G8),X8=Object.assign(Y8,{Group:XD});function J8(t,e=typeof document<"u"?document.defaultView:null,n){let r=Id(t,"escape");HD(e,"keydown",i=>{r&&(i.defaultPrevented||i.key===VD.Escape&&n(i))})}function Z8(){var t;let[e]=D.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[n,r]=D.useState((t=e==null?void 0:e.matches)!=null?t:!1);return Tn(()=>{if(!e)return;function i(s){r(s.matches)}return e.addEventListener("change",i),()=>e.removeEventListener("change",i)},[e]),n}function eK({defaultContainers:t=[],portals:e,mainTreeNode:n}={}){let r=je(()=>{var i,s;let o=wd(n),l=[];for(let u of t)u!==null&&(xs(u)?l.push(u):"current"in u&&xs(u.current)&&l.push(u.current));if(e!=null&&e.current)for(let u of e.current)l.push(u);for(let u of(i=o==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?i:[])u!==document.body&&u!==document.head&&xs(u)&&u.id!=="headlessui-portal-root"&&(n&&(u.contains(n)||u.contains((s=n==null?void 0:n.getRootNode())==null?void 0:s.host))||l.some(h=>u.contains(h))||l.push(u));return l});return{resolveContainers:r,contains:je(i=>r().some(s=>s.contains(i)))}}let JD=D.createContext(null);function P1({children:t,node:e}){let[n,r]=D.useState(null),i=ZD(e??n);return le.createElement(JD.Provider,{value:i},t,i===null&&le.createElement(sw,{features:Qp.Hidden,ref:s=>{var o,l;if(s){for(let u of(l=(o=wd(s))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?l:[])if(u!==document.body&&u!==document.head&&xs(u)&&u!=null&&u.contains(s)){r(u);break}}}}))}function ZD(t=null){var e;return(e=D.useContext(JD))!=null?e:t}function tK(){let t=typeof document>"u";return"useSyncExternalStore"in n_?(e=>e.useSyncExternalStore)(n_)(()=>()=>{},()=>!1,()=>!t):!1}function pg(){let t=tK(),[e,n]=D.useState(Br.isHandoffComplete);return e&&Br.isHandoffComplete===!1&&n(!1),D.useEffect(()=>{e!==!0&&n(!0)},[e]),D.useEffect(()=>Br.handoff(),[]),t?!1:e}function WT(){let t=D.useRef(!1);return Tn(()=>(t.current=!0,()=>{t.current=!1}),[]),t}var bc=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(bc||{});function nK(){let t=D.useRef(0);return WD(!0,"keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function eV(t){if(!t)return new Set;if(typeof t=="function")return new Set(t());let e=new Set;for(let n of t.current)xs(n.current)&&e.add(n.current);return e}let rK="div";var Co=(t=>(t[t.None=0]="None",t[t.InitialFocus=1]="InitialFocus",t[t.TabLock=2]="TabLock",t[t.FocusLock=4]="FocusLock",t[t.RestoreFocus=8]="RestoreFocus",t[t.AutoFocus=16]="AutoFocus",t))(Co||{});function iK(t,e){let n=D.useRef(null),r=Kr(n,e),{initialFocus:i,initialFocusFallback:s,containers:o,features:l=15,...u}=t;pg()||(l=0);let h=zT(n.current);lK(l,{ownerDocument:h});let f=uK(l,{ownerDocument:h,container:n,initialFocus:i,initialFocusFallback:s});cK(l,{ownerDocument:h,container:n,containers:o,previousActiveElement:f});let p=nK(),g=je(R=>{if(!aa(n.current))return;let x=n.current;(O=>O())(()=>{Wi(p.current,{[bc.Forwards]:()=>{nh(x,mi.First,{skipElements:[R.relatedTarget,s]})},[bc.Backwards]:()=>{nh(x,mi.Last,{skipElements:[R.relatedTarget,s]})}})})}),I=Id(!!(l&2),"focus-trap#tab-lock"),A=hg(),C=D.useRef(!1),N={ref:r,onKeyDown(R){R.key=="Tab"&&(C.current=!0,A.requestAnimationFrame(()=>{C.current=!1}))},onBlur(R){if(!(l&4))return;let x=eV(o);aa(n.current)&&x.add(n.current);let O=R.relatedTarget;gs(O)&&O.dataset.headlessuiFocusGuard!=="true"&&(tV(x,O)||(C.current?nh(n.current,Wi(p.current,{[bc.Forwards]:()=>mi.Next,[bc.Backwards]:()=>mi.Previous})|mi.WrapAround,{relativeTo:R.target}):gs(R.target)&&bi(R.target)))}},P=Zn();return le.createElement(le.Fragment,null,I&&le.createElement(sw,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:g,features:Qp.Focusable}),P({ourProps:N,theirProps:u,defaultTag:rK,name:"FocusTrap"}),I&&le.createElement(sw,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:g,features:Qp.Focusable}))}let sK=Sn(iK),oK=Object.assign(sK,{features:Co});function aK(t=!0){let e=D.useRef(cs.slice());return qT(([n],[r])=>{r===!0&&n===!1&&cg(()=>{e.current.splice(0)}),r===!1&&n===!0&&(e.current=cs.slice())},[t,cs,e]),je(()=>{var n;return(n=e.current.find(r=>r!=null&&r.isConnected))!=null?n:null})}function lK(t,{ownerDocument:e}){let n=!!(t&8),r=aK(n);qT(()=>{n||SH(e==null?void 0:e.body)&&bi(r())},[n]),KD(()=>{n&&bi(r())})}function uK(t,{ownerDocument:e,container:n,initialFocus:r,initialFocusFallback:i}){let s=D.useRef(null),o=Id(!!(t&1),"focus-trap#initial-focus"),l=WT();return qT(()=>{if(t===0)return;if(!o){i!=null&&i.current&&bi(i.current);return}let u=n.current;u&&cg(()=>{if(!l.current)return;let h=e==null?void 0:e.activeElement;if(r!=null&&r.current){if((r==null?void 0:r.current)===h){s.current=h;return}}else if(u.contains(h)){s.current=h;return}if(r!=null&&r.current)bi(r.current);else{if(t&16){if(nh(u,mi.First|mi.AutoFocus)!==aw.Error)return}else if(nh(u,mi.First)!==aw.Error)return;if(i!=null&&i.current&&(bi(i.current),(e==null?void 0:e.activeElement)===i.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}s.current=e==null?void 0:e.activeElement})},[i,o,t]),s}function cK(t,{ownerDocument:e,container:n,containers:r,previousActiveElement:i}){let s=WT(),o=!!(t&4);HD(e==null?void 0:e.defaultView,"focus",l=>{if(!o||!s.current)return;let u=eV(r);aa(n.current)&&u.add(n.current);let h=i.current;if(!h)return;let f=l.target;aa(f)?tV(u,f)?(i.current=f,bi(f)):(l.preventDefault(),l.stopPropagation(),bi(h)):bi(i.current)},!0)}function tV(t,e){for(let n of t)if(n.contains(e))return!0;return!1}function nV(t){var e;return!!(t.enter||t.enterFrom||t.enterTo||t.leave||t.leaveFrom||t.leaveTo)||!eh((e=t.as)!=null?e:iV)||le.Children.count(t.children)===1}let mg=D.createContext(null);mg.displayName="TransitionContext";var hK=(t=>(t.Visible="visible",t.Hidden="hidden",t))(hK||{});function dK(){let t=D.useContext(mg);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function fK(){let t=D.useContext(gg);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let gg=D.createContext(null);gg.displayName="NestingContext";function yg(t){return"children"in t?yg(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function rV(t,e){let n=va(t),r=D.useRef([]),i=WT(),s=hg(),o=je((I,A=ms.Hidden)=>{let C=r.current.findIndex(({el:N})=>N===I);C!==-1&&(Wi(A,{[ms.Unmount](){r.current.splice(C,1)},[ms.Hidden](){r.current[C].state="hidden"}}),s.microTask(()=>{var N;!yg(r)&&i.current&&((N=n.current)==null||N.call(n))}))}),l=je(I=>{let A=r.current.find(({el:C})=>C===I);return A?A.state!=="visible"&&(A.state="visible"):r.current.push({el:I,state:"visible"}),()=>o(I,ms.Unmount)}),u=D.useRef([]),h=D.useRef(Promise.resolve()),f=D.useRef({enter:[],leave:[]}),p=je((I,A,C)=>{u.current.splice(0),e&&(e.chains.current[A]=e.chains.current[A].filter(([N])=>N!==I)),e==null||e.chains.current[A].push([I,new Promise(N=>{u.current.push(N)})]),e==null||e.chains.current[A].push([I,new Promise(N=>{Promise.all(f.current[A].map(([P,R])=>R)).then(()=>N())})]),A==="enter"?h.current=h.current.then(()=>e==null?void 0:e.wait.current).then(()=>C(A)):C(A)}),g=je((I,A,C)=>{Promise.all(f.current[A].splice(0).map(([N,P])=>P)).then(()=>{var N;(N=u.current.shift())==null||N()}).then(()=>C(A))});return D.useMemo(()=>({children:r,register:l,unregister:o,onStart:p,onStop:g,wait:h,chains:f}),[l,o,r,p,g,f,h])}let iV=D.Fragment,sV=Gp.RenderStrategy;function pK(t,e){var n,r;let{transition:i=!0,beforeEnter:s,afterEnter:o,beforeLeave:l,afterLeave:u,enter:h,enterFrom:f,enterTo:p,entered:g,leave:I,leaveFrom:A,leaveTo:C,...N}=t,[P,R]=D.useState(null),x=D.useRef(null),O=nV(t),M=Kr(...O?[x,e,R]:e===null?[]:[e]),$=(n=N.unmount)==null||n?ms.Unmount:ms.Hidden,{show:v,appear:y,initial:_}=dK(),[E,S]=D.useState(v?"visible":"hidden"),b=fK(),{register:w,unregister:Te}=b;Tn(()=>w(x),[w,x]),Tn(()=>{if($===ms.Hidden&&x.current){if(v&&E!=="visible"){S("visible");return}return Wi(E,{hidden:()=>Te(x),visible:()=>w(x)})}},[E,x,w,Te,v,$]);let Oe=pg();Tn(()=>{if(O&&Oe&&E==="visible"&&x.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[x,E,Oe,O]);let jt=_&&!y,Ue=y&&v&&_,U=D.useRef(!1),G=rV(()=>{U.current||(S("hidden"),Te(x))},b),B=je(nt=>{U.current=!0;let Pn=nt?"enter":"leave";G.onStart(x,Pn,cn=>{cn==="enter"?s==null||s():cn==="leave"&&(l==null||l())})}),Z=je(nt=>{let Pn=nt?"enter":"leave";U.current=!1,G.onStop(x,Pn,cn=>{cn==="enter"?o==null||o():cn==="leave"&&(u==null||u())}),Pn==="leave"&&!yg(G)&&(S("hidden"),Te(x))});D.useEffect(()=>{O&&i||(B(v),Z(v))},[v,O,i]);let oe=!(!i||!O||!Oe||jt),[,H]=O8(oe,P,v,{start:B,end:Z}),He=Ro({ref:M,className:((r=iw(N.className,Ue&&h,Ue&&f,H.enter&&h,H.enter&&H.closed&&f,H.enter&&!H.closed&&p,H.leave&&I,H.leave&&!H.closed&&A,H.leave&&H.closed&&C,!H.transition&&v&&g))==null?void 0:r.trim())||void 0,...V8(H)}),Ie=0;E==="visible"&&(Ie|=wr.Open),E==="hidden"&&(Ie|=wr.Closed),v&&E==="hidden"&&(Ie|=wr.Opening),!v&&E==="visible"&&(Ie|=wr.Closing);let it=Zn();return le.createElement(gg.Provider,{value:G},le.createElement(j8,{value:Ie},it({ourProps:He,theirProps:N,defaultTag:iV,features:sV,visible:E==="visible",name:"Transition.Child"})))}function mK(t,e){let{show:n,appear:r=!1,unmount:i=!0,...s}=t,o=D.useRef(null),l=nV(t),u=Kr(...l?[o,e]:e===null?[]:[e]);pg();let h=fg();if(n===void 0&&h!==null&&(n=(h&wr.Open)===wr.Open),n===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[f,p]=D.useState(n?"visible":"hidden"),g=rV(()=>{n||p("hidden")}),[I,A]=D.useState(!0),C=D.useRef([n]);Tn(()=>{I!==!1&&C.current[C.current.length-1]!==n&&(C.current.push(n),A(!1))},[C,n]);let N=D.useMemo(()=>({show:n,appear:r,initial:I}),[n,r,I]);Tn(()=>{n?p("visible"):!yg(g)&&o.current!==null&&p("hidden")},[n,g]);let P={unmount:i},R=je(()=>{var M;I&&A(!1),(M=t.beforeEnter)==null||M.call(t)}),x=je(()=>{var M;I&&A(!1),(M=t.beforeLeave)==null||M.call(t)}),O=Zn();return le.createElement(gg.Provider,{value:g},le.createElement(mg.Provider,{value:N},O({ourProps:{...P,as:D.Fragment,children:le.createElement(oV,{ref:u,...P,...s,beforeEnter:R,beforeLeave:x})},theirProps:{},defaultTag:D.Fragment,features:sV,visible:f==="visible",name:"Transition"})))}function gK(t,e){let n=D.useContext(mg)!==null,r=fg()!==null;return le.createElement(le.Fragment,null,!n&&r?le.createElement(uw,{ref:e,...t}):le.createElement(oV,{ref:e,...t}))}let uw=Sn(mK),oV=Sn(pK),HT=Sn(gK),Lf=Object.assign(uw,{Child:HT,Root:uw});var yK=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(yK||{}),_K=(t=>(t[t.SetTitleId=0]="SetTitleId",t))(_K||{});let vK={0(t,e){return t.titleId===e.id?t:{...t,titleId:e.id}}},KT=D.createContext(null);KT.displayName="DialogContext";function _g(t){let e=D.useContext(KT);if(e===null){let n=new Error(`<${t} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,_g),n}return e}function wK(t,e){return Wi(e.type,vK,t,e)}let R1=Sn(function(t,e){let n=D.useId(),{id:r=`headlessui-dialog-${n}`,open:i,onClose:s,initialFocus:o,role:l="dialog",autoFocus:u=!0,__demoMode:h=!1,unmount:f=!1,...p}=t,g=D.useRef(!1);l=function(){return l==="dialog"||l==="alertdialog"?l:(g.current||(g.current=!0,console.warn(`Invalid role [${l}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let I=fg();i===void 0&&I!==null&&(i=(I&wr.Open)===wr.Open);let A=D.useRef(null),C=Kr(A,e),N=zT(A.current),P=i?0:1,[R,x]=D.useReducer(wK,{titleId:null,descriptionId:null,panelRef:D.createRef()}),O=je(()=>s(!1)),M=je(H=>x({type:0,id:H})),$=pg()?P===0:!1,[v,y]=Q8(),_={get current(){var H;return(H=R.panelRef.current)!=null?H:A.current}},E=ZD(),{resolveContainers:S}=eK({mainTreeNode:E,portals:v,defaultContainers:[_]}),b=I!==null?(I&wr.Closing)===wr.Closing:!1;h8(h||b?!1:$,{allowed:je(()=>{var H,He;return[(He=(H=A.current)==null?void 0:H.closest("[data-headlessui-portal]"))!=null?He:null]}),disallowed:je(()=>{var H;return[(H=E==null?void 0:E.closest("body > *:not(#headlessui-portal-root)"))!=null?H:null]})});let w=FD.get(null);Tn(()=>{if($)return w.actions.push(r),()=>w.actions.pop(r)},[w,r,$]);let Te=BD(w,D.useCallback(H=>w.selectors.isTop(H,r),[w,r]));I8(Te,S,H=>{H.preventDefault(),O()}),J8(Te,N==null?void 0:N.defaultView,H=>{H.preventDefault(),H.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),O()}),k8(h||b?!1:$,N,S),d8($,A,O);let[Oe,jt]=jH(),Ue=D.useMemo(()=>[{dialogState:P,close:O,setTitleId:M,unmount:f},R],[P,O,M,f,R]),U=Ed({open:P===0}),G={ref:C,id:r,role:l,tabIndex:-1,"aria-modal":h?void 0:P===0?!0:void 0,"aria-labelledby":R.titleId,"aria-describedby":Oe,unmount:f},B=!Z8(),Z=Co.None;$&&!h&&(Z|=Co.RestoreFocus,Z|=Co.TabLock,u&&(Z|=Co.AutoFocus),B&&(Z|=Co.InitialFocus));let oe=Zn();return le.createElement(U8,null,le.createElement(S1,{force:!0},le.createElement(X8,null,le.createElement(KT.Provider,{value:Ue},le.createElement(XD,{target:A},le.createElement(S1,{force:!1},le.createElement(jt,{slot:U},le.createElement(y,null,le.createElement(oK,{initialFocus:o,initialFocusFallback:A,containers:S,features:Z},le.createElement(HH,{value:O},oe({ourProps:G,theirProps:p,slot:U,defaultTag:EK,features:TK,visible:P===0,name:"Dialog"})))))))))))}),EK="div",TK=Gp.RenderStrategy|Gp.Static;function IK(t,e){let{transition:n=!1,open:r,...i}=t,s=fg(),o=t.hasOwnProperty("open")||s!==null,l=t.hasOwnProperty("onClose");if(!o&&!l)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!o)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!l)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!s&&typeof t.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${t.open}`);if(typeof t.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${t.onClose}`);return(r!==void 0||n)&&!i.static?le.createElement(P1,null,le.createElement(Lf,{show:r,transition:n,unmount:i.unmount},le.createElement(R1,{ref:e,...i}))):le.createElement(P1,null,le.createElement(R1,{ref:e,open:r,...i}))}let AK="div";function SK(t,e){let n=D.useId(),{id:r=`headlessui-dialog-panel-${n}`,transition:i=!1,...s}=t,[{dialogState:o,unmount:l},u]=_g("Dialog.Panel"),h=Kr(e,u.panelRef),f=Ed({open:o===0}),p=je(N=>{N.stopPropagation()}),g={ref:h,id:r,onClick:p},I=i?HT:D.Fragment,A=i?{unmount:l}:{},C=Zn();return le.createElement(I,{...A},C({ourProps:g,theirProps:s,slot:f,defaultTag:AK,name:"Dialog.Panel"}))}let PK="div";function RK(t,e){let{transition:n=!1,...r}=t,[{dialogState:i,unmount:s}]=_g("Dialog.Backdrop"),o=Ed({open:i===0}),l={ref:e,"aria-hidden":!0},u=n?HT:D.Fragment,h=n?{unmount:s}:{},f=Zn();return le.createElement(u,{...h},f({ourProps:l,theirProps:r,slot:o,defaultTag:PK,name:"Dialog.Backdrop"}))}let CK="h2";function bK(t,e){let n=D.useId(),{id:r=`headlessui-dialog-title-${n}`,...i}=t,[{dialogState:s,setTitleId:o}]=_g("Dialog.Title"),l=Kr(e);D.useEffect(()=>(o(r),()=>o(null)),[r,o]);let u=Ed({open:s===0}),h={ref:l,id:r};return Zn()({ourProps:h,theirProps:i,slot:u,defaultTag:CK,name:"Dialog.Title"})}let kK=Sn(IK),xK=Sn(SK);Sn(RK);let NK=Sn(bK),e_=Object.assign(kK,{Panel:xK,Title:NK,Description:qH});const aV="E_OVERLAP";function lV(t){if(!t.name||!t.name.trim())throw new Error("Service name is required");if(t.price==null||t.price<0)throw new Error("Price must be  0");if(t.duration==null||t.duration<=0)throw new Error("Duration must be > 0")}async function DK(t,e){lV(e);const n=Jt(Dt(t,"services"));return await Om(n,{name:e.name.trim(),price:Number(e.price),duration:Number(e.duration),category:e.category??null,description:e.description??null,active:e.active??!0,createdAt:Ot(),updatedAt:Ot()}),n.id}async function VK(t,e,n){lV({...n,name:n.name??"x",price:n.price??0,duration:n.duration??1});const r=Jt(t,"services",e);await Hc(r,{...n.name!=null?{name:n.name.trim()}:{},...n.price!=null?{price:Number(n.price)}:{},...n.duration!=null?{duration:Number(n.duration)}:{},...n.category!==void 0?{category:n.category??null}:{},...n.description!==void 0?{description:n.description??null}:{},...n.active!==void 0?{active:!!n.active}:{},updatedAt:Ot()})}async function OK(t,e){await Tk(Jt(t,"services",e))}function uV(t,e,n){const r=Dt(t,"services"),i=e!=null&&e.activeOnly?sn(r,vt("active","==",!0),_i("name","asc")):sn(r,_i("name","asc"));return Pi(i,s=>{const o=s.docs.map(l=>({id:l.id,...l.data()}));n(o)})}async function MK(t,e){const n=e.id?Jt(t,"customers",e.id):Jt(Dt(t,"customers"));return await Om(n,{name:e.name||"Unnamed",email:e.email||null,phone:e.phone||null,notes:e.notes||null,status:e.status||"approved",createdAt:Ot(),updatedAt:Ot()},{merge:!0}),n.id}async function LK(t,e,n){const r=Jt(t,"customers",e);await Hc(r,{...n.name!==void 0?{name:n.name}:{},...n.email!==void 0?{email:n.email??null}:{},...n.phone!==void 0?{phone:n.phone??null}:{},...n.notes!==void 0?{notes:n.notes??null}:{},...n.status!==void 0?{status:n.status}:{},...n.lastVisit!==void 0?{lastVisit:n.lastVisit??null}:{},...n.totalVisits!==void 0?{totalVisits:n.totalVisits??0}:{},updatedAt:Ot()})}async function $K(t,e){await Tk(Jt(t,"customers",e))}async function FK(t,e){const n=sn(Dt(t,"customers"),vt("email","==",e),Pp(1)),r=await Do(n);if(r.empty)return null;const i=r.docs[0];return{id:i.id,...i.data()}}function jK(t,e,n){const r=Dt(t,"customers");if(e&&e.includes("@")){const s=sn(r,vt("email","==",e));return Pi(s,o=>n(o.docs.map(l=>({id:l.id,...l.data()}))))}if(e&&e.trim().length>=2){const s=e.trim(),o=sn(r,vt("name",">=",s),vt("name","<=",s+""),_i("name","asc"),Pp(50));return Pi(o,l=>n(l.docs.map(u=>({id:u.id,...u.data()}))))}const i=sn(r,_i("name","asc"),Pp(200));return Pi(i,s=>n(s.docs.map(o=>({id:o.id,...o.data()}))))}function UK(t,e,n){const r=new Date(e);r.setHours(0,0,0,0);const i=new Date(e);i.setHours(23,59,59,999);const s=sn(Dt(t,"appointments"),vt("start",">=",r.toISOString()),vt("start","<=",i.toISOString()),_i("start","asc"));return Pi(s,o=>{const l=[];o.forEach(u=>{const h={id:u.id,...u.data()};h.status!=="cancelled"&&l.push(h)}),n(l)})}async function BK(t,e){const n=new Date(e.start).getTime();if(!Number.isFinite(n))throw new Error("Invalid start");const r=n+e.duration*6e4,i=new Date(n).toISOString(),s=new Date(r).toISOString(),o=new Date(n-e.duration*6e4).toISOString(),l=s,u=Dt(t,"appointments"),h=sn(u,vt("start",">=",o),vt("start","<",l)),f=sn(u,vt("start",">=",i),vt("start","<",s)),p={};return await Wj(t,async g=>{(await Do(h)).forEach(P=>{p[P.id]=!0}),(await Do(f)).forEach(P=>{p[P.id]=!0});for(const P of Object.keys(p)){const R=Jt(t,"appointments",P),x=await g.get(R);if(!x.exists())continue;const O=x.data();if(O.status==="cancelled")continue;const M=new Date(O.start).getTime(),$=M+(O.duration||0)*6e4;if(M<r&&$>n)throw new Error(aV)}const C=Jt(Dt(t,"appointments")),N={customerId:e.customerId,serviceId:e.serviceId,start:i,duration:e.duration,status:e.status||"confirmed",notes:e.notes||null,bookedPrice:e.bookedPrice??null,autoConfirm:e.autoConfirm??!1,createdAt:Ot(),updatedAt:Ot()};return g.set(C,N),C.id})}function zK(t,e){const n=Jt(t,"settings","analyticsTargets");return Pi(n,r=>e(r.data()))}async function qK(t,e){const n=Jt(t,"settings","analyticsTargets");await Om(n,{...e,updatedAt:Ot()},{merge:!0})}function cV(t,e){const n=Jt(t,"settings","businessHours");return Pi(n,r=>e(r.data()))}async function WK(t,e){const n=Jt(t,"settings","businessHours");await Om(n,{...e,updatedAt:Ot()},{merge:!0})}function $f(t,e,n,r){const i=n.timezone||"America/Los_Angeles",s=["sun","mon","tue","wed","thu","fri","sat"][t.getDay()],o=n.slots[s]||[],l=Math.max(5,n.slotInterval||15),u=[];for(const[h,f]of o){const p=C1(t,h,i),g=C1(t,f,i);for(let I=p.getTime();I+e*6e4<=g.getTime();I+=l*6e4){const A=new Date(I).toISOString(),C=I+e*6e4;HK(I,C,r)||u.push(A)}}return u}function HK(t,e,n){for(const r of n){if(r.status==="cancelled")continue;const i=new Date(r.start).getTime(),s=i+r.duration*6e4;if(i<e&&s>t)return!0}return!1}function C1(t,e,n){const[r,i]=e.split(":").map(l=>parseInt(l,10)),s=new Intl.DateTimeFormat("en-US",{timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(new Date(t.getFullYear(),t.getMonth(),t.getDate(),r,i,0)),o=l=>{var u;return Number(((u=s.find(h=>h.type===l))==null?void 0:u.value)||"0")};return new Date(o("year"),o("month")-1,o("day"),o("hour"),o("minute"),o("second"))}function KK({open:t,onClose:e,date:n,onCreated:r}){const{db:i}=Jn(),[s,o]=D.useState([]),[l,u]=D.useState(null);D.useEffect(()=>uV(i,{activeOnly:!0},o),[]),D.useEffect(()=>cV(i,u),[]);const[h,f]=D.useState(""),[p,g]=D.useState(""),[I,A]=D.useState(null),[C,N]=D.useState("10:00"),[P,R]=D.useState(60),[x,O]=D.useState(""),[M,$]=D.useState(""),[v,y]=D.useState(""),[_,E]=D.useState("");D.useEffect(()=>{const B=s.find(Z=>Z.id===h);B&&R(B.duration)},[h,s]);const[S,b]=D.useState([]);D.useEffect(()=>{let B=!0;return(async()=>{const Z=p.trim();if(!Z){b([]);return}const oe=[];if(Z.includes("@")){const Ie=await FK(i,Z);Ie&&oe.push(Ie)}const H=Wr(Gn(i,"customers"),zs("name",">=",Z),zs("name","<=",Z+""),ug(5));(await mD(H)).forEach(Ie=>oe.push({id:Ie.id,...Ie.data()})),B&&b(oe)})(),()=>{B=!1}},[p]);const[w,Te]=D.useState([]);D.useEffect(()=>{if(!t)return;const B=new Date(n);B.setHours(0,0,0,0);const Z=new Date(n);Z.setHours(23,59,59,999),p1(async()=>{const{onSnapshot:oe,collection:H,query:He,where:Ie,orderBy:it}=await Promise.resolve().then(()=>i1);return{onSnapshot:oe,collection:H,query:He,where:Ie,orderBy:it}},void 0).then(({onSnapshot:oe,collection:H,query:He,where:Ie,orderBy:it})=>{const nt=He(H(i,"appointments"),Ie("start",">=",B.toISOString()),Ie("start","<=",Z.toISOString()),it("start","asc")),Pn=oe(nt,cn=>{const hn=[];cn.forEach(dn=>hn.push({id:dn.id,...dn.data()})),Te(hn)});return()=>Pn()})},[t,n]),D.useMemo(()=>l?$f(n,P,l,w):[],[l,n,P,w]);const[Oe,jt]=D.useState(!1),[Ue,U]=D.useState("");async function G(){var B;try{jt(!0),U("");let Z;if(I)Z=I.id;else{const{doc:it,setDoc:nt,serverTimestamp:Pn}=await p1(async()=>{const{doc:hn,setDoc:dn,serverTimestamp:Gr}=await Promise.resolve().then(()=>i1);return{doc:hn,setDoc:dn,serverTimestamp:Gr}},void 0),cn=it(Gn(i,"customers"));await nt(cn,{name:v||p||"Unnamed",email:M||null,phone:_||null,status:"approved",createdAt:Pn(),updatedAt:Pn()},{merge:!0}),Z=cn.id}const[oe,H]=C.split(":").map(Number),He=new Date(n);He.setHours(oe,H,0,0);const Ie=await BK(i,{customerId:Z,serviceId:h,start:He.toISOString(),duration:P,status:"confirmed",bookedPrice:((B=s.find(it=>it.id===h))==null?void 0:B.price)??0,notes:x});r==null||r(Ie),e()}catch(Z){(Z==null?void 0:Z.message)===aV?U("This time is already booked. Pick another slot."):U((Z==null?void 0:Z.message)||"Failed to create")}finally{jt(!1)}}return T.jsx(Lf,{show:t,as:D.Fragment,children:T.jsxs(e_,{onClose:e,className:"relative z-50",children:[T.jsx(Lf.Child,{as:D.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:T.jsx("div",{className:"fixed inset-0 bg-black/20"})}),T.jsx("div",{className:"fixed inset-0 overflow-y-auto p-4",children:T.jsx("div",{className:"mx-auto max-w-2xl",children:T.jsx(Lf.Child,{as:D.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 translate-y-2",enterTo:"opacity-100 translate-y-0",leave:"ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-2",children:T.jsxs(e_.Panel,{className:"bg-white rounded-xl shadow-xl p-4",children:[T.jsxs(e_.Title,{className:"font-serif text-xl mb-2",children:["Add appointment  ",Dn(n,"PP")]}),T.jsxs("div",{className:"grid gap-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-sm text-slate-600",children:"Customer"}),T.jsx("input",{className:"border rounded-md p-2 w-full",placeholder:"Type name or email",value:p,onChange:B=>{g(B.target.value),A(null)}}),S.length>0&&T.jsx("div",{className:"border rounded-md mt-1 max-h-40 overflow-auto",children:S.map(B=>T.jsxs("button",{className:"w-full text-left px-2 py-1 hover:bg-cream",onClick:()=>{A(B),g(B.name||B.email||"")},children:[T.jsx("div",{className:"text-sm",children:B.name}),T.jsx("div",{className:"text-xs text-slate-500",children:B.email||B.phone||B.id})]},B.id))}),!I&&T.jsxs("div",{className:"grid sm:grid-cols-3 gap-2 mt-2",children:[T.jsx("input",{className:"border rounded-md p-2",placeholder:"Name",value:v,onChange:B=>y(B.target.value)}),T.jsx("input",{className:"border rounded-md p-2",placeholder:"Email",value:M,onChange:B=>$(B.target.value)}),T.jsx("input",{className:"border rounded-md p-2",placeholder:"Phone",value:_,onChange:B=>E(B.target.value)})]}),I&&T.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:["Selected: ",T.jsx("span",{className:"font-medium",children:I.name})," (",I.email||I.phone||I.id,")"]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-sm text-slate-600",children:"Service"}),T.jsxs("select",{className:"border rounded-md p-2 w-full",value:h,onChange:B=>f(B.target.value),children:[T.jsx("option",{value:"",children:"Select service"}),s.map(B=>T.jsxs("option",{value:B.id,children:[B.name,"  ",B.duration,"m  $",B.price.toFixed(2)]},B.id))]})]}),T.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-sm text-slate-600",children:"Date"}),T.jsx("input",{type:"date",className:"border rounded-md p-2 w-full",value:Dn(n,"yyyy-MM-dd"),onChange:B=>{const Z=new Date(B.target.value+"T00:00:00");Z.setHours(n.getHours(),n.getMinutes(),0,0),n=Z}})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-sm text-slate-600",children:"Time"}),T.jsx("input",{type:"time",className:"border rounded-md p-2 w-full",value:C,onChange:B=>N(B.target.value)})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-sm text-slate-600",children:"Duration (min)"}),T.jsx("input",{type:"number",min:5,step:5,className:"border rounded-md p-2 w-full",value:P,onChange:B=>R(parseInt(B.target.value||"0"))})]})]}),l&&T.jsxs("div",{children:[T.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Available slots"}),T.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[$f(n,P,l,w).slice(0,16).map(B=>T.jsx("button",{className:"border rounded-md py-1 text-sm hover:bg-cream",onClick:()=>N(Dn(Kp(B),"HH:mm")),children:Dn(Kp(B),"h:mm a")},B)),!$f(n,P,l,w).length&&T.jsx("div",{className:"text-xs text-slate-500",children:"No slots under business hours."})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-sm text-slate-600",children:"Notes"}),T.jsx("textarea",{className:"border rounded-md p-2 w-full",rows:3,value:x,onChange:B=>O(B.target.value)})]}),Ue&&T.jsx("div",{className:"text-red-600 text-sm",children:Ue}),T.jsxs("div",{className:"flex justify-end gap-2",children:[T.jsx("button",{className:"px-4 py-2 rounded-md border",onClick:e,disabled:Oe,children:"Cancel"}),T.jsx("button",{className:"px-4 py-2 rounded-md bg-terracotta text-white",onClick:G,disabled:Oe||!h,children:Oe?"Saving":"Create appointment"})]})]})]})})})})]})})}function GK(){const{db:t}=Jn(),[e,n]=D.useState(()=>new Date),r=D.useMemo(()=>oa(ID(e),{weekStartsOn:0}),[e]),i=D.useMemo(()=>SD(TD(e),{weekStartsOn:0}),[e]),[s,o]=D.useState([]);D.useEffect(()=>{const A=Wr(Gn(t,"appointments"),zs("start",">=",r.toISOString()),zs("start","<=",i.toISOString()),xl("start","asc"));return Ur(A,C=>{const N=[];C.forEach(P=>N.push({id:P.id,...P.data()})),o(N)})},[r,i]);const[l,u]=D.useState({});D.useEffect(()=>{const A=Gn(t,"services");return Ur(Wr(A,xl("name","asc")),C=>{const N={};C.forEach(P=>N[P.id]={id:P.id,...P.data()}),u(N)})},[]);const h=D.useMemo(()=>{const A=[];for(let C=new Date(r);C<=i;C=new Date(C.getTime()+24*60*60*1e3))A.push(new Date(C));return A},[r,i]),[f,p]=D.useState(null),[g,I]=D.useState({open:!1,date:null});return T.jsxs("div",{className:"grid gap-4",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("div",{className:"font-serif text-2xl",children:Dn(e,"MMMM yyyy")}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("button",{className:"border rounded-md px-3 py-1 hover:bg-cream",onClick:()=>n(s1(e,-1)),children:"Prev"}),T.jsx("button",{className:"border rounded-md px-3 py-1 hover:bg-cream",onClick:()=>n(new Date),children:"Today"}),T.jsx("button",{className:"border rounded-md px-3 py-1 hover:bg-cream",onClick:()=>n(s1(e,1)),children:"Next"})]})]}),T.jsx("div",{className:"grid grid-cols-7 text-xs text-slate-500",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(A=>T.jsx("div",{className:"px-2 py-1",children:A},A))}),T.jsx("div",{className:"grid grid-cols-7 gap-px bg-slate-200 rounded-xl overflow-hidden",children:h.map((A,C)=>{const N=CD(A,e),P=s.filter(R=>Ky(new Date(R.start),A)&&R.status!=="cancelled");return T.jsxs("div",{className:`relative min-h-[108px] bg-white ${N?"":"bg-slate-50 text-slate-400"}`,onMouseEnter:()=>p(A),onMouseLeave:()=>p(R=>R&&Ky(R,A)?null:R),onClick:()=>I({open:!0,date:A}),children:[T.jsxs("div",{className:"flex items-center justify-between px-2 py-1",children:[T.jsx("span",{className:"text-xs",children:Dn(A,"d")}),!!P.length&&T.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-terracotta text-white",children:P.length})]}),T.jsxs("div",{className:"px-2 pb-2 space-y-1",children:[P.slice(0,3).map(R=>{var x;return T.jsxs("div",{className:"text-[11px] truncate border rounded px-1 py-0.5",children:[Dn(new Date(R.start),"h:mma"),"  ",((x=l[R.serviceId])==null?void 0:x.name)||"Service"]},R.id)}),P.length>3&&T.jsxs("div",{className:"text-[10px] text-slate-500",children:["+",P.length-3," more"]})]}),f&&Ky(f,A)&&P.length>0&&T.jsxs("div",{className:"absolute z-10 left-1/2 -translate-x-1/2 top-full mt-1 w-56 bg-white border rounded-xl shadow-lg p-2",children:[T.jsx("div",{className:"text-xs font-medium mb-1",children:Dn(A,"PP")}),T.jsx("ul",{className:"max-h-48 overflow-auto space-y-1",children:P.map(R=>{var x;return T.jsxs("li",{className:"text-xs flex justify-between gap-2",children:[T.jsx("span",{className:"truncate",children:Dn(new Date(R.start),"h:mm a")}),T.jsx("span",{className:"truncate text-right",children:((x=l[R.serviceId])==null?void 0:x.name)||"Service"})]},R.id)})})]})]},C)})}),T.jsx(KK,{open:g.open,date:g.date||new Date,onClose:()=>I({open:!1,date:null}),onCreated:()=>I({open:!1,date:null})})]})}function QK(){const{db:t}=Jn(),[e,n]=D.useState([]),[r,i]=D.useState(""),[s,o]=D.useState(null);return D.useEffect(()=>jK(t,r,n),[r]),T.jsxs("div",{className:"bg-white rounded-xl shadow-soft p-6",children:[T.jsxs("div",{className:"flex justify-between mb-4",children:[T.jsx("h2",{className:"font-serif text-xl",children:"Customers"}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{className:"border rounded-md p-2",placeholder:"Search name",value:r,onChange:l=>i(l.target.value)}),T.jsx("button",{className:"bg-terracotta text-white rounded-md px-3 py-2",onClick:()=>o({id:"",name:"",email:"",phone:"",status:"approved"}),children:"Add"})]})]}),T.jsxs("table",{className:"w-full text-sm",children:[T.jsx("thead",{children:T.jsxs("tr",{className:"text-left text-slate-600",children:[T.jsx("th",{className:"py-2",children:"Name"}),T.jsx("th",{children:"Email"}),T.jsx("th",{children:"Phone"}),T.jsx("th",{children:"Status"}),T.jsx("th",{})]})}),T.jsx("tbody",{children:e.map(l=>T.jsxs("tr",{className:"border-t",children:[T.jsx("td",{className:"py-2",children:l.name}),T.jsx("td",{children:l.email}),T.jsx("td",{children:l.phone}),T.jsx("td",{children:l.status}),T.jsxs("td",{className:"text-right",children:[T.jsx("button",{className:"mr-2 text-terracotta",onClick:()=>o(l),children:"Edit"}),T.jsx("button",{className:"text-red-600",onClick:()=>$K(t,l.id),children:"Delete"})]})]},l.id))})]}),s&&T.jsx(YK,{initial:s,onClose:()=>o(null)})]})}function YK({initial:t,onClose:e}){const[n,r]=D.useState(t);D.useEffect(()=>{r(t)},[t]);async function i(){n.id?await LK(db,n.id,n):await MK(db,n),e()}return T.jsx("div",{className:"fixed inset-0 bg-black/30 grid place-items-center",onClick:e,children:T.jsxs("div",{className:"bg-white rounded-xl p-6 w-[520px]",onClick:s=>s.stopPropagation(),children:[T.jsx("h3",{className:"font-serif text-xl mb-3",children:n.id?"Edit Customer":"Add Customer"}),T.jsxs("div",{className:"grid gap-3",children:[T.jsx("input",{className:"border rounded-md p-2",placeholder:"Name",value:n.name,onChange:s=>r({...n,name:s.target.value})}),T.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[T.jsx("input",{className:"border rounded-md p-2",placeholder:"Email",value:n.email||"",onChange:s=>r({...n,email:s.target.value})}),T.jsx("input",{className:"border rounded-md p-2",placeholder:"Phone",value:n.phone||"",onChange:s=>r({...n,phone:s.target.value})})]}),T.jsxs("label",{className:"grid grid-cols-[100px_1fr] items-center gap-2",children:[T.jsx("span",{children:"Status"}),T.jsxs("select",{className:"border rounded-md p-2",value:n.status||"approved",onChange:s=>r({...n,status:s.target.value}),children:[T.jsx("option",{value:"approved",children:"approved"}),T.jsx("option",{value:"blocked",children:"blocked"}),T.jsx("option",{value:"guest",children:"guest"})]})]}),T.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[T.jsx("button",{onClick:e,children:"Cancel"}),T.jsx("button",{className:"bg-terracotta text-white rounded-md px-4 py-2",onClick:i,children:"Save"})]})]})]})})}function XK(){const{db:t}=Jn(),[e,n]=D.useState([]),[r,i]=D.useState(null);return D.useEffect(()=>uV(t,void 0,n),[]),T.jsxs("div",{className:"bg-white rounded-xl shadow-soft p-6",children:[T.jsxs("div",{className:"flex justify-between items-center mb-4",children:[T.jsx("h2",{className:"font-serif text-xl",children:"Services"}),T.jsx("button",{className:"bg-terracotta text-white rounded-md px-3 py-2",onClick:()=>i({id:"",name:"",price:0,duration:60,active:!0}),children:"Add"})]}),T.jsxs("table",{className:"w-full text-sm",children:[T.jsx("thead",{children:T.jsxs("tr",{className:"text-left text-slate-600",children:[T.jsx("th",{className:"py-2",children:"Name"}),T.jsx("th",{children:"Price"}),T.jsx("th",{children:"Duration"}),T.jsx("th",{children:"Active"}),T.jsx("th",{})]})}),T.jsx("tbody",{children:e.map(s=>T.jsxs("tr",{className:"border-t",children:[T.jsx("td",{className:"py-2",children:s.name}),T.jsxs("td",{children:["$",s.price.toFixed(2)]}),T.jsxs("td",{children:[s.duration,"m"]}),T.jsx("td",{children:s.active?"Yes":"No"}),T.jsxs("td",{className:"text-right",children:[T.jsx("button",{className:"mr-2 text-terracotta",onClick:()=>i(s),children:"Edit"}),T.jsx("button",{className:"text-red-600",onClick:()=>OK(t,s.id),children:"Delete"})]})]},s.id))})]}),r&&T.jsx(JK,{initial:r,onClose:()=>i(null)})]})}function JK({initial:t,onClose:e}){const[n,r]=D.useState(t);async function i(){n.id?await VK(db,n.id,n):await DK(db,n),e()}return T.jsx("div",{className:"fixed inset-0 bg-black/30 grid place-items-center",onClick:e,children:T.jsxs("div",{className:"bg-white rounded-xl p-6 w-[460px]",onClick:s=>s.stopPropagation(),children:[T.jsx("h3",{className:"font-serif text-xl mb-3",children:n.id?"Edit Service":"Add Service"}),T.jsxs("div",{className:"grid gap-3",children:[T.jsx("input",{className:"border rounded-md p-2",placeholder:"Name",value:n.name,onChange:s=>r({...n,name:s.target.value})}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{className:"border rounded-md p-2 flex-1",type:"number",placeholder:"Price",value:n.price,onChange:s=>r({...n,price:parseFloat(s.target.value||"0")})}),T.jsx("input",{className:"border rounded-md p-2 w-40",type:"number",placeholder:"Duration (min)",value:n.duration,onChange:s=>r({...n,duration:parseInt(s.target.value||"0")})})]}),T.jsxs("label",{className:"flex items-center gap-2",children:[T.jsx("input",{type:"checkbox",checked:n.active,onChange:s=>r({...n,active:s.target.checked})}),T.jsx("span",{children:"Active"})]}),T.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[T.jsx("button",{onClick:e,children:"Cancel"}),T.jsx("button",{className:"bg-terracotta text-white rounded-md px-4 py-2",onClick:i,children:"Save"})]})]})]})})}class ZK{constructor(e,n){this.db=e,n&&typeof window<"u"&&(this.messaging=Px(n))}async sendMessage(e){const n={...e,timestamp:Ot(),read:!1};return(await ky(Dt(this.db,"messages"),n)).id}async getMessages(e,n=50){const r=sn(Dt(this.db,"messages"),vt("customerId","==",e),_i("timestamp","desc"),Pp(n));return(await Do(r)).docs.map(s=>({id:s.id,...s.data()}))}subscribeToMessages(e,n){const r=sn(Dt(this.db,"messages"),vt("customerId","==",e),_i("timestamp","asc"));return Pi(r,i=>{const s=i.docs.map(o=>({id:o.id,...o.data()}));n(s)})}async markMessagesAsRead(e,n){const r=sn(Dt(this.db,"messages"),vt("customerId","==",e),vt("type","==","customer"),vt("read","==",!1)),s=(await Do(r)).docs.map(o=>Hc(o.ref,{read:!0,readBy:n,readAt:Ot()}));await Promise.all(s)}async getConversations(){const e=sn(Dt(this.db,"conversations"),_i("lastMessageTime","desc"));return(await Do(e)).docs.map(r=>({id:r.id,...r.data()}))}subscribeToConversations(e){const n=sn(Dt(this.db,"conversations"),_i("lastMessageTime","desc"));return Pi(n,r=>{const i=r.docs.map(s=>({id:s.id,...s.data()}));e(i)})}async updateConversation(e,n){const r=Jt(this.db,"conversations",e);await Hc(r,{lastMessage:n.content,lastMessageTime:Ot(),unreadCount:n.type==="customer"?await this.getUnreadCount(e)+1:0,status:"active"}).catch(async()=>{await ky(Dt(this.db,"conversations"),{customerId:e,customerName:n.customerName,customerEmail:n.customerEmail,lastMessage:n.content,lastMessageTime:Ot(),unreadCount:n.type==="customer"?1:0,status:"active",appointmentId:n.appointmentId})})}async getUnreadCount(e){const n=sn(Dt(this.db,"messages"),vt("customerId","==",e),vt("type","==","customer"),vt("read","==",!1));return(await Do(n)).size}async requestNotificationPermission(){if(!this.messaging)return null;try{if(await Notification.requestPermission()==="granted")return await A3(this.messaging,{vapidKey:void 0})}catch(e){console.error("Error getting FCM token:",e)}return null}onMessage(e){return this.messaging?S3(this.messaging,e):()=>{}}async saveCustomerToken(e,n){const r=Jt(this.db,"customer_tokens",e);await Hc(r,{token:n,updatedAt:Ot()}).catch(async()=>{await ky(Dt(this.db,"customer_tokens"),{customerId:e,token:n,createdAt:Ot(),updatedAt:Ot()})})}}const b1=t=>{if(!t)return"";const e=t.toDate?t.toDate():new Date(t),r=(new Date().getTime()-e.getTime())/(1e3*60*60);return r<1?"Just now":r<24?`${Math.floor(r)}h ago`:r<168?`${Math.floor(r/24)}d ago`:e.toLocaleDateString()};function eG({className:t=""}){const[e,n]=D.useState([]),[r,i]=D.useState(null),[s,o]=D.useState([]),[l,u]=D.useState(""),[h,f]=D.useState(null),[p,g]=D.useState(!0);D.useEffect(()=>{const{db:A,app:C}=Jn(),N=new ZK(A,C);f(N);const P=N.subscribeToConversations(R=>{n(R),g(!1)});return()=>{P()}},[]),D.useEffect(()=>{if(!r||!h)return;const A=h.subscribeToMessages(r,C=>{o(C),h.markMessagesAsRead(r,"admin")});return()=>{A()}},[r,h]);const I=async()=>{if(!l.trim()||!r||!h)return;const A=e.find(C=>C.id===r);if(A)try{await h.sendMessage({customerId:r,customerName:A.customerName,customerEmail:A.customerEmail,adminId:"admin",adminName:"Admin",content:l.trim(),type:"admin",priority:"medium"}),await h.updateConversation(r,{content:l.trim(),type:"admin"}),u("")}catch(C){console.error("Error sending message:",C)}};return p?T.jsx("div",{className:`flex items-center justify-center h-64 ${t}`,children:T.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):T.jsxs("div",{className:`flex h-full bg-white rounded-lg shadow ${t}`,children:[T.jsxs("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[T.jsx("div",{className:"p-4 border-b border-gray-200",children:T.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Customer Messages"})}),T.jsx("div",{className:"flex-1 overflow-y-auto",children:e.length===0?T.jsx("div",{className:"p-4 text-center text-gray-500",children:"No conversations yet"}):e.map(A=>T.jsx("div",{onClick:()=>i(A.id),className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${r===A.id?"bg-blue-50 border-blue-200":""}`,children:T.jsxs("div",{className:"flex justify-between items-start",children:[T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:A.customerName}),T.jsx("p",{className:"text-xs text-gray-500 truncate",children:A.customerEmail}),A.lastMessage&&T.jsx("p",{className:"text-sm text-gray-600 mt-1 truncate",children:A.lastMessage})]}),T.jsxs("div",{className:"flex flex-col items-end ml-2",children:[A.unreadCount>0&&T.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:A.unreadCount}),T.jsx("span",{className:"text-xs text-gray-400 mt-1",children:A.lastMessageTime&&b1(A.lastMessageTime)})]})]})},A.id))})]}),T.jsx("div",{className:"flex-1 flex flex-col",children:r?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"p-4 border-b border-gray-200",children:(()=>{const A=e.find(C=>C.id===r);return A?T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:A.customerName}),T.jsx("p",{className:"text-sm text-gray-500",children:A.customerEmail})]}):null})()}),T.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:s.length===0?T.jsx("div",{className:"text-center text-gray-500 py-8",children:"No messages yet. Start the conversation!"}):s.map(A=>T.jsx("div",{className:`flex ${A.type==="admin"?"justify-end":"justify-start"}`,children:T.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${A.type==="admin"?"bg-blue-600 text-white":"bg-gray-200 text-gray-900"}`,children:[T.jsx("p",{className:"text-sm",children:A.content}),T.jsx("p",{className:`text-xs mt-1 ${A.type==="admin"?"text-blue-100":"text-gray-500"}`,children:b1(A.timestamp)})]})},A.id))}),T.jsx("div",{className:"p-4 border-t border-gray-200",children:T.jsxs("div",{className:"flex space-x-2",children:[T.jsx("input",{type:"text",value:l,onChange:A=>u(A.target.value),onKeyPress:A=>A.key==="Enter"&&I(),placeholder:"Type your message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),T.jsx("button",{onClick:I,disabled:!l.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})})]}):T.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Select a conversation to start messaging"})})]})}function tG(){return T.jsxs("div",{className:"p-6",children:[T.jsxs("div",{className:"mb-6",children:[T.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Customer Messages"}),T.jsx("p",{className:"text-gray-600 mt-1",children:"Communicate with your customers and provide support"})]}),T.jsx("div",{className:"h-[calc(100vh-200px)]",children:T.jsx(eG,{})})]})}function nG({className:t=""}){const[e,n]=D.useState([]),[r,i]=D.useState([]),[s,o]=D.useState(null),[l,u]=D.useState(""),[h,f]=D.useState(!0),[p,g]=D.useState(!1),{db:I,functions:A}=Jn();D.useEffect(()=>{const O=Wr(Gn(I,"sms_conversations"),xl("timestamp","desc"),ug(100)),M=Ur(O,y=>{const _=y.docs.map(E=>({id:E.id,...E.data()}));n(_),f(!1)}),$=Wr(Gn(I,"customers"),zs("phone","!=",null)),v=Ur($,y=>{const _=y.docs.map(E=>({id:E.id,...E.data()}));i(_)});return()=>{M(),v()}},[I]);const C=O=>r.find(M=>M.phone===O),N=()=>{const O=new Set;return e.forEach(M=>{M.phoneNumber&&O.add(M.phoneNumber)}),Array.from(O)},P=O=>e.filter(M=>M.phoneNumber===O).sort((M,$)=>{var v,y,_,E;return new Date(((y=(v=M.timestamp)==null?void 0:v.toDate)==null?void 0:y.call(v))||M.timestamp).getTime()-new Date(((E=(_=$.timestamp)==null?void 0:_.toDate)==null?void 0:E.call(_))||$.timestamp).getTime()}),R=async()=>{if(!(!l.trim()||!s||p)){g(!0);try{const O=r.find(v=>v.id===s);if(!(O!=null&&O.phone))throw new Error("Customer phone number not found");if((await A.httpsCallable("sendSMSToCustomer")({phoneNumber:O.phone,message:l.trim(),customerId:s})).data.success)u("");else throw new Error("Failed to send SMS")}catch(O){console.error("Error sending SMS:",O),alert("Failed to send SMS. Please try again.")}finally{g(!1)}}},x=O=>{if(!O)return"";const M=O.toDate?O.toDate():new Date(O),v=(new Date().getTime()-M.getTime())/(1e3*60*60);return v<1?"Just now":v<24?`${Math.floor(v)}h ago`:v<168?`${Math.floor(v/24)}d ago`:M.toLocaleDateString()};return h?T.jsx("div",{className:`flex items-center justify-center h-64 ${t}`,children:T.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):T.jsxs("div",{className:`flex h-full bg-white rounded-lg shadow ${t}`,children:[T.jsxs("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[T.jsxs("div",{className:"p-4 border-b border-gray-200",children:[T.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"SMS Conversations"}),T.jsx("p",{className:"text-sm text-gray-500",children:"Customer text messages"})]}),T.jsx("div",{className:"flex-1 overflow-y-auto",children:N().length===0?T.jsx("div",{className:"p-4 text-center text-gray-500",children:"No SMS conversations yet"}):N().map(O=>{const M=C(O),$=P(O),v=$[$.length-1],y=$.filter(_=>_.direction==="inbound"&&!_.read).length;return T.jsx("div",{onClick:()=>o((M==null?void 0:M.id)||null),className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${s===(M==null?void 0:M.id)?"bg-blue-50 border-blue-200":""}`,children:T.jsxs("div",{className:"flex justify-between items-start",children:[T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:(M==null?void 0:M.name)||"SMS Customer"}),T.jsx("p",{className:"text-xs text-gray-500 truncate",children:O}),v&&T.jsx("p",{className:"text-sm text-gray-600 mt-1 truncate",children:v.message})]}),T.jsxs("div",{className:"flex flex-col items-end ml-2",children:[y>0&&T.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:y}),T.jsx("span",{className:"text-xs text-gray-400 mt-1",children:v&&x(v.timestamp)})]})]})},O)})})]}),T.jsx("div",{className:"flex-1 flex flex-col",children:s?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"p-4 border-b border-gray-200",children:(()=>{const O=r.find(M=>M.id===s);return O?T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:O.name}),T.jsx("p",{className:"text-sm text-gray-500",children:O.phone})]}):null})()}),T.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:(()=>{const O=r.find($=>$.id===s);if(!O)return null;const M=P(O.phone);return M.length===0?T.jsx("div",{className:"text-center text-gray-500 py-8",children:"No messages yet. Start the conversation!"}):M.map($=>T.jsx("div",{className:`flex ${$.direction==="outbound"?"justify-end":"justify-start"}`,children:T.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${$.direction==="outbound"?"bg-blue-600 text-white":"bg-gray-200 text-gray-900"}`,children:[T.jsx("p",{className:"text-sm",children:$.message}),T.jsx("p",{className:`text-xs mt-1 ${$.direction==="outbound"?"text-blue-100":"text-gray-500"}`,children:x($.timestamp)})]})},$.id))})()}),T.jsxs("div",{className:"p-4 border-t border-gray-200",children:[T.jsxs("div",{className:"flex space-x-2",children:[T.jsx("input",{type:"text",value:l,onChange:O=>u(O.target.value),onKeyPress:O=>O.key==="Enter"&&R(),placeholder:"Type your SMS message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),T.jsx("button",{onClick:R,disabled:!l.trim()||p,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Sending...":"Send SMS"})]}),T.jsx("p",{className:"text-xs text-gray-500 mt-2",children:" SMS messages are sent via Twilio. Standard messaging rates apply."})]})]}):T.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Select a conversation to view messages"})})]})}function rG(){return T.jsxs("div",{className:"p-6",children:[T.jsxs("div",{className:"mb-6",children:[T.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"SMS Customer Support"}),T.jsx("p",{className:"text-gray-600 mt-1",children:"Manage customer text messages and send SMS responses"}),T.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[T.jsx("h3",{className:"font-semibold text-blue-900",children:"SMS Features:"}),T.jsxs("ul",{className:"text-sm text-blue-800 mt-2 space-y-1",children:[T.jsx("li",{children:" Customers can text your business number for availability"}),T.jsx("li",{children:" Automated responses to common questions"}),T.jsx("li",{children:" Manual SMS responses from admin interface"}),T.jsx("li",{children:" Conversation history and tracking"}),T.jsx("li",{children:" Integration with appointment booking system"})]})]})]}),T.jsx("div",{className:"h-[calc(100vh-300px)]",children:T.jsx(nG,{})})]})}const iG=()=>{const{db:t}=Jn(),[e,n]=D.useState([]),[r,i]=D.useState([]),[s,o]=D.useState(null),[l,u]=D.useState(!0),[h,f]=D.useState("all");D.useEffect(()=>{const P=Wr(Gn(t,"ai_sms_conversations"),xl("timestamp","desc"),ug(100)),R=Ur(P,M=>{const $=M.docs.map(v=>({id:v.id,...v.data()}));n($),u(!1)}),x=Wr(Gn(t,"customers")),O=Ur(x,M=>{const $=M.docs.map(v=>({id:v.id,...v.data()}));i($)});return()=>{R(),O()}},[]);const p=P=>{const R=r.find(x=>x.id===P);return(R==null?void 0:R.name)||"Unknown Customer"},g=P=>{const R=r.find(x=>x.id===P);return(R==null?void 0:R.phone)||"Unknown Phone"},A=e.filter(P=>!(s&&P.customerId!==s||h!=="all"&&P.direction!==h)).reduce((P,R)=>{const x=R.customerId;return P[x]||(P[x]=[]),P[x].push(R),P},{}),C=P=>P?(P.toDate?P.toDate():new Date(P)).toLocaleString():"Unknown time",N=P=>P.direction==="outbound"?P.smsSent?" Sent":" Failed":" Received";return l?T.jsx("div",{className:"flex items-center justify-center h-64",children:T.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):T.jsxs("div",{className:"space-y-6",children:[T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsxs("div",{children:[T.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"AI SMS Conversations"}),T.jsx("p",{className:"text-gray-600",children:"Monitor AI-powered customer interactions"})]}),T.jsxs("div",{className:"flex space-x-4",children:[T.jsxs("select",{value:h,onChange:P=>f(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[T.jsx("option",{value:"all",children:"All Messages"}),T.jsx("option",{value:"inbound",children:"Inbound Only"}),T.jsx("option",{value:"outbound",children:"Outbound Only"})]}),T.jsxs("select",{value:s||"",onChange:P=>o(P.target.value||null),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[T.jsx("option",{value:"",children:"All Customers"}),r.map(P=>T.jsxs("option",{value:P.id,children:[P.name," (",P.phone,")"]},P.id))]})]})]}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[T.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[T.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.length}),T.jsx("div",{className:"text-gray-600",children:"Total Messages"})]}),T.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[T.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(P=>P.direction==="inbound").length}),T.jsx("div",{className:"text-gray-600",children:"Inbound"})]}),T.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[T.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.filter(P=>P.direction==="outbound").length}),T.jsx("div",{className:"text-gray-600",children:"AI Responses"})]}),T.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[T.jsx("div",{className:"text-2xl font-bold text-orange-600",children:Object.keys(A).length}),T.jsx("div",{className:"text-gray-600",children:"Active Customers"})]})]}),T.jsx("div",{className:"space-y-4",children:Object.entries(A).map(([P,R])=>{var x;return T.jsxs("div",{className:"bg-white rounded-lg shadow",children:[T.jsx("div",{className:"p-4 border-b border-gray-200",children:T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsxs("div",{children:[T.jsx("h3",{className:"font-semibold text-gray-900",children:p(P)}),T.jsxs("p",{className:"text-sm text-gray-600",children:[g(P),"  ",R.length," messages"]})]}),T.jsxs("div",{className:"text-sm text-gray-500",children:["Last: ",C((x=R[0])==null?void 0:x.timestamp)]})]})}),T.jsx("div",{className:"p-4 space-y-3",children:R.sort((O,M)=>{var $,v,y,_,E,S;return((y=(v=($=O.timestamp)==null?void 0:$.toDate)==null?void 0:v.call($))==null?void 0:y.getTime())-((S=(E=(_=M.timestamp)==null?void 0:_.toDate)==null?void 0:E.call(_))==null?void 0:S.getTime())}).map(O=>T.jsx("div",{className:`flex ${O.direction==="inbound"?"justify-start":"justify-end"}`,children:T.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${O.direction==="inbound"?"bg-gray-100 text-gray-900":"bg-blue-600 text-white"}`,children:[T.jsx("div",{className:"text-sm",children:O.message}),T.jsxs("div",{className:`text-xs mt-1 ${O.direction==="inbound"?"text-gray-500":"text-blue-100"}`,children:[C(O.timestamp),"  ",N(O)]})]})},O.id))})]},P)})}),Object.keys(A).length===0&&T.jsxs("div",{className:"text-center py-12",children:[T.jsx("div",{className:"text-gray-500 text-lg",children:"No AI conversations found"}),T.jsx("div",{className:"text-gray-400 text-sm mt-2",children:"AI conversations will appear here when customers text your business number"})]})]})},sG=()=>T.jsx("div",{className:"p-6",children:T.jsx(iG,{})});function oG(){const{db:t}=Jn(),[e,n]=D.useState(null),[r,i]=D.useState(null);return D.useEffect(()=>zK(t,n),[]),D.useEffect(()=>cV(t,i),[]),T.jsxs("div",{className:"grid gap-6",children:[T.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-6",children:[T.jsx("h2",{className:"font-serif text-xl mb-4",children:"Analytics Targets"}),e?T.jsx(aG,{initial:e}):T.jsx("div",{className:"text-slate-500 text-sm",children:"Loading targets"})]}),T.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-6",children:[T.jsx("h2",{className:"font-serif text-xl mb-4",children:"Business Hours"}),r?T.jsx(uG,{initial:r}):T.jsx("div",{className:"text-slate-500 text-sm",children:"Loading business hours"})]})]})}function aG({initial:t}){const[e,n]=D.useState(t.dailyTarget),[r,i]=D.useState(t.weeklyTarget),[s,o]=D.useState(t.monthlyTarget),[l,u]=D.useState(t.defaultCogsRate),[h,f]=D.useState(!1),[p,g]=D.useState("");async function I(){try{f(!0),g(""),await qK(db,{dailyTarget:e,weeklyTarget:r,monthlyTarget:s,defaultCogsRate:l}),g("Saved")}catch(A){g((A==null?void 0:A.message)||"Failed to save")}finally{f(!1)}}return T.jsxs("div",{className:"grid gap-3 max-w-xl",children:[T.jsxs("label",{className:"grid grid-cols-[160px_1fr] items-center gap-2",children:[T.jsx("span",{className:"text-sm text-slate-600",children:"Daily target ($)"}),T.jsx("input",{type:"number",min:0,className:"border rounded-md p-2",value:e,onChange:A=>n(parseFloat(A.target.value||"0"))})]}),T.jsxs("label",{className:"grid grid-cols-[160px_1fr] items-center gap-2",children:[T.jsx("span",{className:"text-sm text-slate-600",children:"Weekly target ($)"}),T.jsx("input",{type:"number",min:0,className:"border rounded-md p-2",value:r,onChange:A=>i(parseFloat(A.target.value||"0"))})]}),T.jsxs("label",{className:"grid grid-cols-[160px_1fr] items-center gap-2",children:[T.jsx("span",{className:"text-sm text-slate-600",children:"Monthly target ($)"}),T.jsx("input",{type:"number",min:0,className:"border rounded-md p-2",value:s,onChange:A=>o(parseFloat(A.target.value||"0"))})]}),T.jsxs("label",{className:"grid grid-cols-[160px_1fr] items-center gap-2",children:[T.jsx("span",{className:"text-sm text-slate-600",children:"Default COGS rate (%)"}),T.jsx("input",{type:"number",min:0,max:100,step:.1,className:"border rounded-md p-2",value:l,onChange:A=>u(parseFloat(A.target.value||"0"))})]}),T.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[T.jsx("button",{className:"bg-terracotta text-white rounded-md px-4 py-2",onClick:I,disabled:h,children:h?"Saving":"Save targets"}),p&&T.jsx("span",{className:"text-sm text-slate-600",children:p})]})]})}const lG=["sun","mon","tue","wed","thu","fri","sat"],t_={sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"};function uG({initial:t}){const[e,n]=D.useState(t.timezone),[r,i]=D.useState(t.slotInterval),[s,o]=D.useState(()=>JSON.parse(JSON.stringify(t.slots))),[l,u]=D.useState(!1),[h,f]=D.useState("");function p(C){const N=structuredClone(s);(N[C]||(N[C]=[])).push(["09:00","17:00"]),o(N)}function g(C,N){const P=structuredClone(s);P[C].splice(N,1),o(P)}function I(C,N,P,R){const x=R.trim(),O=structuredClone(s);O[C][N][P]=x,o(O)}async function A(){try{u(!0),f(""),hG({timezone:e,slotInterval:r,slots:s}),await WK(db,{timezone:e,slotInterval:r,slots:s}),f("Saved")}catch(C){f((C==null?void 0:C.message)||"Failed to save")}finally{u(!1)}}return T.jsxs("div",{className:"grid gap-6",children:[T.jsxs("div",{className:"grid sm:grid-cols-2 gap-3 max-w-3xl",children:[T.jsxs("label",{className:"grid grid-cols-[140px_1fr] items-center gap-2",children:[T.jsx("span",{className:"text-sm text-slate-600",children:"Timezone (IANA)"}),T.jsx("input",{className:"border rounded-md p-2",placeholder:"America/Los_Angeles",value:e,onChange:C=>n(C.target.value)})]}),T.jsxs("label",{className:"grid grid-cols-[160px_1fr] items-center gap-2",children:[T.jsx("span",{className:"text-sm text-slate-600",children:"Slot interval (min)"}),T.jsx("input",{type:"number",min:5,step:5,className:"border rounded-md p-2",value:r,onChange:C=>i(parseInt(C.target.value||"15"))})]})]}),T.jsx("div",{className:"grid gap-4",children:lG.map(C=>T.jsxs("div",{className:"border rounded-xl p-4",children:[T.jsxs("div",{className:"flex items-center justify-between mb-3",children:[T.jsx("h3",{className:"font-serif text-lg",children:t_[C]}),T.jsx("button",{className:"text-terracotta",onClick:()=>p(C),children:"+ Add range"})]}),(s[C]||[]).length===0&&T.jsx("div",{className:"text-slate-500 text-sm",children:"Closed"}),T.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-2",children:(s[C]||[]).map((N,P)=>T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("input",{className:"border rounded-md p-2 w-28",placeholder:"09:00",value:N[0],onChange:R=>I(C,P,0,R.target.value),"aria-label":`${t_[C]} start ${P+1}`}),T.jsx("span",{children:""}),T.jsx("input",{className:"border rounded-md p-2 w-28",placeholder:"17:00",value:N[1],onChange:R=>I(C,P,1,R.target.value),"aria-label":`${t_[C]} end ${P+1}`}),T.jsx("button",{className:"text-red-600",onClick:()=>g(C,P),children:"Remove"})]},P))})]},C))}),T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("button",{className:"bg-terracotta text-white rounded-md px-4 py-2",onClick:A,disabled:l,children:l?"Saving":"Save business hours"}),h&&T.jsx("span",{className:"text-sm text-slate-600",children:h})]}),T.jsx(cG,{bh:{timezone:e,slotInterval:r,slots:s}})]})}function cG({bh:t}){const[e,n]=D.useState(()=>new Date().toISOString().slice(0,10)),[r,i]=D.useState(60),[s,o]=D.useState([]),l=D.useMemo(()=>new Date(e+"T00:00:00"),[e]);D.useEffect(()=>UK(db,l,o),[l]);const u=D.useMemo(()=>$f(l,r,t,s),[l,r,t,s]);return T.jsxs("div",{className:"border rounded-xl p-4",children:[T.jsxs("div",{className:"flex flex-wrap items-end gap-3 mb-3",children:[T.jsxs("div",{children:[T.jsx("div",{className:"text-sm text-slate-600",children:"Preview date"}),T.jsx("input",{type:"date",className:"border rounded-md p-2",value:e,onChange:h=>n(h.target.value)})]}),T.jsxs("label",{className:"grid grid-cols-[160px_1fr] items-center gap-2",children:[T.jsx("span",{className:"text-sm text-slate-600",children:"Service duration (min)"}),T.jsx("input",{type:"number",min:5,step:5,className:"border rounded-md p-2",value:r,onChange:h=>i(parseInt(h.target.value||"0"))})]})]}),T.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[u.map(h=>T.jsx("div",{className:"border rounded-md py-2 text-center text-sm",children:Dn(Kp(h),"h:mm a")},h)),!u.length&&T.jsx("div",{className:"text-slate-500 text-sm",children:"No slots under current hours."})]})]})}function hG(t){if(!t.timezone||!t.timezone.includes("/"))throw new Error('Timezone must be a valid IANA zone, e.g. "America/Los_Angeles"');if(!Number.isFinite(t.slotInterval)||t.slotInterval<=0)throw new Error("Slot interval must be a positive number");const e=/^([01]\d|2[0-3]):([0-5]\d)$/;["sun","mon","tue","wed","thu","fri","sat"].forEach(n=>{for(const[r,i]of t.slots[n]||[]){if(!e.test(r)||!e.test(i))throw new Error(`Invalid time on ${n}: use HH:MM`);if(r>=i)throw new Error(`${n}: start must be before end`)}})}function dG(){return T.jsx(KB,{children:T.jsxs("div",{className:"min-h-screen grid",style:{gridTemplateRows:"56px 1fr"},children:[T.jsx(YB,{}),T.jsxs("div",{className:"grid",style:{gridTemplateColumns:"224px 1fr"},children:[T.jsx(QB,{}),T.jsx("main",{className:"p-6",children:T.jsxs(PM,{children:[T.jsx(pr,{index:!0,element:T.jsx(lI,{to:"home",replace:!0})}),T.jsx(pr,{path:"home",element:T.jsx(mH,{})}),T.jsx(pr,{path:"schedule",element:T.jsx(GK,{})}),T.jsx(pr,{path:"customers",element:T.jsx(QK,{})}),T.jsx(pr,{path:"services",element:T.jsx(XK,{})}),T.jsx(pr,{path:"messages",element:T.jsx(tG,{})}),T.jsx(pr,{path:"sms",element:T.jsx(rG,{})}),T.jsx(pr,{path:"ai-conversations",element:T.jsx(sG,{})}),T.jsx(pr,{path:"settings",element:T.jsx(oG,{})}),T.jsx(pr,{path:"*",element:T.jsx(lI,{to:"home",replace:!0})})]})})]})]})})}r_.createRoot(document.getElementById("root")).render(T.jsx(le.StrictMode,{children:T.jsx(C3,{children:T.jsx(VM,{children:T.jsx(dG,{})})})}));
