function bN(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function SN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ix={exports:{}},ud={},ox={exports:{}},ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var El=Symbol.for("react.element"),IN=Symbol.for("react.portal"),NN=Symbol.for("react.fragment"),CN=Symbol.for("react.strict_mode"),kN=Symbol.for("react.profiler"),AN=Symbol.for("react.provider"),PN=Symbol.for("react.context"),RN=Symbol.for("react.forward_ref"),jN=Symbol.for("react.suspense"),DN=Symbol.for("react.memo"),ON=Symbol.for("react.lazy"),yy=Symbol.iterator;function MN(t){return t===null||typeof t!="object"?null:(t=yy&&t[yy]||t["@@iterator"],typeof t=="function"?t:null)}var ax={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lx=Object.assign,ux={};function bo(t,e,n){this.props=t,this.context=e,this.refs=ux,this.updater=n||ax}bo.prototype.isReactComponent={};bo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};bo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function cx(){}cx.prototype=bo.prototype;function fp(t,e,n){this.props=t,this.context=e,this.refs=ux,this.updater=n||ax}var mp=fp.prototype=new cx;mp.constructor=fp;lx(mp,bo.prototype);mp.isPureReactComponent=!0;var _y=Array.isArray,dx=Object.prototype.hasOwnProperty,pp={current:null},hx={key:!0,ref:!0,__self:!0,__source:!0};function fx(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)dx.call(e,r)&&!hx.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:El,type:t,key:i,ref:o,props:s,_owner:pp.current}}function LN(t,e){return{$$typeof:El,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function gp(t){return typeof t=="object"&&t!==null&&t.$$typeof===El}function VN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var wy=/\/+/g;function jh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?VN(""+t.key):e.toString(36)}function $u(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case El:case IN:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+jh(o,0):r,_y(s)?(n="",t!=null&&(n=t.replace(wy,"$&/")+"/"),$u(s,e,n,"",function(d){return d})):s!=null&&(gp(s)&&(s=LN(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(wy,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",_y(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+jh(i,a);o+=$u(i,e,n,l,s)}else if(l=MN(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+jh(i,a++),o+=$u(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function hu(t,e,n){if(t==null)return t;var r=[],s=0;return $u(t,r,"","",function(i){return e.call(n,i,s++)}),r}function FN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ft={current:null},Bu={transition:null},UN={ReactCurrentDispatcher:Ft,ReactCurrentBatchConfig:Bu,ReactCurrentOwner:pp};function mx(){throw Error("act(...) is not supported in production builds of React.")}ue.Children={map:hu,forEach:function(t,e,n){hu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return hu(t,function(){e++}),e},toArray:function(t){return hu(t,function(e){return e})||[]},only:function(t){if(!gp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ue.Component=bo;ue.Fragment=NN;ue.Profiler=kN;ue.PureComponent=fp;ue.StrictMode=CN;ue.Suspense=jN;ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UN;ue.act=mx;ue.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=lx({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=pp.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)dx.call(e,l)&&!hx.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:El,type:t.type,key:s,ref:i,props:r,_owner:o}};ue.createContext=function(t){return t={$$typeof:PN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:AN,_context:t},t.Consumer=t};ue.createElement=fx;ue.createFactory=function(t){var e=fx.bind(null,t);return e.type=t,e};ue.createRef=function(){return{current:null}};ue.forwardRef=function(t){return{$$typeof:RN,render:t}};ue.isValidElement=gp;ue.lazy=function(t){return{$$typeof:ON,_payload:{_status:-1,_result:t},_init:FN}};ue.memo=function(t,e){return{$$typeof:DN,type:t,compare:e===void 0?null:e}};ue.startTransition=function(t){var e=Bu.transition;Bu.transition={};try{t()}finally{Bu.transition=e}};ue.unstable_act=mx;ue.useCallback=function(t,e){return Ft.current.useCallback(t,e)};ue.useContext=function(t){return Ft.current.useContext(t)};ue.useDebugValue=function(){};ue.useDeferredValue=function(t){return Ft.current.useDeferredValue(t)};ue.useEffect=function(t,e){return Ft.current.useEffect(t,e)};ue.useId=function(){return Ft.current.useId()};ue.useImperativeHandle=function(t,e,n){return Ft.current.useImperativeHandle(t,e,n)};ue.useInsertionEffect=function(t,e){return Ft.current.useInsertionEffect(t,e)};ue.useLayoutEffect=function(t,e){return Ft.current.useLayoutEffect(t,e)};ue.useMemo=function(t,e){return Ft.current.useMemo(t,e)};ue.useReducer=function(t,e,n){return Ft.current.useReducer(t,e,n)};ue.useRef=function(t){return Ft.current.useRef(t)};ue.useState=function(t){return Ft.current.useState(t)};ue.useSyncExternalStore=function(t,e,n){return Ft.current.useSyncExternalStore(t,e,n)};ue.useTransition=function(){return Ft.current.useTransition()};ue.version="18.3.1";ox.exports=ue;var _=ox.exports;const ne=SN(_),Df=bN({__proto__:null,default:ne},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $N=_,BN=Symbol.for("react.element"),zN=Symbol.for("react.fragment"),WN=Object.prototype.hasOwnProperty,HN=$N.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qN={key:!0,ref:!0,__self:!0,__source:!0};function px(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)WN.call(e,r)&&!qN.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:BN,type:t,key:i,ref:o,props:s,_owner:HN.current}}ud.Fragment=zN;ud.jsx=px;ud.jsxs=px;ix.exports=ud;var u=ix.exports,Of={},gx={exports:{}},un={},vx={exports:{}},yx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,G){var Y=U.length;U.push(G);e:for(;0<Y;){var se=Y-1>>>1,Z=U[se];if(0<s(Z,G))U[se]=G,U[Y]=Z,Y=se;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var G=U[0],Y=U.pop();if(Y!==G){U[0]=Y;e:for(var se=0,Z=U.length,K=Z>>>1;se<K;){var He=2*(se+1)-1,B=U[He],ie=He+1,le=U[ie];if(0>s(B,Y))ie<Z&&0>s(le,B)?(U[se]=le,U[ie]=Y,se=ie):(U[se]=B,U[He]=Y,se=He);else if(ie<Z&&0>s(le,Y))U[se]=le,U[ie]=Y,se=ie;else break e}}return G}function s(U,G){var Y=U.sortIndex-G.sortIndex;return Y!==0?Y:U.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],h=1,m=null,p=3,x=!1,v=!1,C=!1,A=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var G=n(d);G!==null;){if(G.callback===null)r(d);else if(G.startTime<=U)r(d),G.sortIndex=G.expirationTime,e(l,G);else break;G=n(d)}}function N(U){if(C=!1,w(U),!v)if(n(l)!==null)v=!0,he(j);else{var G=n(d);G!==null&&ae(N,G.startTime-U)}}function j(U,G){v=!1,C&&(C=!1,T(E),E=-1),x=!0;var Y=p;try{for(w(G),m=n(l);m!==null&&(!(m.expirationTime>G)||U&&!R());){var se=m.callback;if(typeof se=="function"){m.callback=null,p=m.priorityLevel;var Z=se(m.expirationTime<=G);G=t.unstable_now(),typeof Z=="function"?m.callback=Z:m===n(l)&&r(l),w(G)}else r(l);m=n(l)}if(m!==null)var K=!0;else{var He=n(d);He!==null&&ae(N,He.startTime-G),K=!1}return K}finally{m=null,p=Y,x=!1}}var D=!1,b=null,E=-1,I=5,k=-1;function R(){return!(t.unstable_now()-k<I)}function O(){if(b!==null){var U=t.unstable_now();k=U;var G=!0;try{G=b(!0,U)}finally{G?P():(D=!1,b=null)}}else D=!1}var P;if(typeof y=="function")P=function(){y(O)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,H=Se.port2;Se.port1.onmessage=O,P=function(){H.postMessage(null)}}else P=function(){A(O,0)};function he(U){b=U,D||(D=!0,P())}function ae(U,G){E=A(function(){U(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){v||x||(v=!0,he(j))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(U){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var Y=p;p=G;try{return U()}finally{p=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,G){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var Y=p;p=U;try{return G()}finally{p=Y}},t.unstable_scheduleCallback=function(U,G,Y){var se=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?se+Y:se):Y=se,U){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=Y+Z,U={id:h++,callback:G,priorityLevel:U,startTime:Y,expirationTime:Z,sortIndex:-1},Y>se?(U.sortIndex=Y,e(d,U),n(l)===null&&U===n(d)&&(C?(T(E),E=-1):C=!0,ae(N,Y-se))):(U.sortIndex=Z,e(l,U),v||x||(v=!0,he(j))),U},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(U){var G=p;return function(){var Y=p;p=G;try{return U.apply(this,arguments)}finally{p=Y}}}})(yx);vx.exports=yx;var GN=vx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KN=_,an=GN;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _x=new Set,Wa={};function yi(t,e){lo(t,e),lo(t+"Capture",e)}function lo(t,e){for(Wa[t]=e,t=0;t<e.length;t++)_x.add(e[t])}var yr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mf=Object.prototype.hasOwnProperty,QN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xy={},Ey={};function YN(t){return Mf.call(Ey,t)?!0:Mf.call(xy,t)?!1:QN.test(t)?Ey[t]=!0:(xy[t]=!0,!1)}function XN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function JN(t,e,n,r){if(e===null||typeof e>"u"||XN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ut(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var _t={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_t[t]=new Ut(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];_t[e]=new Ut(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){_t[t]=new Ut(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_t[t]=new Ut(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_t[t]=new Ut(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){_t[t]=new Ut(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){_t[t]=new Ut(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){_t[t]=new Ut(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){_t[t]=new Ut(t,5,!1,t.toLowerCase(),null,!1,!1)});var vp=/[\-:]([a-z])/g;function yp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(vp,yp);_t[e]=new Ut(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(vp,yp);_t[e]=new Ut(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(vp,yp);_t[e]=new Ut(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){_t[t]=new Ut(t,1,!1,t.toLowerCase(),null,!1,!1)});_t.xlinkHref=new Ut("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){_t[t]=new Ut(t,1,!1,t.toLowerCase(),null,!0,!0)});function _p(t,e,n,r){var s=_t.hasOwnProperty(e)?_t[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JN(e,n,s,r)&&(n=null),r||s===null?YN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var kr=KN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fu=Symbol.for("react.element"),Fi=Symbol.for("react.portal"),Ui=Symbol.for("react.fragment"),wp=Symbol.for("react.strict_mode"),Lf=Symbol.for("react.profiler"),wx=Symbol.for("react.provider"),xx=Symbol.for("react.context"),xp=Symbol.for("react.forward_ref"),Vf=Symbol.for("react.suspense"),Ff=Symbol.for("react.suspense_list"),Ep=Symbol.for("react.memo"),Br=Symbol.for("react.lazy"),Ex=Symbol.for("react.offscreen"),Ty=Symbol.iterator;function Xo(t){return t===null||typeof t!="object"?null:(t=Ty&&t[Ty]||t["@@iterator"],typeof t=="function"?t:null)}var Fe=Object.assign,Dh;function ca(t){if(Dh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Dh=e&&e[1]||""}return`
`+Dh+t}var Oh=!1;function Mh(t,e){if(!t||Oh)return"";Oh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Oh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ca(t):""}function ZN(t){switch(t.tag){case 5:return ca(t.type);case 16:return ca("Lazy");case 13:return ca("Suspense");case 19:return ca("SuspenseList");case 0:case 2:case 15:return t=Mh(t.type,!1),t;case 11:return t=Mh(t.type.render,!1),t;case 1:return t=Mh(t.type,!0),t;default:return""}}function Uf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ui:return"Fragment";case Fi:return"Portal";case Lf:return"Profiler";case wp:return"StrictMode";case Vf:return"Suspense";case Ff:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xx:return(t.displayName||"Context")+".Consumer";case wx:return(t._context.displayName||"Context")+".Provider";case xp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ep:return e=t.displayName||null,e!==null?e:Uf(t.type)||"Memo";case Br:e=t._payload,t=t._init;try{return Uf(t(e))}catch{}}return null}function eC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Uf(e);case 8:return e===wp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ys(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Tx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function tC(t){var e=Tx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function mu(t){t._valueTracker||(t._valueTracker=tC(t))}function bx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Tx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function dc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function $f(t,e){var n=e.checked;return Fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function by(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ys(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Sx(t,e){e=e.checked,e!=null&&_p(t,"checked",e,!1)}function Bf(t,e){Sx(t,e);var n=ys(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?zf(t,e.type,n):e.hasOwnProperty("defaultValue")&&zf(t,e.type,ys(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Sy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function zf(t,e,n){(e!=="number"||dc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var da=Array.isArray;function Ji(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ys(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Wf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return Fe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Iy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error($(92));if(da(n)){if(1<n.length)throw Error($(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ys(n)}}function Ix(t,e){var n=ys(e.value),r=ys(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ny(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Nx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Nx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var pu,Cx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(pu=pu||document.createElement("div"),pu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=pu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ha(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ta={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nC=["Webkit","ms","Moz","O"];Object.keys(Ta).forEach(function(t){nC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ta[e]=Ta[t]})});function kx(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ta.hasOwnProperty(t)&&Ta[t]?(""+e).trim():e+"px"}function Ax(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=kx(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var rC=Fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qf(t,e){if(e){if(rC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function Gf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kf=null;function Tp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Qf=null,Zi=null,eo=null;function Cy(t){if(t=Sl(t)){if(typeof Qf!="function")throw Error($(280));var e=t.stateNode;e&&(e=md(e),Qf(t.stateNode,t.type,e))}}function Px(t){Zi?eo?eo.push(t):eo=[t]:Zi=t}function Rx(){if(Zi){var t=Zi,e=eo;if(eo=Zi=null,Cy(t),e)for(t=0;t<e.length;t++)Cy(e[t])}}function jx(t,e){return t(e)}function Dx(){}var Lh=!1;function Ox(t,e,n){if(Lh)return t(e,n);Lh=!0;try{return jx(t,e,n)}finally{Lh=!1,(Zi!==null||eo!==null)&&(Dx(),Rx())}}function qa(t,e){var n=t.stateNode;if(n===null)return null;var r=md(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error($(231,e,typeof n));return n}var Yf=!1;if(yr)try{var Jo={};Object.defineProperty(Jo,"passive",{get:function(){Yf=!0}}),window.addEventListener("test",Jo,Jo),window.removeEventListener("test",Jo,Jo)}catch{Yf=!1}function sC(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var ba=!1,hc=null,fc=!1,Xf=null,iC={onError:function(t){ba=!0,hc=t}};function oC(t,e,n,r,s,i,o,a,l){ba=!1,hc=null,sC.apply(iC,arguments)}function aC(t,e,n,r,s,i,o,a,l){if(oC.apply(this,arguments),ba){if(ba){var d=hc;ba=!1,hc=null}else throw Error($(198));fc||(fc=!0,Xf=d)}}function _i(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Mx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ky(t){if(_i(t)!==t)throw Error($(188))}function lC(t){var e=t.alternate;if(!e){if(e=_i(t),e===null)throw Error($(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return ky(s),t;if(i===r)return ky(s),e;i=i.sibling}throw Error($(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?t:e}function Lx(t){return t=lC(t),t!==null?Vx(t):null}function Vx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Vx(t);if(e!==null)return e;t=t.sibling}return null}var Fx=an.unstable_scheduleCallback,Ay=an.unstable_cancelCallback,uC=an.unstable_shouldYield,cC=an.unstable_requestPaint,Ke=an.unstable_now,dC=an.unstable_getCurrentPriorityLevel,bp=an.unstable_ImmediatePriority,Ux=an.unstable_UserBlockingPriority,mc=an.unstable_NormalPriority,hC=an.unstable_LowPriority,$x=an.unstable_IdlePriority,cd=null,Wn=null;function fC(t){if(Wn&&typeof Wn.onCommitFiberRoot=="function")try{Wn.onCommitFiberRoot(cd,t,void 0,(t.current.flags&128)===128)}catch{}}var kn=Math.clz32?Math.clz32:gC,mC=Math.log,pC=Math.LN2;function gC(t){return t>>>=0,t===0?32:31-(mC(t)/pC|0)|0}var gu=64,vu=4194304;function ha(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=ha(a):(i&=o,i!==0&&(r=ha(i)))}else o=n&~s,o!==0?r=ha(o):i!==0&&(r=ha(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-kn(e),s=1<<n,r|=t[n],e&=~s;return r}function vC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yC(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-kn(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=vC(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Jf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Bx(){var t=gu;return gu<<=1,!(gu&4194240)&&(gu=64),t}function Vh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Tl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-kn(e),t[e]=n}function _C(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-kn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Sp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-kn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var we=0;function zx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Wx,Ip,Hx,qx,Gx,Zf=!1,yu=[],ss=null,is=null,os=null,Ga=new Map,Ka=new Map,Wr=[],wC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Py(t,e){switch(t){case"focusin":case"focusout":ss=null;break;case"dragenter":case"dragleave":is=null;break;case"mouseover":case"mouseout":os=null;break;case"pointerover":case"pointerout":Ga.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ka.delete(e.pointerId)}}function Zo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Sl(e),e!==null&&Ip(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function xC(t,e,n,r,s){switch(e){case"focusin":return ss=Zo(ss,t,e,n,r,s),!0;case"dragenter":return is=Zo(is,t,e,n,r,s),!0;case"mouseover":return os=Zo(os,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ga.set(i,Zo(Ga.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ka.set(i,Zo(Ka.get(i)||null,t,e,n,r,s)),!0}return!1}function Kx(t){var e=Ks(t.target);if(e!==null){var n=_i(e);if(n!==null){if(e=n.tag,e===13){if(e=Mx(n),e!==null){t.blockedOn=e,Gx(t.priority,function(){Hx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function zu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=em(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Kf=r,n.target.dispatchEvent(r),Kf=null}else return e=Sl(n),e!==null&&Ip(e),t.blockedOn=n,!1;e.shift()}return!0}function Ry(t,e,n){zu(t)&&n.delete(e)}function EC(){Zf=!1,ss!==null&&zu(ss)&&(ss=null),is!==null&&zu(is)&&(is=null),os!==null&&zu(os)&&(os=null),Ga.forEach(Ry),Ka.forEach(Ry)}function ea(t,e){t.blockedOn===e&&(t.blockedOn=null,Zf||(Zf=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,EC)))}function Qa(t){function e(s){return ea(s,t)}if(0<yu.length){ea(yu[0],t);for(var n=1;n<yu.length;n++){var r=yu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ss!==null&&ea(ss,t),is!==null&&ea(is,t),os!==null&&ea(os,t),Ga.forEach(e),Ka.forEach(e),n=0;n<Wr.length;n++)r=Wr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Wr.length&&(n=Wr[0],n.blockedOn===null);)Kx(n),n.blockedOn===null&&Wr.shift()}var to=kr.ReactCurrentBatchConfig,gc=!0;function TC(t,e,n,r){var s=we,i=to.transition;to.transition=null;try{we=1,Np(t,e,n,r)}finally{we=s,to.transition=i}}function bC(t,e,n,r){var s=we,i=to.transition;to.transition=null;try{we=4,Np(t,e,n,r)}finally{we=s,to.transition=i}}function Np(t,e,n,r){if(gc){var s=em(t,e,n,r);if(s===null)Kh(t,e,r,vc,n),Py(t,r);else if(xC(s,t,e,n,r))r.stopPropagation();else if(Py(t,r),e&4&&-1<wC.indexOf(t)){for(;s!==null;){var i=Sl(s);if(i!==null&&Wx(i),i=em(t,e,n,r),i===null&&Kh(t,e,r,vc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Kh(t,e,r,null,n)}}var vc=null;function em(t,e,n,r){if(vc=null,t=Tp(r),t=Ks(t),t!==null)if(e=_i(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Mx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return vc=t,null}function Qx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dC()){case bp:return 1;case Ux:return 4;case mc:case hC:return 16;case $x:return 536870912;default:return 16}default:return 16}}var Jr=null,Cp=null,Wu=null;function Yx(){if(Wu)return Wu;var t,e=Cp,n=e.length,r,s="value"in Jr?Jr.value:Jr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Wu=s.slice(t,1<r?1-r:void 0)}function Hu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _u(){return!0}function jy(){return!1}function cn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?_u:jy,this.isPropagationStopped=jy,this}return Fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_u)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_u)},persist:function(){},isPersistent:_u}),e}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kp=cn(So),bl=Fe({},So,{view:0,detail:0}),SC=cn(bl),Fh,Uh,ta,dd=Fe({},bl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ap,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ta&&(ta&&t.type==="mousemove"?(Fh=t.screenX-ta.screenX,Uh=t.screenY-ta.screenY):Uh=Fh=0,ta=t),Fh)},movementY:function(t){return"movementY"in t?t.movementY:Uh}}),Dy=cn(dd),IC=Fe({},dd,{dataTransfer:0}),NC=cn(IC),CC=Fe({},bl,{relatedTarget:0}),$h=cn(CC),kC=Fe({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),AC=cn(kC),PC=Fe({},So,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),RC=cn(PC),jC=Fe({},So,{data:0}),Oy=cn(jC),DC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},OC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=MC[t])?!!e[t]:!1}function Ap(){return LC}var VC=Fe({},bl,{key:function(t){if(t.key){var e=DC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Hu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?OC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ap,charCode:function(t){return t.type==="keypress"?Hu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Hu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),FC=cn(VC),UC=Fe({},dd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),My=cn(UC),$C=Fe({},bl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ap}),BC=cn($C),zC=Fe({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),WC=cn(zC),HC=Fe({},dd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),qC=cn(HC),GC=[9,13,27,32],Pp=yr&&"CompositionEvent"in window,Sa=null;yr&&"documentMode"in document&&(Sa=document.documentMode);var KC=yr&&"TextEvent"in window&&!Sa,Xx=yr&&(!Pp||Sa&&8<Sa&&11>=Sa),Ly=" ",Vy=!1;function Jx(t,e){switch(t){case"keyup":return GC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $i=!1;function QC(t,e){switch(t){case"compositionend":return Zx(e);case"keypress":return e.which!==32?null:(Vy=!0,Ly);case"textInput":return t=e.data,t===Ly&&Vy?null:t;default:return null}}function YC(t,e){if($i)return t==="compositionend"||!Pp&&Jx(t,e)?(t=Yx(),Wu=Cp=Jr=null,$i=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Xx&&e.locale!=="ko"?null:e.data;default:return null}}var XC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!XC[t.type]:e==="textarea"}function eE(t,e,n,r){Px(r),e=yc(e,"onChange"),0<e.length&&(n=new kp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ia=null,Ya=null;function JC(t){dE(t,0)}function hd(t){var e=Wi(t);if(bx(e))return t}function ZC(t,e){if(t==="change")return e}var tE=!1;if(yr){var Bh;if(yr){var zh="oninput"in document;if(!zh){var Uy=document.createElement("div");Uy.setAttribute("oninput","return;"),zh=typeof Uy.oninput=="function"}Bh=zh}else Bh=!1;tE=Bh&&(!document.documentMode||9<document.documentMode)}function $y(){Ia&&(Ia.detachEvent("onpropertychange",nE),Ya=Ia=null)}function nE(t){if(t.propertyName==="value"&&hd(Ya)){var e=[];eE(e,Ya,t,Tp(t)),Ox(JC,e)}}function ek(t,e,n){t==="focusin"?($y(),Ia=e,Ya=n,Ia.attachEvent("onpropertychange",nE)):t==="focusout"&&$y()}function tk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return hd(Ya)}function nk(t,e){if(t==="click")return hd(e)}function rk(t,e){if(t==="input"||t==="change")return hd(e)}function sk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var jn=typeof Object.is=="function"?Object.is:sk;function Xa(t,e){if(jn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Mf.call(e,s)||!jn(t[s],e[s]))return!1}return!0}function By(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zy(t,e){var n=By(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=By(n)}}function rE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?rE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function sE(){for(var t=window,e=dc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=dc(t.document)}return e}function Rp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function ik(t){var e=sE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&rE(n.ownerDocument.documentElement,n)){if(r!==null&&Rp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=zy(n,i);var o=zy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ok=yr&&"documentMode"in document&&11>=document.documentMode,Bi=null,tm=null,Na=null,nm=!1;function Wy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nm||Bi==null||Bi!==dc(r)||(r=Bi,"selectionStart"in r&&Rp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Na&&Xa(Na,r)||(Na=r,r=yc(tm,"onSelect"),0<r.length&&(e=new kp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Bi)))}function wu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var zi={animationend:wu("Animation","AnimationEnd"),animationiteration:wu("Animation","AnimationIteration"),animationstart:wu("Animation","AnimationStart"),transitionend:wu("Transition","TransitionEnd")},Wh={},iE={};yr&&(iE=document.createElement("div").style,"AnimationEvent"in window||(delete zi.animationend.animation,delete zi.animationiteration.animation,delete zi.animationstart.animation),"TransitionEvent"in window||delete zi.transitionend.transition);function fd(t){if(Wh[t])return Wh[t];if(!zi[t])return t;var e=zi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in iE)return Wh[t]=e[n];return t}var oE=fd("animationend"),aE=fd("animationiteration"),lE=fd("animationstart"),uE=fd("transitionend"),cE=new Map,Hy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ns(t,e){cE.set(t,e),yi(e,[t])}for(var Hh=0;Hh<Hy.length;Hh++){var qh=Hy[Hh],ak=qh.toLowerCase(),lk=qh[0].toUpperCase()+qh.slice(1);Ns(ak,"on"+lk)}Ns(oE,"onAnimationEnd");Ns(aE,"onAnimationIteration");Ns(lE,"onAnimationStart");Ns("dblclick","onDoubleClick");Ns("focusin","onFocus");Ns("focusout","onBlur");Ns(uE,"onTransitionEnd");lo("onMouseEnter",["mouseout","mouseover"]);lo("onMouseLeave",["mouseout","mouseover"]);lo("onPointerEnter",["pointerout","pointerover"]);lo("onPointerLeave",["pointerout","pointerover"]);yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yi("onBeforeInput",["compositionend","keypress","textInput","paste"]);yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uk=new Set("cancel close invalid load scroll toggle".split(" ").concat(fa));function qy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,aC(r,e,void 0,t),t.currentTarget=null}function dE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;qy(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;qy(s,a,d),i=l}}}if(fc)throw t=Xf,fc=!1,Xf=null,t}function Ae(t,e){var n=e[am];n===void 0&&(n=e[am]=new Set);var r=t+"__bubble";n.has(r)||(hE(e,t,2,!1),n.add(r))}function Gh(t,e,n){var r=0;e&&(r|=4),hE(n,t,r,e)}var xu="_reactListening"+Math.random().toString(36).slice(2);function Ja(t){if(!t[xu]){t[xu]=!0,_x.forEach(function(n){n!=="selectionchange"&&(uk.has(n)||Gh(n,!1,t),Gh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[xu]||(e[xu]=!0,Gh("selectionchange",!1,e))}}function hE(t,e,n,r){switch(Qx(e)){case 1:var s=TC;break;case 4:s=bC;break;default:s=Np}n=s.bind(null,e,n,t),s=void 0,!Yf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Kh(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ks(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}Ox(function(){var d=i,h=Tp(n),m=[];e:{var p=cE.get(t);if(p!==void 0){var x=kp,v=t;switch(t){case"keypress":if(Hu(n)===0)break e;case"keydown":case"keyup":x=FC;break;case"focusin":v="focus",x=$h;break;case"focusout":v="blur",x=$h;break;case"beforeblur":case"afterblur":x=$h;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Dy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=NC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=BC;break;case oE:case aE:case lE:x=AC;break;case uE:x=WC;break;case"scroll":x=SC;break;case"wheel":x=qC;break;case"copy":case"cut":case"paste":x=RC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=My}var C=(e&4)!==0,A=!C&&t==="scroll",T=C?p!==null?p+"Capture":null:p;C=[];for(var y=d,w;y!==null;){w=y;var N=w.stateNode;if(w.tag===5&&N!==null&&(w=N,T!==null&&(N=qa(y,T),N!=null&&C.push(Za(y,N,w)))),A)break;y=y.return}0<C.length&&(p=new x(p,v,null,n,h),m.push({event:p,listeners:C}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",p&&n!==Kf&&(v=n.relatedTarget||n.fromElement)&&(Ks(v)||v[_r]))break e;if((x||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,x?(v=n.relatedTarget||n.toElement,x=d,v=v?Ks(v):null,v!==null&&(A=_i(v),v!==A||v.tag!==5&&v.tag!==6)&&(v=null)):(x=null,v=d),x!==v)){if(C=Dy,N="onMouseLeave",T="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(C=My,N="onPointerLeave",T="onPointerEnter",y="pointer"),A=x==null?p:Wi(x),w=v==null?p:Wi(v),p=new C(N,y+"leave",x,n,h),p.target=A,p.relatedTarget=w,N=null,Ks(h)===d&&(C=new C(T,y+"enter",v,n,h),C.target=w,C.relatedTarget=A,N=C),A=N,x&&v)t:{for(C=x,T=v,y=0,w=C;w;w=Ri(w))y++;for(w=0,N=T;N;N=Ri(N))w++;for(;0<y-w;)C=Ri(C),y--;for(;0<w-y;)T=Ri(T),w--;for(;y--;){if(C===T||T!==null&&C===T.alternate)break t;C=Ri(C),T=Ri(T)}C=null}else C=null;x!==null&&Gy(m,p,x,C,!1),v!==null&&A!==null&&Gy(m,A,v,C,!0)}}e:{if(p=d?Wi(d):window,x=p.nodeName&&p.nodeName.toLowerCase(),x==="select"||x==="input"&&p.type==="file")var j=ZC;else if(Fy(p))if(tE)j=rk;else{j=tk;var D=ek}else(x=p.nodeName)&&x.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(j=nk);if(j&&(j=j(t,d))){eE(m,j,n,h);break e}D&&D(t,p,d),t==="focusout"&&(D=p._wrapperState)&&D.controlled&&p.type==="number"&&zf(p,"number",p.value)}switch(D=d?Wi(d):window,t){case"focusin":(Fy(D)||D.contentEditable==="true")&&(Bi=D,tm=d,Na=null);break;case"focusout":Na=tm=Bi=null;break;case"mousedown":nm=!0;break;case"contextmenu":case"mouseup":case"dragend":nm=!1,Wy(m,n,h);break;case"selectionchange":if(ok)break;case"keydown":case"keyup":Wy(m,n,h)}var b;if(Pp)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else $i?Jx(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Xx&&n.locale!=="ko"&&($i||E!=="onCompositionStart"?E==="onCompositionEnd"&&$i&&(b=Yx()):(Jr=h,Cp="value"in Jr?Jr.value:Jr.textContent,$i=!0)),D=yc(d,E),0<D.length&&(E=new Oy(E,t,null,n,h),m.push({event:E,listeners:D}),b?E.data=b:(b=Zx(n),b!==null&&(E.data=b)))),(b=KC?QC(t,n):YC(t,n))&&(d=yc(d,"onBeforeInput"),0<d.length&&(h=new Oy("onBeforeInput","beforeinput",null,n,h),m.push({event:h,listeners:d}),h.data=b))}dE(m,e)})}function Za(t,e,n){return{instance:t,listener:e,currentTarget:n}}function yc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=qa(t,n),i!=null&&r.unshift(Za(t,i,s)),i=qa(t,e),i!=null&&r.push(Za(t,i,s))),t=t.return}return r}function Ri(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Gy(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=qa(n,i),l!=null&&o.unshift(Za(n,l,a))):s||(l=qa(n,i),l!=null&&o.push(Za(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var ck=/\r\n?/g,dk=/\u0000|\uFFFD/g;function Ky(t){return(typeof t=="string"?t:""+t).replace(ck,`
`).replace(dk,"")}function Eu(t,e,n){if(e=Ky(e),Ky(t)!==e&&n)throw Error($(425))}function _c(){}var rm=null,sm=null;function im(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var om=typeof setTimeout=="function"?setTimeout:void 0,hk=typeof clearTimeout=="function"?clearTimeout:void 0,Qy=typeof Promise=="function"?Promise:void 0,fk=typeof queueMicrotask=="function"?queueMicrotask:typeof Qy<"u"?function(t){return Qy.resolve(null).then(t).catch(mk)}:om;function mk(t){setTimeout(function(){throw t})}function Qh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Qa(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Qa(e)}function as(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Yy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Io=Math.random().toString(36).slice(2),Bn="__reactFiber$"+Io,el="__reactProps$"+Io,_r="__reactContainer$"+Io,am="__reactEvents$"+Io,pk="__reactListeners$"+Io,gk="__reactHandles$"+Io;function Ks(t){var e=t[Bn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[_r]||n[Bn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Yy(t);t!==null;){if(n=t[Bn])return n;t=Yy(t)}return e}t=n,n=t.parentNode}return null}function Sl(t){return t=t[Bn]||t[_r],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Wi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function md(t){return t[el]||null}var lm=[],Hi=-1;function Cs(t){return{current:t}}function Re(t){0>Hi||(t.current=lm[Hi],lm[Hi]=null,Hi--)}function Ce(t,e){Hi++,lm[Hi]=t.current,t.current=e}var _s={},Pt=Cs(_s),Ht=Cs(!1),si=_s;function uo(t,e){var n=t.type.contextTypes;if(!n)return _s;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function qt(t){return t=t.childContextTypes,t!=null}function wc(){Re(Ht),Re(Pt)}function Xy(t,e,n){if(Pt.current!==_s)throw Error($(168));Ce(Pt,e),Ce(Ht,n)}function fE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error($(108,eC(t)||"Unknown",s));return Fe({},n,r)}function xc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_s,si=Pt.current,Ce(Pt,t),Ce(Ht,Ht.current),!0}function Jy(t,e,n){var r=t.stateNode;if(!r)throw Error($(169));n?(t=fE(t,e,si),r.__reactInternalMemoizedMergedChildContext=t,Re(Ht),Re(Pt),Ce(Pt,t)):Re(Ht),Ce(Ht,n)}var ir=null,pd=!1,Yh=!1;function mE(t){ir===null?ir=[t]:ir.push(t)}function vk(t){pd=!0,mE(t)}function ks(){if(!Yh&&ir!==null){Yh=!0;var t=0,e=we;try{var n=ir;for(we=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ir=null,pd=!1}catch(s){throw ir!==null&&(ir=ir.slice(t+1)),Fx(bp,ks),s}finally{we=e,Yh=!1}}return null}var qi=[],Gi=0,Ec=null,Tc=0,fn=[],mn=0,ii=null,ar=1,lr="";function Bs(t,e){qi[Gi++]=Tc,qi[Gi++]=Ec,Ec=t,Tc=e}function pE(t,e,n){fn[mn++]=ar,fn[mn++]=lr,fn[mn++]=ii,ii=t;var r=ar;t=lr;var s=32-kn(r)-1;r&=~(1<<s),n+=1;var i=32-kn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ar=1<<32-kn(e)+s|n<<s|r,lr=i+t}else ar=1<<i|n<<s|r,lr=t}function jp(t){t.return!==null&&(Bs(t,1),pE(t,1,0))}function Dp(t){for(;t===Ec;)Ec=qi[--Gi],qi[Gi]=null,Tc=qi[--Gi],qi[Gi]=null;for(;t===ii;)ii=fn[--mn],fn[mn]=null,lr=fn[--mn],fn[mn]=null,ar=fn[--mn],fn[mn]=null}var sn=null,tn=null,je=!1,Sn=null;function gE(t,e){var n=pn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Zy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,sn=t,tn=as(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,sn=t,tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ii!==null?{id:ar,overflow:lr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=pn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,sn=t,tn=null,!0):!1;default:return!1}}function um(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cm(t){if(je){var e=tn;if(e){var n=e;if(!Zy(t,e)){if(um(t))throw Error($(418));e=as(n.nextSibling);var r=sn;e&&Zy(t,e)?gE(r,n):(t.flags=t.flags&-4097|2,je=!1,sn=t)}}else{if(um(t))throw Error($(418));t.flags=t.flags&-4097|2,je=!1,sn=t}}}function e0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;sn=t}function Tu(t){if(t!==sn)return!1;if(!je)return e0(t),je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!im(t.type,t.memoizedProps)),e&&(e=tn)){if(um(t))throw vE(),Error($(418));for(;e;)gE(t,e),e=as(e.nextSibling)}if(e0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){tn=as(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}tn=null}}else tn=sn?as(t.stateNode.nextSibling):null;return!0}function vE(){for(var t=tn;t;)t=as(t.nextSibling)}function co(){tn=sn=null,je=!1}function Op(t){Sn===null?Sn=[t]:Sn.push(t)}var yk=kr.ReactCurrentBatchConfig;function na(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error($(284));if(!n._owner)throw Error($(290,t))}return t}function bu(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function t0(t){var e=t._init;return e(t._payload)}function yE(t){function e(T,y){if(t){var w=T.deletions;w===null?(T.deletions=[y],T.flags|=16):w.push(y)}}function n(T,y){if(!t)return null;for(;y!==null;)e(T,y),y=y.sibling;return null}function r(T,y){for(T=new Map;y!==null;)y.key!==null?T.set(y.key,y):T.set(y.index,y),y=y.sibling;return T}function s(T,y){return T=ds(T,y),T.index=0,T.sibling=null,T}function i(T,y,w){return T.index=w,t?(w=T.alternate,w!==null?(w=w.index,w<y?(T.flags|=2,y):w):(T.flags|=2,y)):(T.flags|=1048576,y)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function a(T,y,w,N){return y===null||y.tag!==6?(y=rf(w,T.mode,N),y.return=T,y):(y=s(y,w),y.return=T,y)}function l(T,y,w,N){var j=w.type;return j===Ui?h(T,y,w.props.children,N,w.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Br&&t0(j)===y.type)?(N=s(y,w.props),N.ref=na(T,y,w),N.return=T,N):(N=Ju(w.type,w.key,w.props,null,T.mode,N),N.ref=na(T,y,w),N.return=T,N)}function d(T,y,w,N){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=sf(w,T.mode,N),y.return=T,y):(y=s(y,w.children||[]),y.return=T,y)}function h(T,y,w,N,j){return y===null||y.tag!==7?(y=ni(w,T.mode,N,j),y.return=T,y):(y=s(y,w),y.return=T,y)}function m(T,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=rf(""+y,T.mode,w),y.return=T,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case fu:return w=Ju(y.type,y.key,y.props,null,T.mode,w),w.ref=na(T,null,y),w.return=T,w;case Fi:return y=sf(y,T.mode,w),y.return=T,y;case Br:var N=y._init;return m(T,N(y._payload),w)}if(da(y)||Xo(y))return y=ni(y,T.mode,w,null),y.return=T,y;bu(T,y)}return null}function p(T,y,w,N){var j=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return j!==null?null:a(T,y,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case fu:return w.key===j?l(T,y,w,N):null;case Fi:return w.key===j?d(T,y,w,N):null;case Br:return j=w._init,p(T,y,j(w._payload),N)}if(da(w)||Xo(w))return j!==null?null:h(T,y,w,N,null);bu(T,w)}return null}function x(T,y,w,N,j){if(typeof N=="string"&&N!==""||typeof N=="number")return T=T.get(w)||null,a(y,T,""+N,j);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case fu:return T=T.get(N.key===null?w:N.key)||null,l(y,T,N,j);case Fi:return T=T.get(N.key===null?w:N.key)||null,d(y,T,N,j);case Br:var D=N._init;return x(T,y,w,D(N._payload),j)}if(da(N)||Xo(N))return T=T.get(w)||null,h(y,T,N,j,null);bu(y,N)}return null}function v(T,y,w,N){for(var j=null,D=null,b=y,E=y=0,I=null;b!==null&&E<w.length;E++){b.index>E?(I=b,b=null):I=b.sibling;var k=p(T,b,w[E],N);if(k===null){b===null&&(b=I);break}t&&b&&k.alternate===null&&e(T,b),y=i(k,y,E),D===null?j=k:D.sibling=k,D=k,b=I}if(E===w.length)return n(T,b),je&&Bs(T,E),j;if(b===null){for(;E<w.length;E++)b=m(T,w[E],N),b!==null&&(y=i(b,y,E),D===null?j=b:D.sibling=b,D=b);return je&&Bs(T,E),j}for(b=r(T,b);E<w.length;E++)I=x(b,T,E,w[E],N),I!==null&&(t&&I.alternate!==null&&b.delete(I.key===null?E:I.key),y=i(I,y,E),D===null?j=I:D.sibling=I,D=I);return t&&b.forEach(function(R){return e(T,R)}),je&&Bs(T,E),j}function C(T,y,w,N){var j=Xo(w);if(typeof j!="function")throw Error($(150));if(w=j.call(w),w==null)throw Error($(151));for(var D=j=null,b=y,E=y=0,I=null,k=w.next();b!==null&&!k.done;E++,k=w.next()){b.index>E?(I=b,b=null):I=b.sibling;var R=p(T,b,k.value,N);if(R===null){b===null&&(b=I);break}t&&b&&R.alternate===null&&e(T,b),y=i(R,y,E),D===null?j=R:D.sibling=R,D=R,b=I}if(k.done)return n(T,b),je&&Bs(T,E),j;if(b===null){for(;!k.done;E++,k=w.next())k=m(T,k.value,N),k!==null&&(y=i(k,y,E),D===null?j=k:D.sibling=k,D=k);return je&&Bs(T,E),j}for(b=r(T,b);!k.done;E++,k=w.next())k=x(b,T,E,k.value,N),k!==null&&(t&&k.alternate!==null&&b.delete(k.key===null?E:k.key),y=i(k,y,E),D===null?j=k:D.sibling=k,D=k);return t&&b.forEach(function(O){return e(T,O)}),je&&Bs(T,E),j}function A(T,y,w,N){if(typeof w=="object"&&w!==null&&w.type===Ui&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case fu:e:{for(var j=w.key,D=y;D!==null;){if(D.key===j){if(j=w.type,j===Ui){if(D.tag===7){n(T,D.sibling),y=s(D,w.props.children),y.return=T,T=y;break e}}else if(D.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Br&&t0(j)===D.type){n(T,D.sibling),y=s(D,w.props),y.ref=na(T,D,w),y.return=T,T=y;break e}n(T,D);break}else e(T,D);D=D.sibling}w.type===Ui?(y=ni(w.props.children,T.mode,N,w.key),y.return=T,T=y):(N=Ju(w.type,w.key,w.props,null,T.mode,N),N.ref=na(T,y,w),N.return=T,T=N)}return o(T);case Fi:e:{for(D=w.key;y!==null;){if(y.key===D)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){n(T,y.sibling),y=s(y,w.children||[]),y.return=T,T=y;break e}else{n(T,y);break}else e(T,y);y=y.sibling}y=sf(w,T.mode,N),y.return=T,T=y}return o(T);case Br:return D=w._init,A(T,y,D(w._payload),N)}if(da(w))return v(T,y,w,N);if(Xo(w))return C(T,y,w,N);bu(T,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(n(T,y.sibling),y=s(y,w),y.return=T,T=y):(n(T,y),y=rf(w,T.mode,N),y.return=T,T=y),o(T)):n(T,y)}return A}var ho=yE(!0),_E=yE(!1),bc=Cs(null),Sc=null,Ki=null,Mp=null;function Lp(){Mp=Ki=Sc=null}function Vp(t){var e=bc.current;Re(bc),t._currentValue=e}function dm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function no(t,e){Sc=t,Mp=Ki=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wt=!0),t.firstContext=null)}function vn(t){var e=t._currentValue;if(Mp!==t)if(t={context:t,memoizedValue:e,next:null},Ki===null){if(Sc===null)throw Error($(308));Ki=t,Sc.dependencies={lanes:0,firstContext:t}}else Ki=Ki.next=t;return e}var Qs=null;function Fp(t){Qs===null?Qs=[t]:Qs.push(t)}function wE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Fp(e)):(n.next=s.next,s.next=n),e.interleaved=n,wr(t,r)}function wr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var zr=!1;function Up(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function dr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ls(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ge&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,wr(t,n)}return s=r.interleaved,s===null?(e.next=e,Fp(r)):(e.next=s.next,s.next=e),r.interleaved=e,wr(t,n)}function qu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sp(t,n)}}function n0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ic(t,e,n,r){var s=t.updateQueue;zr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=l))}if(i!==null){var m=s.baseState;o=0,h=d=l=null,a=i;do{var p=a.lane,x=a.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:x,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=t,C=a;switch(p=e,x=n,C.tag){case 1:if(v=C.payload,typeof v=="function"){m=v.call(x,m,p);break e}m=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=C.payload,p=typeof v=="function"?v.call(x,m,p):v,p==null)break e;m=Fe({},m,p);break e;case 2:zr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else x={eventTime:x,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=x,l=m):h=h.next=x,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(h===null&&(l=m),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ai|=o,t.lanes=o,t.memoizedState=m}}function r0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error($(191,s));s.call(r)}}}var Il={},Hn=Cs(Il),tl=Cs(Il),nl=Cs(Il);function Ys(t){if(t===Il)throw Error($(174));return t}function $p(t,e){switch(Ce(nl,e),Ce(tl,t),Ce(Hn,Il),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Hf(e,t)}Re(Hn),Ce(Hn,e)}function fo(){Re(Hn),Re(tl),Re(nl)}function EE(t){Ys(nl.current);var e=Ys(Hn.current),n=Hf(e,t.type);e!==n&&(Ce(tl,t),Ce(Hn,n))}function Bp(t){tl.current===t&&(Re(Hn),Re(tl))}var Oe=Cs(0);function Nc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Xh=[];function zp(){for(var t=0;t<Xh.length;t++)Xh[t]._workInProgressVersionPrimary=null;Xh.length=0}var Gu=kr.ReactCurrentDispatcher,Jh=kr.ReactCurrentBatchConfig,oi=0,Le=null,st=null,ut=null,Cc=!1,Ca=!1,rl=0,_k=0;function Tt(){throw Error($(321))}function Wp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!jn(t[n],e[n]))return!1;return!0}function Hp(t,e,n,r,s,i){if(oi=i,Le=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Gu.current=t===null||t.memoizedState===null?Tk:bk,t=n(r,s),Ca){i=0;do{if(Ca=!1,rl=0,25<=i)throw Error($(301));i+=1,ut=st=null,e.updateQueue=null,Gu.current=Sk,t=n(r,s)}while(Ca)}if(Gu.current=kc,e=st!==null&&st.next!==null,oi=0,ut=st=Le=null,Cc=!1,e)throw Error($(300));return t}function qp(){var t=rl!==0;return rl=0,t}function Un(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?Le.memoizedState=ut=t:ut=ut.next=t,ut}function yn(){if(st===null){var t=Le.alternate;t=t!==null?t.memoizedState:null}else t=st.next;var e=ut===null?Le.memoizedState:ut.next;if(e!==null)ut=e,st=t;else{if(t===null)throw Error($(310));st=t,t={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},ut===null?Le.memoizedState=ut=t:ut=ut.next=t}return ut}function sl(t,e){return typeof e=="function"?e(t):e}function Zh(t){var e=yn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=st,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var h=d.lane;if((oi&h)===h)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,Le.lanes|=h,ai|=h}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,jn(r,e.memoizedState)||(Wt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Le.lanes|=i,ai|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ef(t){var e=yn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);jn(i,e.memoizedState)||(Wt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function TE(){}function bE(t,e){var n=Le,r=yn(),s=e(),i=!jn(r.memoizedState,s);if(i&&(r.memoizedState=s,Wt=!0),r=r.queue,Gp(NE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ut!==null&&ut.memoizedState.tag&1){if(n.flags|=2048,il(9,IE.bind(null,n,r,s,e),void 0,null),ht===null)throw Error($(349));oi&30||SE(n,e,s)}return s}function SE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function IE(t,e,n,r){e.value=n,e.getSnapshot=r,CE(e)&&kE(t)}function NE(t,e,n){return n(function(){CE(e)&&kE(t)})}function CE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!jn(t,n)}catch{return!0}}function kE(t){var e=wr(t,1);e!==null&&An(e,t,1,-1)}function s0(t){var e=Un();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sl,lastRenderedState:t},e.queue=t,t=t.dispatch=Ek.bind(null,Le,t),[e.memoizedState,t]}function il(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function AE(){return yn().memoizedState}function Ku(t,e,n,r){var s=Un();Le.flags|=t,s.memoizedState=il(1|e,n,void 0,r===void 0?null:r)}function gd(t,e,n,r){var s=yn();r=r===void 0?null:r;var i=void 0;if(st!==null){var o=st.memoizedState;if(i=o.destroy,r!==null&&Wp(r,o.deps)){s.memoizedState=il(e,n,i,r);return}}Le.flags|=t,s.memoizedState=il(1|e,n,i,r)}function i0(t,e){return Ku(8390656,8,t,e)}function Gp(t,e){return gd(2048,8,t,e)}function PE(t,e){return gd(4,2,t,e)}function RE(t,e){return gd(4,4,t,e)}function jE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function DE(t,e,n){return n=n!=null?n.concat([t]):null,gd(4,4,jE.bind(null,e,t),n)}function Kp(){}function OE(t,e){var n=yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ME(t,e){var n=yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Wp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function LE(t,e,n){return oi&21?(jn(n,e)||(n=Bx(),Le.lanes|=n,ai|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wt=!0),t.memoizedState=n)}function wk(t,e){var n=we;we=n!==0&&4>n?n:4,t(!0);var r=Jh.transition;Jh.transition={};try{t(!1),e()}finally{we=n,Jh.transition=r}}function VE(){return yn().memoizedState}function xk(t,e,n){var r=cs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},FE(t))UE(e,n);else if(n=wE(t,e,n,r),n!==null){var s=Vt();An(n,t,r,s),$E(n,e,r)}}function Ek(t,e,n){var r=cs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(FE(t))UE(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,jn(a,o)){var l=e.interleaved;l===null?(s.next=s,Fp(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=wE(t,e,s,r),n!==null&&(s=Vt(),An(n,t,r,s),$E(n,e,r))}}function FE(t){var e=t.alternate;return t===Le||e!==null&&e===Le}function UE(t,e){Ca=Cc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function $E(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sp(t,n)}}var kc={readContext:vn,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},Tk={readContext:vn,useCallback:function(t,e){return Un().memoizedState=[t,e===void 0?null:e],t},useContext:vn,useEffect:i0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ku(4194308,4,jE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ku(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ku(4,2,t,e)},useMemo:function(t,e){var n=Un();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Un();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=xk.bind(null,Le,t),[r.memoizedState,t]},useRef:function(t){var e=Un();return t={current:t},e.memoizedState=t},useState:s0,useDebugValue:Kp,useDeferredValue:function(t){return Un().memoizedState=t},useTransition:function(){var t=s0(!1),e=t[0];return t=wk.bind(null,t[1]),Un().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Le,s=Un();if(je){if(n===void 0)throw Error($(407));n=n()}else{if(n=e(),ht===null)throw Error($(349));oi&30||SE(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,i0(NE.bind(null,r,i,t),[t]),r.flags|=2048,il(9,IE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Un(),e=ht.identifierPrefix;if(je){var n=lr,r=ar;n=(r&~(1<<32-kn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=rl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=_k++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},bk={readContext:vn,useCallback:OE,useContext:vn,useEffect:Gp,useImperativeHandle:DE,useInsertionEffect:PE,useLayoutEffect:RE,useMemo:ME,useReducer:Zh,useRef:AE,useState:function(){return Zh(sl)},useDebugValue:Kp,useDeferredValue:function(t){var e=yn();return LE(e,st.memoizedState,t)},useTransition:function(){var t=Zh(sl)[0],e=yn().memoizedState;return[t,e]},useMutableSource:TE,useSyncExternalStore:bE,useId:VE,unstable_isNewReconciler:!1},Sk={readContext:vn,useCallback:OE,useContext:vn,useEffect:Gp,useImperativeHandle:DE,useInsertionEffect:PE,useLayoutEffect:RE,useMemo:ME,useReducer:ef,useRef:AE,useState:function(){return ef(sl)},useDebugValue:Kp,useDeferredValue:function(t){var e=yn();return st===null?e.memoizedState=t:LE(e,st.memoizedState,t)},useTransition:function(){var t=ef(sl)[0],e=yn().memoizedState;return[t,e]},useMutableSource:TE,useSyncExternalStore:bE,useId:VE,unstable_isNewReconciler:!1};function Tn(t,e){if(t&&t.defaultProps){e=Fe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function hm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Fe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var vd={isMounted:function(t){return(t=t._reactInternals)?_i(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=cs(t),i=dr(r,s);i.payload=e,n!=null&&(i.callback=n),e=ls(t,i,s),e!==null&&(An(e,t,s,r),qu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=cs(t),i=dr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ls(t,i,s),e!==null&&(An(e,t,s,r),qu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vt(),r=cs(t),s=dr(n,r);s.tag=2,e!=null&&(s.callback=e),e=ls(t,s,r),e!==null&&(An(e,t,r,n),qu(e,t,r))}};function o0(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Xa(n,r)||!Xa(s,i):!0}function BE(t,e,n){var r=!1,s=_s,i=e.contextType;return typeof i=="object"&&i!==null?i=vn(i):(s=qt(e)?si:Pt.current,r=e.contextTypes,i=(r=r!=null)?uo(t,s):_s),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=vd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function a0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&vd.enqueueReplaceState(e,e.state,null)}function fm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Up(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=vn(i):(i=qt(e)?si:Pt.current,s.context=uo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(hm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&vd.enqueueReplaceState(s,s.state,null),Ic(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function mo(t,e){try{var n="",r=e;do n+=ZN(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function tf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function mm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Ik=typeof WeakMap=="function"?WeakMap:Map;function zE(t,e,n){n=dr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Pc||(Pc=!0,bm=r),mm(t,e)},n}function WE(t,e,n){n=dr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){mm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){mm(t,e),typeof r!="function"&&(us===null?us=new Set([this]):us.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function l0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Ik;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Uk.bind(null,t,e,n),e.then(t,t))}function u0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function c0(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=dr(-1,1),e.tag=2,ls(n,e,1))),n.lanes|=1),t)}var Nk=kr.ReactCurrentOwner,Wt=!1;function Mt(t,e,n,r){e.child=t===null?_E(e,null,n,r):ho(e,t.child,n,r)}function d0(t,e,n,r,s){n=n.render;var i=e.ref;return no(e,s),r=Hp(t,e,n,r,i,s),n=qp(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,xr(t,e,s)):(je&&n&&jp(e),e.flags|=1,Mt(t,e,r,s),e.child)}function h0(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!ng(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,HE(t,e,i,r,s)):(t=Ju(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Xa,n(o,r)&&t.ref===e.ref)return xr(t,e,s)}return e.flags|=1,t=ds(i,r),t.ref=e.ref,t.return=e,e.child=t}function HE(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Xa(i,r)&&t.ref===e.ref)if(Wt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Wt=!0);else return e.lanes=t.lanes,xr(t,e,s)}return pm(t,e,n,r,s)}function qE(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(Yi,Zt),Zt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ce(Yi,Zt),Zt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ce(Yi,Zt),Zt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ce(Yi,Zt),Zt|=r;return Mt(t,e,s,n),e.child}function GE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function pm(t,e,n,r,s){var i=qt(n)?si:Pt.current;return i=uo(e,i),no(e,s),n=Hp(t,e,n,r,i,s),r=qp(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,xr(t,e,s)):(je&&r&&jp(e),e.flags|=1,Mt(t,e,n,s),e.child)}function f0(t,e,n,r,s){if(qt(n)){var i=!0;xc(e)}else i=!1;if(no(e,s),e.stateNode===null)Qu(t,e),BE(e,n,r),fm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=vn(d):(d=qt(n)?si:Pt.current,d=uo(e,d));var h=n.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&a0(e,o,r,d),zr=!1;var p=e.memoizedState;o.state=p,Ic(e,r,o,s),l=e.memoizedState,a!==r||p!==l||Ht.current||zr?(typeof h=="function"&&(hm(e,n,h,r),l=e.memoizedState),(a=zr||o0(e,n,a,r,p,l,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,xE(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Tn(e.type,a),o.props=d,m=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=vn(l):(l=qt(n)?si:Pt.current,l=uo(e,l));var x=n.getDerivedStateFromProps;(h=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||p!==l)&&a0(e,o,r,l),zr=!1,p=e.memoizedState,o.state=p,Ic(e,r,o,s);var v=e.memoizedState;a!==m||p!==v||Ht.current||zr?(typeof x=="function"&&(hm(e,n,x,r),v=e.memoizedState),(d=zr||o0(e,n,d,r,p,v,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),o.props=r,o.state=v,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return gm(t,e,n,r,i,s)}function gm(t,e,n,r,s,i){GE(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Jy(e,n,!1),xr(t,e,i);r=e.stateNode,Nk.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ho(e,t.child,null,i),e.child=ho(e,null,a,i)):Mt(t,e,a,i),e.memoizedState=r.state,s&&Jy(e,n,!0),e.child}function KE(t){var e=t.stateNode;e.pendingContext?Xy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Xy(t,e.context,!1),$p(t,e.containerInfo)}function m0(t,e,n,r,s){return co(),Op(s),e.flags|=256,Mt(t,e,n,r),e.child}var vm={dehydrated:null,treeContext:null,retryLane:0};function ym(t){return{baseLanes:t,cachePool:null,transitions:null}}function QE(t,e,n){var r=e.pendingProps,s=Oe.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ce(Oe,s&1),t===null)return cm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=wd(o,r,0,null),t=ni(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ym(n),e.memoizedState=vm,t):Qp(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Ck(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ds(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ds(a,i):(i=ni(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?ym(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=vm,r}return i=t.child,t=i.sibling,r=ds(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Qp(t,e){return e=wd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Su(t,e,n,r){return r!==null&&Op(r),ho(e,t.child,null,n),t=Qp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Ck(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=tf(Error($(422))),Su(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=wd({mode:"visible",children:r.children},s,0,null),i=ni(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ho(e,t.child,null,o),e.child.memoizedState=ym(o),e.memoizedState=vm,i);if(!(e.mode&1))return Su(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error($(419)),r=tf(i,r,void 0),Su(t,e,o,r)}if(a=(o&t.childLanes)!==0,Wt||a){if(r=ht,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,wr(t,s),An(r,t,s,-1))}return tg(),r=tf(Error($(421))),Su(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=$k.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,tn=as(s.nextSibling),sn=e,je=!0,Sn=null,t!==null&&(fn[mn++]=ar,fn[mn++]=lr,fn[mn++]=ii,ar=t.id,lr=t.overflow,ii=e),e=Qp(e,r.children),e.flags|=4096,e)}function p0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),dm(t.return,e,n)}function nf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function YE(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Mt(t,e,r.children,n),r=Oe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&p0(t,n,e);else if(t.tag===19)p0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ce(Oe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Nc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),nf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Nc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}nf(e,!0,n,null,i);break;case"together":nf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Qu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ai|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,n=ds(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ds(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function kk(t,e,n){switch(e.tag){case 3:KE(e),co();break;case 5:EE(e);break;case 1:qt(e.type)&&xc(e);break;case 4:$p(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ce(bc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ce(Oe,Oe.current&1),e.flags|=128,null):n&e.child.childLanes?QE(t,e,n):(Ce(Oe,Oe.current&1),t=xr(t,e,n),t!==null?t.sibling:null);Ce(Oe,Oe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return YE(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ce(Oe,Oe.current),r)break;return null;case 22:case 23:return e.lanes=0,qE(t,e,n)}return xr(t,e,n)}var XE,_m,JE,ZE;XE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};_m=function(){};JE=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ys(Hn.current);var i=null;switch(n){case"input":s=$f(t,s),r=$f(t,r),i=[];break;case"select":s=Fe({},s,{value:void 0}),r=Fe({},r,{value:void 0}),i=[];break;case"textarea":s=Wf(t,s),r=Wf(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=_c)}qf(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Wa.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Wa.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&Ae("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};ZE=function(t,e,n,r){n!==r&&(e.flags|=4)};function ra(t,e){if(!je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Ak(t,e,n){var r=e.pendingProps;switch(Dp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(e),null;case 1:return qt(e.type)&&wc(),bt(e),null;case 3:return r=e.stateNode,fo(),Re(Ht),Re(Pt),zp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Tu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sn!==null&&(Nm(Sn),Sn=null))),_m(t,e),bt(e),null;case 5:Bp(e);var s=Ys(nl.current);if(n=e.type,t!==null&&e.stateNode!=null)JE(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return bt(e),null}if(t=Ys(Hn.current),Tu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Bn]=e,r[el]=i,t=(e.mode&1)!==0,n){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(s=0;s<fa.length;s++)Ae(fa[s],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":by(r,i),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ae("invalid",r);break;case"textarea":Iy(r,i),Ae("invalid",r)}qf(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Eu(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Eu(r.textContent,a,t),s=["children",""+a]):Wa.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ae("scroll",r)}switch(n){case"input":mu(r),Sy(r,i,!0);break;case"textarea":mu(r),Ny(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=_c)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Nx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Bn]=e,t[el]=r,XE(t,e,!1,!1),e.stateNode=t;e:{switch(o=Gf(n,r),n){case"dialog":Ae("cancel",t),Ae("close",t),s=r;break;case"iframe":case"object":case"embed":Ae("load",t),s=r;break;case"video":case"audio":for(s=0;s<fa.length;s++)Ae(fa[s],t);s=r;break;case"source":Ae("error",t),s=r;break;case"img":case"image":case"link":Ae("error",t),Ae("load",t),s=r;break;case"details":Ae("toggle",t),s=r;break;case"input":by(t,r),s=$f(t,r),Ae("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Fe({},r,{value:void 0}),Ae("invalid",t);break;case"textarea":Iy(t,r),s=Wf(t,r),Ae("invalid",t);break;default:s=r}qf(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?Ax(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Cx(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ha(t,l):typeof l=="number"&&Ha(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Wa.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ae("scroll",t):l!=null&&_p(t,i,l,o))}switch(n){case"input":mu(t),Sy(t,r,!1);break;case"textarea":mu(t),Ny(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ys(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ji(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ji(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=_c)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bt(e),null;case 6:if(t&&e.stateNode!=null)ZE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(n=Ys(nl.current),Ys(Hn.current),Tu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Bn]=e,(i=r.nodeValue!==n)&&(t=sn,t!==null))switch(t.tag){case 3:Eu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Eu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Bn]=e,e.stateNode=r}return bt(e),null;case 13:if(Re(Oe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(je&&tn!==null&&e.mode&1&&!(e.flags&128))vE(),co(),e.flags|=98560,i=!1;else if(i=Tu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error($(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[Bn]=e}else co(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bt(e),i=!1}else Sn!==null&&(Nm(Sn),Sn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Oe.current&1?it===0&&(it=3):tg())),e.updateQueue!==null&&(e.flags|=4),bt(e),null);case 4:return fo(),_m(t,e),t===null&&Ja(e.stateNode.containerInfo),bt(e),null;case 10:return Vp(e.type._context),bt(e),null;case 17:return qt(e.type)&&wc(),bt(e),null;case 19:if(Re(Oe),i=e.memoizedState,i===null)return bt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ra(i,!1);else{if(it!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Nc(t),o!==null){for(e.flags|=128,ra(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ce(Oe,Oe.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ke()>po&&(e.flags|=128,r=!0,ra(i,!1),e.lanes=4194304)}else{if(!r)if(t=Nc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ra(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!je)return bt(e),null}else 2*Ke()-i.renderingStartTime>po&&n!==1073741824&&(e.flags|=128,r=!0,ra(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ke(),e.sibling=null,n=Oe.current,Ce(Oe,r?n&1|2:n&1),e):(bt(e),null);case 22:case 23:return eg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Zt&1073741824&&(bt(e),e.subtreeFlags&6&&(e.flags|=8192)):bt(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function Pk(t,e){switch(Dp(e),e.tag){case 1:return qt(e.type)&&wc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return fo(),Re(Ht),Re(Pt),zp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Bp(e),null;case 13:if(Re(Oe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));co()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Re(Oe),null;case 4:return fo(),null;case 10:return Vp(e.type._context),null;case 22:case 23:return eg(),null;case 24:return null;default:return null}}var Iu=!1,Nt=!1,Rk=typeof WeakSet=="function"?WeakSet:Set,Q=null;function Qi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Be(t,e,r)}else n.current=null}function wm(t,e,n){try{n()}catch(r){Be(t,e,r)}}var g0=!1;function jk(t,e){if(rm=gc,t=sE(),Rp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,h=0,m=t,p=null;t:for(;;){for(var x;m!==n||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)p=m,m=x;for(;;){if(m===t)break t;if(p===n&&++d===s&&(a=o),p===i&&++h===r&&(l=o),(x=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=x}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(sm={focusedElem:t,selectionRange:n},gc=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var C=v.memoizedProps,A=v.memoizedState,T=e.stateNode,y=T.getSnapshotBeforeUpdate(e.elementType===e.type?C:Tn(e.type,C),A);T.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(N){Be(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return v=g0,g0=!1,v}function ka(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&wm(e,n,i)}s=s.next}while(s!==r)}}function yd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function xm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function eT(t){var e=t.alternate;e!==null&&(t.alternate=null,eT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Bn],delete e[el],delete e[am],delete e[pk],delete e[gk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tT(t){return t.tag===5||t.tag===3||t.tag===4}function v0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Em(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=_c));else if(r!==4&&(t=t.child,t!==null))for(Em(t,e,n),t=t.sibling;t!==null;)Em(t,e,n),t=t.sibling}function Tm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Tm(t,e,n),t=t.sibling;t!==null;)Tm(t,e,n),t=t.sibling}var pt=null,bn=!1;function Fr(t,e,n){for(n=n.child;n!==null;)nT(t,e,n),n=n.sibling}function nT(t,e,n){if(Wn&&typeof Wn.onCommitFiberUnmount=="function")try{Wn.onCommitFiberUnmount(cd,n)}catch{}switch(n.tag){case 5:Nt||Qi(n,e);case 6:var r=pt,s=bn;pt=null,Fr(t,e,n),pt=r,bn=s,pt!==null&&(bn?(t=pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):pt.removeChild(n.stateNode));break;case 18:pt!==null&&(bn?(t=pt,n=n.stateNode,t.nodeType===8?Qh(t.parentNode,n):t.nodeType===1&&Qh(t,n),Qa(t)):Qh(pt,n.stateNode));break;case 4:r=pt,s=bn,pt=n.stateNode.containerInfo,bn=!0,Fr(t,e,n),pt=r,bn=s;break;case 0:case 11:case 14:case 15:if(!Nt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&wm(n,e,o),s=s.next}while(s!==r)}Fr(t,e,n);break;case 1:if(!Nt&&(Qi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Be(n,e,a)}Fr(t,e,n);break;case 21:Fr(t,e,n);break;case 22:n.mode&1?(Nt=(r=Nt)||n.memoizedState!==null,Fr(t,e,n),Nt=r):Fr(t,e,n);break;default:Fr(t,e,n)}}function y0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Rk),e.forEach(function(r){var s=Bk.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function En(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:pt=a.stateNode,bn=!1;break e;case 3:pt=a.stateNode.containerInfo,bn=!0;break e;case 4:pt=a.stateNode.containerInfo,bn=!0;break e}a=a.return}if(pt===null)throw Error($(160));nT(i,o,s),pt=null,bn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){Be(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rT(e,t),e=e.sibling}function rT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(En(e,t),Ln(t),r&4){try{ka(3,t,t.return),yd(3,t)}catch(C){Be(t,t.return,C)}try{ka(5,t,t.return)}catch(C){Be(t,t.return,C)}}break;case 1:En(e,t),Ln(t),r&512&&n!==null&&Qi(n,n.return);break;case 5:if(En(e,t),Ln(t),r&512&&n!==null&&Qi(n,n.return),t.flags&32){var s=t.stateNode;try{Ha(s,"")}catch(C){Be(t,t.return,C)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Sx(s,i),Gf(a,o);var d=Gf(a,i);for(o=0;o<l.length;o+=2){var h=l[o],m=l[o+1];h==="style"?Ax(s,m):h==="dangerouslySetInnerHTML"?Cx(s,m):h==="children"?Ha(s,m):_p(s,h,m,d)}switch(a){case"input":Bf(s,i);break;case"textarea":Ix(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?Ji(s,!!i.multiple,x,!1):p!==!!i.multiple&&(i.defaultValue!=null?Ji(s,!!i.multiple,i.defaultValue,!0):Ji(s,!!i.multiple,i.multiple?[]:"",!1))}s[el]=i}catch(C){Be(t,t.return,C)}}break;case 6:if(En(e,t),Ln(t),r&4){if(t.stateNode===null)throw Error($(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(C){Be(t,t.return,C)}}break;case 3:if(En(e,t),Ln(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Qa(e.containerInfo)}catch(C){Be(t,t.return,C)}break;case 4:En(e,t),Ln(t);break;case 13:En(e,t),Ln(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Jp=Ke())),r&4&&y0(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Nt=(d=Nt)||h,En(e,t),Nt=d):En(e,t),Ln(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(Q=t,h=t.child;h!==null;){for(m=Q=h;Q!==null;){switch(p=Q,x=p.child,p.tag){case 0:case 11:case 14:case 15:ka(4,p,p.return);break;case 1:Qi(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(C){Be(r,n,C)}}break;case 5:Qi(p,p.return);break;case 22:if(p.memoizedState!==null){w0(m);continue}}x!==null?(x.return=p,Q=x):w0(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=kx("display",o))}catch(C){Be(t,t.return,C)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(C){Be(t,t.return,C)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:En(e,t),Ln(t),r&4&&y0(t);break;case 21:break;default:En(e,t),Ln(t)}}function Ln(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tT(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ha(s,""),r.flags&=-33);var i=v0(t);Tm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=v0(t);Em(t,a,o);break;default:throw Error($(161))}}catch(l){Be(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Dk(t,e,n){Q=t,sT(t)}function sT(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var s=Q,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Iu;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Nt;a=Iu;var d=Nt;if(Iu=o,(Nt=l)&&!d)for(Q=s;Q!==null;)o=Q,l=o.child,o.tag===22&&o.memoizedState!==null?x0(s):l!==null?(l.return=o,Q=l):x0(s);for(;i!==null;)Q=i,sT(i),i=i.sibling;Q=s,Iu=a,Nt=d}_0(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Q=i):_0(t)}}function _0(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Nt||yd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Nt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Tn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&r0(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}r0(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&Qa(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}Nt||e.flags&512&&xm(e)}catch(p){Be(e,e.return,p)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function w0(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function x0(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{yd(4,e)}catch(l){Be(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Be(e,s,l)}}var i=e.return;try{xm(e)}catch(l){Be(e,i,l)}break;case 5:var o=e.return;try{xm(e)}catch(l){Be(e,o,l)}}}catch(l){Be(e,e.return,l)}if(e===t){Q=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Q=a;break}Q=e.return}}var Ok=Math.ceil,Ac=kr.ReactCurrentDispatcher,Yp=kr.ReactCurrentOwner,gn=kr.ReactCurrentBatchConfig,ge=0,ht=null,et=null,yt=0,Zt=0,Yi=Cs(0),it=0,ol=null,ai=0,_d=0,Xp=0,Aa=null,Bt=null,Jp=0,po=1/0,rr=null,Pc=!1,bm=null,us=null,Nu=!1,Zr=null,Rc=0,Pa=0,Sm=null,Yu=-1,Xu=0;function Vt(){return ge&6?Ke():Yu!==-1?Yu:Yu=Ke()}function cs(t){return t.mode&1?ge&2&&yt!==0?yt&-yt:yk.transition!==null?(Xu===0&&(Xu=Bx()),Xu):(t=we,t!==0||(t=window.event,t=t===void 0?16:Qx(t.type)),t):1}function An(t,e,n,r){if(50<Pa)throw Pa=0,Sm=null,Error($(185));Tl(t,n,r),(!(ge&2)||t!==ht)&&(t===ht&&(!(ge&2)&&(_d|=n),it===4&&Hr(t,yt)),Gt(t,r),n===1&&ge===0&&!(e.mode&1)&&(po=Ke()+500,pd&&ks()))}function Gt(t,e){var n=t.callbackNode;yC(t,e);var r=pc(t,t===ht?yt:0);if(r===0)n!==null&&Ay(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ay(n),e===1)t.tag===0?vk(E0.bind(null,t)):mE(E0.bind(null,t)),fk(function(){!(ge&6)&&ks()}),n=null;else{switch(zx(r)){case 1:n=bp;break;case 4:n=Ux;break;case 16:n=mc;break;case 536870912:n=$x;break;default:n=mc}n=hT(n,iT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function iT(t,e){if(Yu=-1,Xu=0,ge&6)throw Error($(327));var n=t.callbackNode;if(ro()&&t.callbackNode!==n)return null;var r=pc(t,t===ht?yt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=jc(t,r);else{e=r;var s=ge;ge|=2;var i=aT();(ht!==t||yt!==e)&&(rr=null,po=Ke()+500,ti(t,e));do try{Vk();break}catch(a){oT(t,a)}while(!0);Lp(),Ac.current=i,ge=s,et!==null?e=0:(ht=null,yt=0,e=it)}if(e!==0){if(e===2&&(s=Jf(t),s!==0&&(r=s,e=Im(t,s))),e===1)throw n=ol,ti(t,0),Hr(t,r),Gt(t,Ke()),n;if(e===6)Hr(t,r);else{if(s=t.current.alternate,!(r&30)&&!Mk(s)&&(e=jc(t,r),e===2&&(i=Jf(t),i!==0&&(r=i,e=Im(t,i))),e===1))throw n=ol,ti(t,0),Hr(t,r),Gt(t,Ke()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:zs(t,Bt,rr);break;case 3:if(Hr(t,r),(r&130023424)===r&&(e=Jp+500-Ke(),10<e)){if(pc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Vt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=om(zs.bind(null,t,Bt,rr),e);break}zs(t,Bt,rr);break;case 4:if(Hr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-kn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ke()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ok(r/1960))-r,10<r){t.timeoutHandle=om(zs.bind(null,t,Bt,rr),r);break}zs(t,Bt,rr);break;case 5:zs(t,Bt,rr);break;default:throw Error($(329))}}}return Gt(t,Ke()),t.callbackNode===n?iT.bind(null,t):null}function Im(t,e){var n=Aa;return t.current.memoizedState.isDehydrated&&(ti(t,e).flags|=256),t=jc(t,e),t!==2&&(e=Bt,Bt=n,e!==null&&Nm(e)),t}function Nm(t){Bt===null?Bt=t:Bt.push.apply(Bt,t)}function Mk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!jn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Hr(t,e){for(e&=~Xp,e&=~_d,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-kn(e),r=1<<n;t[n]=-1,e&=~r}}function E0(t){if(ge&6)throw Error($(327));ro();var e=pc(t,0);if(!(e&1))return Gt(t,Ke()),null;var n=jc(t,e);if(t.tag!==0&&n===2){var r=Jf(t);r!==0&&(e=r,n=Im(t,r))}if(n===1)throw n=ol,ti(t,0),Hr(t,e),Gt(t,Ke()),n;if(n===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zs(t,Bt,rr),Gt(t,Ke()),null}function Zp(t,e){var n=ge;ge|=1;try{return t(e)}finally{ge=n,ge===0&&(po=Ke()+500,pd&&ks())}}function li(t){Zr!==null&&Zr.tag===0&&!(ge&6)&&ro();var e=ge;ge|=1;var n=gn.transition,r=we;try{if(gn.transition=null,we=1,t)return t()}finally{we=r,gn.transition=n,ge=e,!(ge&6)&&ks()}}function eg(){Zt=Yi.current,Re(Yi)}function ti(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,hk(n)),et!==null)for(n=et.return;n!==null;){var r=n;switch(Dp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&wc();break;case 3:fo(),Re(Ht),Re(Pt),zp();break;case 5:Bp(r);break;case 4:fo();break;case 13:Re(Oe);break;case 19:Re(Oe);break;case 10:Vp(r.type._context);break;case 22:case 23:eg()}n=n.return}if(ht=t,et=t=ds(t.current,null),yt=Zt=e,it=0,ol=null,Xp=_d=ai=0,Bt=Aa=null,Qs!==null){for(e=0;e<Qs.length;e++)if(n=Qs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Qs=null}return t}function oT(t,e){do{var n=et;try{if(Lp(),Gu.current=kc,Cc){for(var r=Le.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Cc=!1}if(oi=0,ut=st=Le=null,Ca=!1,rl=0,Yp.current=null,n===null||n.return===null){it=1,ol=e,et=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=yt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,h=a,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=u0(o);if(x!==null){x.flags&=-257,c0(x,o,a,i,e),x.mode&1&&l0(i,d,e),e=x,l=d;var v=e.updateQueue;if(v===null){var C=new Set;C.add(l),e.updateQueue=C}else v.add(l);break e}else{if(!(e&1)){l0(i,d,e),tg();break e}l=Error($(426))}}else if(je&&a.mode&1){var A=u0(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),c0(A,o,a,i,e),Op(mo(l,a));break e}}i=l=mo(l,a),it!==4&&(it=2),Aa===null?Aa=[i]:Aa.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=zE(i,l,e);n0(i,T);break e;case 1:a=l;var y=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(us===null||!us.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var N=WE(i,a,e);n0(i,N);break e}}i=i.return}while(i!==null)}uT(n)}catch(j){e=j,et===n&&n!==null&&(et=n=n.return);continue}break}while(!0)}function aT(){var t=Ac.current;return Ac.current=kc,t===null?kc:t}function tg(){(it===0||it===3||it===2)&&(it=4),ht===null||!(ai&268435455)&&!(_d&268435455)||Hr(ht,yt)}function jc(t,e){var n=ge;ge|=2;var r=aT();(ht!==t||yt!==e)&&(rr=null,ti(t,e));do try{Lk();break}catch(s){oT(t,s)}while(!0);if(Lp(),ge=n,Ac.current=r,et!==null)throw Error($(261));return ht=null,yt=0,it}function Lk(){for(;et!==null;)lT(et)}function Vk(){for(;et!==null&&!uC();)lT(et)}function lT(t){var e=dT(t.alternate,t,Zt);t.memoizedProps=t.pendingProps,e===null?uT(t):et=e,Yp.current=null}function uT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Pk(n,e),n!==null){n.flags&=32767,et=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{it=6,et=null;return}}else if(n=Ak(n,e,Zt),n!==null){et=n;return}if(e=e.sibling,e!==null){et=e;return}et=e=t}while(e!==null);it===0&&(it=5)}function zs(t,e,n){var r=we,s=gn.transition;try{gn.transition=null,we=1,Fk(t,e,n,r)}finally{gn.transition=s,we=r}return null}function Fk(t,e,n,r){do ro();while(Zr!==null);if(ge&6)throw Error($(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(_C(t,i),t===ht&&(et=ht=null,yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Nu||(Nu=!0,hT(mc,function(){return ro(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=gn.transition,gn.transition=null;var o=we;we=1;var a=ge;ge|=4,Yp.current=null,jk(t,n),rT(n,t),ik(sm),gc=!!rm,sm=rm=null,t.current=n,Dk(n),cC(),ge=a,we=o,gn.transition=i}else t.current=n;if(Nu&&(Nu=!1,Zr=t,Rc=s),i=t.pendingLanes,i===0&&(us=null),fC(n.stateNode),Gt(t,Ke()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Pc)throw Pc=!1,t=bm,bm=null,t;return Rc&1&&t.tag!==0&&ro(),i=t.pendingLanes,i&1?t===Sm?Pa++:(Pa=0,Sm=t):Pa=0,ks(),null}function ro(){if(Zr!==null){var t=zx(Rc),e=gn.transition,n=we;try{if(gn.transition=null,we=16>t?16:t,Zr===null)var r=!1;else{if(t=Zr,Zr=null,Rc=0,ge&6)throw Error($(331));var s=ge;for(ge|=4,Q=t.current;Q!==null;){var i=Q,o=i.child;if(Q.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(Q=d;Q!==null;){var h=Q;switch(h.tag){case 0:case 11:case 15:ka(8,h,i)}var m=h.child;if(m!==null)m.return=h,Q=m;else for(;Q!==null;){h=Q;var p=h.sibling,x=h.return;if(eT(h),h===d){Q=null;break}if(p!==null){p.return=x,Q=p;break}Q=x}}}var v=i.alternate;if(v!==null){var C=v.child;if(C!==null){v.child=null;do{var A=C.sibling;C.sibling=null,C=A}while(C!==null)}}Q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Q=o;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ka(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,Q=T;break e}Q=i.return}}var y=t.current;for(Q=y;Q!==null;){o=Q;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Q=w;else e:for(o=y;Q!==null;){if(a=Q,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:yd(9,a)}}catch(j){Be(a,a.return,j)}if(a===o){Q=null;break e}var N=a.sibling;if(N!==null){N.return=a.return,Q=N;break e}Q=a.return}}if(ge=s,ks(),Wn&&typeof Wn.onPostCommitFiberRoot=="function")try{Wn.onPostCommitFiberRoot(cd,t)}catch{}r=!0}return r}finally{we=n,gn.transition=e}}return!1}function T0(t,e,n){e=mo(n,e),e=zE(t,e,1),t=ls(t,e,1),e=Vt(),t!==null&&(Tl(t,1,e),Gt(t,e))}function Be(t,e,n){if(t.tag===3)T0(t,t,n);else for(;e!==null;){if(e.tag===3){T0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(us===null||!us.has(r))){t=mo(n,t),t=WE(e,t,1),e=ls(e,t,1),t=Vt(),e!==null&&(Tl(e,1,t),Gt(e,t));break}}e=e.return}}function Uk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Vt(),t.pingedLanes|=t.suspendedLanes&n,ht===t&&(yt&n)===n&&(it===4||it===3&&(yt&130023424)===yt&&500>Ke()-Jp?ti(t,0):Xp|=n),Gt(t,e)}function cT(t,e){e===0&&(t.mode&1?(e=vu,vu<<=1,!(vu&130023424)&&(vu=4194304)):e=1);var n=Vt();t=wr(t,e),t!==null&&(Tl(t,e,n),Gt(t,n))}function $k(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),cT(t,n)}function Bk(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),cT(t,n)}var dT;dT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ht.current)Wt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Wt=!1,kk(t,e,n);Wt=!!(t.flags&131072)}else Wt=!1,je&&e.flags&1048576&&pE(e,Tc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Qu(t,e),t=e.pendingProps;var s=uo(e,Pt.current);no(e,n),s=Hp(null,e,r,t,s,n);var i=qp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qt(r)?(i=!0,xc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Up(e),s.updater=vd,e.stateNode=s,s._reactInternals=e,fm(e,r,t,n),e=gm(null,e,r,!0,i,n)):(e.tag=0,je&&i&&jp(e),Mt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Qu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Wk(r),t=Tn(r,t),s){case 0:e=pm(null,e,r,t,n);break e;case 1:e=f0(null,e,r,t,n);break e;case 11:e=d0(null,e,r,t,n);break e;case 14:e=h0(null,e,r,Tn(r.type,t),n);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),pm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),f0(t,e,r,s,n);case 3:e:{if(KE(e),t===null)throw Error($(387));r=e.pendingProps,i=e.memoizedState,s=i.element,xE(t,e),Ic(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=mo(Error($(423)),e),e=m0(t,e,r,n,s);break e}else if(r!==s){s=mo(Error($(424)),e),e=m0(t,e,r,n,s);break e}else for(tn=as(e.stateNode.containerInfo.firstChild),sn=e,je=!0,Sn=null,n=_E(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(co(),r===s){e=xr(t,e,n);break e}Mt(t,e,r,n)}e=e.child}return e;case 5:return EE(e),t===null&&cm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,im(r,s)?o=null:i!==null&&im(r,i)&&(e.flags|=32),GE(t,e),Mt(t,e,o,n),e.child;case 6:return t===null&&cm(e),null;case 13:return QE(t,e,n);case 4:return $p(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ho(e,null,r,n):Mt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),d0(t,e,r,s,n);case 7:return Mt(t,e,e.pendingProps,n),e.child;case 8:return Mt(t,e,e.pendingProps.children,n),e.child;case 12:return Mt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ce(bc,r._currentValue),r._currentValue=o,i!==null)if(jn(i.value,o)){if(i.children===s.children&&!Ht.current){e=xr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=dr(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?l.next=l:(l.next=h.next,h.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),dm(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error($(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),dm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Mt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,no(e,n),s=vn(s),r=r(s),e.flags|=1,Mt(t,e,r,n),e.child;case 14:return r=e.type,s=Tn(r,e.pendingProps),s=Tn(r.type,s),h0(t,e,r,s,n);case 15:return HE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Tn(r,s),Qu(t,e),e.tag=1,qt(r)?(t=!0,xc(e)):t=!1,no(e,n),BE(e,r,s),fm(e,r,s,n),gm(null,e,r,!0,t,n);case 19:return YE(t,e,n);case 22:return qE(t,e,n)}throw Error($(156,e.tag))};function hT(t,e){return Fx(t,e)}function zk(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(t,e,n,r){return new zk(t,e,n,r)}function ng(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Wk(t){if(typeof t=="function")return ng(t)?1:0;if(t!=null){if(t=t.$$typeof,t===xp)return 11;if(t===Ep)return 14}return 2}function ds(t,e){var n=t.alternate;return n===null?(n=pn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ju(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")ng(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ui:return ni(n.children,s,i,e);case wp:o=8,s|=8;break;case Lf:return t=pn(12,n,e,s|2),t.elementType=Lf,t.lanes=i,t;case Vf:return t=pn(13,n,e,s),t.elementType=Vf,t.lanes=i,t;case Ff:return t=pn(19,n,e,s),t.elementType=Ff,t.lanes=i,t;case Ex:return wd(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wx:o=10;break e;case xx:o=9;break e;case xp:o=11;break e;case Ep:o=14;break e;case Br:o=16,r=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=pn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ni(t,e,n,r){return t=pn(7,t,r,e),t.lanes=n,t}function wd(t,e,n,r){return t=pn(22,t,r,e),t.elementType=Ex,t.lanes=n,t.stateNode={isHidden:!1},t}function rf(t,e,n){return t=pn(6,t,null,e),t.lanes=n,t}function sf(t,e,n){return e=pn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Hk(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vh(0),this.expirationTimes=Vh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function rg(t,e,n,r,s,i,o,a,l){return t=new Hk(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=pn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Up(i),t}function qk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function fT(t){if(!t)return _s;t=t._reactInternals;e:{if(_i(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var n=t.type;if(qt(n))return fE(t,n,e)}return e}function mT(t,e,n,r,s,i,o,a,l){return t=rg(n,r,!0,t,s,i,o,a,l),t.context=fT(null),n=t.current,r=Vt(),s=cs(n),i=dr(r,s),i.callback=e??null,ls(n,i,s),t.current.lanes=s,Tl(t,s,r),Gt(t,r),t}function xd(t,e,n,r){var s=e.current,i=Vt(),o=cs(s);return n=fT(n),e.context===null?e.context=n:e.pendingContext=n,e=dr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ls(s,e,o),t!==null&&(An(t,s,o,i),qu(t,s,o)),o}function Dc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function b0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function sg(t,e){b0(t,e),(t=t.alternate)&&b0(t,e)}function Gk(){return null}var pT=typeof reportError=="function"?reportError:function(t){console.error(t)};function ig(t){this._internalRoot=t}Ed.prototype.render=ig.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));xd(t,e,null,null)};Ed.prototype.unmount=ig.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;li(function(){xd(null,t,null,null)}),e[_r]=null}};function Ed(t){this._internalRoot=t}Ed.prototype.unstable_scheduleHydration=function(t){if(t){var e=qx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Wr.length&&e!==0&&e<Wr[n].priority;n++);Wr.splice(n,0,t),n===0&&Kx(t)}};function og(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Td(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function S0(){}function Kk(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Dc(o);i.call(d)}}var o=mT(e,r,t,0,null,!1,!1,"",S0);return t._reactRootContainer=o,t[_r]=o.current,Ja(t.nodeType===8?t.parentNode:t),li(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Dc(l);a.call(d)}}var l=rg(t,0,!1,null,null,!1,!1,"",S0);return t._reactRootContainer=l,t[_r]=l.current,Ja(t.nodeType===8?t.parentNode:t),li(function(){xd(e,l,n,r)}),l}function bd(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Dc(o);a.call(l)}}xd(e,o,t,s)}else o=Kk(n,e,t,s,r);return Dc(o)}Wx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ha(e.pendingLanes);n!==0&&(Sp(e,n|1),Gt(e,Ke()),!(ge&6)&&(po=Ke()+500,ks()))}break;case 13:li(function(){var r=wr(t,1);if(r!==null){var s=Vt();An(r,t,1,s)}}),sg(t,1)}};Ip=function(t){if(t.tag===13){var e=wr(t,134217728);if(e!==null){var n=Vt();An(e,t,134217728,n)}sg(t,134217728)}};Hx=function(t){if(t.tag===13){var e=cs(t),n=wr(t,e);if(n!==null){var r=Vt();An(n,t,e,r)}sg(t,e)}};qx=function(){return we};Gx=function(t,e){var n=we;try{return we=t,e()}finally{we=n}};Qf=function(t,e,n){switch(e){case"input":if(Bf(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=md(r);if(!s)throw Error($(90));bx(r),Bf(r,s)}}}break;case"textarea":Ix(t,n);break;case"select":e=n.value,e!=null&&Ji(t,!!n.multiple,e,!1)}};jx=Zp;Dx=li;var Qk={usingClientEntryPoint:!1,Events:[Sl,Wi,md,Px,Rx,Zp]},sa={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Yk={bundleType:sa.bundleType,version:sa.version,rendererPackageName:sa.rendererPackageName,rendererConfig:sa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:kr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Lx(t),t===null?null:t.stateNode},findFiberByHostInstance:sa.findFiberByHostInstance||Gk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cu.isDisabled&&Cu.supportsFiber)try{cd=Cu.inject(Yk),Wn=Cu}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qk;un.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!og(e))throw Error($(200));return qk(t,e,null,n)};un.createRoot=function(t,e){if(!og(t))throw Error($(299));var n=!1,r="",s=pT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=rg(t,1,!1,null,null,n,!1,r,s),t[_r]=e.current,Ja(t.nodeType===8?t.parentNode:t),new ig(e)};un.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=Lx(e),t=t===null?null:t.stateNode,t};un.flushSync=function(t){return li(t)};un.hydrate=function(t,e,n){if(!Td(e))throw Error($(200));return bd(null,t,e,!0,n)};un.hydrateRoot=function(t,e,n){if(!og(t))throw Error($(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=pT;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=mT(e,null,t,1,n??null,s,!1,i,o),t[_r]=e.current,Ja(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ed(e)};un.render=function(t,e,n){if(!Td(e))throw Error($(200));return bd(null,t,e,!1,n)};un.unmountComponentAtNode=function(t){if(!Td(t))throw Error($(40));return t._reactRootContainer?(li(function(){bd(null,null,t,!1,function(){t._reactRootContainer=null,t[_r]=null})}),!0):!1};un.unstable_batchedUpdates=Zp;un.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Td(n))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return bd(t,e,n,!1,r)};un.version="18.3.1-next-f1338f8080-20240426";function gT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gT)}catch(t){console.error(t)}}gT(),gx.exports=un;var vT=gx.exports,I0=vT;Of.createRoot=I0.createRoot,Of.hydrateRoot=I0.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function al(){return al=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},al.apply(this,arguments)}var es;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(es||(es={}));const N0="popstate";function Xk(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Cm("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Oc(s)}return Zk(e,n,null,t)}function Ve(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function yT(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Jk(){return Math.random().toString(36).substr(2,8)}function C0(t,e){return{usr:t.state,key:t.key,idx:e}}function Cm(t,e,n,r){return n===void 0&&(n=null),al({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?No(e):e,{state:n,key:e&&e.key||r||Jk()})}function Oc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function No(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function Zk(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=es.Pop,l=null,d=h();d==null&&(d=0,o.replaceState(al({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function m(){a=es.Pop;let A=h(),T=A==null?null:A-d;d=A,l&&l({action:a,location:C.location,delta:T})}function p(A,T){a=es.Push;let y=Cm(C.location,A,T);d=h()+1;let w=C0(y,d),N=C.createHref(y);try{o.pushState(w,"",N)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(N)}i&&l&&l({action:a,location:C.location,delta:1})}function x(A,T){a=es.Replace;let y=Cm(C.location,A,T);d=h();let w=C0(y,d),N=C.createHref(y);o.replaceState(w,"",N),i&&l&&l({action:a,location:C.location,delta:0})}function v(A){let T=s.location.origin!=="null"?s.location.origin:s.location.href,y=typeof A=="string"?A:Oc(A);return y=y.replace(/ $/,"%20"),Ve(T,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,T)}let C={get action(){return a},get location(){return t(s,o)},listen(A){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(N0,m),l=A,()=>{s.removeEventListener(N0,m),l=null}},createHref(A){return e(s,A)},createURL:v,encodeLocation(A){let T=v(A);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:p,replace:x,go(A){return o.go(A)}};return C}var k0;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(k0||(k0={}));function eA(t,e,n){return n===void 0&&(n="/"),tA(t,e,n)}function tA(t,e,n,r){let s=typeof e=="string"?No(e):e,i=go(s.pathname||"/",n);if(i==null)return null;let o=_T(t);nA(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=fA(i);a=dA(o[l],d)}return a}function _T(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Ve(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let d=hs([r,l.relativePath]),h=n.concat(l);i.children&&i.children.length>0&&(Ve(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),_T(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:uA(d,i.index),routesMeta:h})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of wT(i.path))s(i,o,l)}),e}function wT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=wT(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function nA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:cA(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const rA=/^:[\w-]+$/,sA=3,iA=2,oA=1,aA=10,lA=-2,A0=t=>t==="*";function uA(t,e){let n=t.split("/"),r=n.length;return n.some(A0)&&(r+=lA),e&&(r+=iA),n.filter(s=>!A0(s)).reduce((s,i)=>s+(rA.test(i)?sA:i===""?oA:aA),r)}function cA(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function dA(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",m=km({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},h),p=l.route;if(!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:hs([i,m.pathname]),pathnameBase:vA(hs([i,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(i=hs([i,m.pathnameBase]))}return o}function km(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=hA(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,h,m)=>{let{paramName:p,isOptional:x}=h;if(p==="*"){let C=a[m]||"";o=i.slice(0,i.length-C.length).replace(/(.)\/+$/,"$1")}const v=a[m];return x&&!v?d[p]=void 0:d[p]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function hA(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),yT(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function fA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return yT(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function go(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function mA(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?No(t):t;return{pathname:n?n.startsWith("/")?n:pA(n,e):e,search:yA(r),hash:_A(s)}}function pA(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function of(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ag(t,e){let n=gA(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function lg(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=No(t):(s=al({},t),Ve(!s.pathname||!s.pathname.includes("?"),of("?","pathname","search",s)),Ve(!s.pathname||!s.pathname.includes("#"),of("#","pathname","hash",s)),Ve(!s.search||!s.search.includes("#"),of("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let m=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),m-=1;s.pathname=p.join("/")}a=m>=0?e[m]:"/"}let l=mA(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||h)&&(l.pathname+="/"),l}const hs=t=>t.join("/").replace(/\/\/+/g,"/"),vA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),yA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,_A=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function wA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const xT=["post","put","patch","delete"];new Set(xT);const xA=["get",...xT];new Set(xA);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ll(){return ll=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ll.apply(this,arguments)}const Sd=_.createContext(null),ET=_.createContext(null),Ar=_.createContext(null),Id=_.createContext(null),As=_.createContext({outlet:null,matches:[],isDataRoute:!1}),TT=_.createContext(null);function EA(t,e){let{relative:n}=e===void 0?{}:e;Co()||Ve(!1);let{basename:r,navigator:s}=_.useContext(Ar),{hash:i,pathname:o,search:a}=Nd(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:hs([r,o])),s.createHref({pathname:l,search:a,hash:i})}function Co(){return _.useContext(Id)!=null}function ko(){return Co()||Ve(!1),_.useContext(Id).location}function bT(t){_.useContext(Ar).static||_.useLayoutEffect(t)}function ug(){let{isDataRoute:t}=_.useContext(As);return t?OA():TA()}function TA(){Co()||Ve(!1);let t=_.useContext(Sd),{basename:e,future:n,navigator:r}=_.useContext(Ar),{matches:s}=_.useContext(As),{pathname:i}=ko(),o=JSON.stringify(ag(s,n.v7_relativeSplatPath)),a=_.useRef(!1);return bT(()=>{a.current=!0}),_.useCallback(function(d,h){if(h===void 0&&(h={}),!a.current)return;if(typeof d=="number"){r.go(d);return}let m=lg(d,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:hs([e,m.pathname])),(h.replace?r.replace:r.push)(m,h.state,h)},[e,r,o,i,t])}function Nd(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=_.useContext(Ar),{matches:s}=_.useContext(As),{pathname:i}=ko(),o=JSON.stringify(ag(s,r.v7_relativeSplatPath));return _.useMemo(()=>lg(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function bA(t,e){return SA(t,e)}function SA(t,e,n,r){Co()||Ve(!1);let{navigator:s}=_.useContext(Ar),{matches:i}=_.useContext(As),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let d=ko(),h;if(e){var m;let A=typeof e=="string"?No(e):e;l==="/"||(m=A.pathname)!=null&&m.startsWith(l)||Ve(!1),h=A}else h=d;let p=h.pathname||"/",x=p;if(l!=="/"){let A=l.replace(/^\//,"").split("/");x="/"+p.replace(/^\//,"").split("/").slice(A.length).join("/")}let v=eA(t,{pathname:x}),C=AA(v&&v.map(A=>Object.assign({},A,{params:Object.assign({},a,A.params),pathname:hs([l,s.encodeLocation?s.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?l:hs([l,s.encodeLocation?s.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),i,n,r);return e&&C?_.createElement(Id.Provider,{value:{location:ll({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:es.Pop}},C):C}function IA(){let t=DA(),e=wA(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),n?_.createElement("pre",{style:s},n):null,null)}const NA=_.createElement(IA,null);class CA extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?_.createElement(As.Provider,{value:this.props.routeContext},_.createElement(TT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function kA(t){let{routeContext:e,match:n,children:r}=t,s=_.useContext(Sd);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),_.createElement(As.Provider,{value:e},r)}function AA(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let h=o.findIndex(m=>m.route.id&&(a==null?void 0:a[m.route.id])!==void 0);h>=0||Ve(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let m=o[h];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=h),m.route.id){let{loaderData:p,errors:x}=n,v=m.route.loader&&p[m.route.id]===void 0&&(!x||x[m.route.id]===void 0);if(m.route.lazy||v){l=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,m,p)=>{let x,v=!1,C=null,A=null;n&&(x=a&&m.route.id?a[m.route.id]:void 0,C=m.route.errorElement||NA,l&&(d<0&&p===0?(MA("route-fallback"),v=!0,A=null):d===p&&(v=!0,A=m.route.hydrateFallbackElement||null)));let T=e.concat(o.slice(0,p+1)),y=()=>{let w;return x?w=C:v?w=A:m.route.Component?w=_.createElement(m.route.Component,null):m.route.element?w=m.route.element:w=h,_.createElement(kA,{match:m,routeContext:{outlet:h,matches:T,isDataRoute:n!=null},children:w})};return n&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?_.createElement(CA,{location:n.location,revalidation:n.revalidation,component:C,error:x,children:y(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):y()},null)}var ST=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(ST||{}),IT=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(IT||{});function PA(t){let e=_.useContext(Sd);return e||Ve(!1),e}function RA(t){let e=_.useContext(ET);return e||Ve(!1),e}function jA(t){let e=_.useContext(As);return e||Ve(!1),e}function NT(t){let e=jA(),n=e.matches[e.matches.length-1];return n.route.id||Ve(!1),n.route.id}function DA(){var t;let e=_.useContext(TT),n=RA(),r=NT();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function OA(){let{router:t}=PA(ST.UseNavigateStable),e=NT(IT.UseNavigateStable),n=_.useRef(!1);return bT(()=>{n.current=!0}),_.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,ll({fromRouteId:e},i)))},[t,e])}const P0={};function MA(t,e,n){P0[t]||(P0[t]=!0)}function LA(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function R0(t){let{to:e,replace:n,state:r,relative:s}=t;Co()||Ve(!1);let{future:i,static:o}=_.useContext(Ar),{matches:a}=_.useContext(As),{pathname:l}=ko(),d=ug(),h=lg(e,ag(a,i.v7_relativeSplatPath),l,s==="path"),m=JSON.stringify(h);return _.useEffect(()=>d(JSON.parse(m),{replace:n,state:r,relative:s}),[d,m,s,n,r]),null}function Jt(t){Ve(!1)}function VA(t){let{basename:e="/",children:n=null,location:r,navigationType:s=es.Pop,navigator:i,static:o=!1,future:a}=t;Co()&&Ve(!1);let l=e.replace(/^\/*/,"/"),d=_.useMemo(()=>({basename:l,navigator:i,static:o,future:ll({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=No(r));let{pathname:h="/",search:m="",hash:p="",state:x=null,key:v="default"}=r,C=_.useMemo(()=>{let A=go(h,l);return A==null?null:{location:{pathname:A,search:m,hash:p,state:x,key:v},navigationType:s}},[l,h,m,p,x,v,s]);return C==null?null:_.createElement(Ar.Provider,{value:d},_.createElement(Id.Provider,{children:n,value:C}))}function FA(t){let{children:e,location:n}=t;return bA(Am(e),n)}new Promise(()=>{});function Am(t,e){e===void 0&&(e=[]);let n=[];return _.Children.forEach(t,(r,s)=>{if(!_.isValidElement(r))return;let i=[...e,s];if(r.type===_.Fragment){n.push.apply(n,Am(r.props.children,i));return}r.type!==Jt&&Ve(!1),!r.props.index||!r.props.children||Ve(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Am(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mc(){return Mc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Mc.apply(this,arguments)}function CT(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function UA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function $A(t,e){return t.button===0&&(!e||e==="_self")&&!UA(t)}const BA=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],zA=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],WA="6";try{window.__reactRouterVersion=WA}catch{}const HA=_.createContext({isTransitioning:!1}),qA="startTransition",j0=Df[qA];function GA(t){let{basename:e,children:n,future:r,window:s}=t,i=_.useRef();i.current==null&&(i.current=Xk({window:s,v5Compat:!0}));let o=i.current,[a,l]=_.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=_.useCallback(m=>{d&&j0?j0(()=>l(m)):l(m)},[l,d]);return _.useLayoutEffect(()=>o.listen(h),[o,h]),_.useEffect(()=>LA(r),[r]),_.createElement(VA,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const KA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",QA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,YA=_.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:d,preventScrollReset:h,viewTransition:m}=e,p=CT(e,BA),{basename:x}=_.useContext(Ar),v,C=!1;if(typeof d=="string"&&QA.test(d)&&(v=d,KA))try{let w=new URL(window.location.href),N=d.startsWith("//")?new URL(w.protocol+d):new URL(d),j=go(N.pathname,x);N.origin===w.origin&&j!=null?d=j+N.search+N.hash:C=!0}catch{}let A=EA(d,{relative:s}),T=ZA(d,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:m});function y(w){r&&r(w),w.defaultPrevented||T(w)}return _.createElement("a",Mc({},p,{href:v||A,onClick:C||i?r:y,ref:n,target:l}))}),XA=_.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:a,to:l,viewTransition:d,children:h}=e,m=CT(e,zA),p=Nd(l,{relative:m.relative}),x=ko(),v=_.useContext(ET),{navigator:C,basename:A}=_.useContext(Ar),T=v!=null&&eP(p)&&d===!0,y=C.encodeLocation?C.encodeLocation(p).pathname:p.pathname,w=x.pathname,N=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;s||(w=w.toLowerCase(),N=N?N.toLowerCase():null,y=y.toLowerCase()),N&&A&&(N=go(N,A)||N);const j=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let D=w===y||!o&&w.startsWith(y)&&w.charAt(j)==="/",b=N!=null&&(N===y||!o&&N.startsWith(y)&&N.charAt(y.length)==="/"),E={isActive:D,isPending:b,isTransitioning:T},I=D?r:void 0,k;typeof i=="function"?k=i(E):k=[i,D?"active":null,b?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let R=typeof a=="function"?a(E):a;return _.createElement(YA,Mc({},m,{"aria-current":I,className:k,ref:n,style:R,to:l,viewTransition:d}),typeof h=="function"?h(E):h)});var Pm;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Pm||(Pm={}));var D0;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(D0||(D0={}));function JA(t){let e=_.useContext(Sd);return e||Ve(!1),e}function ZA(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=ug(),d=ko(),h=Nd(t,{relative:o});return _.useCallback(m=>{if($A(m,n)){m.preventDefault();let p=r!==void 0?r:Oc(d)===Oc(h);l(t,{replace:p,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[d,l,h,r,s,n,t,i,o,a])}function eP(t,e){e===void 0&&(e={});let n=_.useContext(HA);n==null&&Ve(!1);let{basename:r}=JA(Pm.useViewTransitionState),s=Nd(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=go(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=go(n.nextLocation.pathname,r)||n.nextLocation.pathname;return km(s.pathname,o)!=null||km(s.pathname,i)!=null}const tP=()=>{};var O0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},nP=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},AT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,d=l?t[s+2]:0,h=i>>2,m=(i&3)<<4|a>>4;let p=(a&15)<<2|d>>6,x=d&63;l||(x=64,o||(p=64)),r.push(n[h],n[m],n[p],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(kT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):nP(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||m==null)throw new rP;const p=i<<2|a>>4;if(r.push(p),d!==64){const x=a<<4&240|d>>2;if(r.push(x),m!==64){const v=d<<6&192|m;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class rP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sP=function(t){const e=kT(t);return AT.encodeByteArray(e,!0)},Lc=function(t){return sP(t).replace(/\./g,"")},PT=function(t){try{return AT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP=()=>iP().__FIREBASE_DEFAULTS__,aP=()=>{if(typeof process>"u"||typeof O0>"u")return;const t=O0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},lP=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&PT(t[1]);return e&&JSON.parse(e)},Cd=()=>{try{return tP()||oP()||aP()||lP()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},RT=t=>{var e,n;return(n=(e=Cd())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},cg=t=>{const e=RT(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},jT=()=>{var t;return(t=Cd())===null||t===void 0?void 0:t.config},DT=t=>{var e;return(e=Cd())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function kd(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Lc(JSON.stringify(n)),Lc(JSON.stringify(o)),""].join(".")}const Ra={};function cP(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ra))Ra[e]?t.emulator.push(e):t.prod.push(e);return t}function dP(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let M0=!1;function Ad(t,e){if(typeof window>"u"||typeof document>"u"||!Pr(window.location.host)||Ra[t]===e||Ra[t]||M0)return;Ra[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",i=cP().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,x){p.setAttribute("width","24"),p.setAttribute("id",x),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{M0=!0,o()},p}function h(p,x){p.setAttribute("id",x),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function m(){const p=dP(r),x=n("text"),v=document.getElementById(x)||document.createElement("span"),C=n("learnmore"),A=document.getElementById(C)||document.createElement("a"),T=n("preprendIcon"),y=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const w=p.element;a(w),h(A,C);const N=d();l(y,T),w.append(y,v,A,N),document.body.appendChild(w)}i?(v.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rt())}function fP(){var t;const e=(t=Cd())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function pP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function gP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vP(){const t=Rt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function yP(){return!fP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function MT(){try{return typeof indexedDB=="object"}catch{return!1}}function LT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function _P(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP="FirebaseError";class Mn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=wP,Object.setPrototypeOf(this,Mn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wi.prototype.create)}}class wi{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?xP(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Mn(s,a,r)}}function xP(t,e){return t.replace(EP,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const EP=/\{\$([^}]+)}/g;function TP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ui(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(L0(i)&&L0(o)){if(!ui(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function L0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ma(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function pa(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function bP(t,e){const n=new SP(t,e);return n.subscribe.bind(n)}class SP{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");IP(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=af),s.error===void 0&&(s.error=af),s.complete===void 0&&(s.complete=af);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function IP(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function af(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(t){return t&&t._delegate?t._delegate:t}class ln{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new uP;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kP(e))try{this.getOrInitializeService({instanceIdentifier:Ws})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ws){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ws){return this.instances.has(e)}getOptions(e=Ws){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:CP(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ws){return this.component?this.component.multipleInstances?e:Ws:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function CP(t){return t===Ws?void 0:t}function kP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new NP(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ce;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ce||(ce={}));const PP={debug:ce.DEBUG,verbose:ce.VERBOSE,info:ce.INFO,warn:ce.WARN,error:ce.ERROR,silent:ce.SILENT},RP=ce.INFO,jP={[ce.DEBUG]:"log",[ce.VERBOSE]:"log",[ce.INFO]:"info",[ce.WARN]:"warn",[ce.ERROR]:"error"},DP=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=jP[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dg{constructor(e){this.name=e,this._logLevel=RP,this._logHandler=DP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ce.DEBUG,...e),this._logHandler(this,ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ce.VERBOSE,...e),this._logHandler(this,ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ce.INFO,...e),this._logHandler(this,ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ce.WARN,...e),this._logHandler(this,ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ce.ERROR,...e),this._logHandler(this,ce.ERROR,...e)}}const OP=(t,e)=>e.some(n=>t instanceof n);let V0,F0;function MP(){return V0||(V0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function LP(){return F0||(F0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const VT=new WeakMap,Rm=new WeakMap,FT=new WeakMap,lf=new WeakMap,hg=new WeakMap;function VP(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(hr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&VT.set(n,t)}).catch(()=>{}),hg.set(e,t),e}function FP(t){if(Rm.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Rm.set(t,e)}let jm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Rm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||FT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return hr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function UP(t){jm=t(jm)}function $P(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(uf(this),e,...n);return FT.set(r,e.sort?e.sort():[e]),hr(r)}:LP().includes(t)?function(...e){return t.apply(uf(this),e),hr(VT.get(this))}:function(...e){return hr(t.apply(uf(this),e))}}function BP(t){return typeof t=="function"?$P(t):(t instanceof IDBTransaction&&FP(t),OP(t,MP())?new Proxy(t,jm):t)}function hr(t){if(t instanceof IDBRequest)return VP(t);if(lf.has(t))return lf.get(t);const e=BP(t);return e!==t&&(lf.set(t,e),hg.set(e,t)),e}const uf=t=>hg.get(t);function Pd(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=hr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(hr(o.result),l.oldVersion,l.newVersion,hr(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}function cf(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),hr(n).then(()=>{})}const zP=["get","getKey","getAll","getAllKeys","count"],WP=["put","add","delete","clear"],df=new Map;function U0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(df.get(e))return df.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=WP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||zP.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let d=l.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&l.done]))[0]};return df.set(e,i),i}UP(t=>({...t,get:(e,n,r)=>U0(e,n)||t.get(e,n,r),has:(e,n)=>!!U0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(qP(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function qP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Dm="@firebase/app",$0="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Er=new dg("@firebase/app"),GP="@firebase/app-compat",KP="@firebase/analytics-compat",QP="@firebase/analytics",YP="@firebase/app-check-compat",XP="@firebase/app-check",JP="@firebase/auth",ZP="@firebase/auth-compat",eR="@firebase/database",tR="@firebase/data-connect",nR="@firebase/database-compat",rR="@firebase/functions",sR="@firebase/functions-compat",iR="@firebase/installations",oR="@firebase/installations-compat",aR="@firebase/messaging",lR="@firebase/messaging-compat",uR="@firebase/performance",cR="@firebase/performance-compat",dR="@firebase/remote-config",hR="@firebase/remote-config-compat",fR="@firebase/storage",mR="@firebase/storage-compat",pR="@firebase/firestore",gR="@firebase/ai",vR="@firebase/firestore-compat",yR="firebase",_R="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om="[DEFAULT]",wR={[Dm]:"fire-core",[GP]:"fire-core-compat",[QP]:"fire-analytics",[KP]:"fire-analytics-compat",[XP]:"fire-app-check",[YP]:"fire-app-check-compat",[JP]:"fire-auth",[ZP]:"fire-auth-compat",[eR]:"fire-rtdb",[tR]:"fire-data-connect",[nR]:"fire-rtdb-compat",[rR]:"fire-fn",[sR]:"fire-fn-compat",[iR]:"fire-iid",[oR]:"fire-iid-compat",[aR]:"fire-fcm",[lR]:"fire-fcm-compat",[uR]:"fire-perf",[cR]:"fire-perf-compat",[dR]:"fire-rc",[hR]:"fire-rc-compat",[fR]:"fire-gcs",[mR]:"fire-gcs-compat",[pR]:"fire-fst",[vR]:"fire-fst-compat",[gR]:"fire-vertex","fire-js":"fire-js",[yR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=new Map,xR=new Map,Mm=new Map;function B0(t,e){try{t.container.addComponent(e)}catch(n){Er.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function _n(t){const e=t.name;if(Mm.has(e))return Er.debug(`There were multiple attempts to register component ${e}.`),!1;Mm.set(e,t);for(const n of ul.values())B0(n,t);for(const n of xR.values())B0(n,t);return!0}function Ps(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function en(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fs=new wi("app","Firebase",ER);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ln("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi=_R;function UT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Om,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw fs.create("bad-app-name",{appName:String(s)});if(n||(n=jT()),!n)throw fs.create("no-options");const i=ul.get(s);if(i){if(ui(n,i.options)&&ui(r,i.config))return i;throw fs.create("duplicate-app",{appName:s})}const o=new AP(s);for(const l of Mm.values())o.addComponent(l);const a=new TR(n,r,o);return ul.set(s,a),a}function Cl(t=Om){const e=ul.get(t);if(!e&&t===Om&&jT())return UT();if(!e)throw fs.create("no-app",{appName:t});return e}function bR(){return Array.from(ul.values())}function kt(t,e,n){var r;let s=(r=wR[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Er.warn(a.join(" "));return}_n(new ln(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SR="firebase-heartbeat-database",IR=1,cl="firebase-heartbeat-store";let hf=null;function $T(){return hf||(hf=Pd(SR,IR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(cl)}catch(n){console.warn(n)}}}}).catch(t=>{throw fs.create("idb-open",{originalErrorMessage:t.message})})),hf}async function NR(t){try{const n=(await $T()).transaction(cl),r=await n.objectStore(cl).get(BT(t));return await n.done,r}catch(e){if(e instanceof Mn)Er.warn(e.message);else{const n=fs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Er.warn(n.message)}}}async function z0(t,e){try{const r=(await $T()).transaction(cl,"readwrite");await r.objectStore(cl).put(e,BT(t)),await r.done}catch(n){if(n instanceof Mn)Er.warn(n.message);else{const r=fs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Er.warn(r.message)}}}function BT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR=1024,kR=30;class AR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new RR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=W0();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>kR){const o=jR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Er.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=W0(),{heartbeatsToSend:r,unsentEntries:s}=PR(this._heartbeatsCache.heartbeats),i=Lc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Er.warn(n),""}}}function W0(){return new Date().toISOString().substring(0,10)}function PR(t,e=CR){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),H0(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),H0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class RR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return MT()?LT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await NR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return z0(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return z0(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function H0(t){return Lc(JSON.stringify({version:2,heartbeats:t})).length}function jR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DR(t){_n(new ln("platform-logger",e=>new HP(e),"PRIVATE")),_n(new ln("heartbeat",e=>new AR(e),"PRIVATE")),kt(Dm,$0,t),kt(Dm,$0,"esm2017"),kt("fire-js","")}DR("");var OR="firebase",MR="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kt(OR,MR,"app");var q0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ms,zT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(b,E){function I(){}I.prototype=E.prototype,b.D=E.prototype,b.prototype=new I,b.prototype.constructor=b,b.C=function(k,R,O){for(var P=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)P[Se-2]=arguments[Se];return E.prototype[R].apply(k,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(b,E,I){I||(I=0);var k=Array(16);if(typeof E=="string")for(var R=0;16>R;++R)k[R]=E.charCodeAt(I++)|E.charCodeAt(I++)<<8|E.charCodeAt(I++)<<16|E.charCodeAt(I++)<<24;else for(R=0;16>R;++R)k[R]=E[I++]|E[I++]<<8|E[I++]<<16|E[I++]<<24;E=b.g[0],I=b.g[1],R=b.g[2];var O=b.g[3],P=E+(O^I&(R^O))+k[0]+3614090360&4294967295;E=I+(P<<7&4294967295|P>>>25),P=O+(R^E&(I^R))+k[1]+3905402710&4294967295,O=E+(P<<12&4294967295|P>>>20),P=R+(I^O&(E^I))+k[2]+606105819&4294967295,R=O+(P<<17&4294967295|P>>>15),P=I+(E^R&(O^E))+k[3]+3250441966&4294967295,I=R+(P<<22&4294967295|P>>>10),P=E+(O^I&(R^O))+k[4]+4118548399&4294967295,E=I+(P<<7&4294967295|P>>>25),P=O+(R^E&(I^R))+k[5]+1200080426&4294967295,O=E+(P<<12&4294967295|P>>>20),P=R+(I^O&(E^I))+k[6]+2821735955&4294967295,R=O+(P<<17&4294967295|P>>>15),P=I+(E^R&(O^E))+k[7]+4249261313&4294967295,I=R+(P<<22&4294967295|P>>>10),P=E+(O^I&(R^O))+k[8]+1770035416&4294967295,E=I+(P<<7&4294967295|P>>>25),P=O+(R^E&(I^R))+k[9]+2336552879&4294967295,O=E+(P<<12&4294967295|P>>>20),P=R+(I^O&(E^I))+k[10]+4294925233&4294967295,R=O+(P<<17&4294967295|P>>>15),P=I+(E^R&(O^E))+k[11]+2304563134&4294967295,I=R+(P<<22&4294967295|P>>>10),P=E+(O^I&(R^O))+k[12]+1804603682&4294967295,E=I+(P<<7&4294967295|P>>>25),P=O+(R^E&(I^R))+k[13]+4254626195&4294967295,O=E+(P<<12&4294967295|P>>>20),P=R+(I^O&(E^I))+k[14]+2792965006&4294967295,R=O+(P<<17&4294967295|P>>>15),P=I+(E^R&(O^E))+k[15]+1236535329&4294967295,I=R+(P<<22&4294967295|P>>>10),P=E+(R^O&(I^R))+k[1]+4129170786&4294967295,E=I+(P<<5&4294967295|P>>>27),P=O+(I^R&(E^I))+k[6]+3225465664&4294967295,O=E+(P<<9&4294967295|P>>>23),P=R+(E^I&(O^E))+k[11]+643717713&4294967295,R=O+(P<<14&4294967295|P>>>18),P=I+(O^E&(R^O))+k[0]+3921069994&4294967295,I=R+(P<<20&4294967295|P>>>12),P=E+(R^O&(I^R))+k[5]+3593408605&4294967295,E=I+(P<<5&4294967295|P>>>27),P=O+(I^R&(E^I))+k[10]+38016083&4294967295,O=E+(P<<9&4294967295|P>>>23),P=R+(E^I&(O^E))+k[15]+3634488961&4294967295,R=O+(P<<14&4294967295|P>>>18),P=I+(O^E&(R^O))+k[4]+3889429448&4294967295,I=R+(P<<20&4294967295|P>>>12),P=E+(R^O&(I^R))+k[9]+568446438&4294967295,E=I+(P<<5&4294967295|P>>>27),P=O+(I^R&(E^I))+k[14]+3275163606&4294967295,O=E+(P<<9&4294967295|P>>>23),P=R+(E^I&(O^E))+k[3]+4107603335&4294967295,R=O+(P<<14&4294967295|P>>>18),P=I+(O^E&(R^O))+k[8]+1163531501&4294967295,I=R+(P<<20&4294967295|P>>>12),P=E+(R^O&(I^R))+k[13]+2850285829&4294967295,E=I+(P<<5&4294967295|P>>>27),P=O+(I^R&(E^I))+k[2]+4243563512&4294967295,O=E+(P<<9&4294967295|P>>>23),P=R+(E^I&(O^E))+k[7]+1735328473&4294967295,R=O+(P<<14&4294967295|P>>>18),P=I+(O^E&(R^O))+k[12]+2368359562&4294967295,I=R+(P<<20&4294967295|P>>>12),P=E+(I^R^O)+k[5]+4294588738&4294967295,E=I+(P<<4&4294967295|P>>>28),P=O+(E^I^R)+k[8]+2272392833&4294967295,O=E+(P<<11&4294967295|P>>>21),P=R+(O^E^I)+k[11]+1839030562&4294967295,R=O+(P<<16&4294967295|P>>>16),P=I+(R^O^E)+k[14]+4259657740&4294967295,I=R+(P<<23&4294967295|P>>>9),P=E+(I^R^O)+k[1]+2763975236&4294967295,E=I+(P<<4&4294967295|P>>>28),P=O+(E^I^R)+k[4]+1272893353&4294967295,O=E+(P<<11&4294967295|P>>>21),P=R+(O^E^I)+k[7]+4139469664&4294967295,R=O+(P<<16&4294967295|P>>>16),P=I+(R^O^E)+k[10]+3200236656&4294967295,I=R+(P<<23&4294967295|P>>>9),P=E+(I^R^O)+k[13]+681279174&4294967295,E=I+(P<<4&4294967295|P>>>28),P=O+(E^I^R)+k[0]+3936430074&4294967295,O=E+(P<<11&4294967295|P>>>21),P=R+(O^E^I)+k[3]+3572445317&4294967295,R=O+(P<<16&4294967295|P>>>16),P=I+(R^O^E)+k[6]+76029189&4294967295,I=R+(P<<23&4294967295|P>>>9),P=E+(I^R^O)+k[9]+3654602809&4294967295,E=I+(P<<4&4294967295|P>>>28),P=O+(E^I^R)+k[12]+3873151461&4294967295,O=E+(P<<11&4294967295|P>>>21),P=R+(O^E^I)+k[15]+530742520&4294967295,R=O+(P<<16&4294967295|P>>>16),P=I+(R^O^E)+k[2]+3299628645&4294967295,I=R+(P<<23&4294967295|P>>>9),P=E+(R^(I|~O))+k[0]+4096336452&4294967295,E=I+(P<<6&4294967295|P>>>26),P=O+(I^(E|~R))+k[7]+1126891415&4294967295,O=E+(P<<10&4294967295|P>>>22),P=R+(E^(O|~I))+k[14]+2878612391&4294967295,R=O+(P<<15&4294967295|P>>>17),P=I+(O^(R|~E))+k[5]+4237533241&4294967295,I=R+(P<<21&4294967295|P>>>11),P=E+(R^(I|~O))+k[12]+1700485571&4294967295,E=I+(P<<6&4294967295|P>>>26),P=O+(I^(E|~R))+k[3]+2399980690&4294967295,O=E+(P<<10&4294967295|P>>>22),P=R+(E^(O|~I))+k[10]+4293915773&4294967295,R=O+(P<<15&4294967295|P>>>17),P=I+(O^(R|~E))+k[1]+2240044497&4294967295,I=R+(P<<21&4294967295|P>>>11),P=E+(R^(I|~O))+k[8]+1873313359&4294967295,E=I+(P<<6&4294967295|P>>>26),P=O+(I^(E|~R))+k[15]+4264355552&4294967295,O=E+(P<<10&4294967295|P>>>22),P=R+(E^(O|~I))+k[6]+2734768916&4294967295,R=O+(P<<15&4294967295|P>>>17),P=I+(O^(R|~E))+k[13]+1309151649&4294967295,I=R+(P<<21&4294967295|P>>>11),P=E+(R^(I|~O))+k[4]+4149444226&4294967295,E=I+(P<<6&4294967295|P>>>26),P=O+(I^(E|~R))+k[11]+3174756917&4294967295,O=E+(P<<10&4294967295|P>>>22),P=R+(E^(O|~I))+k[2]+718787259&4294967295,R=O+(P<<15&4294967295|P>>>17),P=I+(O^(R|~E))+k[9]+3951481745&4294967295,b.g[0]=b.g[0]+E&4294967295,b.g[1]=b.g[1]+(R+(P<<21&4294967295|P>>>11))&4294967295,b.g[2]=b.g[2]+R&4294967295,b.g[3]=b.g[3]+O&4294967295}r.prototype.u=function(b,E){E===void 0&&(E=b.length);for(var I=E-this.blockSize,k=this.B,R=this.h,O=0;O<E;){if(R==0)for(;O<=I;)s(this,b,O),O+=this.blockSize;if(typeof b=="string"){for(;O<E;)if(k[R++]=b.charCodeAt(O++),R==this.blockSize){s(this,k),R=0;break}}else for(;O<E;)if(k[R++]=b[O++],R==this.blockSize){s(this,k),R=0;break}}this.h=R,this.o+=E},r.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var E=1;E<b.length-8;++E)b[E]=0;var I=8*this.o;for(E=b.length-8;E<b.length;++E)b[E]=I&255,I/=256;for(this.u(b),b=Array(16),E=I=0;4>E;++E)for(var k=0;32>k;k+=8)b[I++]=this.g[E]>>>k&255;return b};function i(b,E){var I=a;return Object.prototype.hasOwnProperty.call(I,b)?I[b]:I[b]=E(b)}function o(b,E){this.h=E;for(var I=[],k=!0,R=b.length-1;0<=R;R--){var O=b[R]|0;k&&O==E||(I[R]=O,k=!1)}this.g=I}var a={};function l(b){return-128<=b&&128>b?i(b,function(E){return new o([E|0],0>E?-1:0)}):new o([b|0],0>b?-1:0)}function d(b){if(isNaN(b)||!isFinite(b))return m;if(0>b)return A(d(-b));for(var E=[],I=1,k=0;b>=I;k++)E[k]=b/I|0,I*=4294967296;return new o(E,0)}function h(b,E){if(b.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(b.charAt(0)=="-")return A(h(b.substring(1),E));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=d(Math.pow(E,8)),k=m,R=0;R<b.length;R+=8){var O=Math.min(8,b.length-R),P=parseInt(b.substring(R,R+O),E);8>O?(O=d(Math.pow(E,O)),k=k.j(O).add(d(P))):(k=k.j(I),k=k.add(d(P)))}return k}var m=l(0),p=l(1),x=l(16777216);t=o.prototype,t.m=function(){if(C(this))return-A(this).m();for(var b=0,E=1,I=0;I<this.g.length;I++){var k=this.i(I);b+=(0<=k?k:4294967296+k)*E,E*=4294967296}return b},t.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(v(this))return"0";if(C(this))return"-"+A(this).toString(b);for(var E=d(Math.pow(b,6)),I=this,k="";;){var R=N(I,E).g;I=T(I,R.j(E));var O=((0<I.g.length?I.g[0]:I.h)>>>0).toString(b);if(I=R,v(I))return O+k;for(;6>O.length;)O="0"+O;k=O+k}},t.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function v(b){if(b.h!=0)return!1;for(var E=0;E<b.g.length;E++)if(b.g[E]!=0)return!1;return!0}function C(b){return b.h==-1}t.l=function(b){return b=T(this,b),C(b)?-1:v(b)?0:1};function A(b){for(var E=b.g.length,I=[],k=0;k<E;k++)I[k]=~b.g[k];return new o(I,~b.h).add(p)}t.abs=function(){return C(this)?A(this):this},t.add=function(b){for(var E=Math.max(this.g.length,b.g.length),I=[],k=0,R=0;R<=E;R++){var O=k+(this.i(R)&65535)+(b.i(R)&65535),P=(O>>>16)+(this.i(R)>>>16)+(b.i(R)>>>16);k=P>>>16,O&=65535,P&=65535,I[R]=P<<16|O}return new o(I,I[I.length-1]&-2147483648?-1:0)};function T(b,E){return b.add(A(E))}t.j=function(b){if(v(this)||v(b))return m;if(C(this))return C(b)?A(this).j(A(b)):A(A(this).j(b));if(C(b))return A(this.j(A(b)));if(0>this.l(x)&&0>b.l(x))return d(this.m()*b.m());for(var E=this.g.length+b.g.length,I=[],k=0;k<2*E;k++)I[k]=0;for(k=0;k<this.g.length;k++)for(var R=0;R<b.g.length;R++){var O=this.i(k)>>>16,P=this.i(k)&65535,Se=b.i(R)>>>16,H=b.i(R)&65535;I[2*k+2*R]+=P*H,y(I,2*k+2*R),I[2*k+2*R+1]+=O*H,y(I,2*k+2*R+1),I[2*k+2*R+1]+=P*Se,y(I,2*k+2*R+1),I[2*k+2*R+2]+=O*Se,y(I,2*k+2*R+2)}for(k=0;k<E;k++)I[k]=I[2*k+1]<<16|I[2*k];for(k=E;k<2*E;k++)I[k]=0;return new o(I,0)};function y(b,E){for(;(b[E]&65535)!=b[E];)b[E+1]+=b[E]>>>16,b[E]&=65535,E++}function w(b,E){this.g=b,this.h=E}function N(b,E){if(v(E))throw Error("division by zero");if(v(b))return new w(m,m);if(C(b))return E=N(A(b),E),new w(A(E.g),A(E.h));if(C(E))return E=N(b,A(E)),new w(A(E.g),E.h);if(30<b.g.length){if(C(b)||C(E))throw Error("slowDivide_ only works with positive integers.");for(var I=p,k=E;0>=k.l(b);)I=j(I),k=j(k);var R=D(I,1),O=D(k,1);for(k=D(k,2),I=D(I,2);!v(k);){var P=O.add(k);0>=P.l(b)&&(R=R.add(I),O=P),k=D(k,1),I=D(I,1)}return E=T(b,R.j(E)),new w(R,E)}for(R=m;0<=b.l(E);){for(I=Math.max(1,Math.floor(b.m()/E.m())),k=Math.ceil(Math.log(I)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),O=d(I),P=O.j(E);C(P)||0<P.l(b);)I-=k,O=d(I),P=O.j(E);v(O)&&(O=p),R=R.add(O),b=T(b,P)}return new w(R,b)}t.A=function(b){return N(this,b).h},t.and=function(b){for(var E=Math.max(this.g.length,b.g.length),I=[],k=0;k<E;k++)I[k]=this.i(k)&b.i(k);return new o(I,this.h&b.h)},t.or=function(b){for(var E=Math.max(this.g.length,b.g.length),I=[],k=0;k<E;k++)I[k]=this.i(k)|b.i(k);return new o(I,this.h|b.h)},t.xor=function(b){for(var E=Math.max(this.g.length,b.g.length),I=[],k=0;k<E;k++)I[k]=this.i(k)^b.i(k);return new o(I,this.h^b.h)};function j(b){for(var E=b.g.length+1,I=[],k=0;k<E;k++)I[k]=b.i(k)<<1|b.i(k-1)>>>31;return new o(I,b.h)}function D(b,E){var I=E>>5;E%=32;for(var k=b.g.length-I,R=[],O=0;O<k;O++)R[O]=0<E?b.i(O+I)>>>E|b.i(O+I+1)<<32-E:b.i(O+I);return new o(R,b.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,zT=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,ms=o}).apply(typeof q0<"u"?q0:typeof self<"u"?self:typeof window<"u"?window:{});var ku=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var WT,ga,HT,Zu,Lm,qT,GT,KT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,g){return c==Array.prototype||c==Object.prototype||(c[f]=g.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof ku=="object"&&ku];for(var f=0;f<c.length;++f){var g=c[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(c,f){if(f)e:{var g=r;c=c.split(".");for(var S=0;S<c.length-1;S++){var M=c[S];if(!(M in g))break e;g=g[M]}c=c[c.length-1],S=g[c],f=f(S),f!=S&&f!=null&&e(g,c,{configurable:!0,writable:!0,value:f})}}function i(c,f){c instanceof String&&(c+="");var g=0,S=!1,M={next:function(){if(!S&&g<c.length){var L=g++;return{value:f(L,c[L]),done:!1}}return S=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}s("Array.prototype.values",function(c){return c||function(){return i(this,function(f,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function d(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function h(c,f,g){return c.call.apply(c.bind,arguments)}function m(c,f,g){if(!c)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,S),c.apply(f,M)}}return function(){return c.apply(f,arguments)}}function p(c,f,g){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:m,p.apply(null,arguments)}function x(c,f){var g=Array.prototype.slice.call(arguments,1);return function(){var S=g.slice();return S.push.apply(S,arguments),c.apply(this,S)}}function v(c,f){function g(){}g.prototype=f.prototype,c.aa=f.prototype,c.prototype=new g,c.prototype.constructor=c,c.Qb=function(S,M,L){for(var z=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)z[Ee-2]=arguments[Ee];return f.prototype[M].apply(S,z)}}function C(c){const f=c.length;if(0<f){const g=Array(f);for(let S=0;S<f;S++)g[S]=c[S];return g}return[]}function A(c,f){for(let g=1;g<arguments.length;g++){const S=arguments[g];if(l(S)){const M=c.length||0,L=S.length||0;c.length=M+L;for(let z=0;z<L;z++)c[M+z]=S[z]}else c.push(S)}}class T{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function y(c){return/^[\s\xa0]*$/.test(c)}function w(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function N(c){return N[" "](c),c}N[" "]=function(){};var j=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function D(c,f,g){for(const S in c)f.call(g,c[S],S,c)}function b(c,f){for(const g in c)f.call(void 0,c[g],g,c)}function E(c){const f={};for(const g in c)f[g]=c[g];return f}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(c,f){let g,S;for(let M=1;M<arguments.length;M++){S=arguments[M];for(g in S)c[g]=S[g];for(let L=0;L<I.length;L++)g=I[L],Object.prototype.hasOwnProperty.call(S,g)&&(c[g]=S[g])}}function R(c){var f=1;c=c.split(":");const g=[];for(;0<f&&c.length;)g.push(c.shift()),f--;return c.length&&g.push(c.join(":")),g}function O(c){a.setTimeout(()=>{throw c},0)}function P(){var c=G;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class Se{constructor(){this.h=this.g=null}add(f,g){const S=H.get();S.set(f,g),this.h?this.h.next=S:this.g=S,this.h=S}}var H=new T(()=>new he,c=>c.reset());class he{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,U=!1,G=new Se,Y=()=>{const c=a.Promise.resolve(void 0);ae=()=>{c.then(se)}};var se=()=>{for(var c;c=P();){try{c.h.call(c.g)}catch(g){O(g)}var f=H;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}U=!1};function Z(){this.s=this.s,this.C=this.C}Z.prototype.s=!1,Z.prototype.ma=function(){this.s||(this.s=!0,this.N())},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var He=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};a.addEventListener("test",g,f),a.removeEventListener("test",g,f)}catch{}return c}();function B(c,f){if(K.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var g=this.type=c.type,S=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(j){e:{try{N(f.nodeName);var M=!0;break e}catch{}M=!1}M||(f=null)}}else g=="mouseover"?f=c.fromElement:g=="mouseout"&&(f=c.toElement);this.relatedTarget=f,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:ie[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&B.aa.h.call(this)}}v(B,K);var ie={2:"touch",3:"pen",4:"mouse"};B.prototype.h=function(){B.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var le="closure_listenable_"+(1e6*Math.random()|0),De=0;function at(c,f,g,S,M){this.listener=c,this.proxy=null,this.src=f,this.type=g,this.capture=!!S,this.ha=M,this.key=++De,this.da=this.fa=!1}function qe(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function dn(c){this.src=c,this.g={},this.h=0}dn.prototype.add=function(c,f,g,S,M){var L=c.toString();c=this.g[L],c||(c=this.g[L]=[],this.h++);var z=Dr(c,f,S,M);return-1<z?(f=c[z],g||(f.fa=!1)):(f=new at(f,this.src,L,!!S,M),f.fa=g,c.push(f)),f};function jr(c,f){var g=f.type;if(g in c.g){var S=c.g[g],M=Array.prototype.indexOf.call(S,f,void 0),L;(L=0<=M)&&Array.prototype.splice.call(S,M,1),L&&(qe(f),c.g[g].length==0&&(delete c.g[g],c.h--))}}function Dr(c,f,g,S){for(var M=0;M<c.length;++M){var L=c[M];if(!L.da&&L.listener==f&&L.capture==!!g&&L.ha==S)return M}return-1}var Os="closure_lm_"+(1e6*Math.random()|0),Or={};function Ms(c,f,g,S,M){if(Array.isArray(f)){for(var L=0;L<f.length;L++)Ms(c,f[L],g,S,M);return null}return g=Ev(g),c&&c[le]?c.K(f,g,d(S)?!!S.capture:!1,M):QI(c,f,g,!1,S,M)}function QI(c,f,g,S,M,L){if(!f)throw Error("Invalid event type");var z=d(M)?!!M.capture:!!M,Ee=ph(c);if(Ee||(c[Os]=Ee=new dn(c)),g=Ee.add(f,g,S,z,L),g.proxy)return g;if(S=YI(),g.proxy=S,S.src=c,S.listener=g,c.addEventListener)He||(M=z),M===void 0&&(M=!1),c.addEventListener(f.toString(),S,M);else if(c.attachEvent)c.attachEvent(xv(f.toString()),S);else if(c.addListener&&c.removeListener)c.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return g}function YI(){function c(g){return f.call(c.src,c.listener,g)}const f=XI;return c}function wv(c,f,g,S,M){if(Array.isArray(f))for(var L=0;L<f.length;L++)wv(c,f[L],g,S,M);else S=d(S)?!!S.capture:!!S,g=Ev(g),c&&c[le]?(c=c.i,f=String(f).toString(),f in c.g&&(L=c.g[f],g=Dr(L,g,S,M),-1<g&&(qe(L[g]),Array.prototype.splice.call(L,g,1),L.length==0&&(delete c.g[f],c.h--)))):c&&(c=ph(c))&&(f=c.g[f.toString()],c=-1,f&&(c=Dr(f,g,S,M)),(g=-1<c?f[c]:null)&&mh(g))}function mh(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[le])jr(f.i,c);else{var g=c.type,S=c.proxy;f.removeEventListener?f.removeEventListener(g,S,c.capture):f.detachEvent?f.detachEvent(xv(g),S):f.addListener&&f.removeListener&&f.removeListener(S),(g=ph(f))?(jr(g,c),g.h==0&&(g.src=null,f[Os]=null)):qe(c)}}}function xv(c){return c in Or?Or[c]:Or[c]="on"+c}function XI(c,f){if(c.da)c=!0;else{f=new B(f,this);var g=c.listener,S=c.ha||c.src;c.fa&&mh(c),c=g.call(S,f)}return c}function ph(c){return c=c[Os],c instanceof dn?c:null}var gh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ev(c){return typeof c=="function"?c:(c[gh]||(c[gh]=function(f){return c.handleEvent(f)}),c[gh])}function wt(){Z.call(this),this.i=new dn(this),this.M=this,this.F=null}v(wt,Z),wt.prototype[le]=!0,wt.prototype.removeEventListener=function(c,f,g,S){wv(this,c,f,g,S)};function jt(c,f){var g,S=c.F;if(S)for(g=[];S;S=S.F)g.push(S);if(c=c.M,S=f.type||f,typeof f=="string")f=new K(f,c);else if(f instanceof K)f.target=f.target||c;else{var M=f;f=new K(S,c),k(f,M)}if(M=!0,g)for(var L=g.length-1;0<=L;L--){var z=f.g=g[L];M=Yl(z,S,!0,f)&&M}if(z=f.g=c,M=Yl(z,S,!0,f)&&M,M=Yl(z,S,!1,f)&&M,g)for(L=0;L<g.length;L++)z=f.g=g[L],M=Yl(z,S,!1,f)&&M}wt.prototype.N=function(){if(wt.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var g=c.g[f],S=0;S<g.length;S++)qe(g[S]);delete c.g[f],c.h--}}this.F=null},wt.prototype.K=function(c,f,g,S){return this.i.add(String(c),f,!1,g,S)},wt.prototype.L=function(c,f,g,S){return this.i.add(String(c),f,!0,g,S)};function Yl(c,f,g,S){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var M=!0,L=0;L<f.length;++L){var z=f[L];if(z&&!z.da&&z.capture==g){var Ee=z.listener,mt=z.ha||z.src;z.fa&&jr(c.i,z),M=Ee.call(mt,S)!==!1&&M}}return M&&!S.defaultPrevented}function Tv(c,f,g){if(typeof c=="function")g&&(c=p(c,g));else if(c&&typeof c.handleEvent=="function")c=p(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(c,f||0)}function bv(c){c.g=Tv(()=>{c.g=null,c.i&&(c.i=!1,bv(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class JI extends Z{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:bv(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vo(c){Z.call(this),this.h=c,this.g={}}v(Vo,Z);var Sv=[];function Iv(c){D(c.g,function(f,g){this.g.hasOwnProperty(g)&&mh(f)},c),c.g={}}Vo.prototype.N=function(){Vo.aa.N.call(this),Iv(this)},Vo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vh=a.JSON.stringify,ZI=a.JSON.parse,eN=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function yh(){}yh.prototype.h=null;function Nv(c){return c.h||(c.h=c.i())}function Cv(){}var Fo={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function _h(){K.call(this,"d")}v(_h,K);function wh(){K.call(this,"c")}v(wh,K);var Ls={},kv=null;function Xl(){return kv=kv||new wt}Ls.La="serverreachability";function Av(c){K.call(this,Ls.La,c)}v(Av,K);function Uo(c){const f=Xl();jt(f,new Av(f))}Ls.STAT_EVENT="statevent";function Pv(c,f){K.call(this,Ls.STAT_EVENT,c),this.stat=f}v(Pv,K);function Dt(c){const f=Xl();jt(f,new Pv(f,c))}Ls.Ma="timingevent";function Rv(c,f){K.call(this,Ls.Ma,c),this.size=f}v(Rv,K);function $o(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},f)}function Bo(){this.g=!0}Bo.prototype.xa=function(){this.g=!1};function tN(c,f,g,S,M,L){c.info(function(){if(c.g)if(L)for(var z="",Ee=L.split("&"),mt=0;mt<Ee.length;mt++){var ve=Ee[mt].split("=");if(1<ve.length){var xt=ve[0];ve=ve[1];var Et=xt.split("_");z=2<=Et.length&&Et[1]=="type"?z+(xt+"="+ve+"&"):z+(xt+"=redacted&")}}else z=null;else z=L;return"XMLHTTP REQ ("+S+") [attempt "+M+"]: "+f+`
`+g+`
`+z})}function nN(c,f,g,S,M,L,z){c.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+M+"]: "+f+`
`+g+`
`+L+" "+z})}function Ci(c,f,g,S){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+sN(c,g)+(S?" "+S:"")})}function rN(c,f){c.info(function(){return"TIMEOUT: "+f})}Bo.prototype.info=function(){};function sN(c,f){if(!c.g)return f;if(!f)return null;try{var g=JSON.parse(f);if(g){for(c=0;c<g.length;c++)if(Array.isArray(g[c])){var S=g[c];if(!(2>S.length)){var M=S[1];if(Array.isArray(M)&&!(1>M.length)){var L=M[0];if(L!="noop"&&L!="stop"&&L!="close")for(var z=1;z<M.length;z++)M[z]=""}}}}return vh(g)}catch{return f}}var Jl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},jv={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xh;function Zl(){}v(Zl,yh),Zl.prototype.g=function(){return new XMLHttpRequest},Zl.prototype.i=function(){return{}},xh=new Zl;function Mr(c,f,g,S){this.j=c,this.i=f,this.l=g,this.R=S||1,this.U=new Vo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Dv}function Dv(){this.i=null,this.g="",this.h=!1}var Ov={},Eh={};function Th(c,f,g){c.L=1,c.v=ru(tr(f)),c.m=g,c.P=!0,Mv(c,null)}function Mv(c,f){c.F=Date.now(),eu(c),c.A=tr(c.v);var g=c.A,S=c.R;Array.isArray(S)||(S=[String(S)]),Yv(g.i,"t",S),c.C=0,g=c.j.J,c.h=new Dv,c.g=my(c.j,g?f:null,!c.m),0<c.O&&(c.M=new JI(p(c.Y,c,c.g),c.O)),f=c.U,g=c.g,S=c.ca;var M="readystatechange";Array.isArray(M)||(M&&(Sv[0]=M.toString()),M=Sv);for(var L=0;L<M.length;L++){var z=Ms(g,M[L],S||f.handleEvent,!1,f.h||f);if(!z)break;f.g[z.key]=z}f=c.H?E(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),Uo(),tN(c.i,c.u,c.A,c.l,c.R,c.m)}Mr.prototype.ca=function(c){c=c.target;const f=this.M;f&&nr(c)==3?f.j():this.Y(c)},Mr.prototype.Y=function(c){try{if(c==this.g)e:{const Et=nr(this.g);var f=this.g.Ba();const Pi=this.g.Z();if(!(3>Et)&&(Et!=3||this.g&&(this.h.h||this.g.oa()||ry(this.g)))){this.J||Et!=4||f==7||(f==8||0>=Pi?Uo(3):Uo(2)),bh(this);var g=this.g.Z();this.X=g;t:if(Lv(this)){var S=ry(this.g);c="";var M=S.length,L=nr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vs(this),zo(this);var z="";break t}this.h.i=new a.TextDecoder}for(f=0;f<M;f++)this.h.h=!0,c+=this.h.i.decode(S[f],{stream:!(L&&f==M-1)});S.length=0,this.h.g+=c,this.C=0,z=this.h.g}else z=this.g.oa();if(this.o=g==200,nN(this.i,this.u,this.A,this.l,this.R,Et,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Ee,mt=this.g;if((Ee=mt.g?mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Ee)){var ve=Ee;break t}}ve=null}if(g=ve)Ci(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Sh(this,g);else{this.o=!1,this.s=3,Dt(12),Vs(this),zo(this);break e}}if(this.P){g=!0;let xn;for(;!this.J&&this.C<z.length;)if(xn=iN(this,z),xn==Eh){Et==4&&(this.s=4,Dt(14),g=!1),Ci(this.i,this.l,null,"[Incomplete Response]");break}else if(xn==Ov){this.s=4,Dt(15),Ci(this.i,this.l,z,"[Invalid Chunk]"),g=!1;break}else Ci(this.i,this.l,xn,null),Sh(this,xn);if(Lv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Et!=4||z.length!=0||this.h.h||(this.s=1,Dt(16),g=!1),this.o=this.o&&g,!g)Ci(this.i,this.l,z,"[Invalid Chunked Response]"),Vs(this),zo(this);else if(0<z.length&&!this.W){this.W=!0;var xt=this.j;xt.g==this&&xt.ba&&!xt.M&&(xt.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),Ph(xt),xt.M=!0,Dt(11))}}else Ci(this.i,this.l,z,null),Sh(this,z);Et==4&&Vs(this),this.o&&!this.J&&(Et==4?cy(this.j,this):(this.o=!1,eu(this)))}else EN(this.g),g==400&&0<z.indexOf("Unknown SID")?(this.s=3,Dt(12)):(this.s=0,Dt(13)),Vs(this),zo(this)}}}catch{}finally{}};function Lv(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function iN(c,f){var g=c.C,S=f.indexOf(`
`,g);return S==-1?Eh:(g=Number(f.substring(g,S)),isNaN(g)?Ov:(S+=1,S+g>f.length?Eh:(f=f.slice(S,S+g),c.C=S+g,f)))}Mr.prototype.cancel=function(){this.J=!0,Vs(this)};function eu(c){c.S=Date.now()+c.I,Vv(c,c.I)}function Vv(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=$o(p(c.ba,c),f)}function bh(c){c.B&&(a.clearTimeout(c.B),c.B=null)}Mr.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(rN(this.i,this.A),this.L!=2&&(Uo(),Dt(17)),Vs(this),this.s=2,zo(this)):Vv(this,this.S-c)};function zo(c){c.j.G==0||c.J||cy(c.j,c)}function Vs(c){bh(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,Iv(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function Sh(c,f){try{var g=c.j;if(g.G!=0&&(g.g==c||Ih(g.h,c))){if(!c.K&&Ih(g.h,c)&&g.G==3){try{var S=g.Da.g.parse(f)}catch{S=null}if(Array.isArray(S)&&S.length==3){var M=S;if(M[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<c.F)uu(g),au(g);else break e;Ah(g),Dt(18)}}else g.za=M[1],0<g.za-g.T&&37500>M[2]&&g.F&&g.v==0&&!g.C&&(g.C=$o(p(g.Za,g),6e3));if(1>=$v(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Us(g,11)}else if((c.K||g.g==c)&&uu(g),!y(f))for(M=g.Da.g.parse(f),f=0;f<M.length;f++){let ve=M[f];if(g.T=ve[0],ve=ve[1],g.G==2)if(ve[0]=="c"){g.K=ve[1],g.ia=ve[2];const xt=ve[3];xt!=null&&(g.la=xt,g.j.info("VER="+g.la));const Et=ve[4];Et!=null&&(g.Aa=Et,g.j.info("SVER="+g.Aa));const Pi=ve[5];Pi!=null&&typeof Pi=="number"&&0<Pi&&(S=1.5*Pi,g.L=S,g.j.info("backChannelRequestTimeoutMs_="+S)),S=g;const xn=c.g;if(xn){const du=xn.g?xn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(du){var L=S.h;L.g||du.indexOf("spdy")==-1&&du.indexOf("quic")==-1&&du.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Nh(L,L.h),L.h=null))}if(S.D){const Rh=xn.g?xn.g.getResponseHeader("X-HTTP-Session-Id"):null;Rh&&(S.ya=Rh,ke(S.I,S.D,Rh))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-c.F,g.j.info("Handshake RTT: "+g.R+"ms")),S=g;var z=c;if(S.qa=fy(S,S.J?S.ia:null,S.W),z.K){Bv(S.h,z);var Ee=z,mt=S.L;mt&&(Ee.I=mt),Ee.B&&(bh(Ee),eu(Ee)),S.g=z}else ly(S);0<g.i.length&&lu(g)}else ve[0]!="stop"&&ve[0]!="close"||Us(g,7);else g.G==3&&(ve[0]=="stop"||ve[0]=="close"?ve[0]=="stop"?Us(g,7):kh(g):ve[0]!="noop"&&g.l&&g.l.ta(ve),g.v=0)}}Uo(4)}catch{}}var oN=class{constructor(c,f){this.g=c,this.map=f}};function Fv(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Uv(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function $v(c){return c.h?1:c.g?c.g.size:0}function Ih(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function Nh(c,f){c.g?c.g.add(f):c.h=f}function Bv(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}Fv.prototype.cancel=function(){if(this.i=zv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function zv(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const g of c.g.values())f=f.concat(g.D);return f}return C(c.i)}function aN(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var f=[],g=c.length,S=0;S<g;S++)f.push(c[S]);return f}f=[],g=0;for(S in c)f[g++]=c[S];return f}function lN(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var f=[];c=c.length;for(var g=0;g<c;g++)f.push(g);return f}f=[],g=0;for(const S in c)f[g++]=S;return f}}}function Wv(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var g=lN(c),S=aN(c),M=S.length,L=0;L<M;L++)f.call(void 0,S[L],g&&g[L],c)}var Hv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uN(c,f){if(c){c=c.split("&");for(var g=0;g<c.length;g++){var S=c[g].indexOf("="),M=null;if(0<=S){var L=c[g].substring(0,S);M=c[g].substring(S+1)}else L=c[g];f(L,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Fs(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Fs){this.h=c.h,tu(this,c.j),this.o=c.o,this.g=c.g,nu(this,c.s),this.l=c.l;var f=c.i,g=new qo;g.i=f.i,f.g&&(g.g=new Map(f.g),g.h=f.h),qv(this,g),this.m=c.m}else c&&(f=String(c).match(Hv))?(this.h=!1,tu(this,f[1]||"",!0),this.o=Wo(f[2]||""),this.g=Wo(f[3]||"",!0),nu(this,f[4]),this.l=Wo(f[5]||"",!0),qv(this,f[6]||"",!0),this.m=Wo(f[7]||"")):(this.h=!1,this.i=new qo(null,this.h))}Fs.prototype.toString=function(){var c=[],f=this.j;f&&c.push(Ho(f,Gv,!0),":");var g=this.g;return(g||f=="file")&&(c.push("//"),(f=this.o)&&c.push(Ho(f,Gv,!0),"@"),c.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&c.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(Ho(g,g.charAt(0)=="/"?hN:dN,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",Ho(g,mN)),c.join("")};function tr(c){return new Fs(c)}function tu(c,f,g){c.j=g?Wo(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function nu(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function qv(c,f,g){f instanceof qo?(c.i=f,pN(c.i,c.h)):(g||(f=Ho(f,fN)),c.i=new qo(f,c.h))}function ke(c,f,g){c.i.set(f,g)}function ru(c){return ke(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Wo(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ho(c,f,g){return typeof c=="string"?(c=encodeURI(c).replace(f,cN),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function cN(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Gv=/[#\/\?@]/g,dN=/[#\?:]/g,hN=/[#\?]/g,fN=/[#\?@]/g,mN=/#/g;function qo(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function Lr(c){c.g||(c.g=new Map,c.h=0,c.i&&uN(c.i,function(f,g){c.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=qo.prototype,t.add=function(c,f){Lr(this),this.i=null,c=ki(this,c);var g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(f),this.h+=1,this};function Kv(c,f){Lr(c),f=ki(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function Qv(c,f){return Lr(c),f=ki(c,f),c.g.has(f)}t.forEach=function(c,f){Lr(this),this.g.forEach(function(g,S){g.forEach(function(M){c.call(f,M,S,this)},this)},this)},t.na=function(){Lr(this);const c=Array.from(this.g.values()),f=Array.from(this.g.keys()),g=[];for(let S=0;S<f.length;S++){const M=c[S];for(let L=0;L<M.length;L++)g.push(f[S])}return g},t.V=function(c){Lr(this);let f=[];if(typeof c=="string")Qv(this,c)&&(f=f.concat(this.g.get(ki(this,c))));else{c=Array.from(this.g.values());for(let g=0;g<c.length;g++)f=f.concat(c[g])}return f},t.set=function(c,f){return Lr(this),this.i=null,c=ki(this,c),Qv(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},t.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function Yv(c,f,g){Kv(c,f),0<g.length&&(c.i=null,c.g.set(ki(c,f),C(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(var g=0;g<f.length;g++){var S=f[g];const L=encodeURIComponent(String(S)),z=this.V(S);for(S=0;S<z.length;S++){var M=L;z[S]!==""&&(M+="="+encodeURIComponent(String(z[S]))),c.push(M)}}return this.i=c.join("&")};function ki(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function pN(c,f){f&&!c.j&&(Lr(c),c.i=null,c.g.forEach(function(g,S){var M=S.toLowerCase();S!=M&&(Kv(this,S),Yv(this,M,g))},c)),c.j=f}function gN(c,f){const g=new Bo;if(a.Image){const S=new Image;S.onload=x(Vr,g,"TestLoadImage: loaded",!0,f,S),S.onerror=x(Vr,g,"TestLoadImage: error",!1,f,S),S.onabort=x(Vr,g,"TestLoadImage: abort",!1,f,S),S.ontimeout=x(Vr,g,"TestLoadImage: timeout",!1,f,S),a.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=c}else f(!1)}function vN(c,f){const g=new Bo,S=new AbortController,M=setTimeout(()=>{S.abort(),Vr(g,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:S.signal}).then(L=>{clearTimeout(M),L.ok?Vr(g,"TestPingServer: ok",!0,f):Vr(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(M),Vr(g,"TestPingServer: error",!1,f)})}function Vr(c,f,g,S,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),S(g)}catch{}}function yN(){this.g=new eN}function _N(c,f,g){const S=g||"";try{Wv(c,function(M,L){let z=M;d(M)&&(z=vh(M)),f.push(S+L+"="+encodeURIComponent(z))})}catch(M){throw f.push(S+"type="+encodeURIComponent("_badmap")),M}}function su(c){this.l=c.Ub||null,this.j=c.eb||!1}v(su,yh),su.prototype.g=function(){return new iu(this.l,this.j)},su.prototype.i=function(c){return function(){return c}}({});function iu(c,f){wt.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(iu,wt),t=iu.prototype,t.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,Ko(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Go(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Ko(this)),this.g&&(this.readyState=3,Ko(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Xv(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Xv(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?Go(this):Ko(this),this.readyState==3&&Xv(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,Go(this))},t.Qa=function(c){this.g&&(this.response=c,Go(this))},t.ga=function(){this.g&&Go(this)};function Go(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Ko(c)}t.setRequestHeader=function(c,f){this.u.append(c,f)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=f.next();return c.join(`\r
`)};function Ko(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(iu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Jv(c){let f="";return D(c,function(g,S){f+=S,f+=":",f+=g,f+=`\r
`}),f}function Ch(c,f,g){e:{for(S in g){var S=!1;break e}S=!0}S||(g=Jv(g),typeof c=="string"?g!=null&&encodeURIComponent(String(g)):ke(c,f,g))}function $e(c){wt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v($e,wt);var wN=/^https?$/i,xN=["POST","PUT"];t=$e.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,f,g,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xh.g(),this.v=this.o?Nv(this.o):Nv(xh),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(L){Zv(this,L);return}if(c=g||"",g=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var M in S)g.set(M,S[M]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const L of S.keys())g.set(L,S.get(L));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(g.keys()).find(L=>L.toLowerCase()=="content-type"),M=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(xN,f,void 0))||S||M||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,z]of g)this.g.setRequestHeader(L,z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ny(this),this.u=!0,this.g.send(c),this.u=!1}catch(L){Zv(this,L)}};function Zv(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,ey(c),ou(c)}function ey(c){c.A||(c.A=!0,jt(c,"complete"),jt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,jt(this,"complete"),jt(this,"abort"),ou(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ou(this,!0)),$e.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ty(this):this.bb())},t.bb=function(){ty(this)};function ty(c){if(c.h&&typeof o<"u"&&(!c.v[1]||nr(c)!=4||c.Z()!=2)){if(c.u&&nr(c)==4)Tv(c.Ea,0,c);else if(jt(c,"readystatechange"),nr(c)==4){c.h=!1;try{const z=c.Z();e:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var S;if(S=z===0){var M=String(c.D).match(Hv)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),S=!wN.test(M?M.toLowerCase():"")}g=S}if(g)jt(c,"complete"),jt(c,"success");else{c.m=6;try{var L=2<nr(c)?c.g.statusText:""}catch{L=""}c.l=L+" ["+c.Z()+"]",ey(c)}}finally{ou(c)}}}}function ou(c,f){if(c.g){ny(c);const g=c.g,S=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||jt(c,"ready");try{g.onreadystatechange=S}catch{}}}function ny(c){c.I&&(a.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function nr(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<nr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),ZI(f)}};function ry(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function EN(c){const f={};c=(c.g&&2<=nr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<c.length;S++){if(y(c[S]))continue;var g=R(c[S]);const M=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const L=f[M]||[];f[M]=L,L.push(g)}b(f,function(S){return S.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qo(c,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||f}function sy(c){this.Aa=0,this.i=[],this.j=new Bo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Qo("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Qo("baseRetryDelayMs",5e3,c),this.cb=Qo("retryDelaySeedMs",1e4,c),this.Wa=Qo("forwardChannelMaxRetries",2,c),this.wa=Qo("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Fv(c&&c.concurrentRequestLimit),this.Da=new yN,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=sy.prototype,t.la=8,t.G=1,t.connect=function(c,f,g,S){Dt(0),this.W=c,this.H=f||{},g&&S!==void 0&&(this.H.OSID=g,this.H.OAID=S),this.F=this.X,this.I=fy(this,null,this.W),lu(this)};function kh(c){if(iy(c),c.G==3){var f=c.U++,g=tr(c.I);if(ke(g,"SID",c.K),ke(g,"RID",f),ke(g,"TYPE","terminate"),Yo(c,g),f=new Mr(c,c.j,f),f.L=2,f.v=ru(tr(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!g&&a.Image&&(new Image().src=f.v,g=!0),g||(f.g=my(f.j,null),f.g.ea(f.v)),f.F=Date.now(),eu(f)}hy(c)}function au(c){c.g&&(Ph(c),c.g.cancel(),c.g=null)}function iy(c){au(c),c.u&&(a.clearTimeout(c.u),c.u=null),uu(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function lu(c){if(!Uv(c.h)&&!c.s){c.s=!0;var f=c.Ga;ae||Y(),U||(ae(),U=!0),G.add(f,c),c.B=0}}function TN(c,f){return $v(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=$o(p(c.Ga,c,f),dy(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const M=new Mr(this,this.j,c);let L=this.o;if(this.S&&(L?(L=E(L),k(L,this.S)):L=this.S),this.m!==null||this.O||(M.H=L,L=null),this.P)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var S=this.i[g];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(f+=S,4096<f){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=ay(this,M,f),g=tr(this.I),ke(g,"RID",c),ke(g,"CVER",22),this.D&&ke(g,"X-HTTP-Session-Id",this.D),Yo(this,g),L&&(this.O?f="headers="+encodeURIComponent(String(Jv(L)))+"&"+f:this.m&&Ch(g,this.m,L)),Nh(this.h,M),this.Ua&&ke(g,"TYPE","init"),this.P?(ke(g,"$req",f),ke(g,"SID","null"),M.T=!0,Th(M,g,null)):Th(M,g,f),this.G=2}}else this.G==3&&(c?oy(this,c):this.i.length==0||Uv(this.h)||oy(this))};function oy(c,f){var g;f?g=f.l:g=c.U++;const S=tr(c.I);ke(S,"SID",c.K),ke(S,"RID",g),ke(S,"AID",c.T),Yo(c,S),c.m&&c.o&&Ch(S,c.m,c.o),g=new Mr(c,c.j,g,c.B+1),c.m===null&&(g.H=c.o),f&&(c.i=f.D.concat(c.i)),f=ay(c,g,1e3),g.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Nh(c.h,g),Th(g,S,f)}function Yo(c,f){c.H&&D(c.H,function(g,S){ke(f,S,g)}),c.l&&Wv({},function(g,S){ke(f,S,g)})}function ay(c,f,g){g=Math.min(c.i.length,g);var S=c.l?p(c.l.Na,c.l,c):null;e:{var M=c.i;let L=-1;for(;;){const z=["count="+g];L==-1?0<g?(L=M[0].g,z.push("ofs="+L)):L=0:z.push("ofs="+L);let Ee=!0;for(let mt=0;mt<g;mt++){let ve=M[mt].g;const xt=M[mt].map;if(ve-=L,0>ve)L=Math.max(0,M[mt].g-100),Ee=!1;else try{_N(xt,z,"req"+ve+"_")}catch{S&&S(xt)}}if(Ee){S=z.join("&");break e}}}return c=c.i.splice(0,g),f.D=c,S}function ly(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;ae||Y(),U||(ae(),U=!0),G.add(f,c),c.v=0}}function Ah(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=$o(p(c.Fa,c),dy(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,uy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=$o(p(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Dt(10),au(this),uy(this))};function Ph(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function uy(c){c.g=new Mr(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=tr(c.qa);ke(f,"RID","rpc"),ke(f,"SID",c.K),ke(f,"AID",c.T),ke(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&ke(f,"TO",c.ja),ke(f,"TYPE","xmlhttp"),Yo(c,f),c.m&&c.o&&Ch(f,c.m,c.o),c.L&&(c.g.I=c.L);var g=c.g;c=c.ia,g.L=1,g.v=ru(tr(f)),g.m=null,g.P=!0,Mv(g,c)}t.Za=function(){this.C!=null&&(this.C=null,au(this),Ah(this),Dt(19))};function uu(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function cy(c,f){var g=null;if(c.g==f){uu(c),Ph(c),c.g=null;var S=2}else if(Ih(c.h,f))g=f.D,Bv(c.h,f),S=1;else return;if(c.G!=0){if(f.o)if(S==1){g=f.m?f.m.length:0,f=Date.now()-f.F;var M=c.B;S=Xl(),jt(S,new Rv(S,g)),lu(c)}else ly(c);else if(M=f.s,M==3||M==0&&0<f.X||!(S==1&&TN(c,f)||S==2&&Ah(c)))switch(g&&0<g.length&&(f=c.h,f.i=f.i.concat(g)),M){case 1:Us(c,5);break;case 4:Us(c,10);break;case 3:Us(c,6);break;default:Us(c,2)}}}function dy(c,f){let g=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(g*=2),g*f}function Us(c,f){if(c.j.info("Error code "+f),f==2){var g=p(c.fb,c),S=c.Xa;const M=!S;S=new Fs(S||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||tu(S,"https"),ru(S),M?gN(S.toString(),g):vN(S.toString(),g)}else Dt(2);c.G=0,c.l&&c.l.sa(f),hy(c),iy(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function hy(c){if(c.G=0,c.ka=[],c.l){const f=zv(c.h);(f.length!=0||c.i.length!=0)&&(A(c.ka,f),A(c.ka,c.i),c.h.i.length=0,C(c.i),c.i.length=0),c.l.ra()}}function fy(c,f,g){var S=g instanceof Fs?tr(g):new Fs(g);if(S.g!="")f&&(S.g=f+"."+S.g),nu(S,S.s);else{var M=a.location;S=M.protocol,f=f?f+"."+M.hostname:M.hostname,M=+M.port;var L=new Fs(null);S&&tu(L,S),f&&(L.g=f),M&&nu(L,M),g&&(L.l=g),S=L}return g=c.D,f=c.ya,g&&f&&ke(S,g,f),ke(S,"VER",c.la),Yo(c,S),S}function my(c,f,g){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new $e(new su({eb:g})):new $e(c.pa),f.Ha(c.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function py(){}t=py.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function cu(){}cu.prototype.g=function(c,f){return new Xt(c,f)};function Xt(c,f){wt.call(this),this.g=new sy(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!y(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!y(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new Ai(this)}v(Xt,wt),Xt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Xt.prototype.close=function(){kh(this.g)},Xt.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.u&&(g={},g.__data__=vh(c),c=g);f.i.push(new oN(f.Ya++,c)),f.G==3&&lu(f)},Xt.prototype.N=function(){this.g.l=null,delete this.j,kh(this.g),delete this.g,Xt.aa.N.call(this)};function gy(c){_h.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const g in f){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}v(gy,_h);function vy(){wh.call(this),this.status=1}v(vy,wh);function Ai(c){this.g=c}v(Ai,py),Ai.prototype.ua=function(){jt(this.g,"a")},Ai.prototype.ta=function(c){jt(this.g,new gy(c))},Ai.prototype.sa=function(c){jt(this.g,new vy)},Ai.prototype.ra=function(){jt(this.g,"b")},cu.prototype.createWebChannel=cu.prototype.g,Xt.prototype.send=Xt.prototype.o,Xt.prototype.open=Xt.prototype.m,Xt.prototype.close=Xt.prototype.close,KT=function(){return new cu},GT=function(){return Xl()},qT=Ls,Lm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Jl.NO_ERROR=0,Jl.TIMEOUT=8,Jl.HTTP_ERROR=6,Zu=Jl,jv.COMPLETE="complete",HT=jv,Cv.EventType=Fo,Fo.OPEN="a",Fo.CLOSE="b",Fo.ERROR="c",Fo.MESSAGE="d",wt.prototype.listen=wt.prototype.K,ga=Cv,$e.prototype.listenOnce=$e.prototype.L,$e.prototype.getLastError=$e.prototype.Ka,$e.prototype.getLastErrorCode=$e.prototype.Ba,$e.prototype.getStatus=$e.prototype.Z,$e.prototype.getResponseJson=$e.prototype.Oa,$e.prototype.getResponseText=$e.prototype.oa,$e.prototype.send=$e.prototype.ea,$e.prototype.setWithCredentials=$e.prototype.Ha,WT=$e}).apply(typeof ku<"u"?ku:typeof self<"u"?self:typeof window<"u"?window:{});const G0="@firebase/firestore",K0="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}It.UNAUTHENTICATED=new It(null),It.GOOGLE_CREDENTIALS=new It("google-credentials-uid"),It.FIRST_PARTY=new It("first-party-uid"),It.MOCK_USER=new It("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ao="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci=new dg("@firebase/firestore");function Oi(){return ci.logLevel}function q(t,...e){if(ci.logLevel<=ce.DEBUG){const n=e.map(fg);ci.debug(`Firestore (${Ao}): ${t}`,...n)}}function Tr(t,...e){if(ci.logLevel<=ce.ERROR){const n=e.map(fg);ci.error(`Firestore (${Ao}): ${t}`,...n)}}function br(t,...e){if(ci.logLevel<=ce.WARN){const n=e.map(fg);ci.warn(`Firestore (${Ao}): ${t}`,...n)}}function fg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,QT(t,r,n)}function QT(t,e,n){let r=`FIRESTORE (${Ao}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Tr(r),new Error(r)}function me(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||QT(e,s,r)}function re(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends Mn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class XT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(It.UNAUTHENTICATED))}shutdown(){}}class LR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class VR{constructor(e){this.t=e,this.currentUser=It.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){me(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new fr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new fr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new fr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(me(typeof r.accessToken=="string",31837,{l:r}),new YT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return me(e===null||typeof e=="string",2055,{h:e}),new It(e)}}class FR{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=It.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class UR{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new FR(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(It.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Q0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $R{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,en(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){me(this.o===void 0,3512);const r=i=>{i.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Q0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(me(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Q0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=BR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function oe(t,e){return t<e?-1:t>e?1:0}function Vm(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return oe(r,s);{const i=JT(),o=zR(i.encode(Y0(t,n)),i.encode(Y0(e,n)));return o!==0?o:oe(r,s)}}n+=r>65535?2:1}return oe(t.length,e.length)}function Y0(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function zR(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return oe(t[n],e[n]);return oe(t.length,e.length)}function vo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0="__name__";class $n{constructor(e,n,r){n===void 0?n=0:n>e.length&&J(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&J(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return $n.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof $n?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=$n.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return oe(e.length,n.length)}static compareSegments(e,n){const r=$n.isNumericId(e),s=$n.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?$n.extractNumericId(e).compare($n.extractNumericId(n)):Vm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ms.fromString(e.substring(4,e.length-2))}}class xe extends $n{construct(e,n,r){return new xe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new xe(n)}static emptyPath(){return new xe([])}}const WR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dt extends $n{construct(e,n,r){return new dt(e,n,r)}static isValidIdentifier(e){return WR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===X0}static keyField(){return new dt([X0])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new W(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new W(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new W(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dt(n)}static emptyPath(){return new dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.path=e}static fromPath(e){return new X(xe.fromString(e))}static fromName(e){return new X(xe.fromString(e).popFirst(5))}static empty(){return new X(xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return xe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new xe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t,e,n){if(!n)throw new W(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function eb(t,e,n,r){if(e===!0&&r===!0)throw new W(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function J0(t){if(!X.isDocumentKey(t))throw new W(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Z0(t){if(X.isDocumentKey(t))throw new W(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function tb(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function jd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J(12329,{type:typeof t})}function Kt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=jd(t);throw new W(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function HR(t,e){if(e<=0)throw new W(V.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(t,e){const n={typeString:t};return e&&(n.value=e),n}function kl(t,e){if(!tb(t))throw new W(V.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new W(V.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=-62135596800,t_=1e6;class Ie{static now(){return Ie.fromMillis(Date.now())}static fromDate(e){return Ie.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*t_);return new Ie(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<e_)throw new W(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/t_}_compareTo(e){return this.seconds===e.seconds?oe(this.nanoseconds,e.nanoseconds):oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ie._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(kl(e,Ie._jsonSchema))return new Ie(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-e_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ie._jsonSchemaVersion="firestore/timestamp/1.0",Ie._jsonSchema={type:rt("string",Ie._jsonSchemaVersion),seconds:rt("number"),nanoseconds:rt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{static fromTimestamp(e){return new ee(e)}static min(){return new ee(new Ie(0,0))}static max(){return new ee(new Ie(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dl=-1;function qR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ee.fromTimestamp(r===1e9?new Ie(n+1,0):new Ie(n,r));return new ws(s,X.empty(),e)}function GR(t){return new ws(t.readTime,t.key,dl)}class ws{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ws(ee.min(),X.empty(),dl)}static max(){return new ws(ee.max(),X.empty(),dl)}}function KR(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=X.comparator(t.documentKey,e.documentKey),n!==0?n:oe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class YR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Po(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==QR)throw t;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(s=>s?F.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new F((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const d=l;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new F((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function XR(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ro(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Dd.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg=-1;function Al(t){return t==null}function Vc(t){return t===0&&1/t==-1/0}function JR(t){return typeof t=="number"&&Number.isInteger(t)&&!Vc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nb="";function ZR(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=n_(e)),e=e2(t.get(n),e);return n_(e)}function e2(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case nb:n+="";break;default:n+=i}}return n}function n_(t){return t+nb+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Rs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function rb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n){this.comparator=e,this.root=n||gt.EMPTY}insert(e,n){return new Ue(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,gt.BLACK,null,null))}remove(e){return new Ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Au(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Au(this.root,e,this.comparator,!1)}getReverseIterator(){return new Au(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Au(this.root,e,this.comparator,!0)}}class Au{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??gt.RED,this.left=s??gt.EMPTY,this.right=i??gt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new gt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return gt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return gt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw J(27949);return e+(this.isRed()?0:1)}}gt.EMPTY=null,gt.RED=!0,gt.BLACK=!1;gt.EMPTY=new class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new gt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new s_(this.data.getIterator())}getIteratorFrom(e){return new s_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ot)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ot(this.comparator);return n.data=e,n}}class s_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.fields=e,e.sort(dt.comparator)}static empty(){return new nn([])}unionWith(e){let n=new ot(dt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new nn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return vo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new sb("Invalid base64 string: "+i):i}}(e);return new ft(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ft(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ft.EMPTY_BYTE_STRING=new ft("");const t2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xs(t){if(me(!!t,39018),typeof t=="string"){let e=0;const n=t2.exec(t);if(me(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ge(t.seconds),nanos:Ge(t.nanos)}}function Ge(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Es(t){return typeof t=="string"?ft.fromBase64String(t):ft.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib="server_timestamp",ob="__type__",ab="__previous_value__",lb="__local_write_time__";function pg(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[ob])===null||n===void 0?void 0:n.stringValue)===ib}function Od(t){const e=t.mapValue.fields[ab];return pg(e)?Od(e):e}function hl(t){const e=xs(t.mapValue.fields[lb].timestampValue);return new Ie(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n,r,s,i,o,a,l,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=h}}const Fc="(default)";class yo{constructor(e,n){this.projectId=e,this.database=n||Fc}static empty(){return new yo("","")}get isDefaultDatabase(){return this.database===Fc}isEqual(e){return e instanceof yo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ub="__type__",r2="__max__",Pu={mapValue:{}},cb="__vector__",Uc="value";function Ts(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?pg(t)?4:i2(t)?9007199254740991:s2(t)?10:11:J(28295,{value:t})}function Xn(t,e){if(t===e)return!0;const n=Ts(t);if(n!==Ts(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return hl(t).isEqual(hl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=xs(s.timestampValue),a=xs(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Es(s.bytesValue).isEqual(Es(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ge(s.geoPointValue.latitude)===Ge(i.geoPointValue.latitude)&&Ge(s.geoPointValue.longitude)===Ge(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ge(s.integerValue)===Ge(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ge(s.doubleValue),a=Ge(i.doubleValue);return o===a?Vc(o)===Vc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return vo(t.arrayValue.values||[],e.arrayValue.values||[],Xn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(r_(o)!==r_(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Xn(o[l],a[l])))return!1;return!0}(t,e);default:return J(52216,{left:t})}}function fl(t,e){return(t.values||[]).find(n=>Xn(n,e))!==void 0}function _o(t,e){if(t===e)return 0;const n=Ts(t),r=Ts(e);if(n!==r)return oe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return oe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Ge(i.integerValue||i.doubleValue),l=Ge(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return i_(t.timestampValue,e.timestampValue);case 4:return i_(hl(t),hl(e));case 5:return Vm(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Es(i),l=Es(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let d=0;d<a.length&&d<l.length;d++){const h=oe(a[d],l[d]);if(h!==0)return h}return oe(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=oe(Ge(i.latitude),Ge(o.latitude));return a!==0?a:oe(Ge(i.longitude),Ge(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return o_(t.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,d,h;const m=i.fields||{},p=o.fields||{},x=(a=m[Uc])===null||a===void 0?void 0:a.arrayValue,v=(l=p[Uc])===null||l===void 0?void 0:l.arrayValue,C=oe(((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0,((h=v==null?void 0:v.values)===null||h===void 0?void 0:h.length)||0);return C!==0?C:o_(x,v)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Pu.mapValue&&o===Pu.mapValue)return 0;if(i===Pu.mapValue)return 1;if(o===Pu.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),d=o.fields||{},h=Object.keys(d);l.sort(),h.sort();for(let m=0;m<l.length&&m<h.length;++m){const p=Vm(l[m],h[m]);if(p!==0)return p;const x=_o(a[l[m]],d[h[m]]);if(x!==0)return x}return oe(l.length,h.length)}(t.mapValue,e.mapValue);default:throw J(23264,{le:n})}}function i_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return oe(t,e);const n=xs(t),r=xs(e),s=oe(n.seconds,r.seconds);return s!==0?s:oe(n.nanos,r.nanos)}function o_(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=_o(n[s],r[s]);if(i)return i}return oe(n.length,r.length)}function wo(t){return Fm(t)}function Fm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=xs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Es(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return X.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Fm(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Fm(n.fields[o])}`;return s+"}"}(t.mapValue):J(61005,{value:t})}function ec(t){switch(Ts(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Od(t);return e?16+ec(e):16;case 5:return 2*t.stringValue.length;case 6:return Es(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ec(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Rs(r.fields,(i,o)=>{s+=i.length+ec(o)}),s}(t.mapValue);default:throw J(13486,{value:t})}}function a_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Um(t){return!!t&&"integerValue"in t}function gg(t){return!!t&&"arrayValue"in t}function l_(t){return!!t&&"nullValue"in t}function u_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function tc(t){return!!t&&"mapValue"in t}function s2(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[ub])===null||n===void 0?void 0:n.stringValue)===cb}function ja(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Rs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ja(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ja(t.arrayValue.values[n]);return e}return Object.assign({},t)}function i2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===r2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.value=e}static empty(){return new Lt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!tc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ja(n)}setAll(e){let n=dt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=ja(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());tc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Xn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];tc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Rs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Lt(ja(this.value))}}function db(t){const e=[];return Rs(t.fields,(n,r)=>{const s=new dt([n]);if(tc(r)){const i=db(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new nn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ct(e,0,ee.min(),ee.min(),ee.min(),Lt.empty(),0)}static newFoundDocument(e,n,r,s){return new ct(e,1,n,ee.min(),r,s,0)}static newNoDocument(e,n){return new ct(e,2,n,ee.min(),ee.min(),Lt.empty(),0)}static newUnknownDocument(e,n){return new ct(e,3,n,ee.min(),ee.min(),Lt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ct&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ct(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,n){this.position=e,this.inclusive=n}}function c_(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=X.comparator(X.fromName(o.referenceValue),n.key):r=_o(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function d_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Xn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,n="asc"){this.field=e,this.dir=n}}function o2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{}class tt extends hb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new l2(e,n,r):n==="array-contains"?new d2(e,r):n==="in"?new h2(e,r):n==="not-in"?new f2(e,r):n==="array-contains-any"?new m2(e,r):new tt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new u2(e,r):new c2(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(_o(n,this.value)):n!==null&&Ts(this.value)===Ts(n)&&this.matchesComparison(_o(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dn extends hb{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new Dn(e,n)}matches(e){return fb(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function fb(t){return t.op==="and"}function mb(t){return a2(t)&&fb(t)}function a2(t){for(const e of t.filters)if(e instanceof Dn)return!1;return!0}function $m(t){if(t instanceof tt)return t.field.canonicalString()+t.op.toString()+wo(t.value);if(mb(t))return t.filters.map(e=>$m(e)).join(",");{const e=t.filters.map(n=>$m(n)).join(",");return`${t.op}(${e})`}}function pb(t,e){return t instanceof tt?function(r,s){return s instanceof tt&&r.op===s.op&&r.field.isEqual(s.field)&&Xn(r.value,s.value)}(t,e):t instanceof Dn?function(r,s){return s instanceof Dn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&pb(o,s.filters[a]),!0):!1}(t,e):void J(19439)}function gb(t){return t instanceof tt?function(n){return`${n.field.canonicalString()} ${n.op} ${wo(n.value)}`}(t):t instanceof Dn?function(n){return n.op.toString()+" {"+n.getFilters().map(gb).join(" ,")+"}"}(t):"Filter"}class l2 extends tt{constructor(e,n,r){super(e,n,r),this.key=X.fromName(r.referenceValue)}matches(e){const n=X.comparator(e.key,this.key);return this.matchesComparison(n)}}class u2 extends tt{constructor(e,n){super(e,"in",n),this.keys=vb("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class c2 extends tt{constructor(e,n){super(e,"not-in",n),this.keys=vb("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function vb(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}class d2 extends tt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return gg(n)&&fl(n.arrayValue,this.value)}}class h2 extends tt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&fl(this.value.arrayValue,n)}}class f2 extends tt{constructor(e,n){super(e,"not-in",n)}matches(e){if(fl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!fl(this.value.arrayValue,n)}}class m2 extends tt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!gg(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>fl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Pe=null}}function h_(t,e=null,n=[],r=[],s=null,i=null,o=null){return new p2(t,e,n,r,s,i,o)}function vg(t){const e=re(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>$m(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Al(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>wo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>wo(r)).join(",")),e.Pe=n}return e.Pe}function yg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!o2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!pb(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!d_(t.startAt,e.startAt)&&d_(t.endAt,e.endAt)}function Bm(t){return X.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function g2(t,e,n,r,s,i,o,a){return new jo(t,e,n,r,s,i,o,a)}function _g(t){return new jo(t)}function f_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yb(t){return t.collectionGroup!==null}function Da(t){const e=re(t);if(e.Te===null){e.Te=[];const n=new Set;for(const i of e.explicitOrderBy)e.Te.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ot(dt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Te.push(new ml(i,r))}),n.has(dt.keyField().canonicalString())||e.Te.push(new ml(dt.keyField(),r))}return e.Te}function qn(t){const e=re(t);return e.Ie||(e.Ie=v2(e,Da(t))),e.Ie}function v2(t,e){if(t.limitType==="F")return h_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ml(s.field,i)});const n=t.endAt?new $c(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new $c(t.startAt.position,t.startAt.inclusive):null;return h_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function zm(t,e){const n=t.filters.concat([e]);return new jo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Bc(t,e,n){return new jo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Md(t,e){return yg(qn(t),qn(e))&&t.limitType===e.limitType}function _b(t){return`${vg(qn(t))}|lt:${t.limitType}`}function Mi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>gb(s)).join(", ")}]`),Al(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>wo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>wo(s)).join(",")),`Target(${r})`}(qn(t))}; limitType=${t.limitType})`}function Ld(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):X.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Da(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const d=c_(o,a,l);return o.inclusive?d<=0:d<0}(r.startAt,Da(r),s)||r.endAt&&!function(o,a,l){const d=c_(o,a,l);return o.inclusive?d>=0:d>0}(r.endAt,Da(r),s))}(t,e)}function y2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wb(t){return(e,n)=>{let r=!1;for(const s of Da(t)){const i=_2(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function _2(t,e,n){const r=t.field.isKeyField()?X.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),d=a.data.field(i);return l!==null&&d!==null?_o(l,d):J(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return J(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Rs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return rb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=new Ue(X.comparator);function Sr(){return w2}const xb=new Ue(X.comparator);function va(...t){let e=xb;for(const n of t)e=e.insert(n.key,n);return e}function Eb(t){let e=xb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Xs(){return Oa()}function Tb(){return Oa()}function Oa(){return new Ei(t=>t.toString(),(t,e)=>t.isEqual(e))}const x2=new Ue(X.comparator),E2=new ot(X.comparator);function de(...t){let e=E2;for(const n of t)e=e.add(n);return e}const T2=new ot(oe);function b2(){return T2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vc(e)?"-0":e}}function bb(t){return{integerValue:""+t}}function S2(t,e){return JR(e)?bb(e):wg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(){this._=void 0}}function I2(t,e,n){return t instanceof pl?function(s,i){const o={fields:{[ob]:{stringValue:ib},[lb]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&pg(i)&&(i=Od(i)),i&&(o.fields[ab]=i),{mapValue:o}}(n,e):t instanceof gl?Ib(t,e):t instanceof vl?Nb(t,e):function(s,i){const o=Sb(s,i),a=m_(o)+m_(s.Ee);return Um(o)&&Um(s.Ee)?bb(a):wg(s.serializer,a)}(t,e)}function N2(t,e,n){return t instanceof gl?Ib(t,e):t instanceof vl?Nb(t,e):n}function Sb(t,e){return t instanceof zc?function(r){return Um(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class pl extends Vd{}class gl extends Vd{constructor(e){super(),this.elements=e}}function Ib(t,e){const n=Cb(e);for(const r of t.elements)n.some(s=>Xn(s,r))||n.push(r);return{arrayValue:{values:n}}}class vl extends Vd{constructor(e){super(),this.elements=e}}function Nb(t,e){let n=Cb(e);for(const r of t.elements)n=n.filter(s=>!Xn(s,r));return{arrayValue:{values:n}}}class zc extends Vd{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function m_(t){return Ge(t.integerValue||t.doubleValue)}function Cb(t){return gg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e,n){this.field=e,this.transform=n}}function k2(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof gl&&s instanceof gl||r instanceof vl&&s instanceof vl?vo(r.elements,s.elements,Xn):r instanceof zc&&s instanceof zc?Xn(r.Ee,s.Ee):r instanceof pl&&s instanceof pl}(t.transform,e.transform)}class A2{constructor(e,n){this.version=e,this.transformResults=n}}class vt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new vt}static exists(e){return new vt(void 0,e)}static updateTime(e){return new vt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Fd{}function kb(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ud(t.key,vt.none()):new Pl(t.key,t.data,vt.none());{const n=t.data,r=Lt.empty();let s=new ot(dt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new js(t.key,r,new nn(s.toArray()),vt.none())}}function P2(t,e,n){t instanceof Pl?function(s,i,o){const a=s.value.clone(),l=g_(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof js?function(s,i,o){if(!nc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=g_(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Ab(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ma(t,e,n,r){return t instanceof Pl?function(i,o,a,l){if(!nc(i.precondition,o))return a;const d=i.value.clone(),h=v_(i.fieldTransforms,l,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof js?function(i,o,a,l){if(!nc(i.precondition,o))return a;const d=v_(i.fieldTransforms,l,o),h=o.data;return h.setAll(Ab(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,a){return nc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function R2(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Sb(r.transform,s||null);i!=null&&(n===null&&(n=Lt.empty()),n.set(r.field,i))}return n||null}function p_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&vo(r,s,(i,o)=>k2(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Pl extends Fd{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class js extends Fd{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ab(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function g_(t,e,n){const r=new Map;me(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,N2(o,a,n[s]))}return r}function v_(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,I2(i,o,e))}return r}class Ud extends Fd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Pb extends Fd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&P2(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ma(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ma(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Tb();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=kb(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ee.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),de())}isEqual(e){return this.batchId===e.batchId&&vo(this.mutations,e.mutations,(n,r)=>p_(n,r))&&vo(this.baseMutations,e.baseMutations,(n,r)=>p_(n,r))}}class xg{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){me(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=function(){return x2}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new xg(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je,fe;function Rb(t){switch(t){case V.OK:return J(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return J(15467,{code:t})}}function jb(t){if(t===void 0)return Tr("GRPC error has no .code"),V.UNKNOWN;switch(t){case Je.OK:return V.OK;case Je.CANCELLED:return V.CANCELLED;case Je.UNKNOWN:return V.UNKNOWN;case Je.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Je.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Je.INTERNAL:return V.INTERNAL;case Je.UNAVAILABLE:return V.UNAVAILABLE;case Je.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Je.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Je.NOT_FOUND:return V.NOT_FOUND;case Je.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Je.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Je.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Je.ABORTED:return V.ABORTED;case Je.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Je.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Je.DATA_LOSS:return V.DATA_LOSS;default:return J(39323,{code:t})}}(fe=Je||(Je={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2=new ms([4294967295,4294967295],0);function y_(t){const e=JT().encode(t),n=new zT;return n.update(e),new Uint8Array(n.digest())}function __(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ms([n,r],0),new ms([s,i],0)]}class Eg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ya(`Invalid padding: ${n}`);if(r<0)throw new ya(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ya(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ya(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=ms.fromNumber(this.fe)}pe(e,n,r){let s=e.add(n.multiply(ms.fromNumber(r)));return s.compare(M2)===1&&(s=new ms([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=y_(e),[r,s]=__(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);if(!this.ye(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Eg(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.fe===0)return;const n=y_(e),[r,s]=__(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);this.we(o)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ya extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Rl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new $d(ee.min(),s,new Ue(oe),Sr(),de())}}class Rl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Rl(r,n,de(),de(),de())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=s}}class Db{constructor(e,n){this.targetId=e,this.De=n}}class Ob{constructor(e,n,r=ft.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class w_{constructor(){this.ve=0,this.Ce=x_(),this.Fe=ft.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=de(),n=de(),r=de();return this.Ce.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:J(38017,{changeType:i})}}),new Rl(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=x_()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,me(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class L2{constructor(e){this.We=e,this.Ge=new Map,this.ze=Sr(),this.je=Ru(),this.Je=Ru(),this.He=new Ue(oe)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:J(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,s)=>{this.nt(s)&&n(s)})}it(e){const n=e.targetId,r=e.De.count,s=this.st(n);if(s){const i=s.target;if(Bm(i))if(r===0){const o=new X(i.path);this.Xe(n,o,ct.newNoDocument(o,ee.min()))}else me(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const a=this._t(e),l=a?this.ut(a,e,o):1;if(l!==0){this.rt(n);const d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,d)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Es(r).toUint8Array()}catch(l){if(l instanceof sb)return br("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Eg(o,s,i)}catch(l){return br(l instanceof ya?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.fe===0?null:a}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.We.lt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Xe(n,i,null),s++)}),s}Pt(e){const n=new Map;this.Ge.forEach((i,o)=>{const a=this.st(o);if(a){if(i.current&&Bm(a.target)){const l=new X(a.target.path);this.Tt(l).has(o)||this.It(o,l)||this.Xe(o,l,ct.newNoDocument(l,e))}i.Ne&&(n.set(o,i.Le()),i.ke())}});let r=de();this.Je.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const d=this.st(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ze.forEach((i,o)=>o.setReadTime(e));const s=new $d(e,n,this.He,this.ze,r);return this.ze=Sr(),this.je=Ru(),this.Je=Ru(),this.He=new Ue(oe),s}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,n)?s.qe(n,1):s.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new w_,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new ot(oe),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new ot(oe),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||q("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new w_),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}}function Ru(){return new Ue(X.comparator)}function x_(){return new Ue(X.comparator)}const V2={asc:"ASCENDING",desc:"DESCENDING"},F2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},U2={and:"AND",or:"OR"};class $2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Wm(t,e){return t.useProto3Json||Al(e)?e:{value:e}}function Wc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function B2(t,e){return Wc(t,e.toTimestamp())}function on(t){return me(!!t,49232),ee.fromTimestamp(function(n){const r=xs(n);return new Ie(r.seconds,r.nanos)}(t))}function Tg(t,e){return Hm(t,e).canonicalString()}function Hm(t,e){const n=function(s){return new xe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Lb(t){const e=xe.fromString(t);return me(zb(e),10190,{key:e.toString()}),e}function Hc(t,e){return Tg(t.databaseId,e.path)}function La(t,e){const n=Lb(e);if(n.get(1)!==t.databaseId.projectId)throw new W(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new X(Fb(n))}function Vb(t,e){return Tg(t.databaseId,e)}function z2(t){const e=Lb(t);return e.length===4?xe.emptyPath():Fb(e)}function qm(t){return new xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Fb(t){return me(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function E_(t,e,n){return{name:Hc(t,e),fields:n.value.mapValue.fields}}function W2(t,e){return"found"in e?function(r,s){me(!!s.found,43571),s.found.name,s.found.updateTime;const i=La(r,s.found.name),o=on(s.found.updateTime),a=s.found.createTime?on(s.found.createTime):ee.min(),l=new Lt({mapValue:{fields:s.found.fields}});return ct.newFoundDocument(i,o,a,l)}(t,e):"missing"in e?function(r,s){me(!!s.missing,3894),me(!!s.readTime,22933);const i=La(r,s.missing),o=on(s.readTime);return ct.newNoDocument(i,o)}(t,e):J(7234,{result:e})}function H2(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:J(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(me(h===void 0||typeof h=="string",58123),ft.fromBase64String(h||"")):(me(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ft.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?V.UNKNOWN:jb(d.code);return new W(h,d.message||"")}(o);n=new Ob(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=La(t,r.document.name),i=on(r.document.updateTime),o=r.document.createTime?on(r.document.createTime):ee.min(),a=new Lt({mapValue:{fields:r.document.fields}}),l=ct.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new rc(d,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=La(t,r.document),i=r.readTime?on(r.readTime):ee.min(),o=ct.newNoDocument(s,i),a=r.removedTargetIds||[];n=new rc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=La(t,r.document),i=r.removedTargetIds||[];n=new rc([],i,s,null)}else{if(!("filter"in e))return J(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new O2(s,i),a=r.targetId;n=new Db(a,o)}}return n}function Ub(t,e){let n;if(e instanceof Pl)n={update:E_(t,e.key,e.value)};else if(e instanceof Ud)n={delete:Hc(t,e.key)};else if(e instanceof js)n={update:E_(t,e.key,e.data),updateMask:ej(e.fieldMask)};else{if(!(e instanceof Pb))return J(16599,{Rt:e.type});n={verify:Hc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof pl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof gl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof vl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof zc)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw J(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:B2(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:J(27497)}(t,e.precondition)),n}function q2(t,e){return t&&t.length>0?(me(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?on(s.updateTime):on(i);return o.isEqual(ee.min())&&(o=on(i)),new A2(o,s.transformResults||[])}(n,e))):[]}function G2(t,e){return{documents:[Vb(t,e.path)]}}function K2(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Vb(t,s);const i=function(d){if(d.length!==0)return Bb(Dn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(p){return{field:Li(p.field),direction:X2(p.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Wm(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:n,parent:s}}function Q2(t){let e=z2(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){me(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(m){const p=$b(m);return p instanceof Dn&&mb(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(p=>function(v){return new ml(Vi(v.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(m){let p;return p=typeof m=="object"?m.value:m,Al(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(m){const p=!!m.before,x=m.values||[];return new $c(x,p)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const p=!m.before,x=m.values||[];return new $c(x,p)}(n.endAt)),g2(e,s,o,i,a,"F",l,d)}function Y2(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function $b(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Vi(n.unaryFilter.field);return tt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Vi(n.unaryFilter.field);return tt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Vi(n.unaryFilter.field);return tt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Vi(n.unaryFilter.field);return tt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}}(t):t.fieldFilter!==void 0?function(n){return tt.create(Vi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Dn.create(n.compositeFilter.filters.map(r=>$b(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return J(1026)}}(n.compositeFilter.op))}(t):J(30097,{filter:t})}function X2(t){return V2[t]}function J2(t){return F2[t]}function Z2(t){return U2[t]}function Li(t){return{fieldPath:t.canonicalString()}}function Vi(t){return dt.fromServerFormat(t.fieldPath)}function Bb(t){return t instanceof tt?function(n){if(n.op==="=="){if(u_(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NAN"}};if(l_(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(u_(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NOT_NAN"}};if(l_(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Li(n.field),op:J2(n.op),value:n.value}}}(t):t instanceof Dn?function(n){const r=n.getFilters().map(s=>Bb(s));return r.length===1?r[0]:{compositeFilter:{op:Z2(n.op),filters:r}}}(t):J(54877,{filter:t})}function ej(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function zb(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,n,r,s,i=ee.min(),o=ee.min(),a=ft.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(e){this.gt=e}}function nj(t){const e=Q2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Bc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(){this.Dn=new sj}addToCollectionParentIndex(e,n){return this.Dn.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(ws.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(ws.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class sj{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ot(xe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ot(xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Wb=41943040;class $t{static withCacheSize(e){return new $t(e,$t.DEFAULT_COLLECTION_PERCENTILE,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$t.DEFAULT_COLLECTION_PERCENTILE=10,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$t.DEFAULT=new $t(Wb,$t.DEFAULT_COLLECTION_PERCENTILE,$t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$t.DISABLED=new $t(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new xo(0)}static ur(){return new xo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_="LruGarbageCollector",ij=1048576;function S_([t,e],[n,r]){const s=oe(t,n);return s===0?oe(e,r):s}class oj{constructor(e){this.Tr=e,this.buffer=new ot(S_),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();S_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class aj{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){q(b_,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ro(n)?q(b_,"Ignoring IndexedDB error during garbage collection: ",n):await Po(n)}await this.Rr(3e5)})}}class lj{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return F.resolve(Dd.ue);const r=new oj(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(T_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),T_):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,s,i,o,a,l,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),Oi()<=ce.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${m} documents in `+(d-l)+`ms
Total Duration: ${d-h}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function uj(t,e){return new lj(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(){this.changes=new Ei(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ct.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Ma(r.mutation,s,nn.empty(),Ie.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,de()).next(()=>r))}getLocalViewOfDocuments(e,n,r=de()){const s=Xs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=va();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Xs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,de()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Sr();const o=Oa(),a=function(){return Oa()}();return n.forEach((l,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof js)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Ma(h.mutation,d,h.mutation.getFieldMask(),Ie.now())):o.set(d.key,nn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var m;return a.set(d,new dj(h,(m=o.get(d))!==null&&m!==void 0?m:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Oa();let s=new Ue((o,a)=>o-a),i=de();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const d=n.get(l);if(d===null)return;let h=r.get(l)||nn.empty();h=a.applyToLocalView(d,h),r.set(l,h);const m=(s.get(a.batchId)||de()).add(l);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),d=l.key,h=l.value,m=Tb();h.forEach(p=>{if(!i.has(p)){const x=kb(n.get(p),r.get(p));x!==null&&m.set(p,x),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return X.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yb(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):F.resolve(Xs());let a=dl,l=i;return o.next(d=>F.forEach(d,(h,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(h)?F.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,l,d,de())).next(h=>({batchId:a,changes:Eb(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new X(n)).next(r=>{let s=va();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=va();return this.indexManager.getCollectionParents(e,i).next(a=>F.forEach(a,l=>{const d=function(m,p){return new jo(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,ct.newInvalidDocument(h)))});let a=va();return o.forEach((l,d)=>{const h=i.get(l);h!==void 0&&Ma(h.mutation,d,nn.empty(),Ie.now()),Ld(n,d)&&(a=a.insert(l,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return F.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(s){return{id:s.id,version:s.version,createTime:on(s.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(s){return{name:s.name,query:nj(s.bundledQuery),readTime:on(s.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mj{constructor(){this.overlays=new Ue(X.comparator),this.kr=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Xs();return F.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.wt(e,n,i)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.kr.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const s=Xs(),i=n.length+1,o=new X(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,d=l.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return F.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ue((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Xs(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=Xs(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return F.resolve(a)}wt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new D2(n,r));let i=this.kr.get(n);i===void 0&&(i=de(),this.kr.set(n,i)),this.kr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{constructor(){this.sessionToken=ft.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg{constructor(){this.qr=new ot(lt.Qr),this.$r=new ot(lt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new lt(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new lt(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new X(new xe([])),r=new lt(n,e),s=new lt(n,e+1),i=[];return this.$r.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new X(new xe([])),r=new lt(n,e),s=new lt(n,e+1);let i=de();return this.$r.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new lt(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class lt{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return X.comparator(e.key,n.key)||oe(e.Hr,n.Hr)}static Ur(e,n){return oe(e.Hr,n.Hr)||X.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new ot(lt.Qr)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new j2(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Yr=this.Yr.add(new lt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?mg:this.er-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new lt(n,0),s=new lt(n,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([r,s],o=>{const a=this.Zr(o.Hr);i.push(a)}),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ot(oe);return n.forEach(s=>{const i=new lt(s,0),o=new lt(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([i,o],a=>{r=r.add(a.Hr)})}),F.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;X.isDocumentKey(i)||(i=i.child(""));const o=new lt(new X(i),0);let a=new ot(oe);return this.Yr.forEachWhile(l=>{const d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(l.Hr)),!0)},o),F.resolve(this.ei(a))}ei(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){me(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return F.forEach(n.mutations,s=>{const i=new lt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new lt(n,0),s=this.Yr.firstAfterOrEqual(r);return F.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(e){this.ni=e,this.docs=function(){return new Ue(X.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():ct.newInvalidDocument(n))}getEntries(e,n){let r=Sr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ct.newInvalidDocument(s))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Sr();const o=n.path,a=new X(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:h}}=l.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||KR(GR(h),r)<=0||(s.has(h.key)||Ld(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,n,r,s){J(9500)}ri(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new yj(this)}getSize(e){return F.resolve(this.size)}}class yj extends cj{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e){this.persistence=e,this.ii=new Ei(n=>vg(n),yg),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.si=0,this.oi=new bg,this.targetCount=0,this._i=xo.ar()}forEachTarget(e,n){return this.ii.forEach((r,s)=>n(s)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),F.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new xo(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.hr(n),F.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ii.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ii.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),F.waitFor(i).next(()=>s)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),F.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e,n){this.ai={},this.overlays={},this.ui=new Dd(0),this.ci=!1,this.ci=!0,this.li=new pj,this.referenceDelegate=e(this),this.hi=new _j(this),this.indexManager=new rj,this.remoteDocumentCache=function(s){return new vj(s)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new tj(n),this.Ti=new fj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new mj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new gj(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){q("MemoryPersistence","Starting transaction:",e);const s=new wj(this.ui.next());return this.referenceDelegate.Ii(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return F.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}}class wj extends YR{constructor(e){super(),this.currentSequenceNumber=e}}class Sg{constructor(e){this.persistence=e,this.Ai=new bg,this.Ri=null}static Vi(e){return new Sg(e)}get mi(){if(this.Ri)return this.Ri;throw J(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),F.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(s=>this.mi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.mi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.mi,r=>{const s=X.fromPath(r);return this.fi(e,s).next(i=>{i||n.removeEntry(s,ee.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return F.or([()=>F.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class qc{constructor(e,n){this.persistence=e,this.gi=new Ei(r=>ZR(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=uj(this,n)}static Vi(e,n){return new qc(e,n)}Ii(){}di(e){return F.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return F.forEach(this.gi,(r,s)=>this.Sr(e,r,s).next(i=>i?F.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ri(e,o=>this.Sr(e,o,n).next(a=>{a||(r++,i.removeEntry(o,ee.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),F.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),F.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),F.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=ec(e.data.value)),n}Sr(e,n,r){return F.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.gi.get(n);return F.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=s}static Es(e,n){let r=de(),s=de();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ig(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return yP()?8:XR(Rt())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ps(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ys(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new xj;return this.ws(e,n,o).next(a=>{if(i.result=a,this.Rs)return this.Ss(e,n,o,a.size)})}).next(()=>i.result)}Ss(e,n,r,s){return r.documentReadCount<this.Vs?(Oi()<=ce.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",Mi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),F.resolve()):(Oi()<=ce.DEBUG&&q("QueryEngine","Query:",Mi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(Oi()<=ce.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",Mi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qn(n))):F.resolve())}ps(e,n){if(f_(n))return F.resolve(null);let r=qn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Bc(n,null,"F"),r=qn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=de(...i);return this.gs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const d=this.bs(n,a);return this.Ds(n,d,o,l.readTime)?this.ps(e,Bc(n,null,"F")):this.vs(e,d,n,l)}))})))}ys(e,n,r,s){return f_(n)||s.isEqual(ee.min())?F.resolve(null):this.gs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ds(n,o,r,s)?F.resolve(null):(Oi()<=ce.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Mi(n)),this.vs(e,o,n,qR(s,dl)).next(a=>a))})}bs(e,n){let r=new ot(wb(e));return n.forEach((s,i)=>{Ld(e,i)&&(r=r.add(i))}),r}Ds(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ws(e,n,r){return Oi()<=ce.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",Mi(n)),this.gs.getDocumentsMatchingQuery(e,n,ws.min(),r)}vs(e,n,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ng="LocalStore",Tj=3e8;class bj{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.Fs=new Ue(oe),this.Ms=new Ei(i=>vg(i),yg),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hj(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}}function Sj(t,e,n,r){return new bj(t,e,n,r)}async function qb(t,e){const n=re(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=de();for(const d of s){o.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(d=>({Bs:d,removedBatchIds:o,addedBatchIds:a}))})})}function Ij(t,e){const n=re(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(a,l,d,h){const m=d.batch,p=m.keys();let x=F.resolve();return p.forEach(v=>{x=x.next(()=>h.getEntry(l,v)).next(C=>{const A=d.docVersions.get(v);me(A!==null,48541),C.version.compareTo(A)<0&&(m.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),h.addEntry(C)))})}),x.next(()=>a.mutationQueue.removeMutationBatch(l,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=de();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(l=l.add(a.batch.mutations[d].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Gb(t){const e=re(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function Nj(t,e){const n=re(t),r=e.snapshotVersion;let s=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});s=n.Fs;const a=[];e.targetChanges.forEach((h,m)=>{const p=s.get(m);if(!p)return;a.push(n.hi.removeMatchingKeys(i,h.removedDocuments,m).next(()=>n.hi.addMatchingKeys(i,h.addedDocuments,m)));let x=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?x=x.withResumeToken(ft.EMPTY_BYTE_STRING,ee.min()).withLastLimboFreeSnapshotVersion(ee.min()):h.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(h.resumeToken,r)),s=s.insert(m,x),function(C,A,T){return C.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=Tj?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(p,x,h)&&a.push(n.hi.updateTargetData(i,x))});let l=Sr(),d=de();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(Cj(i,o,e.documentUpdates).next(h=>{l=h.Ls,d=h.ks})),!r.isEqual(ee.min())){const h=n.hi.getLastRemoteSnapshotVersion(i).next(m=>n.hi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return F.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,d)).next(()=>l)}).then(i=>(n.Fs=s,i))}function Cj(t,e,n){let r=de(),s=de();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Sr();return n.forEach((a,l)=>{const d=i.get(a);l.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ee.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):q(Ng,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",l.version)}),{Ls:o,ks:s}})}function kj(t,e){const n=re(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=mg),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Aj(t,e){const n=re(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.hi.getTargetData(r,e).next(i=>i?(s=i,F.resolve(s)):n.hi.allocateTargetId(r).next(o=>(s=new ts(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function Gm(t,e,n){const r=re(t),s=r.Fs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ro(o))throw o;q(Ng,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function I_(t,e,n){const r=re(t);let s=ee.min(),i=de();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,d,h){const m=re(l),p=m.Ms.get(h);return p!==void 0?F.resolve(m.Fs.get(p)):m.hi.getTargetData(d,h)}(r,o,qn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:ee.min(),n?i:de())).next(a=>(Pj(r,y2(e),a),{documents:a,qs:i})))}function Pj(t,e,n){let r=t.xs.get(e)||ee.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.xs.set(e,r)}class N_{constructor(){this.activeTargetIds=b2()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rj{constructor(){this.Fo=new N_,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new N_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_="ConnectivityMonitor";class k_{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){q(C_,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){q(C_,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ju=null;function Km(){return ju===null?ju=function(){return 268435456+Math.round(2147483648*Math.random())}():ju++,"0x"+ju.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff="RestConnection",Dj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Oj{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===Fc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=Km(),a=this.Go(e,n.toUriEncodedString());q(ff,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,s,i);const{host:d}=new URL(a),h=Pr(d);return this.jo(e,a,l,r,h).then(m=>(q(ff,`Received RPC '${e}' ${o}: `,m),m),m=>{throw br(ff,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}Jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ao}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Go(e,n){const r=Dj[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="WebChannelConnection";class Lj extends Oj{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,s,i){const o=Km();return new Promise((a,l)=>{const d=new WT;d.setWithCredentials(!0),d.listenOnce(HT.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Zu.NO_ERROR:const m=d.getResponseJson();q(St,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case Zu.TIMEOUT:q(St,`RPC '${e}' ${o} timed out`),l(new W(V.DEADLINE_EXCEEDED,"Request time out"));break;case Zu.HTTP_ERROR:const p=d.getStatus();if(q(St,`RPC '${e}' ${o} failed with status:`,p,"response text:",d.getResponseText()),p>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const v=x==null?void 0:x.error;if(v&&v.status&&v.message){const C=function(T){const y=T.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(y)>=0?y:V.UNKNOWN}(v.status);l(new W(C,v.message))}else l(new W(V.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new W(V.UNAVAILABLE,"Connection failed."));break;default:J(9055,{c_:e,streamId:o,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{q(St,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);q(St,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}P_(e,n,r){const s=Km(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=KT(),a=GT(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=i.join("");q(St,`Creating RPC '${e}' stream ${s}: ${h}`,l);const m=o.createWebChannel(h,l);this.T_(m);let p=!1,x=!1;const v=new Mj({Ho:A=>{x?q(St,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(p||(q(St,`Opening RPC '${e}' stream ${s} transport.`),m.open(),p=!0),q(St,`RPC '${e}' stream ${s} sending:`,A),m.send(A))},Yo:()=>m.close()}),C=(A,T,y)=>{A.listen(T,w=>{try{y(w)}catch(N){setTimeout(()=>{throw N},0)}})};return C(m,ga.EventType.OPEN,()=>{x||(q(St,`RPC '${e}' stream ${s} transport opened.`),v.s_())}),C(m,ga.EventType.CLOSE,()=>{x||(x=!0,q(St,`RPC '${e}' stream ${s} transport closed`),v.__(),this.I_(m))}),C(m,ga.EventType.ERROR,A=>{x||(x=!0,br(St,`RPC '${e}' stream ${s} transport errored. Name:`,A.name,"Message:",A.message),v.__(new W(V.UNAVAILABLE,"The operation could not be completed")))}),C(m,ga.EventType.MESSAGE,A=>{var T;if(!x){const y=A.data[0];me(!!y,16349);const w=y,N=(w==null?void 0:w.error)||((T=w[0])===null||T===void 0?void 0:T.error);if(N){q(St,`RPC '${e}' stream ${s} received error:`,N);const j=N.status;let D=function(I){const k=Je[I];if(k!==void 0)return jb(k)}(j),b=N.message;D===void 0&&(D=V.INTERNAL,b="Unknown error status: "+j+" with message "+N.message),x=!0,v.__(new W(D,b)),m.close()}else q(St,`RPC '${e}' stream ${s} received:`,y),v.a_(y)}}),C(a,qT.STAT_EVENT,A=>{A.stat===Lm.PROXY?q(St,`RPC '${e}' stream ${s} detected buffering proxy`):A.stat===Lm.NOPROXY&&q(St,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.o_()},0),v}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}}function mf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bd(t){return new $2(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=s,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,n-r);s>0&&q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="PersistentStream";class Kb{constructor(e,n,r,s,i,o,a,l){this.Fi=e,this.w_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Cg(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(Tr(n.toString()),Tr("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.b_===n&&this.W_(r,s)},r=>{e(()=>{const s=new W(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{r(()=>this.G_(s))}),this.stream.onMessage(s=>{r(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return q(A_,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(q(A_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Vj extends Kb{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=H2(this.serializer,e),r=function(i){if(!("targetChange"in i))return ee.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ee.min():o.readTime?on(o.readTime):ee.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=qm(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=Bm(l)?{documents:G2(i,l)}:{query:K2(i,l).Vt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Mb(i,o.resumeToken);const d=Wm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(ee.min())>0){a.readTime=Wc(i,o.snapshotVersion.toTimestamp());const d=Wm(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=Y2(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=qm(this.serializer),n.removeTarget=e,this.k_(n)}}class Fj extends Kb{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return me(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,me(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){me(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=q2(e.writeResults,e.commitTime),r=on(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=qm(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Ub(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{}class $j extends Uj{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new W(V.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,Hm(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W(V.UNKNOWN,i.toString())})}Jo(e,n,r,s,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Jo(e,Hm(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(V.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class Bj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Tr(n),this._a=!1):q("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di="RemoteStore";class zj{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Ti(this)&&(q(di,"Restarting streams for network reachability change."),await async function(l){const d=re(l);d.Ia.add(4),await jl(d),d.Aa.set("Unknown"),d.Ia.delete(4),await zd(d)}(this))})}),this.Aa=new Bj(r,s)}}async function zd(t){if(Ti(t))for(const e of t.da)await e(!0)}async function jl(t){for(const e of t.da)await e(!1)}function Qb(t,e){const n=re(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),Rg(n)?Pg(n):Do(n).x_()&&Ag(n,e))}function kg(t,e){const n=re(t),r=Do(n);n.Ta.delete(e),r.x_()&&Yb(n,e),n.Ta.size===0&&(r.x_()?r.B_():Ti(n)&&n.Aa.set("Unknown"))}function Ag(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ee.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Do(t).H_(e)}function Yb(t,e){t.Ra.$e(e),Do(t).Y_(e)}function Pg(t){t.Ra=new L2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),Do(t).start(),t.Aa.aa()}function Rg(t){return Ti(t)&&!Do(t).M_()&&t.Ta.size>0}function Ti(t){return re(t).Ia.size===0}function Xb(t){t.Ra=void 0}async function Wj(t){t.Aa.set("Online")}async function Hj(t){t.Ta.forEach((e,n)=>{Ag(t,e)})}async function qj(t,e){Xb(t),Rg(t)?(t.Aa.la(e),Pg(t)):t.Aa.set("Unknown")}async function Gj(t,e,n){if(t.Aa.set("Online"),e instanceof Ob&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ta.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ta.delete(a),s.Ra.removeTarget(a))}(t,e)}catch(r){q(di,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Gc(t,r)}else if(e instanceof rc?t.Ra.Ye(e):e instanceof Db?t.Ra.it(e):t.Ra.et(e),!n.isEqual(ee.min()))try{const r=await Gb(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Ra.Pt(o);return a.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ta.get(d);h&&i.Ta.set(d,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,d)=>{const h=i.Ta.get(l);if(!h)return;i.Ta.set(l,h.withResumeToken(ft.EMPTY_BYTE_STRING,h.snapshotVersion)),Yb(i,l);const m=new ts(h.target,l,d,h.sequenceNumber);Ag(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){q(di,"Failed to raise snapshot:",r),await Gc(t,r)}}async function Gc(t,e,n){if(!Ro(e))throw e;t.Ia.add(1),await jl(t),t.Aa.set("Offline"),n||(n=()=>Gb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{q(di,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await zd(t)})}function Jb(t,e){return e().catch(n=>Gc(t,n,e))}async function Wd(t){const e=re(t),n=bs(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:mg;for(;Kj(e);)try{const s=await kj(e.localStore,r);if(s===null){e.Pa.length===0&&n.B_();break}r=s.batchId,Qj(e,s)}catch(s){await Gc(e,s)}Zb(e)&&eS(e)}function Kj(t){return Ti(t)&&t.Pa.length<10}function Qj(t,e){t.Pa.push(e);const n=bs(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function Zb(t){return Ti(t)&&!bs(t).M_()&&t.Pa.length>0}function eS(t){bs(t).start()}async function Yj(t){bs(t).na()}async function Xj(t){const e=bs(t);for(const n of t.Pa)e.X_(n.mutations)}async function Jj(t,e,n){const r=t.Pa.shift(),s=xg.from(r,e,n);await Jb(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Wd(t)}async function Zj(t,e){e&&bs(t).Z_&&await async function(r,s){if(function(o){return Rb(o)&&o!==V.ABORTED}(s.code)){const i=r.Pa.shift();bs(r).N_(),await Jb(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Wd(r)}}(t,e),Zb(t)&&eS(t)}async function P_(t,e){const n=re(t);n.asyncQueue.verifyOperationInProgress(),q(di,"RemoteStore received new credentials");const r=Ti(n);n.Ia.add(3),await jl(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await zd(n)}async function eD(t,e){const n=re(t);e?(n.Ia.delete(2),await zd(n)):e||(n.Ia.add(2),await jl(n),n.Aa.set("Unknown"))}function Do(t){return t.Va||(t.Va=function(n,r,s){const i=re(n);return i.ia(),new Vj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:Wj.bind(null,t),e_:Hj.bind(null,t),n_:qj.bind(null,t),J_:Gj.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Rg(t)?Pg(t):t.Aa.set("Unknown")):(await t.Va.stop(),Xb(t))})),t.Va}function bs(t){return t.ma||(t.ma=function(n,r,s){const i=re(n);return i.ia(),new Fj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:Yj.bind(null,t),n_:Zj.bind(null,t),ea:Xj.bind(null,t),ta:Jj.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await Wd(t)):(await t.ma.stop(),t.Pa.length>0&&(q(di,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new fr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new jg(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dg(t,e){if(Tr("AsyncQueue",`${e}: ${t}`),Ro(t))return new W(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{static emptySet(e){return new so(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||X.comparator(n.key,r.key):(n,r)=>X.comparator(n.key,r.key),this.keyedMap=va(),this.sortedSet=new Ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof so)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new so;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(){this.fa=new Ue(X.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):J(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}}class Eo{constructor(e,n,r,s,i,o,a,l,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Eo(e,n,so.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Md(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class nD{constructor(){this.queries=j_(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const s=re(n),i=s.queries;s.queries=j_(),i.forEach((o,a)=>{for(const l of a.wa)l.onError(r)})})(this,new W(V.ABORTED,"Firestore shutting down"))}}function j_(){return new Ei(t=>_b(t),Md)}async function tS(t,e){const n=re(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.ba()&&(r=2):(i=new tD,r=e.ba()?0:1);try{switch(r){case 0:i.ya=await n.onListen(s,!0);break;case 1:i.ya=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Dg(o,`Initialization of query '${Mi(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.wa.push(e),e.va(n.onlineState),i.ya&&e.Ca(i.ya)&&Og(n)}async function nS(t,e){const n=re(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.wa.indexOf(e);o>=0&&(i.wa.splice(o,1),i.wa.length===0?s=e.ba()?0:1:!i.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function rD(t,e){const n=re(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.wa)a.Ca(s)&&(r=!0);o.ya=s}}r&&Og(n)}function sD(t,e,n){const r=re(t),s=r.queries.get(e);if(s)for(const i of s.wa)i.onError(n);r.queries.delete(e)}function Og(t){t.Da.forEach(e=>{e.next()})}var Qm,D_;(D_=Qm||(Qm={})).Fa="default",D_.Cache="cache";class rS{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Eo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=Eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Qm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e){this.key=e}}class iS{constructor(e){this.key=e}}class iD{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=de(),this.mutatedKeys=de(),this.Xa=wb(e),this.eu=new so(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new R_,s=n?n.eu:this.eu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,m)=>{const p=s.get(h),x=Ld(this.query,m)?m:null,v=!!p&&this.mutatedKeys.has(p.key),C=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let A=!1;p&&x?p.data.isEqual(x.data)?v!==C&&(r.track({type:3,doc:x}),A=!0):this.iu(p,x)||(r.track({type:2,doc:x}),A=!0,(l&&this.Xa(x,l)>0||d&&this.Xa(x,d)<0)&&(a=!0)):!p&&x?(r.track({type:0,doc:x}),A=!0):p&&!x&&(r.track({type:1,doc:p}),A=!0,(l||d)&&(a=!0)),A&&(x?(o=o.add(x),i=C?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:a,mutatedKeys:i}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((h,m)=>function(x,v){const C=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J(20277,{At:A})}};return C(x)-C(v)}(h.type,m.type)||this.Xa(h.doc,m.doc)),this.su(r),s=s!=null&&s;const a=n&&!s?this.ou():[],l=this.Za.size===0&&this.current&&!s?1:0,d=l!==this.Ya;return this.Ya=l,o.length!==0||d?{snapshot:new Eo(this.query,e.eu,i,o,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new R_,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=de(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new iS(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new sS(r))}),n}uu(e){this.Ha=e.qs,this.Za=de();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return Eo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Mg="SyncEngine";class oD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class aD{constructor(e){this.key=e,this.lu=!1}}class lD{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Ei(a=>_b(a),Md),this.Tu=new Map,this.Iu=new Set,this.du=new Ue(X.comparator),this.Eu=new Map,this.Au=new bg,this.Ru={},this.Vu=new Map,this.mu=xo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function uD(t,e,n=!0){const r=dS(t);let s;const i=r.Pu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.cu()):s=await oS(r,e,n,!0),s}async function cD(t,e){const n=dS(t);await oS(n,e,!0,!1)}async function oS(t,e,n,r){const s=await Aj(t.localStore,qn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await dD(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Qb(t.remoteStore,s),a}async function dD(t,e,n,r,s){t.gu=(m,p,x)=>async function(C,A,T,y){let w=A.view.nu(T);w.Ds&&(w=await I_(C.localStore,A.query,!1).then(({documents:b})=>A.view.nu(b,w)));const N=y&&y.targetChanges.get(A.targetId),j=y&&y.targetMismatches.get(A.targetId)!=null,D=A.view.applyChanges(w,C.isPrimaryClient,N,j);return M_(C,A.targetId,D._u),D.snapshot}(t,m,p,x);const i=await I_(t.localStore,e,!0),o=new iD(e,i.qs),a=o.nu(i.documents),l=Rl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,l);M_(t,n,d._u);const h=new oD(e,n,o);return t.Pu.set(e,h),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),d.snapshot}async function hD(t,e,n){const r=re(t),s=r.Pu.get(e),i=r.Tu.get(s.targetId);if(i.length>1)return r.Tu.set(s.targetId,i.filter(o=>!Md(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Gm(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&kg(r.remoteStore,s.targetId),Ym(r,s.targetId)}).catch(Po)):(Ym(r,s.targetId),await Gm(r.localStore,s.targetId,!0))}async function fD(t,e){const n=re(t),r=n.Pu.get(e),s=n.Tu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),kg(n.remoteStore,r.targetId))}async function mD(t,e,n){const r=xD(t);try{const s=await function(o,a){const l=re(o),d=Ie.now(),h=a.reduce((x,v)=>x.add(v.key),de());let m,p;return l.persistence.runTransaction("Locally write mutations","readwrite",x=>{let v=Sr(),C=de();return l.Os.getEntries(x,h).next(A=>{v=A,v.forEach((T,y)=>{y.isValidDocument()||(C=C.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(x,v)).next(A=>{m=A;const T=[];for(const y of a){const w=R2(y,m.get(y.key).overlayedDocument);w!=null&&T.push(new js(y.key,w,db(w.value.mapValue),vt.exists(!0)))}return l.mutationQueue.addMutationBatch(x,d,T,a)}).next(A=>{p=A;const T=A.applyToLocalDocumentSet(m,C);return l.documentOverlayCache.saveOverlays(x,A.batchId,T)})}).then(()=>({batchId:p.batchId,changes:Eb(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let d=o.Ru[o.currentUser.toKey()];d||(d=new Ue(oe)),d=d.insert(a,l),o.Ru[o.currentUser.toKey()]=d}(r,s.batchId,n),await Dl(r,s.changes),await Wd(r.remoteStore)}catch(s){const i=Dg(s,"Failed to persist write");n.reject(i)}}async function aS(t,e){const n=re(t);try{const r=await Nj(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Eu.get(i);o&&(me(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.lu=!0:s.modifiedDocuments.size>0?me(o.lu,14607):s.removedDocuments.size>0&&(me(o.lu,42227),o.lu=!1))}),await Dl(n,r,e)}catch(r){await Po(r)}}function O_(t,e,n){const r=re(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Pu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=re(o);l.onlineState=a;let d=!1;l.queries.forEach((h,m)=>{for(const p of m.wa)p.va(a)&&(d=!0)}),d&&Og(l)}(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function pD(t,e,n){const r=re(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Eu.get(e),i=s&&s.key;if(i){let o=new Ue(X.comparator);o=o.insert(i,ct.newNoDocument(i,ee.min()));const a=de().add(i),l=new $d(ee.min(),new Map,new Ue(oe),o,a);await aS(r,l),r.du=r.du.remove(i),r.Eu.delete(e),Lg(r)}else await Gm(r.localStore,e,!1).then(()=>Ym(r,e,n)).catch(Po)}async function gD(t,e){const n=re(t),r=e.batch.batchId;try{const s=await Ij(n.localStore,e);uS(n,r,null),lS(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Dl(n,s)}catch(s){await Po(s)}}async function vD(t,e,n){const r=re(t);try{const s=await function(o,a){const l=re(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return l.mutationQueue.lookupMutationBatch(d,a).next(m=>(me(m!==null,37113),h=m.keys(),l.mutationQueue.removeMutationBatch(d,m))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>l.localDocuments.getDocuments(d,h))})}(r.localStore,e);uS(r,e,n),lS(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Dl(r,s)}catch(s){await Po(s)}}function lS(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function uS(t,e,n){const r=re(t);let s=r.Ru[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function Ym(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||cS(t,r)})}function cS(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(kg(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),Lg(t))}function M_(t,e,n){for(const r of n)r instanceof sS?(t.Au.addReference(r.key,e),yD(t,r)):r instanceof iS?(q(Mg,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||cS(t,r.key)):J(19791,{yu:r})}function yD(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(q(Mg,"New document in limbo: "+n),t.Iu.add(r),Lg(t))}function Lg(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new X(xe.fromString(e)),r=t.mu.next();t.Eu.set(r,new aD(n)),t.du=t.du.insert(n,r),Qb(t.remoteStore,new ts(qn(_g(n.path)),r,"TargetPurposeLimboResolution",Dd.ue))}}async function Dl(t,e,n){const r=re(t),s=[],i=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((a,l)=>{o.push(r.gu(l,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(d){s.push(d);const m=Ig.Es(l.targetId,d);i.push(m)}}))}),await Promise.all(o),r.hu.J_(s),await async function(l,d){const h=re(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>F.forEach(d,p=>F.forEach(p.Is,x=>h.persistence.referenceDelegate.addReference(m,p.targetId,x)).next(()=>F.forEach(p.ds,x=>h.persistence.referenceDelegate.removeReference(m,p.targetId,x)))))}catch(m){if(!Ro(m))throw m;q(Ng,"Failed to update sequence numbers: "+m)}for(const m of d){const p=m.targetId;if(!m.fromCache){const x=h.Fs.get(p),v=x.snapshotVersion,C=x.withLastLimboFreeSnapshotVersion(v);h.Fs=h.Fs.insert(p,C)}}}(r.localStore,i))}async function _D(t,e){const n=re(t);if(!n.currentUser.isEqual(e)){q(Mg,"User change. New user:",e.toKey());const r=await qb(n.localStore,e);n.currentUser=e,function(i,o){i.Vu.forEach(a=>{a.forEach(l=>{l.reject(new W(V.CANCELLED,o))})}),i.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Dl(n,r.Bs)}}function wD(t,e){const n=re(t),r=n.Eu.get(e);if(r&&r.lu)return de().add(r.key);{let s=de();const i=n.Tu.get(e);if(!i)return s;for(const o of i){const a=n.Pu.get(o);s=s.unionWith(a.view.tu)}return s}}function dS(t){const e=re(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=aS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pD.bind(null,e),e.hu.J_=rD.bind(null,e.eventManager),e.hu.pu=sD.bind(null,e.eventManager),e}function xD(t){const e=re(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vD.bind(null,e),e}class Kc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return Sj(this.persistence,new Ej,e.initialUser,this.serializer)}Du(e){return new Hb(Sg.Vi,this.serializer)}bu(e){return new Rj}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Kc.provider={build:()=>new Kc};class ED extends Kc{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){me(this.persistence.referenceDelegate instanceof qc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new aj(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?$t.withCacheSize(this.cacheSizeBytes):$t.DEFAULT;return new Hb(r=>qc.Vi(r,n),this.serializer)}}class Xm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>O_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=_D.bind(null,this.syncEngine),await eD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new nD}()}createDatastore(e){const n=Bd(e.databaseInfo.databaseId),r=function(i){return new Lj(i)}(e.databaseInfo);return function(i,o,a,l){return new $j(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new zj(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>O_(this.syncEngine,n,0),function(){return k_.C()?new k_:new jj}())}createSyncEngine(e,n){return function(s,i,o,a,l,d,h){const m=new lD(s,i,o,a,l,d);return h&&(m.fu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=re(s);q(di,"RemoteStore shutting down."),i.Ia.add(5),await jl(i),i.Ea.shutdown(),i.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Xm.provider={build:()=>new Xm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Tr("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new W(V.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const o=re(s),a={documents:i.map(m=>Hc(o.serializer,m))},l=await o.Jo("BatchGetDocuments",o.serializer.databaseId,xe.emptyPath(),a,i.length),d=new Map;l.forEach(m=>{const p=W2(o.serializer,m);d.set(p.key.toString(),p)});const h=[];return i.forEach(m=>{const p=d.get(m.toString());me(!!p,55234,{key:m}),h.push(p)}),h}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ud(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=X.fromPath(r);this.mutations.push(new Pb(s,this.precondition(s)))}),await async function(r,s){const i=re(r),o={writes:s.map(a=>Ub(i.serializer,a))};await i.Wo("Commit",i.serializer.databaseId,xe.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw J(50498,{Wu:e.constructor.name});n=ee.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new W(V.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ee.min())?vt.exists(!1):vt.updateTime(n):vt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ee.min()))throw new W(V.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vt.updateTime(n)}return vt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.Gu=r.maxAttempts,this.F_=new Cg(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new TD(this.datastore),n=this.Ju(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Hu(s)}))}).catch(r=>{this.Hu(r)})})}Ju(e){try{const n=this.updateFunction(e);return!Al(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!Rb(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="FirestoreClient";class SD{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=It.UNAUTHENTICATED,this.clientId=Rd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{q(Ss,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(q(Ss,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Dg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function pf(t,e){t.asyncQueue.verifyOperationInProgress(),q(Ss,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await qb(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>{br("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{q("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{br("Terminating Firestore due to IndexedDb database deletion failed",s)})}),t._offlineComponents=e}async function L_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await ID(t);q(Ss,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>P_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>P_(e.remoteStore,s)),t._onlineComponents=e}async function ID(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){q(Ss,"Using user provided OfflineComponentProvider");try{await pf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;br("Error using user provided cache. Falling back to memory cache: "+n),await pf(t,new Kc)}}else q(Ss,"Using default OfflineComponentProvider"),await pf(t,new ED(void 0));return t._offlineComponents}async function Vg(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(q(Ss,"Using user provided OnlineComponentProvider"),await L_(t,t._uninitializedComponentsProvider._online)):(q(Ss,"Using default OnlineComponentProvider"),await L_(t,new Xm))),t._onlineComponents}function ND(t){return Vg(t).then(e=>e.syncEngine)}function CD(t){return Vg(t).then(e=>e.datastore)}async function Jm(t){const e=await Vg(t),n=e.eventManager;return n.onListen=uD.bind(null,e.syncEngine),n.onUnlisten=hD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=cD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=fD.bind(null,e.syncEngine),n}function kD(t,e,n={}){const r=new fr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,d){const h=new hS({next:p=>{h.Ou(),o.enqueueAndForget(()=>nS(i,m)),p.fromCache&&l.source==="server"?d.reject(new W(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new rS(a,h,{includeMetadataChanges:!0,ka:!0});return tS(i,m)}(await Jm(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS="firestore.googleapis.com",F_=!0;class U_{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new W(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mS,this.ssl=F_}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:F_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Wb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ij)throw new W(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fS((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new W(V.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new W(V.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new W(V.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hd{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new U_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new U_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new XT;switch(r.type){case"firstParty":return new UR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=V_.get(n);r&&(q("ComponentProvider","Removing Datastore"),V_.delete(n),r.terminate())}(this),Promise.resolve()}}function pS(t,e,n,r={}){var s;t=Kt(t,Hd);const i=Pr(e),o=t._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),l=`${e}:${n}`;i&&(kd(`https://${l}`),Ad("Firestore",!0)),o.host!==mS&&o.host!==l&&br("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:l,ssl:i,emulatorOptions:r});if(!ui(d,a)&&(t._setSettings(d),r.mockUserToken)){let h,m;if(typeof r.mockUserToken=="string")h=r.mockUserToken,m=It.MOCK_USER;else{h=OT(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new W(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new It(p)}t._authCredentials=new LR(new YT(h,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Zn(this.firestore,e,this._query)}}class Me{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Me(this.firestore,e,this._key)}toJSON(){return{type:Me._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(kl(n,Me._jsonSchema))return new Me(e,r||null,new X(xe.fromString(n.referencePath)))}}Me._jsonSchemaVersion="firestore/documentReference/1.0",Me._jsonSchema={type:rt("string",Me._jsonSchemaVersion),referencePath:rt("string")};class mr extends Zn{constructor(e,n,r){super(e,n,_g(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new X(e))}withConverter(e){return new mr(this.firestore,e,this._path)}}function pe(t,e,...n){if(t=ye(t),ZT("collection","path",e),t instanceof Hd){const r=xe.fromString(e,...n);return Z0(r),new mr(t,null,r)}{if(!(t instanceof Me||t instanceof mr))throw new W(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(xe.fromString(e,...n));return Z0(r),new mr(t.firestore,null,r)}}function be(t,e,...n){if(t=ye(t),arguments.length===1&&(e=Rd.newId()),ZT("doc","path",e),t instanceof Hd){const r=xe.fromString(e,...n);return J0(r),new Me(t,null,new X(r))}{if(!(t instanceof Me||t instanceof mr))throw new W(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(xe.fromString(e,...n));return J0(r),new Me(t.firestore,t instanceof mr?t.converter:null,new X(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_="AsyncQueue";class B_{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Cg(this,"async_queue_retry"),this.oc=()=>{const r=mf();r&&q($_,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=mf();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=mf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new fr;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Ro(e))throw e;q($_,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Tr("INTERNAL UNHANDLED ERROR: ",z_(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const s=jg.createAndSchedule(this,e,n,r,i=>this.lc(i));return this.ec.push(s),s}ac(){this.tc&&J(47125,{hc:z_(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}}function z_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W_(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Jn extends Hd{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new B_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new B_(e),this._firestoreClient=void 0,await e}}}function Qc(t,e){const n=typeof t=="object"?t:Cl(),r=typeof t=="string"?t:Fc,s=Ps(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=cg("firestore");i&&pS(s,...i)}return s}function Ol(t){if(t._terminated)throw new W(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||AD(t),t._firestoreClient}function AD(t){var e,n,r;const s=t._freezeSettings(),i=function(a,l,d,h){return new n2(a,l,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,fS(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new SD(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new zt(ft.fromBase64String(e))}catch(n){throw new W(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new zt(ft.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:zt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(kl(e,zt._jsonSchema))return zt.fromBase64String(e.bytes)}}zt._jsonSchemaVersion="firestore/bytes/1.0",zt._jsonSchema={type:rt("string",zt._jsonSchemaVersion),bytes:rt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return oe(this._lat,e._lat)||oe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pn._jsonSchemaVersion}}static fromJSON(e){if(kl(e,Pn._jsonSchema))return new Pn(e.latitude,e.longitude)}}Pn._jsonSchemaVersion="firestore/geoPoint/1.0",Pn._jsonSchema={type:rt("string",Pn._jsonSchemaVersion),latitude:rt("number"),longitude:rt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Rn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(kl(e,Rn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Rn(e.vectorValues);throw new W(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Rn._jsonSchemaVersion="firestore/vectorValue/1.0",Rn._jsonSchema={type:rt("string",Rn._jsonSchemaVersion),vectorValues:rt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=/^__.*__$/;class RD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new js(e,this.data,this.fieldMask,n,this.fieldTransforms):new Pl(e,this.data,n,this.fieldTransforms)}}class gS{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new js(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function vS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{Ec:t})}}class Fg{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Fg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Yc(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(vS(this.Ec)&&PD.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class jD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Bd(e)}Dc(e,n,r,s=!1){return new Fg({Ec:e,methodName:n,bc:r,path:dt.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ll(t){const e=t._freezeSettings(),n=Bd(t._databaseId);return new jD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ug(t,e,n,r,s,i={}){const o=t.Dc(i.merge||i.mergeFields?2:0,e,n,s);Bg("Data must be an object, but it was:",o,r);const a=wS(r,o);let l,d;if(i.merge)l=new nn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const m of i.mergeFields){const p=Zm(e,m,n);if(!o.contains(p))throw new W(V.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);ES(h,p)||h.push(p)}l=new nn(h),d=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,d=o.fieldTransforms;return new RD(new Lt(a),l,d)}class qd extends Ml{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qd}}class $g extends Ml{_toFieldTransform(e){return new C2(e.path,new pl)}isEqual(e){return e instanceof $g}}function yS(t,e,n,r){const s=t.Dc(1,e,n);Bg("Data must be an object, but it was:",s,r);const i=[],o=Lt.empty();Rs(r,(l,d)=>{const h=zg(e,l,n);d=ye(d);const m=s.gc(h);if(d instanceof qd)i.push(h);else{const p=Vl(d,m);p!=null&&(i.push(h),o.set(h,p))}});const a=new nn(i);return new gS(o,a,s.fieldTransforms)}function _S(t,e,n,r,s,i){const o=t.Dc(1,e,n),a=[Zm(e,r,n)],l=[s];if(i.length%2!=0)throw new W(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(Zm(e,i[p])),l.push(i[p+1]);const d=[],h=Lt.empty();for(let p=a.length-1;p>=0;--p)if(!ES(d,a[p])){const x=a[p];let v=l[p];v=ye(v);const C=o.gc(x);if(v instanceof qd)d.push(x);else{const A=Vl(v,C);A!=null&&(d.push(x),h.set(x,A))}}const m=new nn(d);return new gS(h,m,o.fieldTransforms)}function DD(t,e,n,r=!1){return Vl(n,t.Dc(r?4:3,e))}function Vl(t,e){if(xS(t=ye(t)))return Bg("Unsupported field value:",e,t),wS(t,e);if(t instanceof Ml)return function(r,s){if(!vS(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Vl(a,s.yc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return S2(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ie.fromDate(r);return{timestampValue:Wc(s.serializer,i)}}if(r instanceof Ie){const i=new Ie(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Wc(s.serializer,i)}}if(r instanceof Pn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof zt)return{bytesValue:Mb(s.serializer,r._byteString)};if(r instanceof Me){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Tg(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Rn)return function(o,a){return{mapValue:{fields:{[ub]:{stringValue:cb},[Uc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.wc("VectorValues must only contain numeric values.");return wg(a.serializer,d)})}}}}}}(r,s);throw s.wc(`Unsupported field value: ${jd(r)}`)}(t,e)}function wS(t,e){const n={};return rb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rs(t,(r,s)=>{const i=Vl(s,e.Vc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function xS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ie||t instanceof Pn||t instanceof zt||t instanceof Me||t instanceof Ml||t instanceof Rn)}function Bg(t,e,n){if(!xS(n)||!tb(n)){const r=jd(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function Zm(t,e,n){if((e=ye(e))instanceof Oo)return e._internalPath;if(typeof e=="string")return zg(t,e);throw Yc("Field path arguments must be of type string or ",t,!1,void 0,n)}const OD=new RegExp("[~\\*/\\[\\]]");function zg(t,e,n){if(e.search(OD)>=0)throw Yc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Oo(...e.split("."))._internalPath}catch{throw Yc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Yc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new W(V.INVALID_ARGUMENT,a+t+l)}function ES(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new MD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Gd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class MD extends Xc{data(){return super.data()}}function Gd(t,e){return typeof e=="string"?zg(t,e):e instanceof Oo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wg{}class Kd extends Wg{}function Ne(t,e,...n){let r=[];e instanceof Wg&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof Qd).length,a=i.filter(l=>l instanceof Fl).length;if(o>1||o>0&&a>0)throw new W(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Fl extends Kd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Fl(e,n,r)}_apply(e){const n=this._parse(e);return bS(e._query,n),new Zn(e.firestore,e.converter,zm(e._query,n))}_parse(e){const n=Ll(e.firestore);return function(i,o,a,l,d,h,m){let p;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new W(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){q_(m,h);const v=[];for(const C of m)v.push(H_(l,i,C));p={arrayValue:{values:v}}}else p=H_(l,i,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||q_(m,h),p=DD(a,o,m,h==="in"||h==="not-in");return tt.create(d,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Pe(t,e,n){const r=e,s=Gd("where",t);return Fl._create(s,r,n)}class Qd extends Wg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Qd(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Dn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)bS(o,l),o=zm(o,l)}(e._query,n),new Zn(e.firestore,e.converter,zm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Yd extends Kd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Yd(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new W(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new W(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ml(i,o)}(e._query,this._field,this._direction);return new Zn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new jo(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Ct(t,e="asc"){const n=e,r=Gd("orderBy",t);return Yd._create(r,n)}class Xd extends Kd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Xd(e,n,r)}_apply(e){return new Zn(e.firestore,e.converter,Bc(e._query,this._limit,this._limitType))}}function bi(t){return HR("limit",t),Xd._create("limit",t,"F")}function H_(t,e,n){if(typeof(n=ye(n))=="string"){if(n==="")throw new W(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yb(e)&&n.indexOf("/")!==-1)throw new W(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(xe.fromString(n));if(!X.isDocumentKey(r))throw new W(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return a_(t,new X(r))}if(n instanceof Me)return a_(t,n._key);throw new W(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jd(n)}.`)}function q_(t,e){if(!Array.isArray(t)||t.length===0)throw new W(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bS(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Hg{convertValue(e,n="none"){switch(Ts(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Es(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Rs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[Uc].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Ge(o.doubleValue));return new Rn(i)}convertGeoPoint(e){return new Pn(Ge(e.latitude),Ge(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Od(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(hl(e));default:return null}}convertTimestamp(e){const n=xs(e);return new Ie(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=xe.fromString(e);me(zb(r),9688,{name:e});const s=new yo(r.get(1),r.get(3)),i=new X(r.popFirst(5));return s.isEqual(n)||Tr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class LD extends Hg{constructor(e){super(),this.firestore=e}convertBytes(e){return new zt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,n)}}class Js{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pr extends Xc{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Va(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Gd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new W(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=pr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}pr._jsonSchemaVersion="firestore/documentSnapshot/1.0",pr._jsonSchema={type:rt("string",pr._jsonSchemaVersion),bundleSource:rt("string","DocumentSnapshot"),bundleName:rt("string"),bundle:rt("string")};class Va extends pr{data(e={}){return super.data(e)}}class ps{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Js(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Va(this._firestore,this._userDataWriter,r.key,r,new Js(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Va(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Js(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Va(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Js(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:VD(a.type),doc:l,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new W(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ps._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Rd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function VD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J(61501,{type:t})}}ps._jsonSchemaVersion="firestore/querySnapshot/1.0",ps._jsonSchema={type:rt("string",ps._jsonSchemaVersion),bundleSource:rt("string","QuerySnapshot"),bundleName:rt("string"),bundle:rt("string")};class Jd extends Hg{constructor(e){super(),this.firestore=e}convertBytes(e){return new zt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,n)}}function In(t){t=Kt(t,Zn);const e=Kt(t.firestore,Jn),n=Ol(e),r=new Jd(e);return TS(t._query),kD(n,t._query).then(s=>new ps(e,r,t,s))}function Si(t,e,n){t=Kt(t,Me);const r=Kt(t.firestore,Jn),s=qg(t.converter,e,n);return $l(r,[Ug(Ll(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,vt.none())])}function Gn(t,e,n,...r){t=Kt(t,Me);const s=Kt(t.firestore,Jn),i=Ll(s);let o;return o=typeof(e=ye(e))=="string"||e instanceof Oo?_S(i,"updateDoc",t._key,e,n,r):yS(i,"updateDoc",t._key,e),$l(s,[o.toMutation(t._key,vt.exists(!0))])}function Ul(t){return $l(Kt(t.firestore,Jn),[new Ud(t._key,vt.none())])}function sc(t,e){const n=Kt(t.firestore,Jn),r=be(t),s=qg(t.converter,e);return $l(n,[Ug(Ll(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,vt.exists(!1))]).then(()=>r)}function Qe(t,...e){var n,r,s;t=ye(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||W_(e[o])||(i=e[o++]);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(W_(e[o])){const m=e[o];e[o]=(n=m.next)===null||n===void 0?void 0:n.bind(m),e[o+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[o+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let l,d,h;if(t instanceof Me)d=Kt(t.firestore,Jn),h=_g(t._key.path),l={next:m=>{e[o]&&e[o](FD(d,t,m))},error:e[o+1],complete:e[o+2]};else{const m=Kt(t,Zn);d=Kt(m.firestore,Jn),h=m._query;const p=new Jd(d);l={next:x=>{e[o]&&e[o](new ps(d,p,m,x))},error:e[o+1],complete:e[o+2]},TS(t._query)}return function(p,x,v,C){const A=new hS(C),T=new rS(x,A,v);return p.asyncQueue.enqueueAndForget(async()=>tS(await Jm(p),T)),()=>{A.Ou(),p.asyncQueue.enqueueAndForget(async()=>nS(await Jm(p),T))}}(Ol(d),h,a,l)}function $l(t,e){return function(r,s){const i=new fr;return r.asyncQueue.enqueueAndForget(async()=>mD(await ND(r),s,i)),i.promise}(Ol(t),e)}function FD(t,e,n){const r=n.docs.get(e._key),s=new Jd(t);return new pr(t,s,e._key,r,new Js(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD={maxAttempts:5};function _a(t,e){if((t=ye(t)).firestore!==e)throw new W(V.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Ll(e)}get(e){const n=_a(e,this._firestore),r=new LD(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return J(24041);const i=s[0];if(i.isFoundDocument())return new Xc(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Xc(this._firestore,r,n._key,null,n.converter);throw J(18433,{doc:i})})}set(e,n,r){const s=_a(e,this._firestore),i=qg(s.converter,n,r),o=Ug(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=_a(e,this._firestore);let o;return o=typeof(n=ye(n))=="string"||n instanceof Oo?_S(this._dataReader,"Transaction.update",i._key,n,r,s):yS(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=_a(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS extends $D{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=_a(e,this._firestore),r=new Jd(this._firestore);return super.get(e).then(s=>new pr(this._firestore,r,n._key,s._document,new Js(!1,!1),n.converter))}}function IS(t,e,n){t=Kt(t,Jn);const r=Object.assign(Object.assign({},UD),n);return function(i){if(i.maxAttempts<1)throw new W(V.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const l=new fr;return i.asyncQueue.enqueueAndForget(async()=>{const d=await CD(i);new bD(i.asyncQueue,d,a,o,l).zu()}),l.promise}(Ol(t),s=>e(new SS(t,s)),r)}function Ze(){return new $g("serverTimestamp")}(function(e,n=!0){(function(s){Ao=s})(xi),_n(new ln("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Jn(new VR(r.getProvider("auth-internal")),new $R(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new W(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yo(d.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),kt(G0,K0,e),kt(G0,K0,"esm2017")})();const G_=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Hg,Bytes:zt,CollectionReference:mr,DocumentReference:Me,DocumentSnapshot:pr,FieldPath:Oo,FieldValue:Ml,Firestore:Jn,FirestoreError:W,GeoPoint:Pn,Query:Zn,QueryCompositeFilterConstraint:Qd,QueryConstraint:Kd,QueryDocumentSnapshot:Va,QueryFieldFilterConstraint:Fl,QueryLimitConstraint:Xd,QueryOrderByConstraint:Yd,QuerySnapshot:ps,SnapshotMetadata:Js,Timestamp:Ie,Transaction:SS,VectorValue:Rn,_AutoId:Rd,_ByteString:ft,_DatabaseId:yo,_DocumentKey:X,_EmptyAuthCredentialsProvider:XT,_FieldPath:dt,_cast:Kt,_logWarn:br,_validateIsNotUsedTogether:eb,addDoc:sc,collection:pe,connectFirestoreEmulator:pS,deleteDoc:Ul,doc:be,ensureFirestoreConfigured:Ol,executeWrite:$l,getDocs:In,getFirestore:Qc,limit:bi,onSnapshot:Qe,orderBy:Ct,query:Ne,runTransaction:IS,serverTimestamp:Ze,setDoc:Si,updateDoc:Gn,where:Pe},Symbol.toStringTag,{value:"Module"}));function Gg(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function NS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const BD=NS,CS=new wi("auth","Firebase",NS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=new dg("@firebase/auth");function zD(t,...e){Jc.logLevel<=ce.WARN&&Jc.warn(`Auth (${xi}): ${t}`,...e)}function ic(t,...e){Jc.logLevel<=ce.ERROR&&Jc.error(`Auth (${xi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(t,...e){throw Kg(t,...e)}function Kn(t,...e){return Kg(t,...e)}function kS(t,e,n){const r=Object.assign(Object.assign({},BD()),{[e]:n});return new wi("auth","Firebase",r).create(e,{appName:t.name})}function gs(t){return kS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Kg(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return CS.create(t,...e)}function te(t,e,...n){if(!t)throw Kg(e,...n)}function ur(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ic(e),new Error(e)}function Ir(t,e){t||ur(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function WD(){return K_()==="http:"||K_()==="https:"}function K_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(WD()||pP()||"connection"in navigator)?navigator.onLine:!0}function qD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ir(n>e,"Short delay should be less than long delay!"),this.isMobile=hP()||gP()}get(){return HD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(t,e){Ir(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ur("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ur("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ur("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],QD=new Bl(3e4,6e4);function Ii(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ds(t,e,n,r,s={}){return PS(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Nl(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:l},i);return mP()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Pr(t.emulatorConfig.host)&&(d.credentials="include"),AS.fetch()(await RS(t,t.config.apiHost,n,a),d)})}async function PS(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},GD),e);try{const s=new XD(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Du(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,d]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Du(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Du(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Du(t,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw kS(t,h,d);On(t,h)}}catch(s){if(s instanceof Mn)throw s;On(t,"network-request-failed",{message:String(s)})}}async function Zd(t,e,n,r,s={}){const i=await Ds(t,e,n,r,s);return"mfaPendingCredential"in i&&On(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function RS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Qg(t.config,s):`${t.config.apiScheme}://${s}`;return KD.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function YD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class XD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Kn(this.auth,"network-request-failed")),QD.get())})}}function Du(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Kn(t,e,r);return s.customData._tokenResponse=n,s}function Q_(t){return t!==void 0&&t.enterprise!==void 0}class JD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return YD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function ZD(t,e){return Ds(t,"GET","/v2/recaptchaConfig",Ii(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eO(t,e){return Ds(t,"POST","/v1/accounts:delete",e)}async function Zc(t,e){return Ds(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function tO(t,e=!1){const n=ye(t),r=await n.getIdToken(e),s=Yg(r);te(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Fa(gf(s.auth_time)),issuedAtTime:Fa(gf(s.iat)),expirationTime:Fa(gf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function gf(t){return Number(t)*1e3}function Yg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ic("JWT malformed, contained fewer than 3 sections"),null;try{const s=PT(n);return s?JSON.parse(s):(ic("Failed to decode base64 JWT payload"),null)}catch(s){return ic("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Y_(t){const e=Yg(t);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Mn&&nO(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function nO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fa(this.lastLoginAt),this.creationTime=Fa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ed(t){var e;const n=t.auth,r=await t.getIdToken(),s=await yl(t,Zc(n,{idToken:r}));te(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?jS(i.providerUserInfo):[],a=iO(t.providerData,o),l=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),h=l?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new tp(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,m)}async function sO(t){const e=ye(t);await ed(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iO(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function jS(t){return t.map(e=>{var{providerId:n}=e,r=Gg(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oO(t,e){const n=await PS(t,{},async()=>{const r=Nl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await RS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&Pr(t.emulatorConfig.host)&&(l.credentials="include"),AS.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function aO(t,e){return Ds(t,"POST","/v2/accounts:revokeToken",Ii(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Y_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){te(e.length!==0,"internal-error");const n=Y_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await oO(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new io;return r&&(te(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(te(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(te(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new io,this.toJSON())}_performRefresh(){return ur("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(t,e){te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Nn{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Gg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new rO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new tp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await yl(this,this.stsTokenManager.getToken(this.auth,e));return te(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return tO(this,e)}reload(){return sO(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Nn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await ed(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(en(this.auth.app))return Promise.reject(gs(this.auth));const e=await this.getIdToken();return await yl(this,eO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,l,d,h;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,x=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,v=(o=n.photoURL)!==null&&o!==void 0?o:void 0,C=(a=n.tenantId)!==null&&a!==void 0?a:void 0,A=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,T=(d=n.createdAt)!==null&&d!==void 0?d:void 0,y=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:w,emailVerified:N,isAnonymous:j,providerData:D,stsTokenManager:b}=n;te(w&&b,e,"internal-error");const E=io.fromJSON(this.name,b);te(typeof w=="string",e,"internal-error"),Ur(m,e.name),Ur(p,e.name),te(typeof N=="boolean",e,"internal-error"),te(typeof j=="boolean",e,"internal-error"),Ur(x,e.name),Ur(v,e.name),Ur(C,e.name),Ur(A,e.name),Ur(T,e.name),Ur(y,e.name);const I=new Nn({uid:w,auth:e,email:p,emailVerified:N,displayName:m,isAnonymous:j,photoURL:v,phoneNumber:x,tenantId:C,stsTokenManager:E,createdAt:T,lastLoginAt:y});return D&&Array.isArray(D)&&(I.providerData=D.map(k=>Object.assign({},k))),A&&(I._redirectEventId=A),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new io;s.updateFromServerResponse(n);const i=new Nn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ed(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];te(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?jS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new io;a.updateFromIdToken(r);const l=new Nn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new tp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,d),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_=new Map;function cr(t){Ir(t instanceof Function,"Expected a class definition");let e=X_.get(t);return e?(Ir(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,X_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}DS.type="NONE";const J_=DS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oc(t,e,n){return`firebase:${t}:${e}:${n}`}class oo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=oc(this.userKey,s.apiKey,i),this.fullPersistenceKey=oc("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Zc(this.auth,{idToken:e}).catch(()=>{});return n?Nn._fromGetAccountInfoResponse(this.auth,n,e):null}return Nn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new oo(cr(J_),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||cr(J_);const o=oc(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let m;if(typeof h=="string"){const p=await Zc(e,{idToken:h}).catch(()=>{});if(!p)break;m=await Nn._fromGetAccountInfoResponse(e,p,h)}else m=Nn._fromJSON(e,h);d!==i&&(a=m),i=d;break}}catch{}const l=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new oo(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new oo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(OS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(US(e))return"Blackberry";if($S(e))return"Webos";if(MS(e))return"Safari";if((e.includes("chrome/")||LS(e))&&!e.includes("edge/"))return"Chrome";if(FS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function OS(t=Rt()){return/firefox\//i.test(t)}function MS(t=Rt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function LS(t=Rt()){return/crios\//i.test(t)}function VS(t=Rt()){return/iemobile/i.test(t)}function FS(t=Rt()){return/android/i.test(t)}function US(t=Rt()){return/blackberry/i.test(t)}function $S(t=Rt()){return/webos/i.test(t)}function Xg(t=Rt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function lO(t=Rt()){var e;return Xg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function uO(){return vP()&&document.documentMode===10}function BS(t=Rt()){return Xg(t)||FS(t)||$S(t)||US(t)||/windows phone/i.test(t)||VS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zS(t,e=[]){let n;switch(t){case"Browser":n=Z_(Rt());break;case"Worker":n=`${Z_(Rt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${xi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dO(t,e={}){return Ds(t,"GET","/v2/passwordPolicy",Ii(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO=6;class fO{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:hO,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ew(this),this.idTokenSubscription=new ew(this),this.beforeStateQueue=new cO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=CS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=cr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await oo.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Zc(this,{idToken:e}),r=await Nn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(en(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ed(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(en(this.app))return Promise.reject(gs(this));const n=e?ye(e):null;return n&&te(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return en(this.app)?Promise.reject(gs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return en(this.app)?Promise.reject(gs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(cr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await dO(this),n=new fO(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new wi("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await aO(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&cr(e)||this._popupRedirectResolver;te(n,this,"argument-error"),this.redirectPersistenceManager=await oo.create(this,[cr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(en(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&zD(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Mo(t){return ye(t)}class ew{constructor(e){this.auth=e,this.observer=null,this.addObserver=bP(n=>this.observer=n)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pO(t){eh=t}function WS(t){return eh.loadJS(t)}function gO(){return eh.recaptchaEnterpriseScript}function vO(){return eh.gapiScript}function yO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class _O{constructor(){this.enterprise=new wO}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class wO{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const xO="recaptcha-enterprise",HS="NO_RECAPTCHA";class EO{constructor(e){this.type=xO,this.auth=Mo(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{ZD(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new JD(l);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Q_(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(HS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new _O().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Q_(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=gO();l.length!==0&&(l+=a),WS(l).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function tw(t,e,n,r=!1,s=!1){const i=new EO(t);let o;if(s)o=HS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function nw(t,e,n,r,s){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await tw(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await tw(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TO(t,e){const n=Ps(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ui(i,e??{}))return s;On(s,"already-initialized")}return n.initialize({options:e})}function bO(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(cr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function SO(t,e,n){const r=Mo(t);te(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=qS(e),{host:o,port:a}=IO(e),l=a===null?"":`:${a}`,d={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){te(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),te(ui(d,r.config.emulator)&&ui(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Pr(o)?(kd(`${i}//${o}${l}`),Ad("Auth",!0)):NO()}function qS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function IO(t){const e=qS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:rw(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:rw(o)}}}function rw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function NO(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ur("not implemented")}_getIdTokenResponse(e){return ur("not implemented")}_linkToIdToken(e,n){return ur("not implemented")}_getReauthenticationResolver(e){return ur("not implemented")}}async function CO(t,e){return Ds(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kO(t,e){return Zd(t,"POST","/v1/accounts:signInWithPassword",Ii(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AO(t,e){return Zd(t,"POST","/v1/accounts:signInWithEmailLink",Ii(t,e))}async function PO(t,e){return Zd(t,"POST","/v1/accounts:signInWithEmailLink",Ii(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends Jg{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new _l(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new _l(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nw(e,n,"signInWithPassword",kO);case"emailLink":return AO(e,{email:this._email,oobCode:this._password});default:On(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nw(e,r,"signUpPassword",CO);case"emailLink":return PO(e,{idToken:n,email:this._email,oobCode:this._password});default:On(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ao(t,e){return Zd(t,"POST","/v1/accounts:signInWithIdp",Ii(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RO="http://localhost";class hi extends Jg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new hi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):On("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Gg(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new hi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ao(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ao(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ao(e,n)}buildRequest(){const e={requestUri:RO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Nl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jO(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DO(t){const e=ma(pa(t)).link,n=e?ma(pa(e)).deep_link_id:null,r=ma(pa(t)).deep_link_id;return(r?ma(pa(r)).link:null)||r||n||e||t}class Zg{constructor(e){var n,r,s,i,o,a;const l=ma(pa(e)),d=(n=l.apiKey)!==null&&n!==void 0?n:null,h=(r=l.oobCode)!==null&&r!==void 0?r:null,m=jO((s=l.mode)!==null&&s!==void 0?s:null);te(d&&h&&m,"argument-error"),this.apiKey=d,this.operation=m,this.code=h,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=DO(e);try{return new Zg(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(){this.providerId=Lo.PROVIDER_ID}static credential(e,n){return _l._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Zg.parseLink(n);return te(r,"argument-error"),_l._fromEmailAndCode(e,r.code,r.tenantId)}}Lo.PROVIDER_ID="password";Lo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Lo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl extends GS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr extends zl{constructor(){super("facebook.com")}static credential(e){return hi._fromParams({providerId:qr.PROVIDER_ID,signInMethod:qr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qr.credentialFromTaggedObject(e)}static credentialFromError(e){return qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qr.credential(e.oauthAccessToken)}catch{return null}}}qr.FACEBOOK_SIGN_IN_METHOD="facebook.com";qr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr extends zl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return hi._fromParams({providerId:Gr.PROVIDER_ID,signInMethod:Gr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Gr.credentialFromTaggedObject(e)}static credentialFromError(e){return Gr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Gr.credential(n,r)}catch{return null}}}Gr.GOOGLE_SIGN_IN_METHOD="google.com";Gr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr extends zl{constructor(){super("github.com")}static credential(e){return hi._fromParams({providerId:Kr.PROVIDER_ID,signInMethod:Kr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kr.credentialFromTaggedObject(e)}static credentialFromError(e){return Kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Kr.credential(e.oauthAccessToken)}catch{return null}}}Kr.GITHUB_SIGN_IN_METHOD="github.com";Kr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr extends zl{constructor(){super("twitter.com")}static credential(e,n){return hi._fromParams({providerId:Qr.PROVIDER_ID,signInMethod:Qr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Qr.credentialFromTaggedObject(e)}static credentialFromError(e){return Qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Qr.credential(n,r)}catch{return null}}}Qr.TWITTER_SIGN_IN_METHOD="twitter.com";Qr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Nn._fromIdTokenResponse(e,r,s),o=sw(r);return new To({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=sw(r);return new To({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function sw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends Mn{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,td.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new td(e,n,r,s)}}function KS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?td._fromErrorAndOperation(t,i,e,r):i})}async function OO(t,e,n=!1){const r=await yl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return To._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MO(t,e,n=!1){const{auth:r}=t;if(en(r.app))return Promise.reject(gs(r));const s="reauthenticate";try{const i=await yl(t,KS(r,s,e,t),n);te(i.idToken,r,"internal-error");const o=Yg(i.idToken);te(o,r,"internal-error");const{sub:a}=o;return te(t.uid===a,r,"user-mismatch"),To._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&On(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QS(t,e,n=!1){if(en(t.app))return Promise.reject(gs(t));const r="signIn",s=await KS(t,r,e),i=await To._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function LO(t,e){return QS(Mo(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VO(t){const e=Mo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function FO(t,e,n){return en(t.app)?Promise.reject(gs(t)):LO(ye(t),Lo.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&VO(t),r})}function UO(t,e,n,r){return ye(t).onIdTokenChanged(e,n,r)}function $O(t,e,n){return ye(t).beforeAuthStateChanged(e,n)}function BO(t,e,n,r){return ye(t).onAuthStateChanged(e,n,r)}function zO(t){return ye(t).signOut()}const nd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(nd,"1"),this.storage.removeItem(nd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=1e3,HO=10;class XS extends YS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=BS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);uO()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,HO):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},WO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}XS.type="LOCAL";const qO=XS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS extends YS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}JS.type="SESSION";const ZS=JS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new th(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),l=await GO(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}th.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const d=ev("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qn(){return window}function QO(t){Qn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(){return typeof Qn().WorkerGlobalScope<"u"&&typeof Qn().importScripts=="function"}async function YO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function XO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function JO(){return e1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1="firebaseLocalStorageDb",ZO=1,rd="firebaseLocalStorage",n1="fbase_key";class Wl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function nh(t,e){return t.transaction([rd],e?"readwrite":"readonly").objectStore(rd)}function eM(){const t=indexedDB.deleteDatabase(t1);return new Wl(t).toPromise()}function np(){const t=indexedDB.open(t1,ZO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(rd,{keyPath:n1})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(rd)?e(r):(r.close(),await eM(),e(await np()))})})}async function iw(t,e,n){const r=nh(t,!0).put({[n1]:e,value:n});return new Wl(r).toPromise()}async function tM(t,e){const n=nh(t,!1).get(e),r=await new Wl(n).toPromise();return r===void 0?null:r.value}function ow(t,e){const n=nh(t,!0).delete(e);return new Wl(n).toPromise()}const nM=800,rM=3;class r1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await np(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>rM)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return e1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=th._getInstance(JO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await YO(),!this.activeServiceWorker)return;this.sender=new KO(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||XO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await np();return await iw(e,nd,"1"),await ow(e,nd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>iw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>tM(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ow(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=nh(s,!1).getAll();return new Wl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}r1.type="LOCAL";const sM=r1;new Bl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iM(t,e){return e?cr(e):(te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv extends Jg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ao(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ao(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ao(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function oM(t){return QS(t.auth,new tv(t),t.bypassAuthState)}function aM(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),MO(n,new tv(t),t.bypassAuthState)}async function lM(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),OO(n,new tv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return oM;case"linkViaPopup":case"linkViaRedirect":return lM;case"reauthViaPopup":case"reauthViaRedirect":return aM;default:On(this.auth,"internal-error")}}resolve(e){Ir(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ir(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM=new Bl(2e3,1e4);class Xi extends s1{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Xi.currentPopupAction&&Xi.currentPopupAction.cancel(),Xi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return te(e,this.auth,"internal-error"),e}async onExecution(){Ir(this.filter.length===1,"Popup operations only handle one event");const e=ev();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Kn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Kn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Kn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,uM.get())};e()}}Xi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM="pendingRedirect",ac=new Map;class dM extends s1{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ac.get(this.auth._key());if(!e){try{const r=await hM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ac.set(this.auth._key(),e)}return this.bypassAuthState||ac.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function hM(t,e){const n=pM(e),r=mM(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function fM(t,e){ac.set(t._key(),e)}function mM(t){return cr(t._redirectPersistence)}function pM(t){return oc(cM,t.config.apiKey,t.name)}async function gM(t,e,n=!1){if(en(t.app))return Promise.reject(gs(t));const r=Mo(t),s=iM(r,e),o=await new dM(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM=10*60*1e3;class yM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_M(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!i1(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Kn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vM&&this.cachedEventUids.clear(),this.cachedEventUids.has(aw(e))}saveEventToCache(e){this.cachedEventUids.add(aw(e)),this.lastProcessedEventTime=Date.now()}}function aw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function i1({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function _M(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return i1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wM(t,e={}){return Ds(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,EM=/^https?/;async function TM(t){if(t.config.emulator)return;const{authorizedDomains:e}=await wM(t);for(const n of e)try{if(bM(n))return}catch{}On(t,"unauthorized-domain")}function bM(t){const e=ep(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!EM.test(n))return!1;if(xM.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM=new Bl(3e4,6e4);function lw(){const t=Qn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function IM(t){return new Promise((e,n)=>{var r,s,i;function o(){lw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{lw(),n(Kn(t,"network-request-failed"))},timeout:SM.get()})}if(!((s=(r=Qn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Qn().gapi)===null||i===void 0)&&i.load)o();else{const a=yO("iframefcb");return Qn()[a]=()=>{gapi.load?o():n(Kn(t,"network-request-failed"))},WS(`${vO()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw lc=null,e})}let lc=null;function NM(t){return lc=lc||IM(t),lc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CM=new Bl(5e3,15e3),kM="__/auth/iframe",AM="emulator/auth/iframe",PM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},RM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function jM(t){const e=t.config;te(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Qg(e,AM):`https://${t.config.authDomain}/${kM}`,r={apiKey:e.apiKey,appName:t.name,v:xi},s=RM.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Nl(r).slice(1)}`}async function DM(t){const e=await NM(t),n=Qn().gapi;return te(n,t,"internal-error"),e.open({where:document.body,url:jM(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PM,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Kn(t,"network-request-failed"),a=Qn().setTimeout(()=>{i(o)},CM.get());function l(){Qn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MM=500,LM=600,VM="_blank",FM="http://localhost";class uw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function UM(t,e,n,r=MM,s=LM){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},OM),{width:r.toString(),height:s.toString(),top:i,left:o}),d=Rt().toLowerCase();n&&(a=LS(d)?VM:n),OS(d)&&(e=e||FM,l.scrollbars="yes");const h=Object.entries(l).reduce((p,[x,v])=>`${p}${x}=${v},`,"");if(lO(d)&&a!=="_self")return $M(e||"",a),new uw(null);const m=window.open(e||"",a,h);te(m,t,"popup-blocked");try{m.focus()}catch{}return new uw(m)}function $M(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BM="__/auth/handler",zM="emulator/auth/handler",WM=encodeURIComponent("fac");async function cw(t,e,n,r,s,i){te(t.config.authDomain,t,"auth-domain-config-required"),te(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:xi,eventId:s};if(e instanceof GS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",TP(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries({}))o[h]=m}if(e instanceof zl){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),d=l?`#${WM}=${encodeURIComponent(l)}`:"";return`${HM(t)}?${Nl(a).slice(1)}${d}`}function HM({config:t}){return t.emulator?Qg(t,zM):`https://${t.authDomain}/${BM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf="webStorageSupport";class qM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ZS,this._completeRedirectFn=gM,this._overrideRedirectResult=fM}async _openPopup(e,n,r,s){var i;Ir((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await cw(e,n,r,ep(),s);return UM(e,o,ev())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await cw(e,n,r,ep(),s);return QO(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Ir(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await DM(e),r=new yM(e);return n.register("authEvent",s=>(te(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(vf,{type:vf},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[vf];o!==void 0&&n(!!o),On(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=TM(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return BS()||MS()||Xg()}}const GM=qM;var dw="@firebase/auth",hw="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function YM(t){_n(new ln("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;te(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zS(t)},d=new mO(r,s,i,l);return bO(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),_n(new ln("auth-internal",e=>{const n=Mo(e.getProvider("auth").getImmediate());return(r=>new KM(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),kt(dw,hw,QM(t)),kt(dw,hw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XM=5*60,JM=DT("authIdTokenMaxAge")||XM;let fw=null;const ZM=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>JM)return;const s=n==null?void 0:n.token;fw!==s&&(fw=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function e4(t=Cl()){const e=Ps(t,"auth");if(e.isInitialized())return e.getImmediate();const n=TO(t,{popupRedirectResolver:GM,persistence:[sM,qO,ZS]}),r=DT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=ZM(i.toString());$O(n,o,()=>o(n.currentUser)),UO(n,a=>o(a))}}const s=RT("auth");return s&&SO(n,`http://${s}`),n}function t4(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}pO({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Kn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",t4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});YM("Browser");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,en(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rp="us-central1";class r4{constructor(e,n,r,s,i=rp,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new n4(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=rp}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function s4(t,e,n){const r=Pr(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(kd(t.emulatorOrigin),Ad("Functions",!0))}const mw="@firebase/functions",pw="0.12.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4="auth-internal",o4="app-check-internal",a4="messaging-internal";function l4(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(i4),o=n.getProvider(a4),a=n.getProvider(o4);return new r4(s,i,o,a,r)};_n(new ln(o1,e,"PUBLIC").setMultipleInstances(!0)),kt(mw,pw,t),kt(mw,pw,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u4(t=Cl(),e=rp){const r=Ps(ye(t),o1).getImmediate({identifier:e}),s=cg("functions");return s&&c4(r,...s),r}function c4(t,e,n){s4(ye(t),e,n)}l4();const a1="@firebase/installations",nv="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1=1e4,u1=`w:${nv}`,c1="FIS_v2",d4="https://firebaseinstallations.googleapis.com/v1",h4=60*60*1e3,f4="installations",m4="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},fi=new wi(f4,m4,p4);function d1(t){return t instanceof Mn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1({projectId:t}){return`${d4}/projects/${t}/installations`}function f1(t){return{token:t.token,requestStatus:2,expiresIn:v4(t.expiresIn),creationTime:Date.now()}}async function m1(t,e){const r=(await e.json()).error;return fi.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function p1({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function g4(t,{refreshToken:e}){const n=p1(t);return n.append("Authorization",y4(e)),n}async function g1(t){const e=await t();return e.status>=500&&e.status<600?t():e}function v4(t){return Number(t.replace("s","000"))}function y4(t){return`${c1} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _4({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=h1(t),s=p1(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:c1,appId:t.appId,sdkVersion:u1},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await g1(()=>fetch(r,a));if(l.ok){const d=await l.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:f1(d.authToken)}}else throw await m1("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w4(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=/^[cdef][\w-]{21}$/,sp="";function E4(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=T4(t);return x4.test(n)?n:sp}catch{return sp}}function T4(t){return w4(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1=new Map;function _1(t,e){const n=rh(t);w1(n,e),b4(n,e)}function w1(t,e){const n=y1.get(t);if(n)for(const r of n)r(e)}function b4(t,e){const n=S4();n&&n.postMessage({key:t,fid:e}),I4()}let Zs=null;function S4(){return!Zs&&"BroadcastChannel"in self&&(Zs=new BroadcastChannel("[Firebase] FID Change"),Zs.onmessage=t=>{w1(t.data.key,t.data.fid)}),Zs}function I4(){y1.size===0&&Zs&&(Zs.close(),Zs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N4="firebase-installations-database",C4=1,mi="firebase-installations-store";let yf=null;function rv(){return yf||(yf=Pd(N4,C4,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(mi)}}})),yf}async function sd(t,e){const n=rh(t),s=(await rv()).transaction(mi,"readwrite"),i=s.objectStore(mi),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&_1(t,e.fid),e}async function x1(t){const e=rh(t),r=(await rv()).transaction(mi,"readwrite");await r.objectStore(mi).delete(e),await r.done}async function sh(t,e){const n=rh(t),s=(await rv()).transaction(mi,"readwrite"),i=s.objectStore(mi),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&_1(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sv(t){let e;const n=await sh(t.appConfig,r=>{const s=k4(r),i=A4(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===sp?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function k4(t){const e=t||{fid:E4(),registrationStatus:0};return E1(e)}function A4(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(fi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=P4(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:R4(t)}:{installationEntry:e}}async function P4(t,e){try{const n=await _4(t,e);return sd(t.appConfig,n)}catch(n){throw d1(n)&&n.customData.serverCode===409?await x1(t.appConfig):await sd(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function R4(t){let e=await gw(t.appConfig);for(;e.registrationStatus===1;)await v1(100),e=await gw(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await sv(t);return r||n}return e}function gw(t){return sh(t,e=>{if(!e)throw fi.create("installation-not-found");return E1(e)})}function E1(t){return j4(t)?{fid:t.fid,registrationStatus:0}:t}function j4(t){return t.registrationStatus===1&&t.registrationTime+l1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D4({appConfig:t,heartbeatServiceProvider:e},n){const r=O4(t,n),s=g4(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:u1,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await g1(()=>fetch(r,a));if(l.ok){const d=await l.json();return f1(d)}else throw await m1("Generate Auth Token",l)}function O4(t,{fid:e}){return`${h1(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iv(t,e=!1){let n;const r=await sh(t.appConfig,i=>{if(!T1(i))throw fi.create("not-registered");const o=i.authToken;if(!e&&V4(o))return i;if(o.requestStatus===1)return n=M4(t,e),i;{if(!navigator.onLine)throw fi.create("app-offline");const a=U4(i);return n=L4(t,a),a}});return n?await n:r.authToken}async function M4(t,e){let n=await vw(t.appConfig);for(;n.authToken.requestStatus===1;)await v1(100),n=await vw(t.appConfig);const r=n.authToken;return r.requestStatus===0?iv(t,e):r}function vw(t){return sh(t,e=>{if(!T1(e))throw fi.create("not-registered");const n=e.authToken;return $4(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function L4(t,e){try{const n=await D4(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await sd(t.appConfig,r),n}catch(n){if(d1(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await x1(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await sd(t.appConfig,r)}throw n}}function T1(t){return t!==void 0&&t.registrationStatus===2}function V4(t){return t.requestStatus===2&&!F4(t)}function F4(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+h4}function U4(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function $4(t){return t.requestStatus===1&&t.requestTime+l1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B4(t){const e=t,{installationEntry:n,registrationPromise:r}=await sv(e);return r?r.catch(console.error):iv(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z4(t,e=!1){const n=t;return await W4(n),(await iv(n,e)).token}async function W4(t){const{registrationPromise:e}=await sv(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H4(t){if(!t||!t.options)throw _f("App Configuration");if(!t.name)throw _f("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw _f(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function _f(t){return fi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1="installations",q4="installations-internal",G4=t=>{const e=t.getProvider("app").getImmediate(),n=H4(e),r=Ps(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},K4=t=>{const e=t.getProvider("app").getImmediate(),n=Ps(e,b1).getImmediate();return{getId:()=>B4(n),getToken:s=>z4(n,s)}};function Q4(){_n(new ln(b1,G4,"PUBLIC")),_n(new ln(q4,K4,"PRIVATE"))}Q4();kt(a1,nv);kt(a1,nv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4="/firebase-messaging-sw.js",X4="/firebase-cloud-messaging-push-scope",S1="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",J4="https://fcmregistrations.googleapis.com/v1",I1="google.c.a.c_id",Z4="google.c.a.c_l",eL="google.c.a.ts",tL="google.c.a.e",yw=1e4;var _w;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(_w||(_w={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var wl;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(wl||(wl={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nL(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wf="fcm_token_details_db",rL=5,ww="fcm_token_object_Store";async function sL(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(wf))return null;let e=null;return(await Pd(wf,rL,{upgrade:async(r,s,i,o)=>{var a;if(s<2||!r.objectStoreNames.contains(ww))return;const l=o.objectStore(ww),d=await l.index("fcmSenderId").get(t);if(await l.clear(),!!d){if(s===2){const h=d;if(!h.auth||!h.p256dh||!h.endpoint)return;e={token:h.fcmToken,createTime:(a=h.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:h.auth,p256dh:h.p256dh,endpoint:h.endpoint,swScope:h.swScope,vapidKey:typeof h.vapidKey=="string"?h.vapidKey:sr(h.vapidKey)}}}else if(s===3){const h=d;e={token:h.fcmToken,createTime:h.createTime,subscriptionOptions:{auth:sr(h.auth),p256dh:sr(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:sr(h.vapidKey)}}}else if(s===4){const h=d;e={token:h.fcmToken,createTime:h.createTime,subscriptionOptions:{auth:sr(h.auth),p256dh:sr(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:sr(h.vapidKey)}}}}}})).close(),await cf(wf),await cf("fcm_vapid_details_db"),await cf("undefined"),iL(e)?e:null}function iL(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL="firebase-messaging-database",aL=1,xl="firebase-messaging-store";let xf=null;function N1(){return xf||(xf=Pd(oL,aL,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(xl)}}})),xf}async function lL(t){const e=C1(t),r=await(await N1()).transaction(xl).objectStore(xl).get(e);if(r)return r;{const s=await sL(t.appConfig.senderId);if(s)return await ov(t,s),s}}async function ov(t,e){const n=C1(t),s=(await N1()).transaction(xl,"readwrite");return await s.objectStore(xl).put(e,n),await s.done,e}function C1({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},At=new wi("messaging","Messaging",uL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cL(t,e){const n=await lv(t),r=k1(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(av(t.appConfig),s)).json()}catch(o){throw At.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw At.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw At.create("token-subscribe-no-token");return i.token}async function dL(t,e){const n=await lv(t),r=k1(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${av(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw At.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw At.create("token-update-failed",{errorInfo:o})}if(!i.token)throw At.create("token-update-no-token");return i.token}async function hL(t,e){const r={method:"DELETE",headers:await lv(t)};try{const i=await(await fetch(`${av(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw At.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw At.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function av({projectId:t}){return`${J4}/projects/${t}/registrations`}async function lv({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function k1({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==S1&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL=7*24*60*60*1e3;async function mL(t){const e=await gL(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:sr(e.getKey("auth")),p256dh:sr(e.getKey("p256dh"))},r=await lL(t.firebaseDependencies);if(r){if(vL(r.subscriptionOptions,n))return Date.now()>=r.createTime+fL?pL(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await hL(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return xw(t.firebaseDependencies,n)}else return xw(t.firebaseDependencies,n)}async function pL(t,e){try{const n=await dL(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await ov(t.firebaseDependencies,r),n}catch(n){throw n}}async function xw(t,e){const r={token:await cL(t,e),createTime:Date.now(),subscriptionOptions:e};return await ov(t,r),r.token}async function gL(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:nL(e)})}function vL(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return yL(e,t),_L(e,t),wL(e,t),e}function yL(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function _L(t,e){e.data&&(t.data=e.data)}function wL(t,e){var n,r,s,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const l=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;l&&(t.fcmOptions.analyticsLabel=l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(t){return typeof t=="object"&&!!t&&I1 in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EL(t){if(!t||!t.options)throw Ef("App Configuration Object");if(!t.name)throw Ef("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Ef(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Ef(t){return At.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TL=class{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=EL(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bL(t){try{t.swRegistration=await navigator.serviceWorker.register(Y4,{scope:X4}),t.swRegistration.update().catch(()=>{}),await SL(t.swRegistration)}catch(e){throw At.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function SL(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${yw} ms`)),yw),s=t.installing||t.waiting;t.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var o;((o=i.target)===null||o===void 0?void 0:o.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IL(t,e){if(!e&&!t.swRegistration&&await bL(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw At.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NL(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=S1)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A1(t,e){if(!navigator)throw At.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw At.create("permission-blocked");return await NL(t,e==null?void 0:e.vapidKey),await IL(t,e==null?void 0:e.serviceWorkerRegistration),mL(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CL(t,e,n){const r=kL(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[I1],message_name:n[Z4],message_time:n[eL],message_device_time:Math.floor(Date.now()/1e3)})}function kL(t){switch(t){case wl.NOTIFICATION_CLICKED:return"notification_open";case wl.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AL(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===wl.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(Ew(n)):t.onMessageHandler.next(Ew(n)));const r=n.data;xL(r)&&r[tL]==="1"&&await CL(t,n.messageType,r)}const Tw="@firebase/messaging",bw="0.12.22";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PL=t=>{const e=new TL(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>AL(e,n)),e},RL=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>A1(e,r)}};function jL(){_n(new ln("messaging",PL,"PUBLIC")),_n(new ln("messaging-internal",RL,"PRIVATE")),kt(Tw,bw),kt(Tw,bw,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P1(){try{await LT()}catch{return!1}return typeof window<"u"&&MT()&&_P()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(t,e){if(!navigator)throw At.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R1(t=Cl()){return P1().then(e=>{if(!e)throw At.create("unsupported-browser")},e=>{throw At.create("indexed-db-unsupported")}),Ps(ye(t),"messaging").getImmediate()}async function OL(t,e){return t=ye(t),A1(t,e)}function ML(t,e){return t=ye(t),DL(t,e)}jL();const LL={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDMsLYmLj4qZR2Ty5sJJX9ZEZInc61dJos",VITE_FIREBASE_APP_ID:"1:494398949506:web:b4e591e20590044c72cc9b",VITE_FIREBASE_AUTH_DOMAIN:"bueno-brows-7cce7.firebaseapp.com",VITE_FIREBASE_FUNCTIONS_REGION:"us-central1",VITE_FIREBASE_MESSAGING_SENDER_ID:"494398949506",VITE_FIREBASE_PROJECT_ID:"bueno-brows-7cce7",VITE_FIREBASE_STORAGE_BUCKET:"bueno-brows-7cce7.firebasestorage.app",VITE_USE_EMULATORS:"0"};function ji(t){const e=LL[t];if(!e){const n=t==="VITE_FIREBASE_API_KEY"?"***":"";throw console.error(`[Firebase] Missing env: ${t}${n?" ("+n+")":""}`),new Error(`Missing env ${t}`)}return e}let Ou=null;function VL(){if(Ou)return Ou;const t={apiKey:ji("VITE_FIREBASE_API_KEY"),authDomain:ji("VITE_FIREBASE_AUTH_DOMAIN"),projectId:ji("VITE_FIREBASE_PROJECT_ID"),storageBucket:ji("VITE_FIREBASE_STORAGE_BUCKET"),messagingSenderId:ji("VITE_FIREBASE_MESSAGING_SENDER_ID"),appId:ji("VITE_FIREBASE_APP_ID")},e=bR(),n=e.length>0?e[0]:UT(t);console.log("[Firebase] App initialized:",n.name,n.options.projectId);const r=Qc(n),s=e4(n);console.log("[Firebase] Firestore and Auth initialized");const o=u4(n,"us-central1");let a;return typeof window<"u"&&P1().then(l=>{l&&(a=R1(n))}),Ou={app:n,db:r,auth:s,functions:o,messaging:a},Ou}const j1=_.createContext(null);function FL({children:t}){const e=_.useMemo(()=>VL(),[]);return u.jsx(j1.Provider,{value:e,children:t})}function Xe(){const t=_.useContext(j1);if(!t)throw new Error("useFirebase must be used within FirebaseProvider");return t}function UL({children:t}){const[e,n]=_.useState("loading"),[r,s]=_.useState(""),{auth:i}=Xe();return _.useEffect(()=>BO(i,async o=>{if(!o)return n("unauthed");const l=(await o.getIdTokenResult(!0)).claims.role;n(l==="admin"?"authed":"restricted")}),[]),e==="loading"?u.jsx("div",{className:"p-8",children:"Loading"}):e==="restricted"?u.jsx("div",{className:"min-h-screen grid place-items-center bg-cream",children:u.jsxs("div",{className:"bg-white shadow-soft rounded-xl p-6 w-[380px]",children:[u.jsx("h1",{className:"text-xl font-serif text-slate-800 mb-2",children:"Access Restricted"}),u.jsxs("p",{className:"text-slate-600 text-sm",children:["Your account is signed in, but does not have the ",u.jsx("span",{className:"font-mono",children:'role: "admin"'})," claim."]})]})}):e==="unauthed"?u.jsx($L,{onError:s,error:r}):u.jsx(u.Fragment,{children:t})}function $L({error:t,onError:e}){const[n,r]=_.useState(""),[s,i]=_.useState(""),{auth:o}=Xe();async function a(l){l.preventDefault();try{await FO(o,n,s)}catch(d){e(d.message)}}return u.jsx("div",{className:"min-h-screen grid place-items-center bg-cream",children:u.jsxs("form",{onSubmit:a,className:"bg-white shadow-soft rounded-xl p-6 w-[380px]",children:[u.jsx("h1",{className:"text-2xl font-serif text-slate-800 mb-4",children:"Admin Sign In"}),t&&u.jsx("p",{className:"text-sm text-red-600 mb-2",children:t}),u.jsx("input",{className:"w-full border rounded-md p-2 mb-3",placeholder:"Email",value:n,onChange:l=>r(l.target.value)}),u.jsx("input",{className:"w-full border rounded-md p-2 mb-4",type:"password",placeholder:"Password",value:s,onChange:l=>i(l.target.value)}),u.jsx("button",{className:"w-full bg-terracotta text-white rounded-md py-2",children:"Sign In"})]})})}const Vn=({to:t,children:e})=>u.jsx(XA,{to:t,className:({isActive:n})=>`block px-4 py-2 rounded-md ${n?"bg-terracotta text-white":"text-slate-800 hover:bg-cream"}`,children:e});function BL(){return u.jsxs("aside",{className:"min-h-screen bg-white border-r p-4",children:[u.jsxs("div",{className:"text-2xl mb-6",children:[u.jsx("span",{className:"font-brandBueno text-brand-bueno",children:"BUENO"}),u.jsx("span",{className:"ml-2 font-brandBrows text-brand-brows",children:"BROWS"})]}),u.jsxs("nav",{className:"space-y-2",children:[u.jsx(Vn,{to:"/home",children:"Home"}),u.jsx(Vn,{to:"/schedule",children:"Schedule"}),u.jsx(Vn,{to:"/customers",children:"Customers"}),u.jsx(Vn,{to:"/services",children:"Services"}),u.jsx(Vn,{to:"/reviews",children:"Reviews"}),u.jsx(Vn,{to:"/messages",children:"Messages"}),u.jsx(Vn,{to:"/sms",children:"SMS Support"}),u.jsx(Vn,{to:"/ai-conversations",children:"AI Conversations"}),u.jsx(Vn,{to:"/skin-analyses",children:"Skin Analyses"}),u.jsx(Vn,{to:"/settings",children:"Settings"})]})]})}function zL(){const{auth:t}=Xe();return u.jsxs("header",{className:"flex items-center justify-between border-b bg-white px-6 py-3",children:[u.jsx("h1",{className:"font-serif text-xl text-slate-800",children:"Dashboard"}),u.jsx("button",{className:"text-terracotta",onClick:()=>zO(t),children:"Sign out"})]})}function Ye(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Nr(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function Sw(t,e){const n=Ye(t);if(isNaN(e))return Nr(t,NaN);if(!e)return n;const r=n.getDate(),s=Nr(t,n.getTime());s.setMonth(n.getMonth()+e+1,0);const i=s.getDate();return r>=i?s:(n.setFullYear(s.getFullYear(),s.getMonth(),r),n)}const D1=6048e5,WL=864e5,O1=6e4,M1=36e5;let HL={};function Hl(){return HL}function pi(t,e){var a,l,d,h;const n=Hl(),r=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,s=Ye(t),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function id(t){return pi(t,{weekStartsOn:1})}function L1(t){const e=Ye(t),n=e.getFullYear(),r=Nr(t,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const s=id(r),i=Nr(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=id(i);return e.getTime()>=s.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function Is(t){const e=Ye(t);return e.setHours(0,0,0,0),e}function Iw(t){const e=Ye(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function V1(t,e){const n=Is(t),r=Is(e),s=+n-Iw(n),i=+r-Iw(r);return Math.round((s-i)/WL)}function qL(t){const e=L1(t),n=Nr(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),id(n)}function Tf(t,e){const n=Is(t),r=Is(e);return+n==+r}function GL(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function KL(t){if(!GL(t)&&typeof t!="number")return!1;const e=Ye(t);return!isNaN(Number(e))}function QL(t,e){const n=Ye(t),r=Ye(e),s=Nw(n,r),i=Math.abs(V1(n,r));n.setDate(n.getDate()-s*i);const o=+(Nw(n,r)===-s),a=s*(i-o);return a===0?0:a}function Nw(t,e){const n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function Cw(t){const e=Ye(t);return e.setHours(23,59,59,999),e}function F1(t){const e=Ye(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function U1(t){const e=Ye(t);return e.setDate(1),e.setHours(0,0,0,0),e}function YL(t){const e=Ye(t),n=e.getFullYear();return e.setFullYear(n+1,0,0),e.setHours(23,59,59,999),e}function $1(t){const e=Ye(t),n=Nr(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function B1(t,e){var a,l,d,h;const n=Hl(),r=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,s=Ye(t),i=s.getDay(),o=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}const XL={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},JL=(t,e,n)=>{let r;const s=XL[t];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function bf(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const ZL={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},eV={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},tV={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},nV={date:bf({formats:ZL,defaultWidth:"full"}),time:bf({formats:eV,defaultWidth:"full"}),dateTime:bf({formats:tV,defaultWidth:"full"})},rV={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},sV=(t,e,n,r)=>rV[t];function ia(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,a=n!=null&&n.width?String(n.width):o;s=t.formattingValues[a]||t.formattingValues[o]}else{const o=t.defaultWidth,a=n!=null&&n.width?String(n.width):t.defaultWidth;s=t.values[a]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const iV={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},oV={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},aV={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},lV={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},uV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},cV={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},dV=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},hV={ordinalNumber:dV,era:ia({values:iV,defaultWidth:"wide"}),quarter:ia({values:oV,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ia({values:aV,defaultWidth:"wide"}),day:ia({values:lV,defaultWidth:"wide"}),dayPeriod:ia({values:uV,defaultWidth:"wide",formattingValues:cV,defaultFormattingWidth:"wide"})};function oa(t){return(e,n={})=>{const r=n.width,s=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?mV(a,m=>m.test(o)):fV(a,m=>m.test(o));let d;d=t.valueCallback?t.valueCallback(l):l,d=n.valueCallback?n.valueCallback(d):d;const h=e.slice(o.length);return{value:d,rest:h}}}function fV(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function mV(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function pV(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const s=r[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const gV=/^(\d+)(th|st|nd|rd)?/i,vV=/\d+/i,yV={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_V={any:[/^b/i,/^(a|c)/i]},wV={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xV={any:[/1/i,/2/i,/3/i,/4/i]},EV={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},TV={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},bV={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},SV={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},IV={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},NV={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},CV={ordinalNumber:pV({matchPattern:gV,parsePattern:vV,valueCallback:t=>parseInt(t,10)}),era:oa({matchPatterns:yV,defaultMatchWidth:"wide",parsePatterns:_V,defaultParseWidth:"any"}),quarter:oa({matchPatterns:wV,defaultMatchWidth:"wide",parsePatterns:xV,defaultParseWidth:"any",valueCallback:t=>t+1}),month:oa({matchPatterns:EV,defaultMatchWidth:"wide",parsePatterns:TV,defaultParseWidth:"any"}),day:oa({matchPatterns:bV,defaultMatchWidth:"wide",parsePatterns:SV,defaultParseWidth:"any"}),dayPeriod:oa({matchPatterns:IV,defaultMatchWidth:"any",parsePatterns:NV,defaultParseWidth:"any"})},kV={code:"en-US",formatDistance:JL,formatLong:nV,formatRelative:sV,localize:hV,match:CV,options:{weekStartsOn:0,firstWeekContainsDate:1}};function AV(t){const e=Ye(t);return V1(e,$1(e))+1}function PV(t){const e=Ye(t),n=+id(e)-+qL(e);return Math.round(n/D1)+1}function z1(t,e){var h,m,p,x;const n=Ye(t),r=n.getFullYear(),s=Hl(),i=(e==null?void 0:e.firstWeekContainsDate)??((m=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??s.firstWeekContainsDate??((x=(p=s.locale)==null?void 0:p.options)==null?void 0:x.firstWeekContainsDate)??1,o=Nr(t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const a=pi(o,e),l=Nr(t,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const d=pi(l,e);return n.getTime()>=a.getTime()?r+1:n.getTime()>=d.getTime()?r:r-1}function RV(t,e){var a,l,d,h;const n=Hl(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,s=z1(t,e),i=Nr(t,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),pi(i,e)}function jV(t,e){const n=Ye(t),r=+pi(n,e)-+RV(n,e);return Math.round(r/D1)+1}function _e(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const $r={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return _e(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):_e(n+1,2)},d(t,e){return _e(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return _e(t.getHours()%12||12,e.length)},H(t,e){return _e(t.getHours(),e.length)},m(t,e){return _e(t.getMinutes(),e.length)},s(t,e){return _e(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return _e(s,e.length)}},Di={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},kw={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return $r.y(t,e)},Y:function(t,e,n,r){const s=z1(t,r),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return _e(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):_e(i,e.length)},R:function(t,e){const n=L1(t);return _e(n,e.length)},u:function(t,e){const n=t.getFullYear();return _e(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return _e(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return _e(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return $r.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return _e(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const s=jV(t,r);return e==="wo"?n.ordinalNumber(s,{unit:"week"}):_e(s,e.length)},I:function(t,e,n){const r=PV(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):_e(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):$r.d(t,e)},D:function(t,e,n){const r=AV(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):_e(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return _e(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return _e(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return _e(s,e.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let s;switch(r===12?s=Di.noon:r===0?s=Di.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let s;switch(r>=17?s=Di.evening:r>=12?s=Di.afternoon:r>=4?s=Di.morning:s=Di.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return $r.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):$r.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):_e(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):_e(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):$r.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):$r.s(t,e)},S:function(t,e){return $r.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return Pw(r);case"XXXX":case"XX":return Hs(r);case"XXXXX":case"XXX":default:return Hs(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return Pw(r);case"xxxx":case"xx":return Hs(r);case"xxxxx":case"xxx":default:return Hs(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Aw(r,":");case"OOOO":default:return"GMT"+Hs(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Aw(r,":");case"zzzz":default:return"GMT"+Hs(r,":")}},t:function(t,e,n){const r=Math.trunc(t.getTime()/1e3);return _e(r,e.length)},T:function(t,e,n){const r=t.getTime();return _e(r,e.length)}};function Aw(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+e+_e(i,2)}function Pw(t,e){return t%60===0?(t>0?"-":"+")+_e(Math.abs(t)/60,2):Hs(t,e)}function Hs(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=_e(Math.trunc(r/60),2),i=_e(r%60,2);return n+s+e+i}const Rw=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},W1=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},DV=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return Rw(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",Rw(r,e)).replace("{{time}}",W1(s,e))},OV={p:W1,P:DV},MV=/^D+$/,LV=/^Y+$/,VV=["D","DD","YY","YYYY"];function FV(t){return MV.test(t)}function UV(t){return LV.test(t)}function $V(t,e,n){const r=BV(t,e,n);if(console.warn(r),VV.includes(t))throw new RangeError(r)}function BV(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const zV=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,WV=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,HV=/^'([^]*?)'?$/,qV=/''/g,GV=/[a-zA-Z]/;function nt(t,e,n){var h,m,p,x;const r=Hl(),s=r.locale??kV,i=r.firstWeekContainsDate??((m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,o=r.weekStartsOn??((x=(p=r.locale)==null?void 0:p.options)==null?void 0:x.weekStartsOn)??0,a=Ye(t);if(!KL(a))throw new RangeError("Invalid time value");let l=e.match(WV).map(v=>{const C=v[0];if(C==="p"||C==="P"){const A=OV[C];return A(v,s.formatLong)}return v}).join("").match(zV).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const C=v[0];if(C==="'")return{isToken:!1,value:KV(v)};if(kw[C])return{isToken:!0,value:v};if(C.match(GV))throw new RangeError("Format string contains an unescaped latin alphabet character `"+C+"`");return{isToken:!1,value:v}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(v=>{if(!v.isToken)return v.value;const C=v.value;(UV(C)||FV(C))&&$V(C,e,String(t));const A=kw[C[0]];return A(a,C,s.localize,d)}).join("")}function KV(t){const e=t.match(HV);return e?e[1].replace(qV,"'"):t}function H1(t,e){const n=Ye(t),r=Ye(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function gr(t,e){const r=JV(t);let s;if(r.date){const l=ZV(r.date,2);s=e6(l.restDateString,l.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);const i=s.getTime();let o=0,a;if(r.time&&(o=t6(r.time),isNaN(o)))return new Date(NaN);if(r.timezone){if(a=n6(r.timezone),isNaN(a))return new Date(NaN)}else{const l=new Date(i+o),d=new Date(0);return d.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),d.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),d}return new Date(i+o+a)}const Mu={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},QV=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,YV=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,XV=/^([+-])(\d{2})(?::?(\d{2}))?$/;function JV(t){const e={},n=t.split(Mu.dateTimeDelimiter);let r;if(n.length>2)return e;if(/:/.test(n[0])?r=n[0]:(e.date=n[0],r=n[1],Mu.timeZoneDelimiter.test(e.date)&&(e.date=t.split(Mu.timeZoneDelimiter)[0],r=t.substr(e.date.length,t.length))),r){const s=Mu.timezone.exec(r);s?(e.time=r.replace(s[1],""),e.timezone=s[1]):e.time=r}return e}function ZV(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=t.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function e6(t,e){if(e===null)return new Date(NaN);const n=t.match(QV);if(!n)return new Date(NaN);const r=!!n[4],s=aa(n[1]),i=aa(n[2])-1,o=aa(n[3]),a=aa(n[4]),l=aa(n[5])-1;if(r)return a6(e,a,l)?r6(e,a,l):new Date(NaN);{const d=new Date(0);return!i6(e,i,o)||!o6(e,s)?new Date(NaN):(d.setUTCFullYear(e,i,Math.max(s,o)),d)}}function aa(t){return t?parseInt(t):1}function t6(t){const e=t.match(YV);if(!e)return NaN;const n=Sf(e[1]),r=Sf(e[2]),s=Sf(e[3]);return l6(n,r,s)?n*M1+r*O1+s*1e3:NaN}function Sf(t){return t&&parseFloat(t.replace(",","."))||0}function n6(t){if(t==="Z")return 0;const e=t.match(XV);if(!e)return 0;const n=e[1]==="+"?-1:1,r=parseInt(e[2]),s=e[3]&&parseInt(e[3])||0;return u6(r,s)?n*(r*M1+s*O1):NaN}function r6(t,e,n){const r=new Date(0);r.setUTCFullYear(t,0,4);const s=r.getUTCDay()||7,i=(e-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const s6=[31,null,31,30,31,30,31,31,30,31,30,31];function q1(t){return t%400===0||t%4===0&&t%100!==0}function i6(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(s6[e]||(q1(t)?29:28))}function o6(t,e){return e>=1&&e<=(q1(t)?366:365)}function a6(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function l6(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function u6(t,e){return e>=0&&e<=59}function G1({appointment:t,service:e,onClose:n,onEdit:r}){const{db:s}=Xe(),i=ug(),[o,a]=_.useState(!1);if(!t)return null;const l=async()=>{if(confirm("Cancel this appointment?")){a(!0);try{await Gn(be(s,"appointments",t.id),{status:"cancelled"}),n()}catch(h){console.error("Failed to cancel appointment:",h),alert("Failed to cancel appointment")}finally{a(!1)}}},d=()=>{const h=gr(t.start);i("/schedule",{state:{highlightDate:h}}),n()};return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:n,children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:h=>h.stopPropagation(),children:[u.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[u.jsx("h2",{className:"font-serif text-xl",children:"Appointment Details"}),u.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${t.status==="confirmed"?"bg-green-100 text-green-700":t.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:t.status==="confirmed"?"Confirmed":t.status==="pending"?"Pending":"Cancelled"})}),u.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[u.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"Date & Time"}),u.jsx("div",{className:"font-semibold text-lg",children:nt(gr(t.start),"EEEE, MMMM d, yyyy")}),u.jsx("div",{className:"text-slate-600",children:nt(gr(t.start),"h:mm a")}),u.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Duration: ",t.duration," minutes"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"Service"}),u.jsx("div",{className:"font-medium",children:(e==null?void 0:e.name)||"Unknown Service"}),(e==null?void 0:e.description)&&u.jsx("div",{className:"text-sm text-slate-600 mt-1",children:e.description})]}),t.customerName&&u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"Customer"}),u.jsx("div",{className:"font-medium",children:t.customerName}),t.customerEmail&&u.jsx("div",{className:"text-sm text-slate-600",children:t.customerEmail}),t.customerPhone&&u.jsx("div",{className:"text-sm text-slate-600",children:t.customerPhone})]}),u.jsxs("div",{className:"bg-terracotta/10 rounded-lg p-4",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Total Price"}),u.jsxs("div",{className:"text-2xl font-bold text-terracotta",children:["$",(t.bookedPrice??(e==null?void 0:e.price)??0).toFixed(2)]})]}),t.notes&&u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"Notes"}),u.jsx("div",{className:"text-sm text-slate-700 bg-slate-50 rounded-lg p-3",children:t.notes})]}),u.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[r&&u.jsx("button",{onClick:r,className:"flex-1 border border-terracotta text-terracotta rounded-lg px-4 py-2 hover:bg-terracotta/10 transition-colors",children:"Edit Appointment"}),u.jsx("button",{onClick:d,className:"flex-1 bg-terracotta text-white rounded-lg px-4 py-2 hover:bg-terracotta/90 transition-colors",children:"View on Schedule"}),t.status==="confirmed"&&u.jsx("button",{onClick:l,disabled:o,className:"flex-1 border border-red-300 text-red-600 rounded-lg px-4 py-2 hover:bg-red-50 transition-colors disabled:opacity-50",children:o?"Cancelling...":"Cancel"})]})]})]})})}function K1({appointment:t,service:e,onClose:n,onUpdated:r}){const{db:s}=Xe(),[i,o]=_.useState(!1),[a,l]=_.useState([]),[d,h]=_.useState([]),[m,p]=_.useState([]),[x,v]=_.useState(""),[C,A]=_.useState(""),[T,y]=_.useState(""),[w,N]=_.useState(""),[j,D]=_.useState("confirmed"),[b,E]=_.useState(new Set),I=_.useMemo(()=>a.filter(H=>m.includes(H.id)),[a,m]),k=_.useMemo(()=>I.reduce((H,he)=>H+he.duration,0),[I]),R=_.useMemo(()=>I.reduce((H,he)=>H+he.price,0),[I]),O=_.useMemo(()=>{const H={};return a.forEach(he=>{const ae=he.category||"Other";H[ae]||(H[ae]=[]),H[ae].push(he)}),H},[a]),P=H=>{E(he=>{const ae=new Set(he);return ae.has(H)?ae.delete(H):ae.add(H),ae})};_.useEffect(()=>{(async()=>{const[he,ae]=await Promise.all([In(Ne(pe(s,"services"),Pe("active","==",!0))),In(pe(s,"customers"))]),U=[];he.forEach(Y=>U.push({id:Y.id,...Y.data()})),l(U);const G=[];ae.forEach(Y=>G.push({id:Y.id,...Y.data()})),h(G)})()},[s]),_.useEffect(()=>{if(t){t.serviceIds&&Array.isArray(t.serviceIds)?p(t.serviceIds):p(t.serviceId?[t.serviceId]:[]),v(t.customerId);const H=gr(t.start);A(nt(H,"yyyy-MM-dd")),y(nt(H,"HH:mm")),N(t.notes||""),D(t.status)}},[t]);const Se=async()=>{if(t){o(!0);try{const H=d.find(ae=>ae.id===x),he=new Date(`${C}T${T}`);await Gn(be(s,"appointments",t.id),{serviceIds:m,serviceId:m[0]||"",customerId:x,customerName:(H==null?void 0:H.name)||t.customerName,customerEmail:(H==null?void 0:H.email)||t.customerEmail,customerPhone:(H==null?void 0:H.phone)||t.customerPhone,start:he.toISOString(),duration:k,bookedPrice:R,notes:w||null,status:j,updatedAt:new Date().toISOString()}),r(),n()}catch(H){console.error("Failed to update appointment:",H),alert("Failed to update appointment")}finally{o(!1)}}};return t?u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:n,children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:H=>H.stopPropagation(),children:[u.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[u.jsx("h2",{className:"font-serif text-xl",children:"Edit Appointment"}),u.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Select Services ",I.length>0&&u.jsxs("span",{className:"text-terracotta",children:["(",I.length," selected)"]})]}),u.jsx("div",{className:"max-h-64 overflow-y-auto border rounded-lg bg-slate-50",children:Object.entries(O).map(([H,he])=>{const ae=b.has(H);return u.jsxs("div",{className:"border-b border-slate-200 last:border-b-0",children:[u.jsxs("button",{type:"button",onClick:()=>P(H),className:"w-full px-3 py-2 bg-slate-100 border-b border-slate-200 flex items-center justify-between hover:bg-slate-200 transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wide",children:H}),u.jsx("span",{className:"text-xs bg-slate-300 text-slate-600 px-1.5 py-0.5 rounded-full",children:he.length})]}),u.jsx("svg",{className:`w-3 h-3 text-slate-500 transition-transform ${ae?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!ae&&u.jsx("div",{className:"p-3 bg-white",children:u.jsx("div",{className:"grid gap-2",children:he.map(U=>{const G=m.includes(U.id);return u.jsx("button",{type:"button",onClick:()=>{p(G?Y=>Y.filter(se=>se!==U.id):Y=>[...Y,U.id])},className:`
                                  relative p-3 rounded-lg border-2 text-left transition-all
                                  ${G?"border-terracotta bg-terracotta/5 shadow-sm":"border-slate-200 bg-white hover:border-slate-300 hover:shadow-sm"}
                                `,children:u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"font-medium text-slate-800 mb-1",children:U.name}),u.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[u.jsxs("span",{className:"flex items-center gap-1",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),U.duration," min"]}),u.jsxs("span",{className:"flex items-center gap-1 font-medium text-slate-700",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"$",U.price.toFixed(2)]})]})]}),G&&u.jsx("div",{className:"flex-shrink-0",children:u.jsx("div",{className:"w-5 h-5 rounded-full bg-terracotta flex items-center justify-center",children:u.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})})]})},U.id)})})})]},H)})}),I.length>0&&u.jsxs("div",{className:"mt-3 p-3 bg-terracotta/10 border border-terracotta/20 rounded-lg",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Selected Services"}),u.jsx("button",{type:"button",onClick:()=>p([]),className:"text-xs text-slate-500 hover:text-red-600 transition-colors",children:"Clear All"})]}),u.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:I.map(H=>u.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white rounded-md text-xs border border-slate-200",children:[u.jsx("span",{className:"font-medium",children:H.name}),u.jsx("button",{type:"button",onClick:()=>p(he=>he.filter(ae=>ae!==H.id)),className:"ml-1 text-slate-400 hover:text-red-600 transition-colors",children:""})]},H.id))}),u.jsx("div",{className:"flex items-center justify-between pt-2 border-t border-terracotta/20",children:u.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[u.jsxs("span",{className:"text-slate-600",children:[u.jsx("span",{className:"font-medium text-slate-700",children:k})," minutes"]}),u.jsxs("span",{className:"text-slate-600",children:[u.jsxs("span",{className:"font-semibold text-terracotta text-base",children:["$",R.toFixed(2)]})," total"]})]})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Customer *"}),u.jsxs("select",{value:x,onChange:H=>v(H.target.value),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",required:!0,children:[u.jsx("option",{value:"",children:"Select a customer"}),d.map(H=>u.jsxs("option",{value:H.id,children:[H.name," ",H.email?`(${H.email})`:""]},H.id))]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Date *"}),u.jsx("input",{type:"date",value:C,onChange:H=>A(H.target.value),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Time *"}),u.jsx("input",{type:"time",value:T,onChange:H=>y(H.target.value),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Status *"}),u.jsxs("select",{value:j,onChange:H=>D(H.target.value),className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",children:[u.jsx("option",{value:"confirmed",children:"Confirmed"}),u.jsx("option",{value:"pending",children:"Pending"}),u.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),u.jsx("textarea",{value:w,onChange:H=>N(H.target.value),rows:3,className:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"Add any notes about this appointment..."})]}),u.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[u.jsx("button",{onClick:n,className:"flex-1 border border-slate-300 text-slate-700 rounded-lg px-4 py-2 hover:bg-slate-50 transition-colors",children:"Cancel"}),u.jsx("button",{onClick:Se,disabled:i||m.length===0||!x||!C||!T,className:"flex-1 bg-terracotta text-white rounded-lg px-4 py-2 hover:bg-terracotta/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Saving...":"Save Changes"})]})]})]})}):null}function c6(){const[t,e]=_.useState("day"),[n,r]=_.useState(null),[s,i]=_.useState({}),[o,a]=_.useState([]),[l,d]=_.useState(null),[h,m]=_.useState(null),{db:p}=Xe();_.useEffect(()=>{const b=pe(p,"settings");return Qe(b,E=>{const I=E.docs.find(k=>k.id==="analyticsTargets");I!=null&&I.exists()&&r(I.data())})},[]),_.useEffect(()=>{const b=pe(p,"services");return Qe(Ne(b),E=>{const I={};E.forEach(k=>I[k.id]={id:k.id,...k.data()}),i(I)})},[]);const{fromISO:x,toISO:v}=_.useMemo(()=>h6(t),[t]);_.useEffect(()=>{const b=pe(p,"appointments"),E=Ne(b,Pe("start",">=",x),Pe("start","<=",v),Ct("start","asc"));return Qe(E,I=>{const k=[];I.forEach(R=>k.push({id:R.id,...R.data()})),a(k)})},[x,v]);const{revenue:C,cancelledValue:A,uniqueCustomers:T,avgCustomerValue:y,expectedCogs:w,targetValue:N,progressPct:j,topServices:D}=_.useMemo(()=>{var se;const b=o.filter(Z=>Z.status==="confirmed"),E=o.filter(Z=>Z.status==="cancelled"),I=Z=>Z.reduce((K,He)=>{var B;return K+(He.bookedPrice??((B=s[He.serviceId])==null?void 0:B.price)??0)},0),k=I(b),R=I(E),O=new Set(b.map(Z=>Z.customerId)).size||0,P=O?k/O:0,Se=((n==null?void 0:n.defaultCogsRate)??0)/100,H=k*Se,he=f6(t,n,x,v),ae=he>0?Math.min(100,Math.round(k/he*100)):0,U=b.filter(Z=>H1(gr(Z.start),new Date)),G={};for(const Z of U){const K=s[Z.serviceId],He=(K==null?void 0:K.name)||"Unknown",B=Z.bookedPrice??(K==null?void 0:K.price)??0;G[se=Z.serviceId]||(G[se]={name:He,count:0,value:0}),G[Z.serviceId].count+=1,G[Z.serviceId].value+=B}const Y=Object.values(G).sort((Z,K)=>K.value-Z.value).slice(0,5);return{revenue:k,cancelledValue:R,uniqueCustomers:O,avgCustomerValue:P,expectedCogs:H,targetValue:he,progressPct:ae,topServices:Y}},[o,s,n,t,x,v]);return u.jsxs("div",{className:"grid gap-6",children:[u.jsx("div",{className:"flex flex-wrap gap-2",children:["day","week","month","year","all"].map(b=>u.jsx("button",{onClick:()=>e(b),className:`px-3 py-1.5 rounded-md border text-sm ${b===t?"bg-terracotta text-white border-terracotta":"bg-white hover:bg-cream"}`,children:d6(b)},b))}),u.jsxs("section",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsx(la,{title:"Revenue",value:$s(C),subtitle:m6(x,v)}),u.jsx(la,{title:"Target vs Actual",value:`${j}%`,subtitle:n?`Target ${$s(N)}`:"Set targets in Settings",children:u.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-terracotta",style:{width:`${j}%`}})})}),u.jsx(la,{title:"Avg customer value",value:$s(y),subtitle:`${T} unique customers`}),u.jsx(la,{title:"Cancelled value",value:$s(A),subtitle:"Excluded from revenue"}),u.jsx(la,{title:"Expected COGS",value:$s(w),subtitle:`${(n==null?void 0:n.defaultCogsRate)??0}% of revenue`,className:"sm:col-span-2 lg:col-span-1"})]}),u.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-4",children:[u.jsx("h3",{className:"font-serif text-xl mb-3",children:"Upcoming Appointments"}),o.filter(b=>b.status==="confirmed").length===0?u.jsx("div",{className:"text-slate-500 text-sm",children:"No upcoming appointments for this period."}):u.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:o.filter(b=>b.status==="confirmed").slice(0,10).map(b=>{var E,I;return u.jsxs("div",{onClick:()=>d(b),className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors cursor-pointer",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"font-medium text-sm",children:nt(gr(b.start),"MMM d, h:mm a")}),u.jsx("div",{className:"text-xs text-slate-600 truncate",children:((E=s[b.serviceId])==null?void 0:E.name)||"Service"}),b.customerName&&u.jsx("div",{className:"text-xs text-slate-500 truncate",children:b.customerName})]}),u.jsx("div",{className:"text-sm font-semibold text-terracotta",children:$s(b.bookedPrice??((I=s[b.serviceId])==null?void 0:I.price)??0)})]},b.id)})})]}),u.jsx(G1,{appointment:l,service:l?s[l.serviceId]:null,onClose:()=>d(null),onEdit:()=>{m(l),d(null)}}),u.jsx(K1,{appointment:h,service:h?s[h.serviceId]:null,onClose:()=>m(null),onUpdated:()=>{m(null)}}),u.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-4",children:[u.jsx("h3",{className:"font-serif text-xl mb-2",children:"Top services this month"}),!D.length&&u.jsx("div",{className:"text-slate-500 text-sm",children:"No data yet."}),u.jsx("ul",{className:"divide-y",children:D.map((b,E)=>u.jsxs("li",{className:"flex items-center justify-between py-2",children:[u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:b.name}),u.jsxs("div",{className:"text-xs text-slate-500",children:[b.count," bookings"]})]}),u.jsx("div",{className:"font-semibold",children:$s(b.value)})]},E))})]})]})}function la({title:t,value:e,subtitle:n,children:r,className:s=""}){return u.jsxs("div",{className:`bg-white rounded-xl shadow-soft p-4 ${s}`,children:[u.jsx("div",{className:"text-sm text-slate-500",children:t}),u.jsx("div",{className:"text-2xl font-semibold",children:e}),n&&u.jsx("div",{className:"text-xs text-slate-500 mt-1",children:n}),r&&u.jsx("div",{className:"mt-3",children:r})]})}function d6(t){return t==="day"?"Day":t==="week"?"Week":t==="month"?"Month":t==="year"?"Year":"All"}function h6(t){const e=new Date;let n,r;switch(t){case"day":n=Is(e),r=Cw(e);break;case"week":n=pi(e,{weekStartsOn:0}),r=B1(e,{weekStartsOn:0});break;case"month":n=U1(e),r=F1(e);break;case"year":n=$1(e),r=YL(e);break;case"all":default:n=Is(new Date(e.getTime()-365*24*60*60*1e3)),r=Cw(e)}return{fromISO:n.toISOString(),toISO:r.toISOString(),from:n,to:r}}function f6(t,e,n,r){if(!e)return 0;if(t==="day")return e.dailyTarget;if(t==="week")return e.weeklyTarget;if(t==="month")return e.monthlyTarget;if(t==="year")return e.monthlyTarget*12;const s=Math.max(1,QL(new Date(r),new Date(n))+1);return e.dailyTarget*s}function $s(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t||0)}function m6(t,e){const n=new Date(t),r=new Date(e);return Is(n).getTime()===Is(r).getTime()?nt(n,"PP"):`${nt(n,"PP")}  ${nt(r,"PP")}`}const p6="modulepreload",g6=function(t){return"/"+t},jw={},Dw=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=g6(l),l in jw)return;jw[l]=!0;const d=l.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":p6,d||(m.as="script"),m.crossOrigin="",m.href=l,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((p,x)=>{m.addEventListener("load",p),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};var v6=Object.defineProperty,y6=(t,e,n)=>e in t?v6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,If=(t,e,n)=>(y6(t,typeof e!="symbol"?e+"":e,n),n);let _6=class{constructor(){If(this,"current",this.detect()),If(this,"handoffState","pending"),If(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Yn=new _6;function ql(t){var e;return Yn.isServer?null:t==null?document:(e=t==null?void 0:t.ownerDocument)!=null?e:document}function ip(t){var e,n;return Yn.isServer?null:t==null?document:(n=(e=t==null?void 0:t.getRootNode)==null?void 0:e.call(t))!=null?n:document}function Q1(t){var e,n;return(n=(e=ip(t))==null?void 0:e.activeElement)!=null?n:null}function w6(t){return Q1(t)===t}function ih(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function Rr(){let t=[],e={addEventListener(n,r,s,i){return n.addEventListener(r,s,i),e.add(()=>n.removeEventListener(r,s,i))},requestAnimationFrame(...n){let r=requestAnimationFrame(...n);return e.add(()=>cancelAnimationFrame(r))},nextFrame(...n){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...n))},setTimeout(...n){let r=setTimeout(...n);return e.add(()=>clearTimeout(r))},microTask(...n){let r={current:!0};return ih(()=>{r.current&&n[0]()}),e.add(()=>{r.current=!1})},style(n,r,s){let i=n.style.getPropertyValue(r);return Object.assign(n.style,{[r]:s}),this.add(()=>{Object.assign(n.style,{[r]:i})})},group(n){let r=Rr();return n(r),this.add(()=>r.dispose())},add(n){return t.includes(n)||t.push(n),()=>{let r=t.indexOf(n);if(r>=0)for(let s of t.splice(r,1))s()}},dispose(){for(let n of t.splice(0))n()}};return e}function oh(){let[t]=_.useState(Rr);return _.useEffect(()=>()=>t.dispose(),[t]),t}let Qt=(t,e)=>{Yn.isServer?_.useEffect(t,e):_.useLayoutEffect(t,e)};function Ni(t){let e=_.useRef(t);return Qt(()=>{e.current=t},[t]),e}let Te=function(t){let e=Ni(t);return ne.useCallback((...n)=>e.current(...n),[e])};function Gl(t){return _.useMemo(()=>t,Object.values(t))}let x6=_.createContext(void 0);function E6(){return _.useContext(x6)}function op(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function Cr(t,e,...n){if(t in e){let s=e[t];return typeof s=="function"?s(...n):s}let r=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Cr),r}var od=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(od||{}),ns=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(ns||{});function wn(){let t=b6();return _.useCallback(e=>T6({mergeRefs:t,...e}),[t])}function T6({ourProps:t,theirProps:e,slot:n,defaultTag:r,features:s,visible:i=!0,name:o,mergeRefs:a}){a=a??S6;let l=Y1(e,t);if(i)return Lu(l,n,r,o,a);let d=s??0;if(d&2){let{static:h=!1,...m}=l;if(h)return Lu(m,n,r,o,a)}if(d&1){let{unmount:h=!0,...m}=l;return Cr(h?0:1,{0(){return null},1(){return Lu({...m,hidden:!0,style:{display:"none"}},n,r,o,a)}})}return Lu(l,n,r,o,a)}function Lu(t,e={},n,r,s){let{as:i=n,children:o,refName:a="ref",...l}=Nf(t,["unmount","static"]),d=t.ref!==void 0?{[a]:t.ref}:{},h=typeof o=="function"?o(e):o;"className"in l&&l.className&&typeof l.className=="function"&&(l.className=l.className(e)),l["aria-labelledby"]&&l["aria-labelledby"]===l.id&&(l["aria-labelledby"]=void 0);let m={};if(e){let p=!1,x=[];for(let[v,C]of Object.entries(e))typeof C=="boolean"&&(p=!0),C===!0&&x.push(v.replace(/([A-Z])/g,A=>`-${A.toLowerCase()}`));if(p){m["data-headlessui-state"]=x.join(" ");for(let v of x)m[`data-${v}`]=""}}if(Ua(i)&&(Object.keys(qs(l)).length>0||Object.keys(qs(m)).length>0))if(!_.isValidElement(h)||Array.isArray(h)&&h.length>1||N6(h)){if(Object.keys(qs(l)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(qs(l)).concat(Object.keys(qs(m))).map(p=>`  - ${p}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(p=>`  - ${p}`).join(`
`)].join(`
`))}else{let p=h.props,x=p==null?void 0:p.className,v=typeof x=="function"?(...T)=>op(x(...T),l.className):op(x,l.className),C=v?{className:v}:{},A=Y1(h.props,qs(Nf(l,["ref"])));for(let T in m)T in A&&delete m[T];return _.cloneElement(h,Object.assign({},A,m,d,{ref:s(I6(h),d.ref)},C))}return _.createElement(i,Object.assign({},Nf(l,["ref"]),!Ua(i)&&d,!Ua(i)&&m),h)}function b6(){let t=_.useRef([]),e=_.useCallback(n=>{for(let r of t.current)r!=null&&(typeof r=="function"?r(n):r.current=n)},[]);return(...n)=>{if(!n.every(r=>r==null))return t.current=n,e}}function S6(...t){return t.every(e=>e==null)?void 0:e=>{for(let n of t)n!=null&&(typeof n=="function"?n(e):n.current=e)}}function Y1(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},n={};for(let r of t)for(let s in r)s.startsWith("on")&&typeof r[s]=="function"?(n[s]!=null||(n[s]=[]),n[s].push(r[s])):e[s]=r[s];if(e.disabled||e["aria-disabled"])for(let r in n)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(r)&&(n[r]=[s=>{var i;return(i=s==null?void 0:s.preventDefault)==null?void 0:i.call(s)}]);for(let r in n)Object.assign(e,{[r](s,...i){let o=n[r];for(let a of o){if((s instanceof Event||(s==null?void 0:s.nativeEvent)instanceof Event)&&s.defaultPrevented)return;a(s,...i)}}});return e}function Yt(t){var e;return Object.assign(_.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function qs(t){let e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function Nf(t,e=[]){let n=Object.assign({},t);for(let r of e)r in n&&delete n[r];return n}function I6(t){return ne.version.split(".")[0]>="19"?t.props.ref:t.ref}function Ua(t){return t===_.Fragment||t===Symbol.for("react.fragment")}function N6(t){return Ua(t.type)}let C6="span";var ad=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(ad||{});function k6(t,e){var n;let{features:r=1,...s}=t,i={ref:e,"aria-hidden":(r&2)===2?!0:(n=s["aria-hidden"])!=null?n:void 0,hidden:(r&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(r&4)===4&&(r&2)!==2&&{display:"none"}}};return wn()({ourProps:i,theirProps:s,slot:{},defaultTag:C6,name:"Hidden"})}let ap=Yt(k6);function A6(t){return typeof t!="object"||t===null?!1:"nodeType"in t}function vs(t){return A6(t)&&"tagName"in t}function gi(t){return vs(t)&&"accessKey"in t}function rs(t){return vs(t)&&"tabIndex"in t}function P6(t){return vs(t)&&"style"in t}function R6(t){return gi(t)&&t.nodeName==="IFRAME"}function j6(t){return gi(t)&&t.nodeName==="INPUT"}let X1=Symbol();function D6(t,e=!0){return Object.assign(t,{[X1]:e})}function er(...t){let e=_.useRef(t);_.useEffect(()=>{e.current=t},[t]);let n=Te(r=>{for(let s of e.current)s!=null&&(typeof s=="function"?s(r):s.current=r)});return t.every(r=>r==null||(r==null?void 0:r[X1]))?void 0:n}let uv=_.createContext(null);uv.displayName="DescriptionContext";function J1(){let t=_.useContext(uv);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,J1),e}return t}function O6(){let[t,e]=_.useState([]);return[t.length>0?t.join(" "):void 0,_.useMemo(()=>function(n){let r=Te(i=>(e(o=>[...o,i]),()=>e(o=>{let a=o.slice(),l=a.indexOf(i);return l!==-1&&a.splice(l,1),a}))),s=_.useMemo(()=>({register:r,slot:n.slot,name:n.name,props:n.props,value:n.value}),[r,n.slot,n.name,n.props,n.value]);return ne.createElement(uv.Provider,{value:s},n.children)},[e])]}let M6="p";function L6(t,e){let n=_.useId(),r=E6(),{id:s=`headlessui-description-${n}`,...i}=t,o=J1(),a=er(e);Qt(()=>o.register(s),[s,o.register]);let l=Gl({...o.slot,disabled:r||!1}),d={ref:a,...o.props,id:s};return wn()({ourProps:d,theirProps:i,slot:l,defaultTag:M6,name:o.name||"Description"})}let V6=Yt(L6),F6=Object.assign(V6,{});var Z1=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(Z1||{});let U6=_.createContext(()=>{});function $6({value:t,children:e}){return ne.createElement(U6.Provider,{value:t},e)}let eI=class extends Map{constructor(e){super(),this.factory=e}get(e){let n=super.get(e);return n===void 0&&(n=this.factory(e),this.set(e,n)),n}};var B6=Object.defineProperty,z6=(t,e,n)=>e in t?B6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,W6=(t,e,n)=>(z6(t,e+"",n),n),tI=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},hn=(t,e,n)=>(tI(t,e,"read from private field"),n?n.call(t):e.get(t)),Cf=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Ow=(t,e,n,r)=>(tI(t,e,"write to private field"),e.set(t,n),n),Fn,wa,xa;let H6=class{constructor(e){Cf(this,Fn,{}),Cf(this,wa,new eI(()=>new Set)),Cf(this,xa,new Set),W6(this,"disposables",Rr()),Ow(this,Fn,e),Yn.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return hn(this,Fn)}subscribe(e,n){if(Yn.isServer)return()=>{};let r={selector:e,callback:n,current:e(hn(this,Fn))};return hn(this,xa).add(r),this.disposables.add(()=>{hn(this,xa).delete(r)})}on(e,n){return Yn.isServer?()=>{}:(hn(this,wa).get(e).add(n),this.disposables.add(()=>{hn(this,wa).get(e).delete(n)}))}send(e){let n=this.reduce(hn(this,Fn),e);if(n!==hn(this,Fn)){Ow(this,Fn,n);for(let r of hn(this,xa)){let s=r.selector(hn(this,Fn));nI(r.current,s)||(r.current=s,r.callback(s))}for(let r of hn(this,wa).get(e.type))r(hn(this,Fn),e)}}};Fn=new WeakMap,wa=new WeakMap,xa=new WeakMap;function nI(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:Array.isArray(t)&&Array.isArray(e)?t.length!==e.length?!1:kf(t[Symbol.iterator](),e[Symbol.iterator]()):t instanceof Map&&e instanceof Map||t instanceof Set&&e instanceof Set?t.size!==e.size?!1:kf(t.entries(),e.entries()):Mw(t)&&Mw(e)?kf(Object.entries(t)[Symbol.iterator](),Object.entries(e)[Symbol.iterator]()):!1}function kf(t,e){do{let n=t.next(),r=e.next();if(n.done&&r.done)return!0;if(n.done||r.done||!Object.is(n.value,r.value))return!1}while(!0)}function Mw(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}var q6=Object.defineProperty,G6=(t,e,n)=>e in t?q6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Lw=(t,e,n)=>(G6(t,typeof e!="symbol"?e+"":e,n),n),K6=(t=>(t[t.Push=0]="Push",t[t.Pop=1]="Pop",t))(K6||{});let Q6={0(t,e){let n=e.id,r=t.stack,s=t.stack.indexOf(n);if(s!==-1){let i=t.stack.slice();return i.splice(s,1),i.push(n),r=i,{...t,stack:r}}return{...t,stack:[...t.stack,n]}},1(t,e){let n=e.id,r=t.stack.indexOf(n);if(r===-1)return t;let s=t.stack.slice();return s.splice(r,1),{...t,stack:s}}},Y6=class rI extends H6{constructor(){super(...arguments),Lw(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),Lw(this,"selectors",{isTop:(e,n)=>e.stack[e.stack.length-1]===n,inStack:(e,n)=>e.stack.includes(n)})}static new(){return new rI({stack:[]})}reduce(e,n){return Cr(n.type,Q6,e,n)}};const sI=new eI(()=>Y6.new());var iI={exports:{}},oI={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kl=_;function X6(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var J6=typeof Object.is=="function"?Object.is:X6,Z6=Kl.useSyncExternalStore,e3=Kl.useRef,t3=Kl.useEffect,n3=Kl.useMemo,r3=Kl.useDebugValue;oI.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=e3(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=n3(function(){function l(x){if(!d){if(d=!0,h=x,x=r(x),s!==void 0&&o.hasValue){var v=o.value;if(s(v,x))return m=v}return m=x}if(v=m,J6(h,x))return v;var C=r(x);return s!==void 0&&s(v,C)?(h=x,v):(h=x,m=C)}var d=!1,h,m,p=n===void 0?null:n;return[function(){return l(e())},p===null?void 0:function(){return l(p())}]},[e,n,r,s]);var a=Z6(t,i[0],i[1]);return t3(function(){o.hasValue=!0,o.value=a},[a]),r3(a),a};iI.exports=oI;var s3=iI.exports;function aI(t,e,n=nI){return s3.useSyncExternalStoreWithSelector(Te(r=>t.subscribe(i3,r)),Te(()=>t.state),Te(()=>t.state),Te(e),n)}function i3(t){return t}function Ql(t,e){let n=_.useId(),r=sI.get(e),[s,i]=aI(r,_.useCallback(o=>[r.selectors.isTop(o,n),r.selectors.inStack(o,n)],[r,n]));return Qt(()=>{if(t)return r.actions.push(n),()=>r.actions.pop(n)},[r,t,n]),t?i?s:!0:!1}let lp=new Map,$a=new Map;function Vw(t){var e;let n=(e=$a.get(t))!=null?e:0;return $a.set(t,n+1),n!==0?()=>Fw(t):(lp.set(t,{"aria-hidden":t.getAttribute("aria-hidden"),inert:t.inert}),t.setAttribute("aria-hidden","true"),t.inert=!0,()=>Fw(t))}function Fw(t){var e;let n=(e=$a.get(t))!=null?e:1;if(n===1?$a.delete(t):$a.set(t,n-1),n!==1)return;let r=lp.get(t);r&&(r["aria-hidden"]===null?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",r["aria-hidden"]),t.inert=r.inert,lp.delete(t))}function o3(t,{allowed:e,disallowed:n}={}){let r=Ql(t,"inert-others");Qt(()=>{var s,i;if(!r)return;let o=Rr();for(let l of(s=n==null?void 0:n())!=null?s:[])l&&o.add(Vw(l));let a=(i=e==null?void 0:e())!=null?i:[];for(let l of a){if(!l)continue;let d=ql(l);if(!d)continue;let h=l.parentElement;for(;h&&h!==d.body;){for(let m of h.children)a.some(p=>m.contains(p))||o.add(Vw(m));h=h.parentElement}}return o.dispose},[r,e,n])}function a3(t,e,n){let r=Ni(s=>{let i=s.getBoundingClientRect();i.x===0&&i.y===0&&i.width===0&&i.height===0&&n()});_.useEffect(()=>{if(!t)return;let s=e===null?null:gi(e)?e:e.current;if(!s)return;let i=Rr();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>r.current(s));o.observe(s),i.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>r.current(s));o.observe(s),i.add(()=>o.disconnect())}return()=>i.dispose()},[e,r,t])}let ld=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(","),l3=["[data-autofocus]"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var or=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t[t.AutoFocus=64]="AutoFocus",t))(or||{}),up=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(up||{}),u3=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(u3||{});function c3(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(ld)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}function d3(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(l3)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var lI=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(lI||{});function h3(t,e=0){var n;return t===((n=ql(t))==null?void 0:n.body)?!1:Cr(e,{0(){return t.matches(ld)},1(){let r=t;for(;r!==null;){if(r.matches(ld))return!0;r=r.parentElement}return!1}})}var f3=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(f3||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function vr(t){t==null||t.focus({preventScroll:!0})}let m3=["textarea","input"].join(",");function p3(t){var e,n;return(n=(e=t==null?void 0:t.matches)==null?void 0:e.call(t,m3))!=null?n:!1}function g3(t,e=n=>n){return t.slice().sort((n,r)=>{let s=e(n),i=e(r);if(s===null||i===null)return 0;let o=s.compareDocumentPosition(i);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Ba(t,e,{sorted:n=!0,relativeTo:r=null,skipElements:s=[]}={}){let i=Array.isArray(t)?t.length>0?ip(t[0]):document:ip(t),o=Array.isArray(t)?n?g3(t):t:e&64?d3(t):c3(t);s.length>0&&o.length>1&&(o=o.filter(x=>!s.some(v=>v!=null&&"current"in v?(v==null?void 0:v.current)===x:v===x))),r=r??(i==null?void 0:i.activeElement);let a=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(r))-1;if(e&4)return Math.max(0,o.indexOf(r))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=e&32?{preventScroll:!0}:{},h=0,m=o.length,p;do{if(h>=m||h+m<=0)return 0;let x=l+h;if(e&16)x=(x+m)%m;else{if(x<0)return 3;if(x>=m)return 1}p=o[x],p==null||p.focus(d),h+=a}while(p!==Q1(p));return e&6&&p3(p)&&p.select(),2}function uI(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function v3(){return/Android/gi.test(window.navigator.userAgent)}function Uw(){return uI()||v3()}function Vu(t,e,n,r){let s=Ni(n);_.useEffect(()=>{if(!t)return;function i(o){s.current(o)}return document.addEventListener(e,i,r),()=>document.removeEventListener(e,i,r)},[t,e,r])}function cI(t,e,n,r){let s=Ni(n);_.useEffect(()=>{if(!t)return;function i(o){s.current(o)}return window.addEventListener(e,i,r),()=>window.removeEventListener(e,i,r)},[t,e,r])}const $w=30;function y3(t,e,n){let r=Ni(n),s=_.useCallback(function(a,l){if(a.defaultPrevented)return;let d=l(a);if(d===null||!d.getRootNode().contains(d)||!d.isConnected)return;let h=function m(p){return typeof p=="function"?m(p()):Array.isArray(p)||p instanceof Set?p:[p]}(e);for(let m of h)if(m!==null&&(m.contains(d)||a.composed&&a.composedPath().includes(m)))return;return!h3(d,lI.Loose)&&d.tabIndex!==-1&&a.preventDefault(),r.current(a,d)},[r,e]),i=_.useRef(null);Vu(t,"pointerdown",a=>{var l,d;Uw()||(i.current=((d=(l=a.composedPath)==null?void 0:l.call(a))==null?void 0:d[0])||a.target)},!0),Vu(t,"pointerup",a=>{if(Uw()||!i.current)return;let l=i.current;return i.current=null,s(a,()=>l)},!0);let o=_.useRef({x:0,y:0});Vu(t,"touchstart",a=>{o.current.x=a.touches[0].clientX,o.current.y=a.touches[0].clientY},!0),Vu(t,"touchend",a=>{let l={x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY};if(!(Math.abs(l.x-o.current.x)>=$w||Math.abs(l.y-o.current.y)>=$w))return s(a,()=>rs(a.target)?a.target:null)},!0),cI(t,"blur",a=>s(a,()=>R6(window.document.activeElement)?window.document.activeElement:null),!0)}function cv(...t){return _.useMemo(()=>ql(...t),[...t])}function dI(t,e,n,r){let s=Ni(n);_.useEffect(()=>{t=t??window;function i(o){s.current(o)}return t.addEventListener(e,i,r),()=>t.removeEventListener(e,i,r)},[t,e,r])}function _3(t){return _.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}function w3(t,e){let n=t(),r=new Set;return{getSnapshot(){return n},subscribe(s){return r.add(s),()=>r.delete(s)},dispatch(s,...i){let o=e[s].call(n,...i);o&&(n=o,r.forEach(a=>a()))}}}function x3(){let t;return{before({doc:e}){var n;let r=e.documentElement,s=(n=e.defaultView)!=null?n:window;t=Math.max(0,s.innerWidth-r.clientWidth)},after({doc:e,d:n}){let r=e.documentElement,s=Math.max(0,r.clientWidth-r.offsetWidth),i=Math.max(0,t-s);n.style(r,"paddingRight",`${i}px`)}}}function E3(){return uI()?{before({doc:t,d:e,meta:n}){function r(s){for(let i of n().containers)for(let o of i())if(o.contains(s))return!0;return!1}e.microTask(()=>{var s;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let a=Rr();a.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>a.dispose()))}let i=(s=window.scrollY)!=null?s:window.pageYOffset,o=null;e.addEventListener(t,"click",a=>{if(rs(a.target))try{let l=a.target.closest("a");if(!l)return;let{hash:d}=new URL(l.href),h=t.querySelector(d);rs(h)&&!r(h)&&(o=h)}catch{}},!0),e.group(a=>{e.addEventListener(t,"touchstart",l=>{if(a.dispose(),rs(l.target)&&P6(l.target))if(r(l.target)){let d=l.target;for(;d.parentElement&&r(d.parentElement);)d=d.parentElement;a.style(d,"overscrollBehavior","contain")}else a.style(l.target,"touchAction","none")})}),e.addEventListener(t,"touchmove",a=>{if(rs(a.target)){if(j6(a.target))return;if(r(a.target)){let l=a.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&a.preventDefault()}else a.preventDefault()}},{passive:!1}),e.add(()=>{var a;let l=(a=window.scrollY)!=null?a:window.pageYOffset;i!==l&&window.scrollTo(0,i),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function T3(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function Bw(t){let e={};for(let n of t)Object.assign(e,n(e));return e}let ei=w3(()=>new Map,{PUSH(t,e){var n;let r=(n=this.get(t))!=null?n:{doc:t,count:0,d:Rr(),meta:new Set,computedMeta:{}};return r.count++,r.meta.add(e),r.computedMeta=Bw(r.meta),this.set(t,r),this},POP(t,e){let n=this.get(t);return n&&(n.count--,n.meta.delete(e),n.computedMeta=Bw(n.meta)),this},SCROLL_PREVENT(t){let e={doc:t.doc,d:t.d,meta(){return t.computedMeta}},n=[E3(),x3(),T3()];n.forEach(({before:r})=>r==null?void 0:r(e)),n.forEach(({after:r})=>r==null?void 0:r(e))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});ei.subscribe(()=>{let t=ei.getSnapshot(),e=new Map;for(let[n]of t)e.set(n,n.documentElement.style.overflow);for(let n of t.values()){let r=e.get(n.doc)==="hidden",s=n.count!==0;(s&&!r||!s&&r)&&ei.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&ei.dispatch("TEARDOWN",n)}});function b3(t,e,n=()=>({containers:[]})){let r=_3(ei),s=e?r.get(e):void 0,i=s?s.count>0:!1;return Qt(()=>{if(!(!e||!t))return ei.dispatch("PUSH",e,n),()=>ei.dispatch("POP",e,n)},[t,e]),i}function S3(t,e,n=()=>[document.body]){let r=Ql(t,"scroll-lock");b3(r,e,s=>{var i;return{containers:[...(i=s.containers)!=null?i:[],n]}})}function I3(t=0){let[e,n]=_.useState(t),r=_.useCallback(l=>n(l),[]),s=_.useCallback(l=>n(d=>d|l),[]),i=_.useCallback(l=>(e&l)===l,[e]),o=_.useCallback(l=>n(d=>d&~l),[]),a=_.useCallback(l=>n(d=>d^l),[]);return{flags:e,setFlag:r,addFlag:s,hasFlag:i,removeFlag:o,toggleFlag:a}}var N3={},zw,Ww;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((zw=process==null?void 0:N3)==null?void 0:zw.NODE_ENV)==="test"&&typeof((Ww=Element==null?void 0:Element.prototype)==null?void 0:Ww.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var C3=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(C3||{});function k3(t){let e={};for(let n in t)t[n]===!0&&(e[`data-${n}`]="");return e}function A3(t,e,n,r){let[s,i]=_.useState(n),{hasFlag:o,addFlag:a,removeFlag:l}=I3(t&&s?3:0),d=_.useRef(!1),h=_.useRef(!1),m=oh();return Qt(()=>{var p;if(t){if(n&&i(!0),!e){n&&a(3);return}return(p=r==null?void 0:r.start)==null||p.call(r,n),P3(e,{inFlight:d,prepare(){h.current?h.current=!1:h.current=d.current,d.current=!0,!h.current&&(n?(a(3),l(4)):(a(4),l(2)))},run(){h.current?n?(l(3),a(4)):(l(4),a(3)):n?l(1):a(1)},done(){var x;h.current&&D3(e)||(d.current=!1,l(7),n||i(!1),(x=r==null?void 0:r.end)==null||x.call(r,n))}})}},[t,n,e,m]),t?[s,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function P3(t,{prepare:e,run:n,done:r,inFlight:s}){let i=Rr();return j3(t,{prepare:e,inFlight:s}),i.nextFrame(()=>{n(),i.requestAnimationFrame(()=>{i.add(R3(t,r))})}),i.dispose}function R3(t,e){var n,r;let s=Rr();if(!t)return s.dispose;let i=!1;s.add(()=>{i=!0});let o=(r=(n=t.getAnimations)==null?void 0:n.call(t).filter(a=>a instanceof CSSTransition))!=null?r:[];return o.length===0?(e(),s.dispose):(Promise.allSettled(o.map(a=>a.finished)).then(()=>{i||e()}),s.dispose)}function j3(t,{inFlight:e,prepare:n}){if(e!=null&&e.current){n();return}let r=t.style.transition;t.style.transition="none",n(),t.offsetHeight,t.style.transition=r}function D3(t){var e,n;return((n=(e=t.getAnimations)==null?void 0:e.call(t))!=null?n:[]).some(r=>r instanceof CSSTransition&&r.playState!=="finished")}function dv(t,e){let n=_.useRef([]),r=Te(t);_.useEffect(()=>{let s=[...n.current];for(let[i,o]of e.entries())if(n.current[i]!==o){let a=r(e,s);return n.current=e,a}},[r,...e])}let ah=_.createContext(null);ah.displayName="OpenClosedContext";var Cn=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(Cn||{});function lh(){return _.useContext(ah)}function O3({value:t,children:e}){return ne.createElement(ah.Provider,{value:t},e)}function M3({children:t}){return ne.createElement(ah.Provider,{value:null},t)}function L3(t){function e(){document.readyState!=="loading"&&(t(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let Yr=[];L3(()=>{function t(e){if(!rs(e.target)||e.target===document.body||Yr[0]===e.target)return;let n=e.target;n=n.closest(ld),Yr.unshift(n??e.target),Yr=Yr.filter(r=>r!=null&&r.isConnected),Yr.splice(10)}window.addEventListener("click",t,{capture:!0}),window.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("focus",t,{capture:!0}),document.body.addEventListener("click",t,{capture:!0}),document.body.addEventListener("mousedown",t,{capture:!0}),document.body.addEventListener("focus",t,{capture:!0})});function hI(t){let e=Te(t),n=_.useRef(!1);_.useEffect(()=>(n.current=!1,()=>{n.current=!0,ih(()=>{n.current&&e()})}),[e])}let fI=_.createContext(!1);function V3(){return _.useContext(fI)}function Hw(t){return ne.createElement(fI.Provider,{value:t.force},t.children)}function F3(t){let e=V3(),n=_.useContext(pI),[r,s]=_.useState(()=>{var i;if(!e&&n!==null)return(i=n.current)!=null?i:null;if(Yn.isServer)return null;let o=t==null?void 0:t.getElementById("headlessui-portal-root");if(o)return o;if(t===null)return null;let a=t.createElement("div");return a.setAttribute("id","headlessui-portal-root"),t.body.appendChild(a)});return _.useEffect(()=>{r!==null&&(t!=null&&t.body.contains(r)||t==null||t.body.appendChild(r))},[r,t]),_.useEffect(()=>{e||n!==null&&s(n.current)},[n,s,e]),r}let mI=_.Fragment,U3=Yt(function(t,e){let{ownerDocument:n=null,...r}=t,s=_.useRef(null),i=er(D6(p=>{s.current=p}),e),o=cv(s.current),a=n??o,l=F3(a),d=_.useContext(cp),h=oh(),m=wn();return hI(()=>{var p;l&&l.childNodes.length<=0&&((p=l.parentElement)==null||p.removeChild(l))}),l?vT.createPortal(ne.createElement("div",{"data-headlessui-portal":"",ref:p=>{h.dispose(),d&&p&&h.add(d.register(p))}},m({ourProps:{ref:i},theirProps:r,slot:{},defaultTag:mI,name:"Portal"})),l):null});function $3(t,e){let n=er(e),{enabled:r=!0,ownerDocument:s,...i}=t,o=wn();return r?ne.createElement(U3,{...i,ownerDocument:s,ref:n}):o({ourProps:{ref:n},theirProps:i,slot:{},defaultTag:mI,name:"Portal"})}let B3=_.Fragment,pI=_.createContext(null);function z3(t,e){let{target:n,...r}=t,s={ref:er(e)},i=wn();return ne.createElement(pI.Provider,{value:n},i({ourProps:s,theirProps:r,defaultTag:B3,name:"Popover.Group"}))}let cp=_.createContext(null);function W3(){let t=_.useContext(cp),e=_.useRef([]),n=Te(i=>(e.current.push(i),t&&t.register(i),()=>r(i))),r=Te(i=>{let o=e.current.indexOf(i);o!==-1&&e.current.splice(o,1),t&&t.unregister(i)}),s=_.useMemo(()=>({register:n,unregister:r,portals:e}),[n,r,e]);return[e,_.useMemo(()=>function({children:i}){return ne.createElement(cp.Provider,{value:s},i)},[s])]}let H3=Yt($3),gI=Yt(z3),q3=Object.assign(H3,{Group:gI});function G3(t,e=typeof document<"u"?document.defaultView:null,n){let r=Ql(t,"escape");dI(e,"keydown",s=>{r&&(s.defaultPrevented||s.key===Z1.Escape&&n(s))})}function K3(){var t;let[e]=_.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[n,r]=_.useState((t=e==null?void 0:e.matches)!=null?t:!1);return Qt(()=>{if(!e)return;function s(i){r(i.matches)}return e.addEventListener("change",s),()=>e.removeEventListener("change",s)},[e]),n}function Q3({defaultContainers:t=[],portals:e,mainTreeNode:n}={}){let r=Te(()=>{var s,i;let o=ql(n),a=[];for(let l of t)l!==null&&(vs(l)?a.push(l):"current"in l&&vs(l.current)&&a.push(l.current));if(e!=null&&e.current)for(let l of e.current)a.push(l);for(let l of(s=o==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?s:[])l!==document.body&&l!==document.head&&vs(l)&&l.id!=="headlessui-portal-root"&&(n&&(l.contains(n)||l.contains((i=n==null?void 0:n.getRootNode())==null?void 0:i.host))||a.some(d=>l.contains(d))||a.push(l));return a});return{resolveContainers:r,contains:Te(s=>r().some(i=>i.contains(s)))}}let vI=_.createContext(null);function qw({children:t,node:e}){let[n,r]=_.useState(null),s=yI(e??n);return ne.createElement(vI.Provider,{value:s},t,s===null&&ne.createElement(ap,{features:ad.Hidden,ref:i=>{var o,a;if(i){for(let l of(a=(o=ql(i))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?a:[])if(l!==document.body&&l!==document.head&&vs(l)&&l!=null&&l.contains(i)){r(l);break}}}}))}function yI(t=null){var e;return(e=_.useContext(vI))!=null?e:t}function Y3(){let t=typeof document>"u";return"useSyncExternalStore"in Df?(e=>e.useSyncExternalStore)(Df)(()=>()=>{},()=>!1,()=>!t):!1}function uh(){let t=Y3(),[e,n]=_.useState(Yn.isHandoffComplete);return e&&Yn.isHandoffComplete===!1&&n(!1),_.useEffect(()=>{e!==!0&&n(!0)},[e]),_.useEffect(()=>Yn.handoff(),[]),t?!1:e}function hv(){let t=_.useRef(!1);return Qt(()=>(t.current=!0,()=>{t.current=!1}),[]),t}var Ea=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(Ea||{});function X3(){let t=_.useRef(0);return cI(!0,"keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function _I(t){if(!t)return new Set;if(typeof t=="function")return new Set(t());let e=new Set;for(let n of t.current)vs(n.current)&&e.add(n.current);return e}let J3="div";var Gs=(t=>(t[t.None=0]="None",t[t.InitialFocus=1]="InitialFocus",t[t.TabLock=2]="TabLock",t[t.FocusLock=4]="FocusLock",t[t.RestoreFocus=8]="RestoreFocus",t[t.AutoFocus=16]="AutoFocus",t))(Gs||{});function Z3(t,e){let n=_.useRef(null),r=er(n,e),{initialFocus:s,initialFocusFallback:i,containers:o,features:a=15,...l}=t;uh()||(a=0);let d=cv(n.current);rF(a,{ownerDocument:d});let h=sF(a,{ownerDocument:d,container:n,initialFocus:s,initialFocusFallback:i});iF(a,{ownerDocument:d,container:n,containers:o,previousActiveElement:h});let m=X3(),p=Te(y=>{if(!gi(n.current))return;let w=n.current;(N=>N())(()=>{Cr(m.current,{[Ea.Forwards]:()=>{Ba(w,or.First,{skipElements:[y.relatedTarget,i]})},[Ea.Backwards]:()=>{Ba(w,or.Last,{skipElements:[y.relatedTarget,i]})}})})}),x=Ql(!!(a&2),"focus-trap#tab-lock"),v=oh(),C=_.useRef(!1),A={ref:r,onKeyDown(y){y.key=="Tab"&&(C.current=!0,v.requestAnimationFrame(()=>{C.current=!1}))},onBlur(y){if(!(a&4))return;let w=_I(o);gi(n.current)&&w.add(n.current);let N=y.relatedTarget;rs(N)&&N.dataset.headlessuiFocusGuard!=="true"&&(wI(w,N)||(C.current?Ba(n.current,Cr(m.current,{[Ea.Forwards]:()=>or.Next,[Ea.Backwards]:()=>or.Previous})|or.WrapAround,{relativeTo:y.target}):rs(y.target)&&vr(y.target)))}},T=wn();return ne.createElement(ne.Fragment,null,x&&ne.createElement(ap,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:p,features:ad.Focusable}),T({ourProps:A,theirProps:l,defaultTag:J3,name:"FocusTrap"}),x&&ne.createElement(ap,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:p,features:ad.Focusable}))}let eF=Yt(Z3),tF=Object.assign(eF,{features:Gs});function nF(t=!0){let e=_.useRef(Yr.slice());return dv(([n],[r])=>{r===!0&&n===!1&&ih(()=>{e.current.splice(0)}),r===!1&&n===!0&&(e.current=Yr.slice())},[t,Yr,e]),Te(()=>{var n;return(n=e.current.find(r=>r!=null&&r.isConnected))!=null?n:null})}function rF(t,{ownerDocument:e}){let n=!!(t&8),r=nF(n);dv(()=>{n||w6(e==null?void 0:e.body)&&vr(r())},[n]),hI(()=>{n&&vr(r())})}function sF(t,{ownerDocument:e,container:n,initialFocus:r,initialFocusFallback:s}){let i=_.useRef(null),o=Ql(!!(t&1),"focus-trap#initial-focus"),a=hv();return dv(()=>{if(t===0)return;if(!o){s!=null&&s.current&&vr(s.current);return}let l=n.current;l&&ih(()=>{if(!a.current)return;let d=e==null?void 0:e.activeElement;if(r!=null&&r.current){if((r==null?void 0:r.current)===d){i.current=d;return}}else if(l.contains(d)){i.current=d;return}if(r!=null&&r.current)vr(r.current);else{if(t&16){if(Ba(l,or.First|or.AutoFocus)!==up.Error)return}else if(Ba(l,or.First)!==up.Error)return;if(s!=null&&s.current&&(vr(s.current),(e==null?void 0:e.activeElement)===s.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}i.current=e==null?void 0:e.activeElement})},[s,o,t]),i}function iF(t,{ownerDocument:e,container:n,containers:r,previousActiveElement:s}){let i=hv(),o=!!(t&4);dI(e==null?void 0:e.defaultView,"focus",a=>{if(!o||!i.current)return;let l=_I(r);gi(n.current)&&l.add(n.current);let d=s.current;if(!d)return;let h=a.target;gi(h)?wI(l,h)?(s.current=h,vr(h)):(a.preventDefault(),a.stopPropagation(),vr(d)):vr(s.current)},!0)}function wI(t,e){for(let n of t)if(n.contains(e))return!0;return!1}function xI(t){var e;return!!(t.enter||t.enterFrom||t.enterTo||t.leave||t.leaveFrom||t.leaveTo)||!Ua((e=t.as)!=null?e:TI)||ne.Children.count(t.children)===1}let ch=_.createContext(null);ch.displayName="TransitionContext";var oF=(t=>(t.Visible="visible",t.Hidden="hidden",t))(oF||{});function aF(){let t=_.useContext(ch);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function lF(){let t=_.useContext(dh);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let dh=_.createContext(null);dh.displayName="NestingContext";function hh(t){return"children"in t?hh(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function EI(t,e){let n=Ni(t),r=_.useRef([]),s=hv(),i=oh(),o=Te((x,v=ns.Hidden)=>{let C=r.current.findIndex(({el:A})=>A===x);C!==-1&&(Cr(v,{[ns.Unmount](){r.current.splice(C,1)},[ns.Hidden](){r.current[C].state="hidden"}}),i.microTask(()=>{var A;!hh(r)&&s.current&&((A=n.current)==null||A.call(n))}))}),a=Te(x=>{let v=r.current.find(({el:C})=>C===x);return v?v.state!=="visible"&&(v.state="visible"):r.current.push({el:x,state:"visible"}),()=>o(x,ns.Unmount)}),l=_.useRef([]),d=_.useRef(Promise.resolve()),h=_.useRef({enter:[],leave:[]}),m=Te((x,v,C)=>{l.current.splice(0),e&&(e.chains.current[v]=e.chains.current[v].filter(([A])=>A!==x)),e==null||e.chains.current[v].push([x,new Promise(A=>{l.current.push(A)})]),e==null||e.chains.current[v].push([x,new Promise(A=>{Promise.all(h.current[v].map(([T,y])=>y)).then(()=>A())})]),v==="enter"?d.current=d.current.then(()=>e==null?void 0:e.wait.current).then(()=>C(v)):C(v)}),p=Te((x,v,C)=>{Promise.all(h.current[v].splice(0).map(([A,T])=>T)).then(()=>{var A;(A=l.current.shift())==null||A()}).then(()=>C(v))});return _.useMemo(()=>({children:r,register:a,unregister:o,onStart:m,onStop:p,wait:d,chains:h}),[a,o,r,m,p,h,d])}let TI=_.Fragment,bI=od.RenderStrategy;function uF(t,e){var n,r;let{transition:s=!0,beforeEnter:i,afterEnter:o,beforeLeave:a,afterLeave:l,enter:d,enterFrom:h,enterTo:m,entered:p,leave:x,leaveFrom:v,leaveTo:C,...A}=t,[T,y]=_.useState(null),w=_.useRef(null),N=xI(t),j=er(...N?[w,e,y]:e===null?[]:[e]),D=(n=A.unmount)==null||n?ns.Unmount:ns.Hidden,{show:b,appear:E,initial:I}=aF(),[k,R]=_.useState(b?"visible":"hidden"),O=lF(),{register:P,unregister:Se}=O;Qt(()=>P(w),[P,w]),Qt(()=>{if(D===ns.Hidden&&w.current){if(b&&k!=="visible"){R("visible");return}return Cr(k,{hidden:()=>Se(w),visible:()=>P(w)})}},[k,w,P,Se,b,D]);let H=uh();Qt(()=>{if(N&&H&&k==="visible"&&w.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[w,k,H,N]);let he=I&&!E,ae=E&&b&&I,U=_.useRef(!1),G=EI(()=>{U.current||(R("hidden"),Se(w))},O),Y=Te(le=>{U.current=!0;let De=le?"enter":"leave";G.onStart(w,De,at=>{at==="enter"?i==null||i():at==="leave"&&(a==null||a())})}),se=Te(le=>{let De=le?"enter":"leave";U.current=!1,G.onStop(w,De,at=>{at==="enter"?o==null||o():at==="leave"&&(l==null||l())}),De==="leave"&&!hh(G)&&(R("hidden"),Se(w))});_.useEffect(()=>{N&&s||(Y(b),se(b))},[b,N,s]);let Z=!(!s||!N||!H||he),[,K]=A3(Z,T,b,{start:Y,end:se}),He=qs({ref:j,className:((r=op(A.className,ae&&d,ae&&h,K.enter&&d,K.enter&&K.closed&&h,K.enter&&!K.closed&&m,K.leave&&x,K.leave&&!K.closed&&v,K.leave&&K.closed&&C,!K.transition&&b&&p))==null?void 0:r.trim())||void 0,...k3(K)}),B=0;k==="visible"&&(B|=Cn.Open),k==="hidden"&&(B|=Cn.Closed),b&&k==="hidden"&&(B|=Cn.Opening),!b&&k==="visible"&&(B|=Cn.Closing);let ie=wn();return ne.createElement(dh.Provider,{value:G},ne.createElement(O3,{value:B},ie({ourProps:He,theirProps:A,defaultTag:TI,features:bI,visible:k==="visible",name:"Transition.Child"})))}function cF(t,e){let{show:n,appear:r=!1,unmount:s=!0,...i}=t,o=_.useRef(null),a=xI(t),l=er(...a?[o,e]:e===null?[]:[e]);uh();let d=lh();if(n===void 0&&d!==null&&(n=(d&Cn.Open)===Cn.Open),n===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[h,m]=_.useState(n?"visible":"hidden"),p=EI(()=>{n||m("hidden")}),[x,v]=_.useState(!0),C=_.useRef([n]);Qt(()=>{x!==!1&&C.current[C.current.length-1]!==n&&(C.current.push(n),v(!1))},[C,n]);let A=_.useMemo(()=>({show:n,appear:r,initial:x}),[n,r,x]);Qt(()=>{n?m("visible"):!hh(p)&&o.current!==null&&m("hidden")},[n,p]);let T={unmount:s},y=Te(()=>{var j;x&&v(!1),(j=t.beforeEnter)==null||j.call(t)}),w=Te(()=>{var j;x&&v(!1),(j=t.beforeLeave)==null||j.call(t)}),N=wn();return ne.createElement(dh.Provider,{value:p},ne.createElement(ch.Provider,{value:A},N({ourProps:{...T,as:_.Fragment,children:ne.createElement(SI,{ref:l,...T,...i,beforeEnter:y,beforeLeave:w})},theirProps:{},defaultTag:_.Fragment,features:bI,visible:h==="visible",name:"Transition"})))}function dF(t,e){let n=_.useContext(ch)!==null,r=lh()!==null;return ne.createElement(ne.Fragment,null,!n&&r?ne.createElement(dp,{ref:e,...t}):ne.createElement(SI,{ref:e,...t}))}let dp=Yt(cF),SI=Yt(uF),fv=Yt(dF),uc=Object.assign(dp,{Child:fv,Root:dp});var hF=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(hF||{}),fF=(t=>(t[t.SetTitleId=0]="SetTitleId",t))(fF||{});let mF={0(t,e){return t.titleId===e.id?t:{...t,titleId:e.id}}},mv=_.createContext(null);mv.displayName="DialogContext";function fh(t){let e=_.useContext(mv);if(e===null){let n=new Error(`<${t} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,fh),n}return e}function pF(t,e){return Cr(e.type,mF,t,e)}let Gw=Yt(function(t,e){let n=_.useId(),{id:r=`headlessui-dialog-${n}`,open:s,onClose:i,initialFocus:o,role:a="dialog",autoFocus:l=!0,__demoMode:d=!1,unmount:h=!1,...m}=t,p=_.useRef(!1);a=function(){return a==="dialog"||a==="alertdialog"?a:(p.current||(p.current=!0,console.warn(`Invalid role [${a}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let x=lh();s===void 0&&x!==null&&(s=(x&Cn.Open)===Cn.Open);let v=_.useRef(null),C=er(v,e),A=cv(v.current),T=s?0:1,[y,w]=_.useReducer(pF,{titleId:null,descriptionId:null,panelRef:_.createRef()}),N=Te(()=>i(!1)),j=Te(K=>w({type:0,id:K})),D=uh()?T===0:!1,[b,E]=W3(),I={get current(){var K;return(K=y.panelRef.current)!=null?K:v.current}},k=yI(),{resolveContainers:R}=Q3({mainTreeNode:k,portals:b,defaultContainers:[I]}),O=x!==null?(x&Cn.Closing)===Cn.Closing:!1;o3(d||O?!1:D,{allowed:Te(()=>{var K,He;return[(He=(K=v.current)==null?void 0:K.closest("[data-headlessui-portal]"))!=null?He:null]}),disallowed:Te(()=>{var K;return[(K=k==null?void 0:k.closest("body > *:not(#headlessui-portal-root)"))!=null?K:null]})});let P=sI.get(null);Qt(()=>{if(D)return P.actions.push(r),()=>P.actions.pop(r)},[P,r,D]);let Se=aI(P,_.useCallback(K=>P.selectors.isTop(K,r),[P,r]));y3(Se,R,K=>{K.preventDefault(),N()}),G3(Se,A==null?void 0:A.defaultView,K=>{K.preventDefault(),K.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),N()}),S3(d||O?!1:D,A,R),a3(D,v,N);let[H,he]=O6(),ae=_.useMemo(()=>[{dialogState:T,close:N,setTitleId:j,unmount:h},y],[T,N,j,h,y]),U=Gl({open:T===0}),G={ref:C,id:r,role:a,tabIndex:-1,"aria-modal":d?void 0:T===0?!0:void 0,"aria-labelledby":y.titleId,"aria-describedby":H,unmount:h},Y=!K3(),se=Gs.None;D&&!d&&(se|=Gs.RestoreFocus,se|=Gs.TabLock,l&&(se|=Gs.AutoFocus),Y&&(se|=Gs.InitialFocus));let Z=wn();return ne.createElement(M3,null,ne.createElement(Hw,{force:!0},ne.createElement(q3,null,ne.createElement(mv.Provider,{value:ae},ne.createElement(gI,{target:v},ne.createElement(Hw,{force:!1},ne.createElement(he,{slot:U},ne.createElement(E,null,ne.createElement(tF,{initialFocus:o,initialFocusFallback:v,containers:R,features:se},ne.createElement($6,{value:N},Z({ourProps:G,theirProps:m,slot:U,defaultTag:gF,features:vF,visible:T===0,name:"Dialog"})))))))))))}),gF="div",vF=od.RenderStrategy|od.Static;function yF(t,e){let{transition:n=!1,open:r,...s}=t,i=lh(),o=t.hasOwnProperty("open")||i!==null,a=t.hasOwnProperty("onClose");if(!o&&!a)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!o)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!a)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!i&&typeof t.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${t.open}`);if(typeof t.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${t.onClose}`);return(r!==void 0||n)&&!s.static?ne.createElement(qw,null,ne.createElement(uc,{show:r,transition:n,unmount:s.unmount},ne.createElement(Gw,{ref:e,...s}))):ne.createElement(qw,null,ne.createElement(Gw,{ref:e,open:r,...s}))}let _F="div";function wF(t,e){let n=_.useId(),{id:r=`headlessui-dialog-panel-${n}`,transition:s=!1,...i}=t,[{dialogState:o,unmount:a},l]=fh("Dialog.Panel"),d=er(e,l.panelRef),h=Gl({open:o===0}),m=Te(A=>{A.stopPropagation()}),p={ref:d,id:r,onClick:m},x=s?fv:_.Fragment,v=s?{unmount:a}:{},C=wn();return ne.createElement(x,{...v},C({ourProps:p,theirProps:i,slot:h,defaultTag:_F,name:"Dialog.Panel"}))}let xF="div";function EF(t,e){let{transition:n=!1,...r}=t,[{dialogState:s,unmount:i}]=fh("Dialog.Backdrop"),o=Gl({open:s===0}),a={ref:e,"aria-hidden":!0},l=n?fv:_.Fragment,d=n?{unmount:i}:{},h=wn();return ne.createElement(l,{...d},h({ourProps:a,theirProps:r,slot:o,defaultTag:xF,name:"Dialog.Backdrop"}))}let TF="h2";function bF(t,e){let n=_.useId(),{id:r=`headlessui-dialog-title-${n}`,...s}=t,[{dialogState:i,setTitleId:o}]=fh("Dialog.Title"),a=er(e);_.useEffect(()=>(o(r),()=>o(null)),[r,o]);let l=Gl({open:i===0}),d={ref:a,id:r};return wn()({ourProps:d,theirProps:s,slot:l,defaultTag:TF,name:"Dialog.Title"})}let SF=Yt(yF),IF=Yt(wF);Yt(EF);let NF=Yt(bF),Af=Object.assign(SF,{Panel:IF,Title:NF,Description:F6});const II="E_OVERLAP";function NI(t){if(!t.name||!t.name.trim())throw new Error("Service name is required");if(t.price==null||t.price<0)throw new Error("Price must be  0");if(t.duration==null||t.duration<=0)throw new Error("Duration must be > 0")}async function CF(t,e){NI(e);const n=be(pe(t,"services"));return await Si(n,{name:e.name.trim(),price:Number(e.price),duration:Number(e.duration),category:e.category??null,description:e.description??null,active:e.active??!0,createdAt:Ze(),updatedAt:Ze()}),n.id}async function kF(t,e,n){NI({...n,name:n.name??"x",price:n.price??0,duration:n.duration??1});const r=be(t,"services",e);await Gn(r,{...n.name!=null?{name:n.name.trim()}:{},...n.price!=null?{price:Number(n.price)}:{},...n.duration!=null?{duration:Number(n.duration)}:{},...n.category!==void 0?{category:n.category??null}:{},...n.description!==void 0?{description:n.description??null}:{},...n.active!==void 0?{active:!!n.active}:{},updatedAt:Ze()})}async function AF(t,e){await Ul(be(t,"services",e))}function CI(t,e,n){const r=pe(t,"services"),s=e!=null&&e.activeOnly?Ne(r,Pe("active","==",!0),Ct("name","asc")):Ne(r,Ct("name","asc"));return Qe(s,i=>{const o=i.docs.map(a=>({id:a.id,...a.data()}));n(o)})}async function PF(t,e){const n=e.id?be(t,"customers",e.id):be(pe(t,"customers"));return await Si(n,{name:e.name||"Unnamed",email:e.email||null,phone:e.phone||null,notes:e.notes||null,status:e.status||"approved",createdAt:Ze(),updatedAt:Ze()},{merge:!1}),n.id}async function RF(t,e,n){const r=be(t,"customers",e);await Gn(r,{...n.name!==void 0?{name:n.name}:{},...n.email!==void 0?{email:n.email??null}:{},...n.phone!==void 0?{phone:n.phone??null}:{},...n.notes!==void 0?{notes:n.notes??null}:{},...n.status!==void 0?{status:n.status}:{},...n.lastVisit!==void 0?{lastVisit:n.lastVisit??null}:{},...n.totalVisits!==void 0?{totalVisits:n.totalVisits??0}:{},updatedAt:Ze()})}async function kI(t,e){await Ul(be(t,"customers",e))}async function jF(t,e){const n=Ne(pe(t,"customers"),Pe("email","==",e),bi(1)),r=await In(n);if(r.empty)return null;const s=r.docs[0];return{id:s.id,...s.data()}}function DF(t,e,n){const r=pe(t,"customers"),s=(e==null?void 0:e.trim().toLowerCase())||"",i=Ne(r,Ct("name","asc"),bi(200));return Qe(i,o=>{let a=o.docs.map(l=>({id:l.id,...l.data()}));s&&(a=a.filter(l=>{var d,h,m;return((d=l.name)==null?void 0:d.toLowerCase().includes(s))||((h=l.email)==null?void 0:h.toLowerCase().includes(s))||((m=l.phone)==null?void 0:m.includes(s))})),n(a)})}function OF(t,e,n){const r=new Date(e);r.setHours(0,0,0,0);const s=new Date(e);s.setHours(23,59,59,999);const i=Ne(pe(t,"appointments"),Pe("start",">=",r.toISOString()),Pe("start","<=",s.toISOString()),Ct("start","asc"));return Qe(i,o=>{const a=[];o.forEach(l=>{const d={id:l.id,...l.data()};d.status!=="cancelled"&&a.push(d)}),n(a)})}async function MF(t,e){const n=new Date(e.start).getTime();if(!Number.isFinite(n))throw new Error("Invalid start");const r=n+e.duration*6e4,s=new Date(n).toISOString(),i=new Date(r).toISOString(),o=new Date(n-e.duration*6e4).toISOString(),a=i,l=pe(t,"appointments"),d=Ne(l,Pe("start",">=",o),Pe("start","<",a)),h=Ne(l,Pe("start",">=",s),Pe("start","<",i)),m={};return await IS(t,async p=>{(await In(d)).forEach(T=>{m[T.id]=!0}),(await In(h)).forEach(T=>{m[T.id]=!0});for(const T of Object.keys(m)){const y=be(t,"appointments",T),w=await p.get(y);if(!w.exists())continue;const N=w.data();if(N.status==="cancelled")continue;const j=new Date(N.start).getTime(),D=j+(N.duration||0)*6e4;if(j<r&&D>n)throw new Error(II)}const C=be(pe(t,"appointments")),A={customerId:e.customerId,serviceId:e.serviceId,start:s,duration:e.duration,status:e.status||"confirmed",notes:e.notes||null,bookedPrice:e.bookedPrice??null,autoConfirm:e.autoConfirm??!1,createdAt:Ze(),updatedAt:Ze()};return p.set(C,A),C.id})}function LF(t,e){const n=be(t,"settings","analyticsTargets");return Qe(n,r=>e(r.data()))}async function VF(t,e){const n=be(t,"settings","analyticsTargets");await Si(n,{...e,updatedAt:Ze()},{merge:!0})}function AI(t,e){const n=be(t,"settings","businessHours");return Qe(n,r=>{const s=r.data();if(!s){e({timezone:"America/Los_Angeles",slotInterval:15,slots:{sun:[],mon:[],tue:[],wed:[],thu:[],fri:[],sat:[]}});return}const i={timezone:s.timezone||"America/Los_Angeles",slotInterval:s.slotInterval||15,slots:{sun:[],mon:[],tue:[],wed:[],thu:[],fri:[],sat:[]}};s.slots&&Object.entries(s.slots).forEach(([o,a])=>{a&&a.ranges&&Array.isArray(a.ranges)&&(i.slots[o]=a.ranges.map(l=>[l.start,l.end]))}),e(i)})}async function FF(t,e){const n=be(t,"settings","businessHours"),r={timezone:e.timezone,slotInterval:e.slotInterval,slots:Object.fromEntries(Object.entries(e.slots).map(([s,i])=>[s,{ranges:i.map(([o,a])=>({start:o,end:a}))}])),updatedAt:Ze()};await Si(n,r,{merge:!0})}function UF(t,e){const n=be(t,"settings","businessInfo");return Qe(n,r=>{if(!r.exists()){e({name:"BUENO BROWS",address:"315 9th Ave",city:"San Mateo",state:"CA",zip:"94401",phone:"(650) 613-8455",email:"hello@buenobrows.com",instagram:"buenobrows",tiktok:"buenobrows"});return}e(r.data())})}async function $F(t,e){const n=be(t,"settings","businessInfo");await Si(n,{...e,updatedAt:Ze()},{merge:!0})}function BF(t,e){const n=be(t,"settings","homePageContent");return Qe(n,r=>{if(!r.exists()){e({heroTitle:"Refined. Natural. You.",heroSubtitle:"Filipino-inspired beauty studio specializing in brows & lashes. Thoughtfully scheduled, never rushed.",ctaPrimary:"Book now",ctaSecondary:"See services",aboutText:"At BUENO BROWS, we believe beauty is personal. Our Filipino-inspired approach combines precision with warmth, creating results that enhance your natural features.",buenoCircleEnabled:!0,buenoCircleTitle:"Join the Bueno Circle",buenoCircleDescription:"Get 10% off your first appointment and exclusive updates!",buenoCircleDiscount:10});return}e(r.data())})}async function PI(t,e){const n=be(t,"settings","homePageContent");await Si(n,{...e,updatedAt:Ze()},{merge:!0})}function cc(t,e,n,r){const s=n.timezone||"America/Los_Angeles",i=["sun","mon","tue","wed","thu","fri","sat"][t.getDay()],o=n.slots[i]||[],a=Math.max(5,n.slotInterval||15),l=[];for(const[d,h]of o){const m=Kw(t,d,s),p=Kw(t,h,s);for(let x=m.getTime();x+e*6e4<=p.getTime();x+=a*6e4){const v=new Date(x).toISOString(),C=x+e*6e4;zF(x,C,r)||l.push(v)}}return l}function zF(t,e,n){for(const r of n){if(r.status==="cancelled")continue;const s=new Date(r.start).getTime(),i=s+r.duration*6e4;if(s<e&&i>t)return!0}return!1}function Kw(t,e,n){const[r,s]=e.split(":").map(a=>parseInt(a,10)),i=new Intl.DateTimeFormat("en-US",{timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(new Date(t.getFullYear(),t.getMonth(),t.getDate(),r,s,0)),o=a=>{var l;return Number(((l=i.find(d=>d.type===a))==null?void 0:l.value)||"0")};return new Date(o("year"),o("month")-1,o("day"),o("hour"),o("minute"),o("second"))}function WF({open:t,onClose:e,date:n,onCreated:r}){const{db:s}=Xe(),[i,o]=_.useState([]),[a,l]=_.useState(null);_.useEffect(()=>CI(s,{activeOnly:!0},o),[]),_.useEffect(()=>AI(s,l),[]);const[d,h]=_.useState([]),[m,p]=_.useState(""),[x,v]=_.useState(null),[C,A]=_.useState("10:00"),[T,y]=_.useState(""),[w,N]=_.useState(""),[j,D]=_.useState(""),[b,E]=_.useState(""),[I,k]=_.useState(new Set),R=_.useMemo(()=>i.filter(B=>d.includes(B.id)),[i,d]),O=_.useMemo(()=>R.reduce((B,ie)=>B+ie.duration,0),[R]),P=_.useMemo(()=>R.reduce((B,ie)=>B+ie.price,0),[R]),Se=_.useMemo(()=>{const B={};return i.forEach(ie=>{const le=ie.category||"Other";B[le]||(B[le]=[]),B[le].push(ie)}),B},[i]),H=B=>{k(ie=>{const le=new Set(ie);return le.has(B)?le.delete(B):le.add(B),le})},[he,ae]=_.useState([]);_.useEffect(()=>{let B=!0;return(async()=>{const ie=m.trim();if(!ie){ae([]);return}const le=[];if(ie.includes("@")){const qe=await jF(s,ie);qe&&le.push(qe)}const De=Ne(pe(s,"customers"),Pe("name",">=",ie),Pe("name","<=",ie+""),bi(5));(await In(De)).forEach(qe=>le.push({id:qe.id,...qe.data()})),B&&ae(le)})(),()=>{B=!1}},[m]);const[U,G]=_.useState([]);_.useEffect(()=>{if(!t)return;const B=new Date(n);B.setHours(0,0,0,0);const ie=new Date(n);ie.setHours(23,59,59,999),Dw(async()=>{const{onSnapshot:le,collection:De,query:at,where:qe,orderBy:dn}=await Promise.resolve().then(()=>G_);return{onSnapshot:le,collection:De,query:at,where:qe,orderBy:dn}},void 0).then(({onSnapshot:le,collection:De,query:at,where:qe,orderBy:dn})=>{const jr=at(De(s,"appointments"),qe("start",">=",B.toISOString()),qe("start","<=",ie.toISOString()),dn("start","asc")),Dr=le(jr,Os=>{const Or=[];Os.forEach(Ms=>Or.push({id:Ms.id,...Ms.data()})),G(Or)});return()=>Dr()})},[t,n]),_.useMemo(()=>a?cc(n,O,a,U):[],[a,n,O,U]);const[Y,se]=_.useState(!1),[Z,K]=_.useState("");async function He(){try{if(se(!0),K(""),d.length===0){K("Please select at least one service");return}let B;if(x)B=x.id;else{const{doc:qe,setDoc:dn,serverTimestamp:jr}=await Dw(async()=>{const{doc:Os,setDoc:Or,serverTimestamp:Ms}=await Promise.resolve().then(()=>G_);return{doc:Os,setDoc:Or,serverTimestamp:Ms}},void 0),Dr=qe(pe(s,"customers"));await dn(Dr,{name:j||m||"Unnamed",email:w||null,phone:b||null,status:"approved",createdAt:jr(),updatedAt:jr()},{merge:!0}),B=Dr.id}const[ie,le]=C.split(":").map(Number),De=new Date(n);De.setHours(ie,le,0,0);const at=await MF(s,{customerId:B,serviceIds:d,serviceId:d[0],start:De.toISOString(),duration:O,status:"confirmed",bookedPrice:P,notes:T});r==null||r(at),e()}catch(B){(B==null?void 0:B.message)===II?K("This time is already booked. Pick another slot."):K((B==null?void 0:B.message)||"Failed to create")}finally{se(!1)}}return u.jsx(uc,{show:t,as:_.Fragment,children:u.jsxs(Af,{onClose:e,className:"relative z-50",children:[u.jsx(uc.Child,{as:_.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:u.jsx("div",{className:"fixed inset-0 bg-black/20"})}),u.jsx("div",{className:"fixed inset-0 overflow-y-auto p-4",children:u.jsx("div",{className:"mx-auto max-w-2xl",children:u.jsx(uc.Child,{as:_.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 translate-y-2",enterTo:"opacity-100 translate-y-0",leave:"ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-2",children:u.jsxs(Af.Panel,{className:"bg-white rounded-xl shadow-xl p-4",children:[u.jsxs(Af.Title,{className:"font-serif text-xl mb-2",children:["Add appointment  ",nt(n,"PP")]}),u.jsxs("div",{className:"grid gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm text-slate-600",children:"Customer"}),u.jsx("input",{className:"border rounded-md p-2 w-full",placeholder:"Type name or email",value:m,onChange:B=>{p(B.target.value),v(null)}}),he.length>0&&u.jsx("div",{className:"border rounded-md mt-1 max-h-40 overflow-auto",children:he.map(B=>u.jsxs("button",{className:"w-full text-left px-2 py-1 hover:bg-cream",onClick:()=>{v(B),p(B.name||B.email||"")},children:[u.jsx("div",{className:"text-sm",children:B.name}),u.jsx("div",{className:"text-xs text-slate-500",children:B.email||B.phone||B.id})]},B.id))}),!x&&u.jsxs("div",{className:"grid sm:grid-cols-3 gap-2 mt-2",children:[u.jsx("input",{className:"border rounded-md p-2",placeholder:"Name",value:j,onChange:B=>D(B.target.value)}),u.jsx("input",{className:"border rounded-md p-2",placeholder:"Email",value:w,onChange:B=>N(B.target.value)}),u.jsx("input",{className:"border rounded-md p-2",placeholder:"Phone",value:b,onChange:B=>E(B.target.value)})]}),x&&u.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:["Selected: ",u.jsx("span",{className:"font-medium",children:x.name})," (",x.email||x.phone||x.id,")"]})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"text-sm font-medium text-slate-700 mb-2 block",children:["Select Services ",R.length>0&&u.jsxs("span",{className:"text-terracotta",children:["(",R.length," selected)"]})]}),u.jsx("div",{className:"max-h-64 overflow-y-auto border rounded-lg bg-slate-50",children:Object.entries(Se).map(([B,ie])=>{const le=I.has(B);return u.jsxs("div",{className:"border-b border-slate-200 last:border-b-0",children:[u.jsxs("button",{type:"button",onClick:()=>H(B),className:"w-full px-3 py-2 bg-slate-100 border-b border-slate-200 flex items-center justify-between hover:bg-slate-200 transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wide",children:B}),u.jsx("span",{className:"text-xs bg-slate-300 text-slate-600 px-1.5 py-0.5 rounded-full",children:ie.length})]}),u.jsx("svg",{className:`w-3 h-3 text-slate-500 transition-transform ${le?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!le&&u.jsx("div",{className:"p-3 bg-white",children:u.jsx("div",{className:"grid gap-2",children:ie.map(De=>{const at=d.includes(De.id);return u.jsx("button",{type:"button",onClick:()=>{h(at?qe=>qe.filter(dn=>dn!==De.id):qe=>[...qe,De.id])},className:`
                                          relative p-3 rounded-lg border-2 text-left transition-all
                                          ${at?"border-terracotta bg-terracotta/5 shadow-sm":"border-slate-200 bg-white hover:border-slate-300 hover:shadow-sm"}
                                        `,children:u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"font-medium text-slate-800 mb-1",children:De.name}),u.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[u.jsxs("span",{className:"flex items-center gap-1",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),De.duration," min"]}),u.jsxs("span",{className:"flex items-center gap-1 font-medium text-slate-700",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"$",De.price.toFixed(2)]})]})]}),at&&u.jsx("div",{className:"flex-shrink-0",children:u.jsx("div",{className:"w-5 h-5 rounded-full bg-terracotta flex items-center justify-center",children:u.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})})]})},De.id)})})})]},B)})}),R.length>0&&u.jsxs("div",{className:"mt-3 p-3 bg-terracotta/10 border border-terracotta/20 rounded-lg",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Selected Services"}),u.jsx("button",{type:"button",onClick:()=>h([]),className:"text-xs text-slate-500 hover:text-red-600 transition-colors",children:"Clear All"})]}),u.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:R.map(B=>u.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-white rounded-md text-xs border border-slate-200",children:[u.jsx("span",{className:"font-medium",children:B.name}),u.jsx("button",{type:"button",onClick:()=>h(ie=>ie.filter(le=>le!==B.id)),className:"ml-1 text-slate-400 hover:text-red-600 transition-colors",children:""})]},B.id))}),u.jsx("div",{className:"flex items-center justify-between pt-2 border-t border-terracotta/20",children:u.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[u.jsxs("span",{className:"text-slate-600",children:[u.jsx("span",{className:"font-medium text-slate-700",children:O})," minutes"]}),u.jsxs("span",{className:"text-slate-600",children:[u.jsxs("span",{className:"font-semibold text-terracotta text-base",children:["$",P.toFixed(2)]})," total"]})]})})]})]}),u.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-sm text-slate-600",children:"Date"}),u.jsx("input",{type:"date",className:"border rounded-md p-2 w-full",value:nt(n,"yyyy-MM-dd"),onChange:B=>{const ie=new Date(B.target.value+"T00:00:00");ie.setHours(n.getHours(),n.getMinutes(),0,0),n=ie}})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm text-slate-600",children:"Time"}),u.jsx("input",{type:"time",className:"border rounded-md p-2 w-full",value:C,onChange:B=>A(B.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm text-slate-600",children:"Duration (min)"}),u.jsx("input",{type:"number",min:5,step:5,className:"border rounded-md p-2 w-full bg-slate-50",value:O,readOnly:!0}),u.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Auto-calculated from selected services"})]})]}),a&&u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Available slots"}),u.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[cc(n,O,a,U).slice(0,16).map(B=>u.jsx("button",{className:"border rounded-md py-1 text-sm hover:bg-cream",onClick:()=>A(nt(gr(B),"HH:mm")),children:nt(gr(B),"h:mm a")},B)),!cc(n,O,a,U).length&&u.jsx("div",{className:"text-xs text-slate-500",children:"No slots under business hours."})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm text-slate-600",children:"Notes"}),u.jsx("textarea",{className:"border rounded-md p-2 w-full",rows:3,value:T,onChange:B=>y(B.target.value)})]}),Z&&u.jsx("div",{className:"text-red-600 text-sm",children:Z}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{className:"px-4 py-2 rounded-md border",onClick:e,disabled:Y,children:"Cancel"}),u.jsx("button",{className:"px-4 py-2 rounded-md bg-terracotta text-white",onClick:He,disabled:Y||d.length===0,children:Y?"Saving":"Create appointment"})]})]})]})})})})]})})}function HF(){const{db:t}=Xe(),[e,n]=_.useState(()=>new Date),r=_.useMemo(()=>pi(U1(e),{weekStartsOn:0}),[e]),s=_.useMemo(()=>B1(F1(e),{weekStartsOn:0}),[e]),[i,o]=_.useState([]);_.useEffect(()=>{const y=Ne(pe(t,"appointments"),Pe("start",">=",r.toISOString()),Pe("start","<=",s.toISOString()),Ct("start","asc"));return Qe(y,w=>{const N=[];w.forEach(j=>N.push({id:j.id,...j.data()})),o(N)})},[r,s]);const[a,l]=_.useState({});_.useEffect(()=>{const y=pe(t,"services");return Qe(Ne(y,Ct("name","asc")),w=>{const N={};w.forEach(j=>N[j.id]={id:j.id,...j.data()}),l(N)})},[]);const d=_.useMemo(()=>{const y=[];for(let w=new Date(r);w<=s;w=new Date(w.getTime()+24*60*60*1e3))y.push(new Date(w));return y},[r,s]),[h,m]=_.useState(null),[p,x]=_.useState({open:!1,date:null}),[v,C]=_.useState(null),[A,T]=_.useState(null);return u.jsxs("div",{className:"grid gap-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"font-serif text-2xl",children:nt(e,"MMMM yyyy")}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{className:"border rounded-md px-3 py-1 hover:bg-cream",onClick:()=>n(Sw(e,-1)),children:"Prev"}),u.jsx("button",{className:"border rounded-md px-3 py-1 hover:bg-cream",onClick:()=>n(new Date),children:"Today"}),u.jsx("button",{className:"border rounded-md px-3 py-1 hover:bg-cream",onClick:()=>n(Sw(e,1)),children:"Next"})]})]}),u.jsx("div",{className:"grid grid-cols-7 text-xs text-slate-500",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(y=>u.jsx("div",{className:"px-2 py-1",children:y},y))}),u.jsx("div",{className:"grid grid-cols-7 gap-px bg-slate-200 rounded-xl overflow-hidden",children:d.map((y,w)=>{const N=H1(y,e),j=i.filter(D=>Tf(new Date(D.start),y)&&D.status!=="cancelled");return u.jsxs("div",{className:`relative min-h-[108px] bg-white ${N?"":"bg-slate-50 text-slate-400"}`,onMouseEnter:()=>m(y),onMouseLeave:()=>m(D=>D&&Tf(D,y)?null:D),onClick:()=>x({open:!0,date:y}),children:[u.jsxs("div",{className:"flex items-center justify-between px-2 py-1",children:[u.jsx("span",{className:"text-xs",children:nt(y,"d")}),!!j.length&&u.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-terracotta text-white",children:j.length})]}),u.jsxs("div",{className:"px-2 pb-2 space-y-1",children:[j.slice(0,3).map(D=>{var b;return u.jsxs("div",{onClick:E=>{E.stopPropagation(),C(D)},className:"text-[11px] truncate border rounded px-1 py-0.5 cursor-pointer hover:bg-slate-100 transition-colors",children:[nt(new Date(D.start),"h:mma"),"  ",((b=a[D.serviceId])==null?void 0:b.name)||"Service"]},D.id)}),j.length>3&&u.jsxs("div",{className:"text-[10px] text-slate-500",children:["+",j.length-3," more"]})]}),h&&Tf(h,y)&&j.length>0&&u.jsxs("div",{className:"absolute z-10 left-1/2 -translate-x-1/2 top-full mt-1 w-64 bg-white border rounded-xl shadow-lg p-3",children:[u.jsx("div",{className:"text-xs font-medium mb-2",children:nt(y,"PP")}),u.jsx("ul",{className:"max-h-48 overflow-auto space-y-2",children:j.map(D=>{var b;return u.jsxs("li",{onClick:E=>{E.stopPropagation(),C(D)},className:"text-xs flex items-center justify-between gap-2 p-2 bg-slate-50 rounded-md hover:bg-slate-100 group cursor-pointer",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"font-medium truncate",children:nt(new Date(D.start),"h:mm a")}),u.jsx("div",{className:"text-slate-600 truncate",children:((b=a[D.serviceId])==null?void 0:b.name)||"Service"}),D.customerName&&u.jsx("div",{className:"text-slate-500 truncate text-[10px]",children:D.customerName})]}),u.jsx("button",{onClick:E=>{E.stopPropagation(),confirm("Cancel this appointment?")&&Gn(be(t,"appointments",D.id),{status:"cancelled"})},className:"opacity-0 group-hover:opacity-100 transition-opacity text-red-600 hover:text-red-700 p-1",title:"Cancel appointment",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},D.id)})})]})]},w)})}),u.jsx(WF,{open:p.open,date:p.date||new Date,onClose:()=>x({open:!1,date:null}),onCreated:()=>x({open:!1,date:null})}),u.jsx(G1,{appointment:v,service:v?a[v.serviceId]:null,onClose:()=>C(null),onEdit:()=>{T(v),C(null)}}),u.jsx(K1,{appointment:A,service:A?a[A.serviceId]:null,onClose:()=>T(null),onUpdated:()=>{T(null)}})]})}function qF(){const{db:t}=Xe(),[e,n]=_.useState([]),[r,s]=_.useState(""),[i,o]=_.useState("name"),[a,l]=_.useState(null),[d,h]=_.useState(null),[m,p]=_.useState(new Set);_.useEffect(()=>DF(t,r,n),[r]);const x=_.useMemo(()=>{const w=[...e];switch(i){case"name":return w.sort((N,j)=>(N.name||"").localeCompare(j.name||""));case"date":return w.sort((N,j)=>{var E,I,k,R;const D=((I=(E=N.createdAt)==null?void 0:E.toMillis)==null?void 0:I.call(E))||0;return(((R=(k=j.createdAt)==null?void 0:k.toMillis)==null?void 0:R.call(k))||0)-D});case"visits":return w.sort((N,j)=>(j.totalVisits||0)-(N.totalVisits||0));default:return w}},[e,i]),v=_.useMemo(()=>{const w={"VIP Customers":[],"Regular Customers":[],"New Customers":[],"Inactive Customers":[],"Blocked Customers":[]};return x.forEach(N=>{N.status==="blocked"?w["Blocked Customers"].push(N):N.status==="guest"?w["New Customers"].push(N):(N.totalVisits||0)>=10?w["VIP Customers"].push(N):(N.totalVisits||0)>=3?w["Regular Customers"].push(N):(N.totalVisits||0)>0?w["New Customers"].push(N):w["Inactive Customers"].push(N)}),Object.keys(w).forEach(N=>{w[N].length===0&&delete w[N]}),w},[x]),C=w=>{p(N=>{const j=new Set(N);return j.has(w)?j.delete(w):j.add(w),j})},A=w=>{var j;return((j=w.name)==null?void 0:j.split(" ").map(D=>D[0]).join("").toUpperCase())||"?"},T=w=>{switch(w){case"approved":return"bg-green-100 text-green-700 border-green-200";case"blocked":return"bg-red-100 text-red-700 border-red-200";default:return"bg-slate-100 text-slate-700 border-slate-200"}},y=w=>{switch(w){case"VIP Customers":return"";case"Regular Customers":return"";case"New Customers":return"";case"Inactive Customers":return"";case"Blocked Customers":return"";default:return""}};return u.jsxs("div",{className:"bg-white rounded-xl shadow-soft p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"font-serif text-2xl text-slate-800",children:"Customers"}),u.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Manage your customer relationships and track their journey"})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("select",{className:"border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-terracotta focus:border-transparent",value:i,onChange:w=>o(w.target.value),children:[u.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),u.jsx("option",{value:"date",children:"Sort: Newest First"}),u.jsx("option",{value:"visits",children:"Sort: Most Visits"})]}),u.jsx("input",{className:"border border-slate-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"Search customers...",value:r,onChange:w=>s(w.target.value)}),u.jsxs("button",{className:"bg-terracotta text-white rounded-lg px-4 py-2 hover:bg-terracotta/90 transition-colors flex items-center gap-2",onClick:()=>l({id:"",name:"",email:"",phone:"",status:"approved",totalVisits:0}),children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Customer"]})]})]}),u.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[u.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-slate-800",children:x.length}),u.jsx("div",{className:"text-xs text-slate-600",children:"Total Customers"})]}),u.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.filter(w=>w.status==="approved").length}),u.jsx("div",{className:"text-xs text-slate-600",children:"Active"})]}),u.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.filter(w=>(w.totalVisits||0)>=5).length}),u.jsx("div",{className:"text-xs text-slate-600",children:"Regulars"})]}),u.jsxs("div",{className:"bg-terracotta/10 rounded-lg p-4 text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-terracotta",children:x.reduce((w,N)=>w+(N.totalVisits||0),0)}),u.jsx("div",{className:"text-xs text-slate-600",children:"Total Visits"})]})]}),u.jsx("div",{className:"space-y-4",children:Object.entries(v).map(([w,N])=>{const j=m.has(w);return u.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[u.jsxs("button",{onClick:()=>C(w),className:"w-full px-4 py-3 bg-slate-50 border-b border-slate-200 flex items-center justify-between hover:bg-slate-100 transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"text-lg",children:y(w)}),u.jsx("div",{className:"text-sm font-semibold text-slate-700",children:w}),u.jsxs("span",{className:"text-xs bg-slate-200 text-slate-600 px-2 py-1 rounded-full",children:[N.length," customer",N.length!==1?"s":""]})]}),u.jsx("svg",{className:`w-4 h-4 text-slate-500 transition-transform ${j?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!j&&u.jsx("div",{className:"p-4 bg-white",children:u.jsx("div",{className:"grid gap-4",children:N.map(D=>u.jsx("div",{className:"p-4 rounded-lg border-2 border-slate-200 bg-white hover:border-slate-300 hover:shadow-sm transition-all",children:u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[u.jsx("div",{className:"w-12 h-12 rounded-full bg-terracotta/10 flex items-center justify-center flex-shrink-0",children:u.jsx("span",{className:"text-sm font-semibold text-terracotta",children:A(D)})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("button",{className:"font-medium text-slate-800 hover:text-terracotta transition-colors",onClick:()=>h(D),children:D.name}),u.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${T(D.status||"guest")}`,children:D.status||"guest"})]}),u.jsxs("div",{className:"space-y-1 text-sm text-slate-600",children:[D.email&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})}),D.email]}),D.phone&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),D.phone]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-lg font-semibold text-slate-800",children:D.totalVisits||0}),u.jsx("div",{className:"text-xs text-slate-500",children:"visits"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>l(D),className:"px-3 py-1 text-sm border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",children:"Edit"}),u.jsx("button",{onClick:()=>kI(t,D.id),className:"px-3 py-1 text-sm border border-red-300 text-red-600 rounded-md hover:bg-red-50 transition-colors",children:"Delete"})]})]})]})},D.id))})})]},w)})}),a&&u.jsx(KF,{initial:a,onClose:()=>l(null),db:t}),d&&u.jsx(GF,{customer:d,onClose:()=>h(null),db:t})]})}function GF({customer:t,onClose:e,db:n}){var o,a,l,d,h;const[r,s]=_.useState(!1),i=async()=>{if(confirm(`Are you sure you want to delete ${t.name}? This action cannot be undone.`)){s(!0);try{await kI(n,t.id),e()}catch(m){console.error("Failed to delete customer:",m)}finally{s(!1)}}};return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:u.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl",onClick:m=>m.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h3",{className:"font-serif text-2xl text-slate-800",children:"Customer Details"}),u.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"grid gap-6 mb-6",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-slate-600 mb-3",children:"Contact Information"}),u.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 space-y-3",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 rounded-full bg-terracotta/10 flex items-center justify-center",children:u.jsx("span",{className:"text-sm font-semibold text-terracotta",children:((o=t.name)==null?void 0:o.split(" ").map(m=>m[0]).join("").toUpperCase())||"?"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800",children:t.name}),u.jsxs("div",{className:"text-sm text-slate-600",children:["Customer since ",t.createdAt?new Date(((l=(a=t.createdAt).toMillis)==null?void 0:l.call(a))||t.createdAt).toLocaleDateString():"Unknown"]})]})]}),t.email&&u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})}),u.jsx("span",{className:"text-sm text-slate-700",children:t.email})]}),t.phone&&u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),u.jsx("span",{className:"text-sm text-slate-700",children:t.phone})]})]})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-slate-600 mb-3",children:"Customer Stats"}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.totalVisits||0}),u.jsx("div",{className:"text-xs text-slate-600",children:"Total Visits"})]}),u.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.status==="approved"?"Active":t.status==="blocked"?"Blocked":"Guest"}),u.jsx("div",{className:"text-xs text-slate-600",children:"Status"})]}),u.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.lastVisit?new Date(((h=(d=t.lastVisit).toMillis)==null?void 0:h.call(d))||t.lastVisit).toLocaleDateString():"N/A"}),u.jsx("div",{className:"text-xs text-slate-600",children:"Last Visit"})]})]})]}),t.notes&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-slate-600 mb-3",children:"Notes"}),u.jsx("div",{className:"bg-slate-50 rounded-lg p-4",children:u.jsx("p",{className:"text-sm text-slate-700",children:t.notes})})]})]}),u.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[u.jsx("button",{onClick:i,disabled:r,className:"flex-1 border border-red-300 text-red-600 rounded-lg px-4 py-2 hover:bg-red-50 transition-colors disabled:opacity-50",children:r?"Deleting...":"Delete Customer"}),u.jsx("button",{onClick:e,className:"flex-1 bg-terracotta text-white rounded-lg px-4 py-2 hover:bg-terracotta/90 transition-colors",children:"Close"})]})]})})}function KF({initial:t,onClose:e,db:n}){const[r,s]=_.useState(t),[i,o]=_.useState(!1);_.useEffect(()=>{s(t)},[t]);async function a(){o(!0);try{r.id?await RF(n,r.id,r):await PF(n,r),e()}catch(l){console.error("Failed to save customer:",l)}finally{o(!1)}}return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:u.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",onClick:l=>l.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h3",{className:"font-serif text-xl text-slate-800",children:r.id?"Edit Customer":"Add New Customer"}),u.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Name *"}),u.jsx("input",{className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"Customer name",value:r.name,onChange:l=>s({...r,name:l.target.value})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email"}),u.jsx("input",{className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"email@example.com",value:r.email||"",onChange:l=>s({...r,email:l.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Phone"}),u.jsx("input",{className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"(555) 123-4567",value:r.phone||"",onChange:l=>s({...r,phone:l.target.value})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Status"}),u.jsxs("select",{className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:r.status||"approved",onChange:l=>s({...r,status:l.target.value}),children:[u.jsx("option",{value:"approved",children:"Approved"}),u.jsx("option",{value:"blocked",children:"Blocked"}),u.jsx("option",{value:"guest",children:"Guest"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Notes"}),u.jsx("textarea",{className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"Add any notes about this customer...",value:r.notes||"",onChange:l=>s({...r,notes:l.target.value}),rows:3})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx("button",{onClick:e,className:"flex-1 border border-slate-300 text-slate-700 rounded-lg px-4 py-2 hover:bg-slate-50 transition-colors",disabled:i,children:"Cancel"}),u.jsx("button",{className:"flex-1 bg-terracotta text-white rounded-lg px-4 py-2 hover:bg-terracotta/90 transition-colors disabled:opacity-50",onClick:a,disabled:i||!r.name.trim(),children:i?"Saving...":r.id?"Update Customer":"Create Customer"})]})]})]})})}function QF(){const{db:t}=Xe(),[e,n]=_.useState([]),[r,s]=_.useState(null),[i,o]=_.useState(new Set);_.useEffect(()=>CI(t,void 0,n),[]);const a=_.useMemo(()=>{const d={};return e.forEach(h=>{const m=h.category||"Other";d[m]||(d[m]=[]),d[m].push(h)}),d},[e]),l=d=>{o(h=>{const m=new Set(h);return m.has(d)?m.delete(d):m.add(d),m})};return u.jsxs("div",{className:"bg-white rounded-xl shadow-soft p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"font-serif text-2xl text-slate-800",children:"Services"}),u.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Manage your service offerings and pricing"})]}),u.jsxs("button",{className:"bg-terracotta text-white rounded-lg px-4 py-2 hover:bg-terracotta/90 transition-colors flex items-center gap-2",onClick:()=>s({id:"",name:"",price:0,duration:60,active:!0,category:""}),children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Service"]})]}),u.jsx("div",{className:"space-y-4",children:Object.entries(a).map(([d,h])=>{const m=i.has(d);return u.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[u.jsxs("button",{onClick:()=>l(d),className:"w-full px-4 py-3 bg-slate-50 border-b border-slate-200 flex items-center justify-between hover:bg-slate-100 transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wide",children:d}),u.jsxs("span",{className:"text-xs bg-slate-200 text-slate-600 px-2 py-1 rounded-full",children:[h.length," service",h.length!==1?"s":""]})]}),u.jsx("svg",{className:`w-4 h-4 text-slate-500 transition-transform ${m?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!m&&u.jsx("div",{className:"p-4 bg-white",children:u.jsx("div",{className:"grid gap-3",children:h.map(p=>u.jsx("div",{className:`p-4 rounded-lg border-2 transition-all ${p.active?"border-slate-200 bg-white hover:border-slate-300 hover:shadow-sm":"border-slate-100 bg-slate-50 opacity-60"}`,children:u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("h3",{className:"font-medium text-slate-800",children:p.name}),!p.active&&u.jsx("span",{className:"text-xs bg-slate-300 text-slate-600 px-2 py-1 rounded-full",children:"Inactive"})]}),p.description&&u.jsx("p",{className:"text-sm text-slate-600 mb-3",children:p.description}),u.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[u.jsxs("span",{className:"flex items-center gap-1 text-slate-600",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),p.duration," minutes"]}),u.jsxs("span",{className:"flex items-center gap-1 font-medium text-slate-700",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"$",p.price.toFixed(2)]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>s(p),className:"px-3 py-1 text-sm border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",children:"Edit"}),u.jsx("button",{onClick:()=>AF(t,p.id),className:"px-3 py-1 text-sm border border-red-300 text-red-600 rounded-md hover:bg-red-50 transition-colors",children:"Delete"})]})]})},p.id))})})]},d)})}),r&&u.jsx(YF,{initial:r,onClose:()=>s(null),db:t})]})}function YF({initial:t,onClose:e,db:n}){const[r,s]=_.useState(t),[i,o]=_.useState(!1);async function a(){o(!0);try{r.id?await kF(n,r.id,r):await CF(n,r),e()}catch(l){console.error("Failed to save service:",l)}finally{o(!1)}}return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:u.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",onClick:l=>l.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h3",{className:"font-serif text-xl text-slate-800",children:r.id?"Edit Service":"Add New Service"}),u.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Service Name *"}),u.jsx("input",{className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"e.g., Brow Shaping, Lash Extensions",value:r.name,onChange:l=>s({...r,name:l.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Category"}),u.jsx("input",{className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"e.g., Brows, Lashes, Facials",value:r.category||"",onChange:l=>s({...r,category:l.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),u.jsx("textarea",{className:"w-full border border-slate-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"Brief description of the service...",value:r.description||"",onChange:l=>s({...r,description:l.target.value}),rows:3})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Price *"}),u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-500",children:"$"}),u.jsx("input",{className:"w-full border border-slate-300 rounded-lg pl-8 pr-3 py-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",type:"number",step:"0.01",placeholder:"0.00",value:r.price,onChange:l=>s({...r,price:parseFloat(l.target.value||"0")})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Duration *"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{className:"w-full border border-slate-300 rounded-lg px-3 py-2 pr-12 focus:ring-2 focus:ring-terracotta focus:border-transparent",type:"number",placeholder:"60",value:r.duration,onChange:l=>s({...r,duration:parseInt(l.target.value||"0")})}),u.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-500 text-sm",children:"min"})]})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[u.jsx("input",{type:"checkbox",id:"active",checked:r.active,onChange:l=>s({...r,active:l.target.checked}),className:"w-4 h-4 text-terracotta border-slate-300 rounded focus:ring-terracotta"}),u.jsx("label",{htmlFor:"active",className:"text-sm font-medium text-slate-700",children:"Service is active and available for booking"})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx("button",{onClick:e,className:"flex-1 border border-slate-300 text-slate-700 rounded-lg px-4 py-2 hover:bg-slate-50 transition-colors",disabled:i,children:"Cancel"}),u.jsx("button",{className:"flex-1 bg-terracotta text-white rounded-lg px-4 py-2 hover:bg-terracotta/90 transition-colors disabled:opacity-50",onClick:a,disabled:i||!r.name.trim()||r.price<=0||r.duration<=0,children:i?"Saving...":r.id?"Update Service":"Create Service"})]})]})]})})}function XF(){const{db:t}=Xe(),[e,n]=_.useState([]),[r,s]=_.useState(!0),[i,o]=_.useState("all"),[a,l]=_.useState(null);_.useEffect(()=>{const v=Ne(pe(t,"reviews"),Ct("createdAt","desc")),C=Qe(v,A=>{const T=A.docs.map(y=>({id:y.id,...y.data()}));n(T),s(!1)},A=>{console.error("Error fetching reviews:",A),s(!1)});return()=>C()},[t]);const d=e.filter(v=>i==="pending"?v.isApproved===!1:i==="approved"?v.isApproved===!0:!0),h=async v=>{try{await Gn(be(t,"reviews",v),{isApproved:!0})}catch(C){console.error("Error approving review:",C),alert("Error approving review")}},m=async v=>{if(confirm("Are you sure you want to delete this review?"))try{await Ul(be(t,"reviews",v))}catch(C){console.error("Error deleting review:",C),alert("Error deleting review")}},p=v=>Array.from({length:5},(C,A)=>u.jsx("span",{className:`text-lg ${A<v?"text-yellow-400":"text-gray-300"}`,children:""},A)),x=v=>v.isApproved===!0?u.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"Approved"}):v.isApproved===!1?u.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:"Pending"}):u.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:"New"});return r?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-terracotta mx-auto mb-4"}),u.jsx("p",{className:"text-slate-600",children:"Loading reviews..."})]})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Customer Reviews"}),u.jsx("p",{className:"text-slate-600",children:"Manage and moderate customer reviews"})]}),u.jsxs("div",{className:"flex gap-6 text-sm",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-slate-900",children:e.length}),u.jsx("div",{className:"text-slate-600",children:"Total"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.filter(v=>v.isApproved===!1).length}),u.jsx("div",{className:"text-slate-600",children:"Pending"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(v=>v.isApproved===!0).length}),u.jsx("div",{className:"text-slate-600",children:"Approved"})]})]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>o("all"),className:`px-4 py-2 rounded-lg text-sm font-medium ${i==="all"?"bg-terracotta text-white":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:"All Reviews"}),u.jsxs("button",{onClick:()=>o("pending"),className:`px-4 py-2 rounded-lg text-sm font-medium ${i==="pending"?"bg-terracotta text-white":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:["Pending (",e.filter(v=>v.isApproved===!1).length,")"]}),u.jsxs("button",{onClick:()=>o("approved"),className:`px-4 py-2 rounded-lg text-sm font-medium ${i==="approved"?"bg-terracotta text-white":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:["Approved (",e.filter(v=>v.isApproved===!0).length,")"]})]}),d.length===0?u.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border",children:[u.jsx("div",{className:"text-6xl mb-4",children:""}),u.jsx("h3",{className:"text-lg font-medium text-slate-700 mb-2",children:i==="pending"?"No pending reviews":i==="approved"?"No approved reviews":"No reviews yet"}),u.jsx("p",{className:"text-slate-500",children:i==="pending"?"All reviews have been processed":"Customer reviews will appear here"})]}):u.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:u.jsx("div",{className:"divide-y divide-slate-200",children:d.map(v=>u.jsx("div",{className:"p-6 hover:bg-slate-50",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("h3",{className:"font-medium text-slate-900",children:v.customerName}),u.jsx("div",{className:"flex items-center",children:p(v.rating)}),x(v)]}),v.serviceName&&u.jsxs("p",{className:"text-sm text-slate-600 mb-2",children:["Service: ",u.jsx("span",{className:"font-medium",children:v.serviceName})]}),u.jsxs("blockquote",{className:"text-slate-700 italic mb-3",children:['"',v.comment,'"']}),u.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-500",children:[u.jsx("span",{children:v.customerEmail}),u.jsx("span",{children:""}),u.jsx("span",{children:v.createdAt&&nt(v.createdAt.toDate(),"MMM d, yyyy 'at' h:mm a")})]})]}),u.jsxs("div",{className:"flex gap-2 ml-4",children:[v.isApproved!==!0&&u.jsx("button",{onClick:()=>h(v.id),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors",children:"Approve"}),u.jsx("button",{onClick:()=>m(v.id),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:v.isApproved===!0?"Delete":"Reject"})]})]})},v.id))})}),a&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-start mb-4",children:[u.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Review Details"}),u.jsx("button",{onClick:()=>l(null),className:"text-slate-400 hover:text-slate-600",children:""})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"font-medium",children:a.customerName}),u.jsx("div",{className:"flex items-center",children:p(a.rating)}),x(a)]}),a.serviceName&&u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Service: "}),u.jsx("span",{children:a.serviceName})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Email: "}),u.jsx("span",{children:a.customerEmail})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Date: "}),u.jsx("span",{children:a.createdAt&&nt(a.createdAt.toDate(),"MMM d, yyyy 'at' h:mm a")})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Review: "}),u.jsxs("blockquote",{className:"mt-1 text-slate-700 italic",children:['"',a.comment,'"']})]})]}),u.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t",children:[a.isApproved!==!0&&u.jsx("button",{onClick:()=>{h(a.id),l(null)},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"Approve Review"}),u.jsx("button",{onClick:()=>{m(a.id),l(null)},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:a.isApproved===!0?"Delete Review":"Reject Review"}),u.jsx("button",{onClick:()=>l(null),className:"px-4 py-2 bg-slate-300 text-slate-700 rounded hover:bg-slate-400 transition-colors",children:"Cancel"})]})]})})})]})}class JF{constructor(e,n){this.db=e,n&&typeof window<"u"&&(this.messaging=R1(n))}async sendMessage(e){const n={...e,timestamp:Ze(),read:!1};return(await sc(pe(this.db,"messages"),n)).id}async getMessages(e,n=50){const r=Ne(pe(this.db,"messages"),Pe("customerId","==",e),Ct("timestamp","desc"),bi(n));return(await In(r)).docs.map(i=>({id:i.id,...i.data()}))}subscribeToMessages(e,n){const r=Ne(pe(this.db,"messages"),Pe("customerId","==",e),Ct("timestamp","asc"));return Qe(r,s=>{const i=s.docs.map(o=>({id:o.id,...o.data()}));n(i)})}async markMessagesAsRead(e,n){const r=Ne(pe(this.db,"messages"),Pe("customerId","==",e),Pe("type","==","customer"),Pe("read","==",!1)),i=(await In(r)).docs.map(o=>Gn(o.ref,{read:!0,readBy:n,readAt:Ze()}));await Promise.all(i)}async getConversations(){const e=Ne(pe(this.db,"conversations"),Ct("lastMessageTime","desc"));return(await In(e)).docs.map(r=>({id:r.id,...r.data()}))}subscribeToConversations(e){const n=Ne(pe(this.db,"conversations"),Ct("lastMessageTime","desc"));return Qe(n,r=>{const s=r.docs.map(i=>({id:i.id,...i.data()}));e(s)})}async updateConversation(e,n){const r=be(this.db,"conversations",e);await Gn(r,{lastMessage:n.content,lastMessageTime:Ze(),unreadCount:n.type==="customer"?await this.getUnreadCount(e)+1:0,status:"active"}).catch(async()=>{await sc(pe(this.db,"conversations"),{customerId:e,customerName:n.customerName,customerEmail:n.customerEmail,lastMessage:n.content,lastMessageTime:Ze(),unreadCount:n.type==="customer"?1:0,status:"active",appointmentId:n.appointmentId})})}async getUnreadCount(e){const n=Ne(pe(this.db,"messages"),Pe("customerId","==",e),Pe("type","==","customer"),Pe("read","==",!1));return(await In(n)).size}async requestNotificationPermission(){if(!this.messaging)return null;try{if(await Notification.requestPermission()==="granted")return await OL(this.messaging,{vapidKey:void 0})}catch(e){console.error("Error getting FCM token:",e)}return null}onMessage(e){return this.messaging?ML(this.messaging,e):()=>{}}async saveCustomerToken(e,n){const r=be(this.db,"customer_tokens",e);await Gn(r,{token:n,updatedAt:Ze()}).catch(async()=>{await sc(pe(this.db,"customer_tokens"),{customerId:e,token:n,createdAt:Ze(),updatedAt:Ze()})})}}const Qw=t=>{if(!t)return"";const e=t.toDate?t.toDate():new Date(t),r=(new Date().getTime()-e.getTime())/(1e3*60*60);return r<1?"Just now":r<24?`${Math.floor(r)}h ago`:r<168?`${Math.floor(r/24)}d ago`:e.toLocaleDateString()};function ZF({className:t=""}){const[e,n]=_.useState([]),[r,s]=_.useState(null),[i,o]=_.useState([]),[a,l]=_.useState(""),[d,h]=_.useState(null),[m,p]=_.useState(!0);_.useEffect(()=>{const{db:v,app:C}=Xe(),A=new JF(v,C);h(A);const T=A.subscribeToConversations(y=>{n(y),p(!1)});return()=>{T()}},[]),_.useEffect(()=>{if(!r||!d)return;const v=d.subscribeToMessages(r,C=>{o(C),d.markMessagesAsRead(r,"admin")});return()=>{v()}},[r,d]);const x=async()=>{if(!a.trim()||!r||!d)return;const v=e.find(C=>C.id===r);if(v)try{await d.sendMessage({customerId:r,customerName:v.customerName,customerEmail:v.customerEmail,adminId:"admin",adminName:"Admin",content:a.trim(),type:"admin",priority:"medium"}),await d.updateConversation(r,{content:a.trim(),type:"admin"}),l("")}catch(C){console.error("Error sending message:",C)}};return m?u.jsx("div",{className:`flex items-center justify-center h-64 ${t}`,children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):u.jsxs("div",{className:`flex h-full bg-white rounded-lg shadow ${t}`,children:[u.jsxs("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[u.jsx("div",{className:"p-4 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Customer Messages"})}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:e.length===0?u.jsx("div",{className:"p-4 text-center text-gray-500",children:"No conversations yet"}):e.map(v=>u.jsx("div",{onClick:()=>s(v.id),className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${r===v.id?"bg-blue-50 border-blue-200":""}`,children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:v.customerName}),u.jsx("p",{className:"text-xs text-gray-500 truncate",children:v.customerEmail}),v.lastMessage&&u.jsx("p",{className:"text-sm text-gray-600 mt-1 truncate",children:v.lastMessage})]}),u.jsxs("div",{className:"flex flex-col items-end ml-2",children:[v.unreadCount>0&&u.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:v.unreadCount}),u.jsx("span",{className:"text-xs text-gray-400 mt-1",children:v.lastMessageTime&&Qw(v.lastMessageTime)})]})]})},v.id))})]}),u.jsx("div",{className:"flex-1 flex flex-col",children:r?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"p-4 border-b border-gray-200",children:(()=>{const v=e.find(C=>C.id===r);return v?u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:v.customerName}),u.jsx("p",{className:"text-sm text-gray-500",children:v.customerEmail})]}):null})()}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:i.length===0?u.jsx("div",{className:"text-center text-gray-500 py-8",children:"No messages yet. Start the conversation!"}):i.map(v=>u.jsx("div",{className:`flex ${v.type==="admin"?"justify-end":"justify-start"}`,children:u.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${v.type==="admin"?"bg-blue-600 text-white":"bg-gray-200 text-gray-900"}`,children:[u.jsx("p",{className:"text-sm",children:v.content}),u.jsx("p",{className:`text-xs mt-1 ${v.type==="admin"?"text-blue-100":"text-gray-500"}`,children:Qw(v.timestamp)})]})},v.id))}),u.jsx("div",{className:"p-4 border-t border-gray-200",children:u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("input",{type:"text",value:a,onChange:v=>l(v.target.value),onKeyPress:v=>v.key==="Enter"&&x(),placeholder:"Type your message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),u.jsx("button",{onClick:x,disabled:!a.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})})]}):u.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Select a conversation to start messaging"})})]})}function eU(){return u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Customer Messages"}),u.jsx("p",{className:"text-gray-600 mt-1",children:"Communicate with your customers and provide support"})]}),u.jsx("div",{className:"h-[calc(100vh-200px)]",children:u.jsx(ZF,{})})]})}function tU({className:t=""}){const[e,n]=_.useState([]),[r,s]=_.useState([]),[i,o]=_.useState(null),[a,l]=_.useState(""),[d,h]=_.useState(!0),[m,p]=_.useState(!1),{db:x,functions:v}=Xe();_.useEffect(()=>{const N=Ne(pe(x,"sms_conversations"),Ct("timestamp","desc"),bi(100)),j=Qe(N,E=>{const I=E.docs.map(k=>({id:k.id,...k.data()}));n(I),h(!1)}),D=Ne(pe(x,"customers"),Pe("phone","!=",null)),b=Qe(D,E=>{const I=E.docs.map(k=>({id:k.id,...k.data()}));s(I)});return()=>{j(),b()}},[x]);const C=N=>r.find(j=>j.phone===N),A=()=>{const N=new Set;return e.forEach(j=>{j.phoneNumber&&N.add(j.phoneNumber)}),Array.from(N)},T=N=>e.filter(j=>j.phoneNumber===N).sort((j,D)=>{var b,E,I,k;return new Date(((E=(b=j.timestamp)==null?void 0:b.toDate)==null?void 0:E.call(b))||j.timestamp).getTime()-new Date(((k=(I=D.timestamp)==null?void 0:I.toDate)==null?void 0:k.call(I))||D.timestamp).getTime()}),y=async()=>{if(!(!a.trim()||!i||m)){p(!0);try{const N=r.find(b=>b.id===i);if(!(N!=null&&N.phone))throw new Error("Customer phone number not found");if((await v.httpsCallable("sendSMSToCustomer")({phoneNumber:N.phone,message:a.trim(),customerId:i})).data.success)l("");else throw new Error("Failed to send SMS")}catch(N){console.error("Error sending SMS:",N),alert("Failed to send SMS. Please try again.")}finally{p(!1)}}},w=N=>{if(!N)return"";const j=N.toDate?N.toDate():new Date(N),b=(new Date().getTime()-j.getTime())/(1e3*60*60);return b<1?"Just now":b<24?`${Math.floor(b)}h ago`:b<168?`${Math.floor(b/24)}d ago`:j.toLocaleDateString()};return d?u.jsx("div",{className:`flex items-center justify-center h-64 ${t}`,children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):u.jsxs("div",{className:`flex h-full bg-white rounded-lg shadow ${t}`,children:[u.jsxs("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[u.jsxs("div",{className:"p-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"SMS Conversations"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Customer text messages"})]}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:A().length===0?u.jsx("div",{className:"p-4 text-center text-gray-500",children:"No SMS conversations yet"}):A().map(N=>{const j=C(N),D=T(N),b=D[D.length-1],E=D.filter(I=>I.direction==="inbound"&&!I.read).length;return u.jsx("div",{onClick:()=>o((j==null?void 0:j.id)||null),className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${i===(j==null?void 0:j.id)?"bg-blue-50 border-blue-200":""}`,children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:(j==null?void 0:j.name)||"SMS Customer"}),u.jsx("p",{className:"text-xs text-gray-500 truncate",children:N}),b&&u.jsx("p",{className:"text-sm text-gray-600 mt-1 truncate",children:b.message})]}),u.jsxs("div",{className:"flex flex-col items-end ml-2",children:[E>0&&u.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:E}),u.jsx("span",{className:"text-xs text-gray-400 mt-1",children:b&&w(b.timestamp)})]})]})},N)})})]}),u.jsx("div",{className:"flex-1 flex flex-col",children:i?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"p-4 border-b border-gray-200",children:(()=>{const N=r.find(j=>j.id===i);return N?u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:N.name}),u.jsx("p",{className:"text-sm text-gray-500",children:N.phone})]}):null})()}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:(()=>{const N=r.find(D=>D.id===i);if(!N)return null;const j=T(N.phone);return j.length===0?u.jsx("div",{className:"text-center text-gray-500 py-8",children:"No messages yet. Start the conversation!"}):j.map(D=>u.jsx("div",{className:`flex ${D.direction==="outbound"?"justify-end":"justify-start"}`,children:u.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${D.direction==="outbound"?"bg-blue-600 text-white":"bg-gray-200 text-gray-900"}`,children:[u.jsx("p",{className:"text-sm",children:D.message}),u.jsx("p",{className:`text-xs mt-1 ${D.direction==="outbound"?"text-blue-100":"text-gray-500"}`,children:w(D.timestamp)})]})},D.id))})()}),u.jsxs("div",{className:"p-4 border-t border-gray-200",children:[u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("input",{type:"text",value:a,onChange:N=>l(N.target.value),onKeyPress:N=>N.key==="Enter"&&y(),placeholder:"Type your SMS message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),u.jsx("button",{onClick:y,disabled:!a.trim()||m,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Sending...":"Send SMS"})]}),u.jsx("p",{className:"text-xs text-gray-500 mt-2",children:" SMS messages are sent via Twilio. Standard messaging rates apply."})]})]}):u.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Select a conversation to view messages"})})]})}function nU(){return u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"SMS Customer Support"}),u.jsx("p",{className:"text-gray-600 mt-1",children:"Manage customer text messages and send SMS responses"}),u.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[u.jsx("h3",{className:"font-semibold text-blue-900",children:"SMS Features:"}),u.jsxs("ul",{className:"text-sm text-blue-800 mt-2 space-y-1",children:[u.jsx("li",{children:" Customers can text your business number for availability"}),u.jsx("li",{children:" Automated responses to common questions"}),u.jsx("li",{children:" Manual SMS responses from admin interface"}),u.jsx("li",{children:" Conversation history and tracking"}),u.jsx("li",{children:" Integration with appointment booking system"})]})]})]}),u.jsx("div",{className:"h-[calc(100vh-300px)]",children:u.jsx(tU,{})})]})}const rU=()=>{const{db:t}=Xe(),[e,n]=_.useState([]),[r,s]=_.useState([]),[i,o]=_.useState(null),[a,l]=_.useState(!0),[d,h]=_.useState("all");_.useEffect(()=>{const T=Ne(pe(t,"ai_sms_conversations"),Ct("timestamp","desc"),bi(100)),y=Qe(T,j=>{const D=j.docs.map(b=>({id:b.id,...b.data()}));n(D),l(!1)}),w=Ne(pe(t,"customers")),N=Qe(w,j=>{const D=j.docs.map(b=>({id:b.id,...b.data()}));s(D)});return()=>{y(),N()}},[]);const m=T=>{const y=r.find(w=>w.id===T);return(y==null?void 0:y.name)||"Unknown Customer"},p=T=>{const y=r.find(w=>w.id===T);return(y==null?void 0:y.phone)||"Unknown Phone"},v=e.filter(T=>!(i&&T.customerId!==i||d!=="all"&&T.direction!==d)).reduce((T,y)=>{const w=y.customerId;return T[w]||(T[w]=[]),T[w].push(y),T},{}),C=T=>T?(T.toDate?T.toDate():new Date(T)).toLocaleString():"Unknown time",A=T=>T.direction==="outbound"?T.smsSent?" Sent":" Failed":" Received";return a?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"AI SMS Conversations"}),u.jsx("p",{className:"text-gray-600",children:"Monitor AI-powered customer interactions"})]}),u.jsxs("div",{className:"flex space-x-4",children:[u.jsxs("select",{value:d,onChange:T=>h(T.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"all",children:"All Messages"}),u.jsx("option",{value:"inbound",children:"Inbound Only"}),u.jsx("option",{value:"outbound",children:"Outbound Only"})]}),u.jsxs("select",{value:i||"",onChange:T=>o(T.target.value||null),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"All Customers"}),r.map(T=>u.jsxs("option",{value:T.id,children:[T.name," (",T.phone,")"]},T.id))]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[u.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.length}),u.jsx("div",{className:"text-gray-600",children:"Total Messages"})]}),u.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[u.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(T=>T.direction==="inbound").length}),u.jsx("div",{className:"text-gray-600",children:"Inbound"})]}),u.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[u.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.filter(T=>T.direction==="outbound").length}),u.jsx("div",{className:"text-gray-600",children:"AI Responses"})]}),u.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[u.jsx("div",{className:"text-2xl font-bold text-orange-600",children:Object.keys(v).length}),u.jsx("div",{className:"text-gray-600",children:"Active Customers"})]})]}),u.jsx("div",{className:"space-y-4",children:Object.entries(v).map(([T,y])=>{var w;return u.jsxs("div",{className:"bg-white rounded-lg shadow",children:[u.jsx("div",{className:"p-4 border-b border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-900",children:m(T)}),u.jsxs("p",{className:"text-sm text-gray-600",children:[p(T),"  ",y.length," messages"]})]}),u.jsxs("div",{className:"text-sm text-gray-500",children:["Last: ",C((w=y[0])==null?void 0:w.timestamp)]})]})}),u.jsx("div",{className:"p-4 space-y-3",children:y.sort((N,j)=>{var D,b,E,I,k,R;return((E=(b=(D=N.timestamp)==null?void 0:D.toDate)==null?void 0:b.call(D))==null?void 0:E.getTime())-((R=(k=(I=j.timestamp)==null?void 0:I.toDate)==null?void 0:k.call(I))==null?void 0:R.getTime())}).map(N=>u.jsx("div",{className:`flex ${N.direction==="inbound"?"justify-start":"justify-end"}`,children:u.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${N.direction==="inbound"?"bg-gray-100 text-gray-900":"bg-blue-600 text-white"}`,children:[u.jsx("div",{className:"text-sm",children:N.message}),u.jsxs("div",{className:`text-xs mt-1 ${N.direction==="inbound"?"text-gray-500":"text-blue-100"}`,children:[C(N.timestamp),"  ",A(N)]})]})},N.id))})]},T)})}),Object.keys(v).length===0&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx("div",{className:"text-gray-500 text-lg",children:"No AI conversations found"}),u.jsx("div",{className:"text-gray-400 text-sm mt-2",children:"AI conversations will appear here when customers text your business number"})]})]})},sU=()=>u.jsx("div",{className:"p-6",children:u.jsx(rU,{})});function iU(){const[t,e]=_.useState([]),[n,r]=_.useState(!0),[s,i]=_.useState(null),[o,a]=_.useState("all");_.useEffect(()=>{const m=Qc(),p=Ne(pe(m,"skinAnalyses"),Ct("createdAt","desc")),x=Qe(p,v=>{const C=v.docs.map(A=>({...A.data(),id:A.id}));e(C),r(!1)});return()=>x()},[]);const l=async m=>{if(confirm("Are you sure you want to delete this analysis?"))try{const p=Qc();await Ul(be(p,"skinAnalyses",m)),i(null)}catch(p){console.error("Error deleting analysis:",p),alert("Failed to delete analysis")}},d=t.filter(m=>o==="all"||m.type===o),h=m=>m?(m.toDate?m.toDate():new Date(m)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown";return n?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"text-lg text-slate-600",children:"Loading analyses..."})}):u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Skin Analyses"}),u.jsx("p",{className:"text-slate-600",children:"View all customer skin and product analyses powered by AI"})]}),u.jsxs("div",{className:"mb-6 flex gap-2",children:[u.jsxs("button",{onClick:()=>a("all"),className:`px-4 py-2 rounded-lg transition-colors ${o==="all"?"bg-terracotta text-white":"bg-white border border-gray-300 hover:bg-gray-50"}`,children:["All (",t.length,")"]}),u.jsxs("button",{onClick:()=>a("skin"),className:`px-4 py-2 rounded-lg transition-colors ${o==="skin"?"bg-terracotta text-white":"bg-white border border-gray-300 hover:bg-gray-50"}`,children:["Skin Analysis (",t.filter(m=>m.type==="skin").length,")"]}),u.jsxs("button",{onClick:()=>a("products"),className:`px-4 py-2 rounded-lg transition-colors ${o==="products"?"bg-terracotta text-white":"bg-white border border-gray-300 hover:bg-gray-50"}`,children:["Product Analysis (",t.filter(m=>m.type==="products").length,")"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Total Analyses"}),u.jsx("div",{className:"text-2xl font-bold text-terracotta",children:t.length})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Completed"}),u.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.filter(m=>m.status==="completed").length})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Pending"}),u.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.filter(m=>m.status==="pending").length})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Errors"}),u.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.filter(m=>m.status==="error").length})]})]}),u.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:d.length===0?u.jsx("div",{className:"p-8 text-center text-slate-600",children:"No analyses found"}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(m=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:h(m.createdAt)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${m.type==="skin"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:m.type==="skin"?" Skin":" Products"})}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[u.jsx("div",{children:m.customerName||"Guest"}),m.customerEmail&&u.jsx("div",{className:"text-xs text-slate-500",children:m.customerEmail})]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${m.status==="completed"?"bg-green-100 text-green-800":m.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:m.status})}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[u.jsx("button",{onClick:()=>i(m),className:"text-terracotta hover:underline mr-3",children:"View"}),u.jsx("button",{onClick:()=>l(m.id),className:"text-red-600 hover:underline",children:"Delete"})]})]},m.id))})]})})}),s&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[u.jsx("h2",{className:"text-2xl font-bold",children:s.type==="skin"?"Skin Analysis":"Product Analysis"}),u.jsx("button",{onClick:()=>i(null),className:"text-slate-400 hover:text-slate-600",children:""})]}),u.jsxs("div",{className:"p-6 space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2",children:"Customer Information"}),u.jsxs("div",{className:"bg-gray-50 rounded p-3 text-sm",children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Name:"})," ",s.customerName||"N/A"]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Email:"})," ",s.customerEmail||"N/A"]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Date:"})," ",h(s.createdAt)]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Status:"})," ",u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2",children:"Uploaded Image"}),u.jsx("img",{src:s.imageUrl,alt:"Analysis",className:"max-h-64 rounded-lg border"})]}),s.status==="completed"&&s.analysis&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2",children:"Summary"}),u.jsx("div",{className:"bg-terracotta/10 rounded p-4",children:s.analysis.summary})]}),s.analysis.skinType&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2",children:"Skin Type"}),u.jsx("div",{className:"inline-block px-4 py-2 bg-green-100 text-green-800 rounded-full font-semibold",children:s.analysis.skinType})]}),s.type==="skin"&&s.analysis.skinTone&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-3",children:"Skin Tone Analysis"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[u.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[u.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Category"}),u.jsx("div",{className:"font-semibold",children:s.analysis.skinTone.category})]}),u.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[u.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Undertone"}),u.jsx("div",{className:"font-semibold",children:s.analysis.skinTone.undertone})]}),u.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[u.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Fitzpatrick Scale"}),u.jsxs("div",{className:"font-semibold",children:["Type ",s.analysis.skinTone.fitzpatrickScale]})]}),s.analysis.skinTone.hexColor&&u.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[u.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-6 h-6 rounded border",style:{backgroundColor:s.analysis.skinTone.hexColor}}),u.jsx("div",{className:"font-mono text-xs",children:s.analysis.skinTone.hexColor})]})]})]})]}),s.type==="skin"&&s.analysis.foundationMatch&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-3",children:"Foundation Matching"}),u.jsxs("div",{className:"border rounded-lg p-4 bg-pink-50",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Shade Range"}),u.jsx("div",{className:"font-semibold",children:s.analysis.foundationMatch.shadeRange})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Undertone"}),u.jsx("div",{className:"font-semibold",children:s.analysis.foundationMatch.undertoneRecommendation})]})]}),s.analysis.foundationMatch.popularBrands&&s.analysis.foundationMatch.popularBrands.length>0&&u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-600 mb-2 font-semibold",children:"Brand Recommendations"}),u.jsx("div",{className:"space-y-2",children:s.analysis.foundationMatch.popularBrands.map((m,p)=>u.jsxs("div",{className:"bg-white rounded p-2",children:[u.jsx("div",{className:"font-semibold text-sm",children:m.brand}),u.jsx("div",{className:"text-xs text-slate-600",children:m.shades.join(", ")})]},p))})]})]})]}),s.type==="skin"&&s.analysis.facialFeatures&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-3",children:"Facial Features"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[s.analysis.facialFeatures.faceShape&&u.jsxs("div",{className:"border rounded p-3 bg-blue-50",children:[u.jsx("div",{className:"text-xs text-slate-600",children:"Face Shape"}),u.jsx("div",{className:"font-semibold",children:s.analysis.facialFeatures.faceShape})]}),s.analysis.facialFeatures.browShape&&u.jsxs("div",{className:"border rounded p-3 bg-blue-50",children:[u.jsx("div",{className:"text-xs text-slate-600",children:"Brow Shape"}),u.jsx("div",{className:"font-semibold",children:s.analysis.facialFeatures.browShape})]}),s.analysis.facialFeatures.eyeShape&&u.jsxs("div",{className:"border rounded p-3 bg-blue-50",children:[u.jsx("div",{className:"text-xs text-slate-600",children:"Eye Shape"}),u.jsx("div",{className:"font-semibold",children:s.analysis.facialFeatures.eyeShape})]}),s.analysis.facialFeatures.lipShape&&u.jsxs("div",{className:"border rounded p-3 bg-blue-50",children:[u.jsx("div",{className:"text-xs text-slate-600",children:"Lip Shape"}),u.jsx("div",{className:"font-semibold",children:s.analysis.facialFeatures.lipShape})]})]})]}),s.analysis.detailedReport&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-3",children:"Detailed Report"}),u.jsx("div",{className:"border rounded-lg p-4 bg-slate-50",children:u.jsx("p",{className:"text-sm whitespace-pre-line text-slate-700",children:s.analysis.detailedReport})})]}),s.analysis.concerns&&s.analysis.concerns.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2",children:"Concerns"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:s.analysis.concerns.map((m,p)=>u.jsx("span",{className:"px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm",children:m},p))})]}),s.analysis.recommendations&&s.analysis.recommendations.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-2",children:"Recommendations"}),u.jsx("ul",{className:"space-y-2",children:s.analysis.recommendations.map((m,p)=>u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx("span",{className:"text-terracotta mt-1",children:""}),u.jsx("span",{children:m})]},p))})]}),s.type==="products"&&s.analysis.productAnalysis&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-3",children:"Product Routine"}),s.analysis.productAnalysis.products&&u.jsx("div",{className:"space-y-3 mb-4",children:s.analysis.productAnalysis.products.sort((m,p)=>m.order-p.order).map((m,p)=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-terracotta text-white rounded-full flex items-center justify-center font-bold",children:m.order}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"font-semibold mb-1",children:m.name}),u.jsx("p",{className:"text-sm text-slate-600 mb-2",children:m.usage}),u.jsx("div",{className:"inline-block px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:m.suitability})]})]})},p))}),s.analysis.productAnalysis.routine&&u.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[u.jsx("h4",{className:"font-semibold mb-2",children:"Complete Routine"}),u.jsx("p",{className:"text-sm whitespace-pre-line",children:s.analysis.productAnalysis.routine})]})]}),s.analysis.recommendedServices&&s.analysis.recommendedServices.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold mb-3",children:"Recommended Services"}),u.jsx("div",{className:"space-y-3",children:s.analysis.recommendedServices.map((m,p)=>u.jsxs("div",{className:"border border-terracotta rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-start justify-between mb-2",children:[u.jsx("h4",{className:"font-semibold text-terracotta",children:m.serviceName}),u.jsx("span",{className:"text-sm text-slate-600 bg-slate-100 px-2 py-1 rounded",children:m.frequency})]}),u.jsx("p",{className:"text-sm text-slate-700",children:m.reason})]},p))})]})]})]}),u.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t px-6 py-4 flex justify-end gap-3",children:[u.jsx("button",{onClick:()=>l(s.id),className:"px-4 py-2 border border-red-600 text-red-600 rounded-lg hover:bg-red-50",children:"Delete"}),u.jsx("button",{onClick:()=>i(null),className:"px-4 py-2 bg-terracotta text-white rounded-lg hover:bg-terracotta/90",children:"Close"})]})]})})]})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="firebasestorage.googleapis.com",jI="storageBucket",oU=2*60*1e3,aU=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We extends Mn{constructor(e,n,r=0){super(Pf(e),`Firebase Storage: ${n} (${Pf(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,We.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ze;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ze||(ze={}));function Pf(t){return"storage/"+t}function pv(){const t="An unknown error occurred, please check the error payload for server response.";return new We(ze.UNKNOWN,t)}function lU(t){return new We(ze.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function uU(t){return new We(ze.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function cU(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new We(ze.UNAUTHENTICATED,t)}function dU(){return new We(ze.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function hU(t){return new We(ze.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function fU(){return new We(ze.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function mU(){return new We(ze.CANCELED,"User canceled the upload/download.")}function pU(t){return new We(ze.INVALID_URL,"Invalid URL '"+t+"'.")}function gU(t){return new We(ze.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function vU(){return new We(ze.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+jI+"' property when initializing the app?")}function yU(){return new We(ze.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function _U(){return new We(ze.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function wU(t){return new We(ze.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function hp(t){return new We(ze.INVALID_ARGUMENT,t)}function DI(){return new We(ze.APP_DELETED,"The Firebase app was deleted.")}function xU(t){return new We(ze.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function za(t,e){return new We(ze.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ua(t){throw new We(ze.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=rn.makeFromUrl(e,n)}catch{return new rn(e,"")}if(r.path==="")return r;throw gU(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function d(N){N.path_=decodeURIComponent(N.path)}const h="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",x=new RegExp(`^https?://${m}/${h}/b/${s}/o${p}`,"i"),v={bucket:1,path:3},C=n===RI?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",T=new RegExp(`^https?://${C}/${s}/${A}`,"i"),w=[{regex:a,indices:l,postModify:i},{regex:x,indices:v,postModify:d},{regex:T,indices:{bucket:1,path:2},postModify:d}];for(let N=0;N<w.length;N++){const j=w[N],D=j.regex.exec(e);if(D){const b=D[j.indices.bucket];let E=D[j.indices.path];E||(E=""),r=new rn(b,E),j.postModify(r);break}}if(r==null)throw pU(e);return r}}class EU{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TU(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let d=!1;function h(...A){d||(d=!0,e.apply(null,A))}function m(A){s=setTimeout(()=>{s=null,t(x,l())},A)}function p(){i&&clearTimeout(i)}function x(A,...T){if(d){p();return}if(A){p(),h.call(null,A,...T);return}if(l()||o){p(),h.call(null,A,...T);return}r<64&&(r*=2);let w;a===1?(a=2,w=0):w=(r+Math.random())*1e3,m(w)}let v=!1;function C(A){v||(v=!0,p(),!d&&(s!==null?(A||(a=2),clearTimeout(s),m(0)):A||(a=1)))}return m(0),i=setTimeout(()=>{o=!0,C(!0)},n),C}function bU(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SU(t){return t!==void 0}function IU(t){return typeof t=="object"&&!Array.isArray(t)}function gv(t){return typeof t=="string"||t instanceof String}function Yw(t){return vv()&&t instanceof Blob}function vv(){return typeof Blob<"u"}function Xw(t,e,n,r){if(r<e)throw hp(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw hp(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function OI(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ri;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ri||(ri={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NU(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CU{constructor(e,n,r,s,i,o,a,l,d,h,m,p=!0,x=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=m,this.retry=p,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,C)=>{this.resolve_=v,this.reject_=C,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Fu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===ri.NO_ERROR,l=i.getStatus();if(!a||NU(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===ri.ABORT;r(!1,new Fu(!1,null,h));return}const d=this.successCodes_.indexOf(l)!==-1;r(!0,new Fu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());SU(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=pv();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?DI():mU();o(l)}else{const l=fU();o(l)}};this.canceled_?n(!1,new Fu(!1,null,!0)):this.backoffId_=TU(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&bU(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Fu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function kU(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function AU(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function PU(t,e){e&&(t["X-Firebase-GMPID"]=e)}function RU(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function jU(t,e,n,r,s,i,o=!0,a=!1){const l=OI(t.urlParams),d=t.url+l,h=Object.assign({},t.headers);return PU(h,e),kU(h,n),AU(h,i),RU(h,r),new CU(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DU(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function OU(...t){const e=DU();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(vv())return new Blob(t);throw new We(ze.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function MU(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(t){if(typeof atob>"u")throw wU("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Rf{constructor(e,n){this.data=e,this.contentType=n||null}}function VU(t,e){switch(t){case zn.RAW:return new Rf(MI(e));case zn.BASE64:case zn.BASE64URL:return new Rf(LI(t,e));case zn.DATA_URL:return new Rf(UU(e),$U(e))}throw pv()}function MI(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function FU(t){let e;try{e=decodeURIComponent(t)}catch{throw za(zn.DATA_URL,"Malformed data URL.")}return MI(e)}function LI(t,e){switch(t){case zn.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw za(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case zn.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw za(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=LU(e)}catch(s){throw s.message.includes("polyfill")?s:za(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class VI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw za(zn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=BU(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function UU(t){const e=new VI(t);return e.base64?LI(zn.BASE64,e.rest):FU(e.rest)}function $U(t){return new VI(t).contentType}function BU(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,n){let r=0,s="";Yw(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(Yw(this.data_)){const r=this.data_,s=MU(r,e,n);return s===null?null:new Xr(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Xr(r,!0)}}static getBlob(...e){if(vv()){const n=e.map(r=>r instanceof Xr?r.data_:r);return new Xr(OU.apply(null,n))}else{const n=e.map(o=>gv(o)?VU(zn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Xr(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(t){let e;try{e=JSON.parse(t)}catch{return null}return IU(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zU(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function WU(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function UI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HU(t,e){return e}class Ot{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||HU}}let Uu=null;function qU(t){return!gv(t)||t.length<2?t:UI(t)}function $I(){if(Uu)return Uu;const t=[];t.push(new Ot("bucket")),t.push(new Ot("generation")),t.push(new Ot("metageneration")),t.push(new Ot("name","fullPath",!0));function e(i,o){return qU(o)}const n=new Ot("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Ot("size");return s.xform=r,t.push(s),t.push(new Ot("timeCreated")),t.push(new Ot("updated")),t.push(new Ot("md5Hash",null,!0)),t.push(new Ot("cacheControl",null,!0)),t.push(new Ot("contentDisposition",null,!0)),t.push(new Ot("contentEncoding",null,!0)),t.push(new Ot("contentLanguage",null,!0)),t.push(new Ot("contentType",null,!0)),t.push(new Ot("metadata","customMetadata",!0)),Uu=t,Uu}function GU(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new rn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function KU(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return GU(r,t),r}function BI(t,e,n){const r=FI(e);return r===null?null:KU(t,r,n)}function QU(t,e,n,r){const s=FI(e);if(s===null||!gv(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,m=t.fullPath,p="/b/"+o(h)+"/o/"+o(m),x=yv(p,n,r),v=OI({alt:"media",token:d});return x+v})[0]}function YU(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class zI{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(t){if(!t)throw pv()}function XU(t,e){function n(r,s){const i=BI(t,s,e);return WI(i!==null),i}return n}function JU(t,e){function n(r,s){const i=BI(t,s,e);return WI(i!==null),QU(i,s,t.host,t._protocol)}return n}function HI(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=dU():s=cU():n.getStatus()===402?s=uU(t.bucket):n.getStatus()===403?s=hU(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function ZU(t){const e=HI(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=lU(t.path)),i.serverResponse=s.serverResponse,i}return n}function e5(t,e,n){const r=e.fullServerUrl(),s=yv(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new zI(s,i,JU(t,n),o);return a.errorHandler=ZU(e),a}function t5(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function n5(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=t5(null,e)),r}function r5(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let N=0;N<2;N++)w=w+Math.random().toString().slice(2);return w}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const d=n5(e,r,s),h=YU(d,n),m="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+l+"--",x=Xr.getBlob(m,r,p);if(x===null)throw yU();const v={name:d.fullPath},C=yv(i,t.host,t._protocol),A="POST",T=t.maxUploadRetryTime,y=new zI(C,A,XU(t,n),T);return y.urlParams=v,y.headers=o,y.body=x.uploadData(),y.errorHandler=HI(e),y}class s5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ri.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ri.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ri.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw ua("cannot .send() more than once");if(Pr(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ua("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ua("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ua("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ua("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class i5 extends s5{initXhr(){this.xhr_.responseType="text"}}function qI(){return new i5}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,n){this._service=e,n instanceof rn?this._location=n:this._location=rn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new vi(e,n)}get root(){const e=new rn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return UI(this._location.path)}get storage(){return this._service}get parent(){const e=zU(this._location.path);if(e===null)return null;const n=new rn(this._location.bucket,e);return new vi(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw xU(e)}}function o5(t,e,n){t._throwIfRoot("uploadBytes");const r=r5(t.storage,t._location,$I(),new Xr(e,!0),n);return t.storage.makeRequestWithTokens(r,qI).then(s=>({metadata:s,ref:t}))}function a5(t){t._throwIfRoot("getDownloadURL");const e=e5(t.storage,t._location,$I());return t.storage.makeRequestWithTokens(e,qI).then(n=>{if(n===null)throw _U();return n})}function l5(t,e){const n=WU(t._location.path,e),r=new rn(t._location.bucket,n);return new vi(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u5(t){return/^[A-Za-z]+:\/\//.test(t)}function c5(t,e){return new vi(t,e)}function GI(t,e){if(t instanceof _v){const n=t;if(n._bucket==null)throw vU();const r=new vi(n,n._bucket);return e!=null?GI(r,e):r}else return e!==void 0?l5(t,e):t}function d5(t,e){if(e&&u5(e)){if(t instanceof _v)return c5(t,e);throw hp("To use ref(service, url), the first argument must be a Storage instance.")}else return GI(t,e)}function Jw(t,e){const n=e==null?void 0:e[jI];return n==null?null:rn.makeFromBucketSpec(n,t)}function h5(t,e,n,r={}){t.host=`${e}:${n}`;const s=Pr(e);s&&(kd(`https://${t.host}/b`),Ad("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:OT(i,t.app.options.projectId))}class _v{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=RI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=oU,this._maxUploadRetryTime=aU,this._requests=new Set,s!=null?this._bucket=rn.makeFromBucketSpec(s,this._host):this._bucket=Jw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=rn.makeFromBucketSpec(this._url,e):this._bucket=Jw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Xw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Xw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(en(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new vi(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new EU(DI());{const o=jU(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const Zw="@firebase/storage",ex="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KI="storage";function tx(t,e,n){return t=ye(t),o5(t,e,n)}function nx(t){return t=ye(t),a5(t)}function rx(t,e){return t=ye(t),d5(t,e)}function sx(t=Cl(),e){t=ye(t);const r=Ps(t,KI).getImmediate({identifier:e}),s=cg("storage");return s&&f5(r,...s),r}function f5(t,e,n,r={}){h5(t,e,n,r)}function m5(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new _v(n,r,s,e,xi)}function p5(){_n(new ln(KI,m5,"PUBLIC").setMultipleInstances(!0)),kt(Zw,ex,""),kt(Zw,ex,"esm2017")}p5();function g5(){const{db:t}=Xe(),[e,n]=_.useState("business"),[r,s]=_.useState(null),[i,o]=_.useState(null),[a,l]=_.useState(null),[d,h]=_.useState(null);_.useEffect(()=>LF(t,s),[]),_.useEffect(()=>AI(t,o),[]),_.useEffect(()=>UF(t,l),[]),_.useEffect(()=>BF(t,h),[]);const m=[{id:"business",label:"Business Info",icon:""},{id:"content",label:"Website Content",icon:""},{id:"media",label:"Media Gallery",icon:""},{id:"hours",label:"Business Hours",icon:""},{id:"analytics",label:"Analytics",icon:""}];return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"font-serif text-3xl text-slate-800",children:"Settings"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Manage your business settings and website content"})]}),u.jsx("div",{className:"border-b border-slate-200",children:u.jsx("nav",{className:"flex gap-4",children:m.map(p=>u.jsxs("button",{onClick:()=>n(p.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${e===p.id?"border-terracotta text-terracotta font-medium":"border-transparent text-slate-600 hover:text-slate-800 hover:border-slate-300"}`,children:[u.jsx("span",{children:p.icon}),u.jsx("span",{children:p.label})]},p.id))})}),u.jsxs("div",{className:"min-h-[500px]",children:[e==="business"&&u.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-6",children:[u.jsx("h2",{className:"font-serif text-xl mb-2",children:"Business Information"}),u.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Manage your business contact details and social media links"}),a?u.jsx(v5,{initial:a}):u.jsx("div",{className:"text-slate-500 text-sm",children:"Loading"})]}),e==="content"&&u.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-6",children:[u.jsx("h2",{className:"font-serif text-xl mb-2",children:"Website Content"}),u.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Customize your homepage text and promotional sections"}),d?u.jsx(_5,{initial:d}):u.jsx("div",{className:"text-slate-500 text-sm",children:"Loading"})]}),e==="media"&&u.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-6",children:[u.jsx("h2",{className:"font-serif text-xl mb-2",children:"Media Gallery"}),u.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Upload and manage your hero image and shop gallery photos"}),d?u.jsx(y5,{initial:d}):u.jsx("div",{className:"text-slate-500 text-sm",children:"Loading"})]}),e==="hours"&&u.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-6",children:[u.jsx("h2",{className:"font-serif text-xl mb-2",children:"Business Hours"}),u.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Set your operating hours and availability"}),i?u.jsx(E5,{initial:i}):u.jsx("div",{className:"text-slate-500 text-sm",children:"Loading"})]}),e==="analytics"&&u.jsxs("section",{className:"bg-white rounded-xl shadow-soft p-6",children:[u.jsx("h2",{className:"font-serif text-xl mb-2",children:"Analytics Targets"}),u.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Set your revenue goals and performance targets"}),r?u.jsx(w5,{initial:r}):u.jsx("div",{className:"text-slate-500 text-sm",children:"Loading"})]})]})]})}function v5({initial:t}){const{db:e}=Xe(),[n,r]=_.useState(t),[s,i]=_.useState(!1),[o,a]=_.useState("");_.useEffect(()=>{r(t)},[t]);async function l(){try{i(!0),a(""),await $F(e,n),a("Saved"),setTimeout(()=>a(""),3e3)}catch(d){a((d==null?void 0:d.message)||"Failed to save")}finally{i(!1)}}return u.jsxs("div",{className:"grid gap-4 max-w-3xl",children:[u.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Business Name"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.name,onChange:d=>r({...n,name:d.target.value})})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Phone Number"}),u.jsx("input",{type:"tel",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.phone,onChange:d=>r({...n,phone:d.target.value})})]})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Email Address"}),u.jsx("input",{type:"email",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.email,onChange:d=>r({...n,email:d.target.value})})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Street Address"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.address,onChange:d=>r({...n,address:d.target.value})})]}),u.jsxs("div",{className:"grid sm:grid-cols-3 gap-4",children:[u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"City"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.city,onChange:d=>r({...n,city:d.target.value})})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"State"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.state,onChange:d=>r({...n,state:d.target.value})})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"ZIP Code"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.zip,onChange:d=>r({...n,zip:d.target.value})})]})]}),u.jsxs("div",{className:"border-t pt-4 mt-2",children:[u.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Social Media (usernames only)"}),u.jsxs("div",{className:"grid sm:grid-cols-3 gap-4",children:[u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Instagram"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-slate-500",children:"@"}),u.jsx("input",{type:"text",className:"flex-1 border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"buenobrows",value:n.instagram||"",onChange:d=>r({...n,instagram:d.target.value})})]})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"TikTok"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-slate-500",children:"@"}),u.jsx("input",{type:"text",className:"flex-1 border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"buenobrows",value:n.tiktok||"",onChange:d=>r({...n,tiktok:d.target.value})})]})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Facebook"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"buenobrows",value:n.facebook||"",onChange:d=>r({...n,facebook:d.target.value})})]})]})]}),u.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[u.jsx("button",{className:"bg-terracotta text-white rounded-lg px-6 py-2 hover:bg-terracotta/90 transition-colors disabled:opacity-50",onClick:l,disabled:s,children:s?"Saving":"Save Business Info"}),o&&u.jsx("span",{className:`text-sm ${o==="Saved"?"text-green-600":"text-red-600"}`,children:o})]})]})}function y5({initial:t}){var y;const{db:e}=Xe(),[n,r]=_.useState(t),[s,i]=_.useState(!1),[o,a]=_.useState(""),[l,d]=_.useState(!1),[h,m]=_.useState(""),[p,x]=_.useState(!1);_.useEffect(()=>{r(t)},[t]);async function v(){try{i(!0),a(""),await PI(e,n),a("Saved"),setTimeout(()=>a(""),3e3)}catch(w){a((w==null?void 0:w.message)||"Failed to save")}finally{i(!1)}}async function C(w){var j;const N=(j=w.target.files)==null?void 0:j[0];if(N){if(!N.type.startsWith("image/")){a("Please select an image file");return}if(N.size>5*1024*1024){a("Image must be less than 5MB");return}try{d(!0),m("Uploading image..."),a("");const D=sx(),E=`hero-images/${Date.now()}-${N.name}`,I=rx(D,E);await tx(I,N),m("Getting download URL...");const k=await nx(I);r({...n,heroImageUrl:k}),m("Image uploaded successfully!"),setTimeout(()=>m(""),3e3)}catch(D){console.error("Upload error:",D),a((D==null?void 0:D.message)||"Failed to upload image")}finally{d(!1)}}}async function A(w){const N=w.target.files;if(!(!N||N.length===0)){for(const j of Array.from(N)){if(!j.type.startsWith("image/")){a("All files must be images");return}if(j.size>5*1024*1024){a(`${j.name} is too large (max 5MB)`);return}}try{x(!0),a("");const j=sx(),D=[];for(const E of Array.from(N)){const k=`gallery/${Date.now()}-${E.name}`,R=rx(j,k);await tx(R,E);const O=await nx(R);D.push(O)}const b=n.galleryPhotos||[];r({...n,galleryPhotos:[...b,...D]}),a(`Successfully uploaded ${D.length} photo${D.length>1?"s":""}`),setTimeout(()=>a(""),3e3)}catch(j){console.error("Gallery upload error:",j),a((j==null?void 0:j.message)||"Failed to upload photos")}finally{x(!1)}}}function T(w){const j=(n.galleryPhotos||[]).filter((D,b)=>b!==w);r({...n,galleryPhotos:j})}return u.jsxs("div",{className:"grid gap-8 max-w-4xl",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("h3",{className:"font-semibold text-slate-800 flex items-center gap-2 text-lg",children:[u.jsx("span",{className:"text-xl",children:""}),"Hero Image"]}),u.jsx("p",{className:"text-sm text-slate-600",children:"Upload the main image that appears at the top of your homepage"}),n.heroImageUrl&&u.jsxs("div",{className:"relative w-full h-64 rounded-lg overflow-hidden border-2 border-slate-200",children:[u.jsx("img",{src:n.heroImageUrl,alt:"Hero preview",className:"w-full h-full object-cover"}),u.jsx("button",{onClick:()=>r({...n,heroImageUrl:""}),className:"absolute top-3 right-3 bg-red-500 text-white rounded-full p-2 hover:bg-red-600 transition-colors shadow-lg",title:"Remove image",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("label",{className:"cursor-pointer",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:C,className:"hidden",disabled:l}),u.jsxs("div",{className:"bg-terracotta text-white hover:bg-terracotta/90 rounded-lg px-5 py-2.5 inline-flex items-center gap-2 transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),l?"Uploading...":n.heroImageUrl?"Change Hero Image":"Upload Hero Image"]})]}),h&&u.jsx("span",{className:"text-sm text-green-600",children:h})]}),u.jsx("span",{className:"text-xs text-slate-500",children:"Recommended: 1200x600px, max 5MB (JPG, PNG, WebP)"})]}),u.jsxs("div",{className:"space-y-4 border-t pt-8",children:[u.jsxs("h3",{className:"font-semibold text-slate-800 flex items-center gap-2 text-lg",children:[u.jsx("span",{className:"text-xl",children:""}),"Shop Photo Gallery"]}),u.jsx("p",{className:"text-sm text-slate-600",children:"Upload beautiful photos of your shop, workspace, or work samples to showcase on the homepage"}),n.galleryPhotos&&n.galleryPhotos.length>0&&u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mb-4",children:n.galleryPhotos.map((w,N)=>u.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden border-2 border-slate-200 group",children:[u.jsx("img",{src:w,alt:`Gallery ${N+1}`,className:"w-full h-full object-cover"}),u.jsx("button",{onClick:()=>T(N),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1.5 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 shadow-lg",title:"Remove photo",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},N))}),!((y=n.galleryPhotos)!=null&&y.length)&&u.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-slate-300 rounded-lg bg-slate-50",children:[u.jsx("svg",{className:"w-16 h-16 mx-auto text-slate-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),u.jsx("p",{className:"text-slate-600 font-medium",children:"No gallery photos yet"}),u.jsx("p",{className:"text-slate-500 text-sm",children:"Upload your first photos to create a beautiful gallery"})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("label",{className:"cursor-pointer",children:[u.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:A,className:"hidden",disabled:p}),u.jsxs("div",{className:"bg-terracotta text-white hover:bg-terracotta/90 rounded-lg px-5 py-2.5 inline-flex items-center gap-2 transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),p?"Uploading...":"Add Gallery Photos"]})]}),u.jsx("span",{className:"text-xs text-slate-500",children:"Select multiple photos (max 5MB each)"})]})]}),u.jsxs("div",{className:"flex items-center gap-3 pt-6 border-t",children:[u.jsx("button",{className:"bg-terracotta text-white rounded-lg px-6 py-2.5 hover:bg-terracotta/90 transition-colors disabled:opacity-50 font-medium",onClick:v,disabled:s,children:s?"Saving":"Save All Changes"}),o&&u.jsx("span",{className:`text-sm font-medium ${o.includes("Success")||o==="Saved"?"text-green-600":"text-red-600"}`,children:o})]})]})}function _5({initial:t}){const{db:e}=Xe(),[n,r]=_.useState(t),[s,i]=_.useState(!1),[o,a]=_.useState("");_.useEffect(()=>{r(t)},[t]);async function l(){try{i(!0),a(""),await PI(e,n),a("Saved"),setTimeout(()=>a(""),3e3)}catch(d){a((d==null?void 0:d.message)||"Failed to save")}finally{i(!1)}}return u.jsxs("div",{className:"grid gap-6 max-w-3xl",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("h3",{className:"font-semibold text-slate-800 flex items-center gap-2",children:[u.jsx("span",{className:"text-lg",children:""}),"Hero Section"]}),u.jsx("p",{className:"text-sm text-slate-600",children:"The main heading and subtitle for your homepage. To change the hero image, go to the Media Gallery tab."}),u.jsxs("div",{className:"grid gap-4",children:[u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Hero Title"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.heroTitle,onChange:d=>r({...n,heroTitle:d.target.value})})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Hero Subtitle"}),u.jsx("textarea",{className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",rows:2,value:n.heroSubtitle,onChange:d=>r({...n,heroSubtitle:d.target.value})})]})]})]}),u.jsxs("div",{className:"space-y-4 border-t pt-6",children:[u.jsxs("h3",{className:"font-semibold text-slate-800 flex items-center gap-2",children:[u.jsx("span",{className:"text-lg",children:""}),"Call-to-Action Buttons"]}),u.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Primary Button Text"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.ctaPrimary,onChange:d=>r({...n,ctaPrimary:d.target.value})})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Secondary Button Text"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.ctaSecondary,onChange:d=>r({...n,ctaSecondary:d.target.value})})]})]})]}),u.jsxs("div",{className:"space-y-4 border-t pt-6",children:[u.jsxs("h3",{className:"font-semibold text-slate-800 flex items-center gap-2",children:[u.jsx("span",{className:"text-lg",children:""}),"About Section"]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"About Text"}),u.jsx("textarea",{className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",rows:3,value:n.aboutText,onChange:d=>r({...n,aboutText:d.target.value})})]})]}),u.jsxs("div",{className:"space-y-4 border-t pt-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("h3",{className:"font-semibold text-slate-800 flex items-center gap-2",children:[u.jsx("span",{className:"text-lg",children:""}),"Bueno Circle (Loyalty Program)"]}),u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",className:"rounded border-slate-300 text-terracotta focus:ring-terracotta",checked:n.buenoCircleEnabled,onChange:d=>r({...n,buenoCircleEnabled:d.target.checked})}),u.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Enabled"})]})]}),n.buenoCircleEnabled&&u.jsxs("div",{className:"grid gap-4 pl-6 border-l-2 border-terracotta/30",children:[u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Section Title"}),u.jsx("input",{type:"text",className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n.buenoCircleTitle,onChange:d=>r({...n,buenoCircleTitle:d.target.value})})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Description"}),u.jsx("textarea",{className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",rows:2,value:n.buenoCircleDescription,onChange:d=>r({...n,buenoCircleDescription:d.target.value})})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Discount Percentage"}),u.jsx("input",{type:"number",min:0,max:100,className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent w-32",value:n.buenoCircleDiscount,onChange:d=>r({...n,buenoCircleDiscount:parseInt(d.target.value||"0")})})]})]})]}),u.jsxs("div",{className:"flex items-center gap-3 pt-6 border-t",children:[u.jsx("button",{className:"bg-terracotta text-white rounded-lg px-6 py-2 hover:bg-terracotta/90 transition-colors disabled:opacity-50",onClick:l,disabled:s,children:s?"Saving":"Save Website Content"}),o&&u.jsx("span",{className:`text-sm ${o==="Saved"?"text-green-600":"text-red-600"}`,children:o})]})]})}function w5({initial:t}){const{db:e}=Xe(),[n,r]=_.useState(t.dailyTarget),[s,i]=_.useState(t.weeklyTarget),[o,a]=_.useState(t.monthlyTarget),[l,d]=_.useState(t.defaultCogsRate),[h,m]=_.useState(!1),[p,x]=_.useState("");async function v(){try{m(!0),x(""),await VF(e,{dailyTarget:n,weeklyTarget:s,monthlyTarget:o,defaultCogsRate:l}),x("Saved"),setTimeout(()=>x(""),3e3)}catch(C){x((C==null?void 0:C.message)||"Failed to save")}finally{m(!1)}}return u.jsxs("div",{className:"grid gap-4 max-w-2xl",children:[u.jsxs("label",{className:"grid grid-cols-[200px_1fr] items-center gap-4",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Daily target ($)"}),u.jsx("input",{type:"number",min:0,className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:n,onChange:C=>r(parseFloat(C.target.value||"0"))})]}),u.jsxs("label",{className:"grid grid-cols-[200px_1fr] items-center gap-4",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Weekly target ($)"}),u.jsx("input",{type:"number",min:0,className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:s,onChange:C=>i(parseFloat(C.target.value||"0"))})]}),u.jsxs("label",{className:"grid grid-cols-[200px_1fr] items-center gap-4",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Monthly target ($)"}),u.jsx("input",{type:"number",min:0,className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:o,onChange:C=>a(parseFloat(C.target.value||"0"))})]}),u.jsxs("label",{className:"grid grid-cols-[200px_1fr] items-center gap-4",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Default COGS rate (%)"}),u.jsx("input",{type:"number",min:0,max:100,step:.1,className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:l,onChange:C=>d(parseFloat(C.target.value||"0"))})]}),u.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[u.jsx("button",{className:"bg-terracotta text-white rounded-lg px-6 py-2 hover:bg-terracotta/90 transition-colors",onClick:v,disabled:h,children:h?"Saving":"Save Targets"}),p&&u.jsx("span",{className:`text-sm ${p==="Saved"?"text-green-600":"text-red-600"}`,children:p})]})]})}const x5=["sun","mon","tue","wed","thu","fri","sat"],jf={sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"};function E5({initial:t}){const{db:e}=Xe(),[n,r]=_.useState(t.timezone),[s,i]=_.useState(t.slotInterval),[o,a]=_.useState(()=>JSON.parse(JSON.stringify(t.slots))),[l,d]=_.useState(!1),[h,m]=_.useState("");function p(A){const T=structuredClone(o);(T[A]||(T[A]=[])).push(["09:00","17:00"]),a(T)}function x(A,T){const y=structuredClone(o);y[A].splice(T,1),a(y)}function v(A,T,y,w){const N=w.trim(),j=structuredClone(o);j[A][T][y]=N,a(j)}async function C(){try{d(!0),m(""),b5({timezone:n,slotInterval:s,slots:o}),await FF(e,{timezone:n,slotInterval:s,slots:o}),m("Saved"),setTimeout(()=>m(""),3e3)}catch(A){m((A==null?void 0:A.message)||"Failed to save")}finally{d(!1)}}return u.jsxs("div",{className:"grid gap-6 max-w-4xl",children:[u.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Timezone (IANA)"}),u.jsx("input",{className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",placeholder:"America/Los_Angeles",value:n,onChange:A=>r(A.target.value)})]}),u.jsxs("label",{className:"grid gap-2",children:[u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Slot interval (minutes)"}),u.jsx("input",{type:"number",min:5,step:5,className:"border border-slate-300 rounded-lg p-2 focus:ring-2 focus:ring-terracotta focus:border-transparent",value:s,onChange:A=>i(parseInt(A.target.value||"15"))})]})]}),u.jsx("div",{className:"grid gap-4",children:x5.map(A=>u.jsxs("div",{className:"border border-slate-200 rounded-xl p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h3",{className:"font-serif text-lg text-slate-800",children:jf[A]}),u.jsx("button",{className:"text-terracotta hover:text-terracotta/80 text-sm font-medium",onClick:()=>p(A),children:"+ Add hours"})]}),(o[A]||[]).length===0&&u.jsx("div",{className:"text-slate-500 text-sm bg-slate-50 rounded-lg p-3 text-center",children:"Closed"}),u.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-3",children:(o[A]||[]).map((T,y)=>u.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 rounded-lg p-2",children:[u.jsx("input",{className:"border border-slate-300 rounded-md p-2 w-24 text-sm",placeholder:"09:00",value:T[0],onChange:w=>v(A,y,0,w.target.value),"aria-label":`${jf[A]} start ${y+1}`}),u.jsx("span",{className:"text-slate-500",children:""}),u.jsx("input",{className:"border border-slate-300 rounded-md p-2 w-24 text-sm",placeholder:"17:00",value:T[1],onChange:w=>v(A,y,1,w.target.value),"aria-label":`${jf[A]} end ${y+1}`}),u.jsx("button",{className:"text-red-600 hover:text-red-700 p-1",onClick:()=>x(A,y),title:"Remove",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},y))})]},A))}),u.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t",children:[u.jsx("button",{className:"bg-terracotta text-white rounded-lg px-6 py-2 hover:bg-terracotta/90 transition-colors",onClick:C,disabled:l,children:l?"Saving":"Save Business Hours"}),h&&u.jsx("span",{className:`text-sm ${h==="Saved"?"text-green-600":"text-red-600"}`,children:h})]}),u.jsx(T5,{bh:{timezone:n,slotInterval:s,slots:o}})]})}function T5({bh:t}){const{db:e}=Xe(),[n,r]=_.useState(()=>new Date().toISOString().slice(0,10)),[s,i]=_.useState(60),[o,a]=_.useState([]),l=_.useMemo(()=>new Date(n+"T00:00:00"),[n]);_.useEffect(()=>OF(e,l,a),[l]);const d=_.useMemo(()=>cc(l,s,t,o),[l,s,t,o]);return u.jsxs("div",{className:"border border-slate-200 rounded-xl p-4 bg-slate-50",children:[u.jsx("h4",{className:"font-medium text-slate-800 mb-3",children:"Preview Available Slots"}),u.jsxs("div",{className:"flex flex-wrap items-end gap-3 mb-4",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Preview date"}),u.jsx("input",{type:"date",className:"border border-slate-300 rounded-lg p-2 text-sm",value:n,onChange:h=>r(h.target.value)})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-slate-600 mb-1",children:"Service duration (minutes)"}),u.jsx("input",{type:"number",min:5,step:5,className:"border border-slate-300 rounded-lg p-2 text-sm w-32",value:s,onChange:h=>i(parseInt(h.target.value||"0"))})]})]}),u.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[d.map(h=>u.jsx("div",{className:"border border-slate-300 bg-white rounded-md py-2 text-center text-sm",children:nt(gr(h),"h:mm a")},h)),!d.length&&u.jsx("div",{className:"col-span-4 text-slate-500 text-sm text-center py-4",children:"No available slots for this date/duration."})]})]})}function b5(t){if(!t.timezone||!t.timezone.includes("/"))throw new Error('Timezone must be a valid IANA zone, e.g. "America/Los_Angeles"');if(!Number.isFinite(t.slotInterval)||t.slotInterval<=0)throw new Error("Slot interval must be a positive number");const e=/^([01]\d|2[0-3]):([0-5]\d)$/;["sun","mon","tue","wed","thu","fri","sat"].forEach(n=>{for(const[r,s]of t.slots[n]||[]){if(!e.test(r)||!e.test(s))throw new Error(`Invalid time on ${n}: use HH:MM`);if(r>=s)throw new Error(`${n}: start must be before end`)}})}function S5(){return u.jsx(UL,{children:u.jsxs("div",{className:"min-h-screen grid",style:{gridTemplateRows:"56px 1fr"},children:[u.jsx(zL,{}),u.jsxs("div",{className:"grid",style:{gridTemplateColumns:"224px 1fr"},children:[u.jsx(BL,{}),u.jsx("main",{className:"p-6",children:u.jsxs(FA,{children:[u.jsx(Jt,{index:!0,element:u.jsx(R0,{to:"home",replace:!0})}),u.jsx(Jt,{path:"home",element:u.jsx(c6,{})}),u.jsx(Jt,{path:"schedule",element:u.jsx(HF,{})}),u.jsx(Jt,{path:"customers",element:u.jsx(qF,{})}),u.jsx(Jt,{path:"services",element:u.jsx(QF,{})}),u.jsx(Jt,{path:"reviews",element:u.jsx(XF,{})}),u.jsx(Jt,{path:"messages",element:u.jsx(eU,{})}),u.jsx(Jt,{path:"sms",element:u.jsx(nU,{})}),u.jsx(Jt,{path:"ai-conversations",element:u.jsx(sU,{})}),u.jsx(Jt,{path:"skin-analyses",element:u.jsx(iU,{})}),u.jsx(Jt,{path:"settings",element:u.jsx(g5,{})}),u.jsx(Jt,{path:"*",element:u.jsx(R0,{to:"home",replace:!0})})]})})]})]})})}Of.createRoot(document.getElementById("root")).render(u.jsx(ne.StrictMode,{children:u.jsx(FL,{children:u.jsx(GA,{children:u.jsx(S5,{})})})}));
